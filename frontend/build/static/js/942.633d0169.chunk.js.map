{"version":3,"file":"static/js/942.633d0169.chunk.js","mappings":"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","sources":["components/NumberInput.jsx","components/NormConfigEditor.jsx","pages/school/NormPage.jsx","utils/kademe.js","components/ui/TabProgressHeatmap.jsx"],"sourcesContent":["// frontend/src/components/NumberInput.jsx\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\n\r\nconst DEFAULT_LOCALE = \"tr-TR\";\r\n\r\nconst separatorsCache = new Map();\r\n\r\nfunction getSeparators(locale) {\r\n  if (separatorsCache.has(locale)) return separatorsCache.get(locale);\r\n  const parts = new Intl.NumberFormat(locale).formatToParts(1000.1);\r\n  const group = parts.find((p) => p.type === \"group\")?.value || \",\";\r\n  const decimal = parts.find((p) => p.type === \"decimal\")?.value || \".\";\r\n  const next = { group, decimal };\r\n  separatorsCache.set(locale, next);\r\n  return next;\r\n}\r\n\r\nfunction countStepDecimals(step) {\r\n  if (step == null) return 2;\r\n  const s = String(step).trim();\r\n  if (!s || s === \"any\") return 6;\r\n  const dot = s.indexOf(\".\");\r\n  if (dot === -1) return 0;\r\n  return Math.max(0, s.length - dot - 1);\r\n}\r\n\r\nfunction parseFlexibleNumber(input) {\r\n  const raw = String(input ?? \"\").trim();\r\n  if (!raw) return { value: null, empty: true };\r\n\r\n  // Remove spaces and keep only digits/separators/sign.\r\n  const cleaned = raw.replace(/\\s+/g, \"\");\r\n  const hasDot = cleaned.includes(\".\");\r\n  const hasComma = cleaned.includes(\",\");\r\n\r\n  let decimalSep = null;\r\n  let thousandSep = null;\r\n\r\n  if (hasDot && hasComma) {\r\n    const lastDot = cleaned.lastIndexOf(\".\");\r\n    const lastComma = cleaned.lastIndexOf(\",\");\r\n    decimalSep = lastDot > lastComma ? \".\" : \",\";\r\n    thousandSep = decimalSep === \".\" ? \",\" : \".\";\r\n  } else if (hasDot || hasComma) {\r\n    const sep = hasDot ? \".\" : \",\";\r\n    const count = (cleaned.match(new RegExp(`\\\\${sep}`, \"g\")) || []).length;\r\n    if (count > 1) {\r\n      thousandSep = sep;\r\n    } else {\r\n      const idx = cleaned.lastIndexOf(sep);\r\n      const digitsAfter = cleaned.length - idx - 1;\r\n      if (digitsAfter >= 1 && digitsAfter <= 2) {\r\n        decimalSep = sep;\r\n      } else {\r\n        thousandSep = sep;\r\n      }\r\n    }\r\n  }\r\n\r\n  let normalized = cleaned;\r\n  if (thousandSep) normalized = normalized.split(thousandSep).join(\"\");\r\n  if (decimalSep) normalized = normalized.replace(decimalSep, \".\");\r\n  if (!decimalSep) normalized = normalized.replace(/[.,]/g, \"\");\r\n\r\n  // Keep a single leading minus.\r\n  normalized = normalized.replace(/(?!^)-/g, \"\");\r\n  normalized = normalized.replace(/[^0-9.-]/g, \"\");\r\n\r\n  const value = Number(normalized);\r\n  if (!Number.isFinite(value)) return { value: null, empty: false };\r\n  return { value, empty: false };\r\n}\r\n\r\nexport default function NumberInput({\r\n  value,\r\n  onChange,\r\n  onBlur,\r\n  onFocus,\r\n  className,\r\n  step,\r\n  disabled,\r\n  placeholder,\r\n  title,\r\n  name,\r\n  id,\r\n  inputMode,\r\n  ...rest\r\n}) {\r\n  const decimals = useMemo(() => countStepDecimals(step), [step]);\r\n  const locale = DEFAULT_LOCALE;\r\n  const { decimal } = useMemo(() => getSeparators(locale), [locale]);\r\n\r\n  const formatter = useMemo(\r\n    () =>\r\n      new Intl.NumberFormat(locale, {\r\n        useGrouping: true,\r\n        maximumFractionDigits: decimals,\r\n      }),\r\n    [locale, decimals]\r\n  );\r\n\r\n  const rawFormatter = useMemo(\r\n    () =>\r\n      new Intl.NumberFormat(locale, {\r\n        useGrouping: false,\r\n        maximumFractionDigits: decimals,\r\n      }),\r\n    [locale, decimals]\r\n  );\r\n\r\n  const [editing, setEditing] = useState(false);\r\n  const [draft, setDraft] = useState(\"\");\r\n\r\n  const numericValue = Number(value);\r\n  const hasValue = value !== \"\" && value != null && Number.isFinite(numericValue);\r\n\r\n  useEffect(() => {\r\n    if (editing) return;\r\n    if (!hasValue) {\r\n      setDraft(\"\");\r\n      return;\r\n    }\r\n    setDraft(formatter.format(numericValue));\r\n  }, [editing, formatter, hasValue, numericValue]);\r\n\r\n  const handleFocus = (event) => {\r\n    setEditing(true);\r\n    if (hasValue) {\r\n      setDraft(rawFormatter.format(numericValue));\r\n    } else {\r\n      setDraft(\"\");\r\n    }\r\n    onFocus?.(event);\r\n  };\r\n\r\n  const handleChange = (event) => {\r\n    const next = event.target.value;\r\n    setDraft(next);\r\n\r\n    const parsed = parseFlexibleNumber(next);\r\n    if (parsed.empty) {\r\n      onChange?.(\"\");\r\n      return;\r\n    }\r\n    if (parsed.value == null) return;\r\n    onChange?.(parsed.value);\r\n  };\r\n\r\n  const handleBlur = (event) => {\r\n    setEditing(false);\r\n\r\n    const parsed = parseFlexibleNumber(draft);\r\n    if (parsed.empty) {\r\n      setDraft(\"\");\r\n      onChange?.(\"\");\r\n      onBlur?.(event);\r\n      return;\r\n    }\r\n    if (parsed.value != null) {\r\n      const rounded = Number(parsed.value);\r\n      setDraft(formatter.format(rounded));\r\n      onChange?.(rounded);\r\n    }\r\n    onBlur?.(event);\r\n  };\r\n\r\n  return (\r\n    <input\r\n      {...rest}\r\n      id={id}\r\n      name={name}\r\n      className={className}\r\n      value={editing ? draft : draft || \"\"}\r\n      onChange={handleChange}\r\n      onFocus={handleFocus}\r\n      onBlur={handleBlur}\r\n      disabled={disabled}\r\n      placeholder={placeholder}\r\n      title={title}\r\n      inputMode={inputMode || \"decimal\"}\r\n      autoComplete=\"off\"\r\n      aria-invalid={rest[\"aria-invalid\"]}\r\n      data-decimal-separator={decimal}\r\n    />\r\n  );\r\n}\r\n","//frontend/src/components/NormConfigEditor.jsx\r\n\r\nimport React, { useMemo, useState } from \"react\";\r\nimport { getGradeOptions, getKademeDefinitions, getKademeForGrade, formatKademeLabel, normalizeKademeConfig } from \"../utils/kademe\";\r\nimport NumberInput from \"./NumberInput\";\r\n\r\nconst KEY_SEP = \"||\"; // stored subject key format: \"Teacher||Lesson\"\r\nconst ALL_GRADES = getGradeOptions();\r\nconst GRADE_INDEX = new Map(ALL_GRADES.map((g, i) => [g, i]));\r\nconst YEAR_KEYS = [\"y1\", \"y2\", \"y3\"];\r\nconst DEFAULT_MAX_HOURS = 24;\r\n\r\nconst KADEME_DEFS = getKademeDefinitions();\r\nconst KADEME_LABELS = Object.freeze(\r\n  KADEME_DEFS.reduce((m, d) => {\r\n    m[d.key] = d.label;\r\n    return m;\r\n  }, {})\r\n);\r\n\r\nconst EMPTY_ARRAY = Object.freeze([]);\r\n\r\nconst safeNum = (v) => {\r\n  const n = Number(v);\r\n  return Number.isFinite(n) ? n : 0;\r\n};\r\n\r\nfunction buildEmptyCurriculum() {\r\n  const out = {};\r\n  ALL_GRADES.forEach((g) => (out[g] = {}));\r\n  return out;\r\n}\r\n\r\nfunction normalizeNormValue(value) {\r\n  const v = value && typeof value === \"object\" ? value : {};\r\n  const yearsSrc = v?.years && typeof v.years === \"object\" ? v.years : null;\r\n  if (yearsSrc) {\r\n    const outYears = {};\r\n    YEAR_KEYS.forEach((y) => {\r\n      const src = yearsSrc?.[y] || {};\r\n      const hoursRaw = Number(src?.teacherWeeklyMaxHours ?? v?.teacherWeeklyMaxHours ?? DEFAULT_MAX_HOURS);\r\n      const hours = Number.isFinite(hoursRaw) && hoursRaw > 0 ? hoursRaw : DEFAULT_MAX_HOURS;\r\n      const curr =\r\n        src?.curriculumWeeklyHours && typeof src.curriculumWeeklyHours === \"object\"\r\n          ? src.curriculumWeeklyHours\r\n          : buildEmptyCurriculum();\r\n      outYears[y] = { teacherWeeklyMaxHours: hours, curriculumWeeklyHours: curr };\r\n    });\r\n    return { years: outYears };\r\n  }\r\n\r\n  const baseHoursRaw = Number(v?.teacherWeeklyMaxHours ?? DEFAULT_MAX_HOURS);\r\n  const baseHours = Number.isFinite(baseHoursRaw) && baseHoursRaw > 0 ? baseHoursRaw : DEFAULT_MAX_HOURS;\r\n  const baseCurr =\r\n    v?.curriculumWeeklyHours && typeof v.curriculumWeeklyHours === \"object\"\r\n      ? v.curriculumWeeklyHours\r\n      : buildEmptyCurriculum();\r\n\r\n  const years = {};\r\n  YEAR_KEYS.forEach((y) => {\r\n    years[y] = { teacherWeeklyMaxHours: baseHours, curriculumWeeklyHours: structuredClone(baseCurr) };\r\n  });\r\n  return { years };\r\n}\r\n\r\nfunction encodeKey(teacher, lesson) {\r\n  const t = String(teacher || \"\").trim();\r\n  const l = String(lesson || \"\").trim();\r\n  if (!t && !l) return \"\";\r\n  if (!l) return t;\r\n  if (!t) return l;\r\n  return `${t}${KEY_SEP}${l}`;\r\n}\r\n\r\nfunction decodeKey(key) {\r\n  const k = String(key || \"\");\r\n  if (k.includes(KEY_SEP)) {\r\n    const [t, ...rest] = k.split(KEY_SEP);\r\n    return { teacher: t || \"\", lesson: rest.join(KEY_SEP) || \"\" };\r\n  }\r\n  return { teacher: k, lesson: k };\r\n}\r\n\r\nfunction normalizeGrades(grades, gradeOrder) {\r\n  const data = Array.isArray(grades) ? grades : [];\r\n  const order = Array.isArray(gradeOrder) && gradeOrder.length ? gradeOrder : ALL_GRADES;\r\n  return order.map((g) => {\r\n    const row = data.find((x) => String(x.grade) === g) || { grade: g, branchCount: 0, studentsPerBranch: 0 };\r\n    return {\r\n      grade: g,\r\n      branchCount: safeNum(row.branchCount),\r\n      studentsPerBranch: safeNum(row.studentsPerBranch),\r\n    };\r\n  });\r\n}\r\n\r\nfunction normalizePlanningGrades(input) {\r\n  if (Array.isArray(input)) {\r\n    return { y1: input, y2: input, y3: input };\r\n  }\r\n  if (input && typeof input === \"object\") {\r\n    const years = input.years && typeof input.years === \"object\" ? input.years : input;\r\n    const y1 = Array.isArray(years?.y1) ? years.y1 : [];\r\n    const y2 = Array.isArray(years?.y2) ? years.y2 : y1;\r\n    const y3 = Array.isArray(years?.y3) ? years.y3 : y1;\r\n    return { y1, y2, y3 };\r\n  }\r\n  return { y1: [], y2: [], y3: [] };\r\n}\r\n\r\nfunction totalStudentsFromGrades(grades) {\r\n  const rows = normalizeGrades(grades, ALL_GRADES);\r\n  // studentsPerBranch now represents TOTAL students for the grade (not per-branch)\r\n  return rows.reduce((s, r) => s + safeNum(r.studentsPerBranch), 0);\r\n}\r\n\r\nfunction resolveVisibleGrades(kademeConfig) {\r\n  const cfg = normalizeKademeConfig(kademeConfig);\r\n  const included = new Set();\r\n  Object.values(cfg).forEach((row) => {\r\n    if (!row?.enabled) return;\r\n    const fromIdx = GRADE_INDEX.get(String(row.from));\r\n    const toIdx = GRADE_INDEX.get(String(row.to));\r\n    if (!Number.isInteger(fromIdx) || !Number.isInteger(toIdx)) return;\r\n    const start = Math.min(fromIdx, toIdx);\r\n    const end = Math.max(fromIdx, toIdx);\r\n    for (let i = start; i <= end; i += 1) included.add(ALL_GRADES[i]);\r\n  });\r\n  const list = ALL_GRADES.filter((g) => included.has(g));\r\n  return list.length ? list : ALL_GRADES;\r\n}\r\n\r\n\r\nfunction buildKademeSegments(gradeOrder, kademeConfig) {\r\n  const order = Array.isArray(gradeOrder) && gradeOrder.length ? gradeOrder : ALL_GRADES;\r\n  const segments = [];\r\n\r\n  let curKey = null;\r\n  let curGrades = [];\r\n\r\n  const push = () => {\r\n    if (!curGrades.length) return;\r\n    const key = curKey;\r\n    const label = key ? formatKademeLabel(KADEME_LABELS[key] || key, kademeConfig, key) : \"\";\r\n    segments.push({ key, label, grades: curGrades });\r\n  };\r\n\r\n  for (const g of order) {\r\n    const k = getKademeForGrade(g, kademeConfig);\r\n    if (k !== curKey && curGrades.length) {\r\n      push();\r\n      curGrades = [];\r\n    }\r\n    if (k !== curKey) curKey = k;\r\n    curGrades.push(g);\r\n  }\r\n  push();\r\n\r\n  return segments;\r\n}\r\n\r\nfunction GradeTable({\r\n  title,\r\n  subtitle,\r\n  grades,\r\n  onChange,\r\n  dirtyPaths,\r\n  onDirty,\r\n  pathPrefix,\r\n  gradeColWidth,\r\n  inputWidth,\r\n  gradeOrder,\r\n  allGrades,\r\n  kademeConfig,\r\n}) {\r\n  const visibleOrder = Array.isArray(gradeOrder) && gradeOrder.length ? gradeOrder : ALL_GRADES;\r\n  const fullOrder = Array.isArray(allGrades) && allGrades.length ? allGrades : visibleOrder;\r\n  const data = normalizeGrades(grades, visibleOrder);\r\n  const fullData = normalizeGrades(grades, fullOrder);\r\n  const disabled = typeof onChange !== \"function\";\r\n  const isDirty = (path) => (path && dirtyPaths ? dirtyPaths.has(path) : false);\r\n  const inputClass = (base, path) => base + (isDirty(path) ? \" input-dirty\" : \"\");\r\n  const makePath = (grade, field) => (pathPrefix ? `${pathPrefix}.${grade}.${field}` : \"\");\r\n\r\n  const totals = data.reduce(\r\n    (acc, r) => {\r\n      // studentsPerBranch is TOTAL students for the grade.\r\n      const gradeStudents = safeNum(r.studentsPerBranch);\r\n      acc.totalBranches += safeNum(r.branchCount);\r\n      acc.totalStudents += gradeStudents;\r\n      return acc;\r\n    },\r\n    { totalBranches: 0, totalStudents: 0 }\r\n  );\r\n\r\n  function setField(grade, field, value) {\r\n    if (disabled) return;\r\n    const nextValue = value === \"\" ? 0 : safeNum(value);\r\n    const next = fullData.map((r) => {\r\n      if (r.grade !== grade) return r;\r\n      return { ...r, [field]: nextValue };\r\n    });\r\n    onChange(next);\r\n    if (pathPrefix) onDirty?.(makePath(grade, field), nextValue);\r\n  }\r\n\r\n  const dividerStyle = { borderLeft: \"2px solid rgba(0,0,0,0.10)\" };\r\n  const totalColStyle = { background: \"rgba(0,0,0,0.04)\" };\r\n  const rowLabelStyle = { fontWeight: 800, whiteSpace: \"nowrap\" };\r\n\r\n  const LABEL_COL_W = 150;\r\n  const GRADE_COL_W = Number.isFinite(gradeColWidth) ? gradeColWidth : 36;\r\n  const TOTAL_COL_W = 78;\r\n  const SINGLE_SEGMENT_MIN_W = 100;\r\n\r\n  const compactInputStyle = {\r\n    width: Number.isFinite(inputWidth) ? inputWidth : GRADE_COL_W - 2,\r\n    boxSizing: \"border-box\",\r\n    textAlign: \"center\",\r\n    paddingLeft: 4,\r\n    paddingRight: 4,\r\n  };\r\n\r\n  const segments = useMemo(() => buildKademeSegments(visibleOrder, kademeConfig), [visibleOrder, kademeConfig]);\r\n\r\n  // kademe total students per segment\r\n  const segmentTotals = useMemo(() => {\r\n    const byGrade = new Map(data.map((r) => [r.grade, safeNum(r.studentsPerBranch)]));\r\n    return segments.map((seg) => seg.grades.reduce((s, g) => s + safeNum(byGrade.get(g)), 0));\r\n  }, [segments, data]);\r\n\r\n  return (\r\n    <div className=\"card\" style={{ marginTop: 12 }}>\r\n      <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\r\n        <div>\r\n          <div style={{ fontWeight: 800 }}>{title}</div>\r\n          {subtitle ? <div className=\"small\">{subtitle}</div> : null}\r\n        </div>\r\n        <div className=\"row\">\r\n          <span className=\"badge\">Toplam ube: {totals.totalBranches.toFixed(0)}</span>\r\n          <span className=\"badge\">Toplam renci: {totals.totalStudents.toFixed(0)}</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div style={{ overflowX: \"auto\", marginTop: 10 }}>\r\n        <table className=\"table\" style={{ tableLayout: \"fixed\" }}>\r\n          <thead>\r\n            {/* Grouping header (Kademe) */}\r\n            <tr>\r\n              <th\r\n                rowSpan={2}\r\n                style={{ minWidth: LABEL_COL_W, width: LABEL_COL_W, maxWidth: LABEL_COL_W }}\r\n              ></th>\r\n              {segments.map((seg, idx) => (\r\n                <th\r\n                  key={`${seg.key || \"none\"}-${idx}`}\r\n                  colSpan={seg.grades.length}\r\n                  style={{\r\n                    textAlign: \"center\",\r\n                    fontWeight: 900,\r\n                    paddingTop: 6,\r\n                    paddingBottom: 6,\r\n                    ...(idx === 0 ? {} : dividerStyle),\r\n                    background: \"rgba(22, 87, 238, 0.03)\",\r\n                    minWidth:\r\n                      seg.grades.length === 1\r\n                        ? SINGLE_SEGMENT_MIN_W\r\n                        : seg.grades.length * GRADE_COL_W,\r\n                    width:\r\n                      seg.grades.length === 1\r\n                        ? SINGLE_SEGMENT_MIN_W\r\n                        : seg.grades.length * GRADE_COL_W,\r\n                    whiteSpace: \"normal\",\r\n                    lineHeight: 1.2,\r\n                  }}\r\n                  title={seg.label}\r\n                >\r\n                  {seg.label}\r\n                </th>\r\n              ))}\r\n              <th\r\n                rowSpan={2}\r\n                style={{\r\n                  textAlign: \"center\",\r\n                  minWidth: TOTAL_COL_W,\r\n                  width: TOTAL_COL_W,\r\n                  maxWidth: TOTAL_COL_W,\r\n                  ...dividerStyle,\r\n                  ...totalColStyle,\r\n                  paddingLeft: 8,\r\n                  paddingRight: 8,\r\n                }}\r\n              >\r\n                TOPLAM\r\n              </th>\r\n            </tr>\r\n\r\n            {/* Grade headers */}\r\n            <tr>\r\n              {data.map((r, idx) => (\r\n                <th\r\n                  key={r.grade}\r\n                  style={{\r\n                    textAlign: \"center\",\r\n                    minWidth: GRADE_COL_W,\r\n                    width: GRADE_COL_W,\r\n                    maxWidth: GRADE_COL_W,\r\n                    ...(idx === 0 ? {} : dividerStyle),\r\n                    paddingLeft: 4,\r\n                    paddingRight: 4,\r\n                  }}\r\n                >\r\n                  {r.grade}\r\n                </th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n\r\n          <tbody>\r\n            <tr>\r\n              <td style={rowLabelStyle}>ube Says</td>\r\n              {data.map((r, idx) => (\r\n                <td\r\n                  key={r.grade}\r\n                  style={{\r\n                    textAlign: \"right\",\r\n                    ...(idx === 0 ? {} : dividerStyle),\r\n                    paddingLeft: 4,\r\n                    paddingRight: 4,\r\n                  }}\r\n                >\r\n                  <NumberInput\r\n                    className={inputClass(\"input sm\", makePath(r.grade, \"branchCount\"))}\r\n                    style={compactInputStyle}\r\n                    min=\"0\"\r\n                    step=\"1\"\r\n                    value={r.branchCount}\r\n                    disabled={disabled}\r\n                    onChange={(value) => setField(r.grade, \"branchCount\", value)}\r\n                  />\r\n                </td>\r\n              ))}\r\n              <td\r\n                style={{\r\n                  textAlign: \"right\",\r\n                  fontWeight: 900,\r\n                  ...dividerStyle,\r\n                  ...totalColStyle,\r\n                  paddingLeft: 4,\r\n                  paddingRight: 4,\r\n                }}\r\n              >\r\n                {totals.totalBranches.toFixed(0)}\r\n              </td>\r\n            </tr>\r\n\r\n            <tr>\r\n              <td style={rowLabelStyle}>renci</td>\r\n              {data.map((r, idx) => (\r\n                <td\r\n                  key={r.grade}\r\n                  style={{\r\n                    textAlign: \"right\",\r\n                    ...(idx === 0 ? {} : dividerStyle),\r\n                    paddingLeft: 4,\r\n                    paddingRight: 4,\r\n                  }}\r\n                >\r\n                  <NumberInput\r\n                    className={inputClass(\"input sm\", makePath(r.grade, \"studentsPerBranch\"))}\r\n                    style={compactInputStyle}\r\n                    min=\"0\"\r\n                    step=\"1\"\r\n                    value={r.studentsPerBranch}\r\n                    disabled={disabled}\r\n                    onChange={(value) => setField(r.grade, \"studentsPerBranch\", value)}\r\n                  />\r\n                </td>\r\n              ))}\r\n              <td\r\n                style={{\r\n                  textAlign: \"right\",\r\n                  fontWeight: 900,\r\n                  ...dividerStyle,\r\n                  ...totalColStyle,\r\n                  paddingLeft: 4,\r\n                  paddingRight: 4,\r\n                }}\r\n              >\r\n                {totals.totalStudents.toFixed(0)}\r\n              </td>\r\n            </tr>\r\n\r\n            {/* Kademe totals (students only) */}\r\n            <tr>\r\n              <td style={rowLabelStyle}>Kademe Toplam</td>\r\n              {segments.map((seg, idx) => (\r\n                <td\r\n                  key={`seg-total-${idx}`}\r\n                  colSpan={seg.grades.length}\r\n                  style={{\r\n                    textAlign: \"right\",\r\n                    fontWeight: 900,\r\n                    ...(idx === 0 ? {} : dividerStyle),\r\n                    background: \"rgba(15, 23, 42, 0.03)\",\r\n                    paddingLeft: 8,\r\n                    paddingRight: 8,\r\n                  }}\r\n                >\r\n                  {safeNum(segmentTotals[idx]).toFixed(0)}\r\n                </td>\r\n              ))}\r\n              <td\r\n                style={{\r\n                  textAlign: \"right\",\r\n                  fontWeight: 900,\r\n                  ...dividerStyle,\r\n                  ...totalColStyle,\r\n                  paddingLeft: 4,\r\n                  paddingRight: 4,\r\n                }}\r\n              >\r\n                {totals.totalStudents.toFixed(0)}\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nexport default function NormConfigEditor({\r\n  value,\r\n  onChange,\r\n  lastUpdatedAt,\r\n  planningGrades,\r\n  currentGrades,\r\n  onPlanningGradesChange,\r\n  onCurrentGradesChange,\r\n  kademeConfig,\r\n  dirtyPaths,\r\n  onDirty,\r\n}) {\r\n  const norm = useMemo(() => normalizeNormValue(value), [value]);\r\n  const [activeYear, setActiveYear] = useState(\"y1\");\r\n\r\n  //  Fix #1: memoize yearData (avoid `|| {}` creating a new object each render)\r\n  const yearData = useMemo(() => {\r\n    const yd = norm.years?.[activeYear];\r\n    return yd || { teacherWeeklyMaxHours: DEFAULT_MAX_HOURS, curriculumWeeklyHours: buildEmptyCurriculum() };\r\n  }, [norm.years, activeYear]);\r\n\r\n  const teacherWeeklyMaxHours = safeNum(yearData.teacherWeeklyMaxHours ?? DEFAULT_MAX_HOURS) || DEFAULT_MAX_HOURS;\r\n\r\n  // (normalizeNormValue already guarantees object shape, but keep safe)\r\n  const curriculumWeeklyHours =\r\n    yearData.curriculumWeeklyHours && typeof yearData.curriculumWeeklyHours === \"object\"\r\n      ? yearData.curriculumWeeklyHours\r\n      : buildEmptyCurriculum();\r\n\r\n  const visibleGrades = useMemo(() => resolveVisibleGrades(kademeConfig), [kademeConfig]);\r\n  const planningByYear = useMemo(() => normalizePlanningGrades(planningGrades), [planningGrades]);\r\n\r\n  //  Fix #2: memoize activePlanningGrades (avoid `|| []` new array each render)\r\n  const activePlanningGrades = useMemo(\r\n    () => planningByYear?.[activeYear] || EMPTY_ARRAY,\r\n    [planningByYear, activeYear]\r\n  );\r\n\r\n  const canEditCurrent = activeYear === \"y1\";\r\n\r\n  const plannedTotalsByYear = useMemo(\r\n    () => ({\r\n      y1: totalStudentsFromGrades(planningByYear.y1),\r\n      y2: totalStudentsFromGrades(planningByYear.y2),\r\n      y3: totalStudentsFromGrades(planningByYear.y3),\r\n    }),\r\n    [planningByYear]\r\n  );\r\n\r\n  const missingPlanYears = [];\r\n  const y2Missing = plannedTotalsByYear.y2 <= 0 || planningByYear.y2 === planningByYear.y1;\r\n  const y3Missing = plannedTotalsByYear.y3 <= 0 || planningByYear.y3 === planningByYear.y1;\r\n  if (y2Missing) missingPlanYears.push(\"Y2\");\r\n  if (y3Missing) missingPlanYears.push(\"Y3\");\r\n\r\n  const isDirty = (path) => (path && dirtyPaths ? dirtyPaths.has(path) : false);\r\n  const inputClass = (base, path) => base + (isDirty(path) ? \" input-dirty\" : \"\");\r\n  const normPath = (suffix) => `norm.years.${activeYear}.${suffix}`;\r\n  const planningPath = `inputs.gradesYears.${activeYear}`;\r\n\r\n  const curriculumKeys = useMemo(() => {\r\n    const set = new Set();\r\n    ALL_GRADES.forEach((g) => {\r\n      const obj = curriculumWeeklyHours?.[g] || {};\r\n      Object.keys(obj).forEach((k) => set.add(k));\r\n    });\r\n    return Array.from(set);\r\n  }, [curriculumWeeklyHours]);\r\n\r\n  const rows = useMemo(() => {\r\n    const out = curriculumKeys\r\n      .map((k) => ({ key: k, ...decodeKey(k) }))\r\n      .filter((r) => String(r.key || \"\").trim());\r\n    out.sort((a, b) => {\r\n      const ta = String(a.teacher || \"\").toLowerCase();\r\n      const tb = String(b.teacher || \"\").toLowerCase();\r\n      if (ta !== tb) return ta.localeCompare(tb);\r\n      return String(a.lesson || \"\").toLowerCase().localeCompare(String(b.lesson || \"\").toLowerCase());\r\n    });\r\n    return out;\r\n  }, [curriculumKeys]);\r\n\r\n  const plan = useMemo(() => normalizeGrades(activePlanningGrades, ALL_GRADES), [activePlanningGrades]);\r\n\r\n  const branchByGrade = useMemo(() => {\r\n    const m = {};\r\n    plan.forEach((r) => (m[r.grade] = safeNum(r.branchCount)));\r\n    return m;\r\n  }, [plan]);\r\n\r\n\r\n  const studentsPerBranchByGrade = useMemo(() => {\r\n    const m = {};\r\n    plan.forEach((r) => (m[r.grade] = safeNum(r.studentsPerBranch)));\r\n    return m;\r\n  }, [plan]);\r\n\r\n  const [newTeacher, setNewTeacher] = useState(\"\");\r\n  const [newLesson, setNewLesson] = useState(\"\");\r\n  const [draftLabels, setDraftLabels] = useState({});\r\n\r\n  const yearLabel = (y) => (y === \"y1\" ? \"Y1\" : y === \"y2\" ? \"Y2\" : \"Y3\");\r\n  const activeYearIndex = YEAR_KEYS.indexOf(activeYear);\r\n  const prevYearKey = activeYearIndex > 0 ? YEAR_KEYS[activeYearIndex - 1] : null;\r\n\r\n  function setMaxHours(val) {\r\n    const num = val === \"\" ? 0 : safeNum(val);\r\n    const nextValue = Number.isFinite(num) && num > 0 ? num : 24;\r\n    const next = structuredClone(norm);\r\n    next.years = next.years || {};\r\n    next.years[activeYear] = next.years[activeYear] || {\r\n      teacherWeeklyMaxHours: DEFAULT_MAX_HOURS,\r\n      curriculumWeeklyHours: buildEmptyCurriculum(),\r\n    };\r\n    next.years[activeYear].teacherWeeklyMaxHours = nextValue;\r\n    onChange({ years: next.years });\r\n    onDirty?.(normPath(\"teacherWeeklyMaxHours\"), nextValue);\r\n  }\r\n\r\n  function setPlanningGrades(nextGrades) {\r\n    if (typeof onPlanningGradesChange !== \"function\") return;\r\n    const next = { ...planningByYear, [activeYear]: nextGrades };\r\n    onPlanningGradesChange(next);\r\n  }\r\n\r\n  function ensureKeyEveryGrade(key) {\r\n    const next = { ...(curriculumWeeklyHours || {}) };\r\n    ALL_GRADES.forEach((g) => {\r\n      next[g] = { ...(next[g] || {}) };\r\n      if (!(key in next[g])) next[g][key] = 0;\r\n    });\r\n    return next;\r\n  }\r\n\r\n  function addRow() {\r\n    const key = encodeKey(newTeacher, newLesson);\r\n    if (!key) return;\r\n    if (curriculumKeys.includes(key)) return;\r\n    const nextCurr = ensureKeyEveryGrade(key);\r\n    const next = structuredClone(norm);\r\n    next.years = next.years || {};\r\n    next.years[activeYear] = next.years[activeYear] || {\r\n      teacherWeeklyMaxHours: DEFAULT_MAX_HOURS,\r\n      curriculumWeeklyHours: buildEmptyCurriculum(),\r\n    };\r\n    next.years[activeYear].curriculumWeeklyHours = nextCurr;\r\n    onChange({ years: next.years });\r\n    ALL_GRADES.forEach((g) => {\r\n      onDirty?.(normPath(`curriculumWeeklyHours.${g}.${key}`), 0);\r\n    });\r\n    setNewTeacher(\"\");\r\n    setNewLesson(\"\");\r\n  }\r\n\r\n  function removeRow(key) {\r\n    const next = { ...(curriculumWeeklyHours || {}) };\r\n    ALL_GRADES.forEach((g) => {\r\n      const row = { ...(next[g] || {}) };\r\n      delete row[key];\r\n      next[g] = row;\r\n    });\r\n    const nextNorm = structuredClone(norm);\r\n    nextNorm.years = nextNorm.years || {};\r\n    nextNorm.years[activeYear] = nextNorm.years[activeYear] || {\r\n      teacherWeeklyMaxHours: DEFAULT_MAX_HOURS,\r\n      curriculumWeeklyHours: buildEmptyCurriculum(),\r\n    };\r\n    nextNorm.years[activeYear].curriculumWeeklyHours = next;\r\n    onChange({ years: nextNorm.years });\r\n    ALL_GRADES.forEach((g) => {\r\n      onDirty?.(normPath(`curriculumWeeklyHours.${g}.${key}`), undefined);\r\n    });\r\n  }\r\n\r\n  function renameRow(oldKey, nextTeacher, nextLesson) {\r\n    const newKey = encodeKey(nextTeacher, nextLesson);\r\n    if (!newKey || newKey === oldKey) return;\r\n    if (curriculumKeys.includes(newKey)) return;\r\n\r\n    const nextCurr = { ...(curriculumWeeklyHours || {}) };\r\n    ALL_GRADES.forEach((g) => {\r\n      const row = { ...(nextCurr[g] || {}) };\r\n      const prevVal = safeNum(row[oldKey]);\r\n      row[newKey] = prevVal;\r\n      delete row[oldKey];\r\n      nextCurr[g] = row;\r\n      onDirty?.(normPath(`curriculumWeeklyHours.${g}.${newKey}`), prevVal);\r\n      onDirty?.(normPath(`curriculumWeeklyHours.${g}.${oldKey}`), undefined);\r\n    });\r\n\r\n    const nextNorm = structuredClone(norm);\r\n    nextNorm.years = nextNorm.years || {};\r\n    nextNorm.years[activeYear] = nextNorm.years[activeYear] || {\r\n      teacherWeeklyMaxHours: DEFAULT_MAX_HOURS,\r\n      curriculumWeeklyHours: buildEmptyCurriculum(),\r\n    };\r\n    nextNorm.years[activeYear].curriculumWeeklyHours = nextCurr;\r\n    onChange({ years: nextNorm.years });\r\n    return newKey;\r\n  }\r\n\r\n  function setDraft(key, patch) {\r\n    setDraftLabels((prev) => ({\r\n      ...prev,\r\n      [key]: {\r\n        teacher: rows.find((x) => x.key === key)?.teacher || \"\",\r\n        lesson: rows.find((x) => x.key === key)?.lesson || \"\",\r\n        ...(prev[key] || {}),\r\n        ...patch,\r\n      },\r\n    }));\r\n  }\r\n\r\n  function commitDraftRename(key) {\r\n    const d = draftLabels[key];\r\n    if (!d) return;\r\n    const orig = decodeKey(key);\r\n    const t = String(d.teacher || \"\").trim();\r\n    const l = String(d.lesson || \"\").trim();\r\n\r\n    if (t === String(orig.teacher || \"\").trim() && l === String(orig.lesson || \"\").trim()) {\r\n      setDraftLabels((prev) => {\r\n        const next = { ...prev };\r\n        delete next[key];\r\n        return next;\r\n      });\r\n      return;\r\n    }\r\n\r\n    const newKey = encodeKey(t, l);\r\n    if (!newKey || newKey === key || curriculumKeys.includes(newKey)) {\r\n      setDraftLabels((prev) => {\r\n        const next = { ...prev };\r\n        delete next[key];\r\n        return next;\r\n      });\r\n      return;\r\n    }\r\n\r\n    renameRow(key, t, l);\r\n    setDraftLabels((prev) => {\r\n      const next = { ...prev };\r\n      delete next[key];\r\n      return next;\r\n    });\r\n  }\r\n\r\n  function setCell(grade, key, val) {\r\n    const num = val === \"\" ? 0 : safeNum(val);\r\n    const nextValue = Number.isFinite(num) && num >= 0 ? num : 0;\r\n\r\n    const nextNorm = structuredClone(norm);\r\n    nextNorm.years = nextNorm.years || {};\r\n    nextNorm.years[activeYear] = nextNorm.years[activeYear] || {\r\n      teacherWeeklyMaxHours: DEFAULT_MAX_HOURS,\r\n      curriculumWeeklyHours: buildEmptyCurriculum(),\r\n    };\r\n\r\n    nextNorm.years[activeYear].curriculumWeeklyHours = {\r\n      ...(curriculumWeeklyHours || {}),\r\n      [grade]: {\r\n        ...(curriculumWeeklyHours?.[grade] || {}),\r\n        [key]: nextValue,\r\n      },\r\n    };\r\n\r\n    onChange({ years: nextNorm.years });\r\n    onDirty?.(normPath(`curriculumWeeklyHours.${grade}.${key}`), nextValue);\r\n  }\r\n\r\n  function copyFromPrevYear() {\r\n    if (!prevYearKey) return;\r\n\r\n    const prevData = norm.years?.[prevYearKey] || {\r\n      teacherWeeklyMaxHours: DEFAULT_MAX_HOURS,\r\n      curriculumWeeklyHours: buildEmptyCurriculum(),\r\n    };\r\n\r\n    const prevCurr =\r\n      prevData?.curriculumWeeklyHours && typeof prevData.curriculumWeeklyHours === \"object\"\r\n        ? prevData.curriculumWeeklyHours\r\n        : buildEmptyCurriculum();\r\n\r\n    const nextNorm = structuredClone(norm);\r\n    nextNorm.years = nextNorm.years || {};\r\n    nextNorm.years[activeYear] = {\r\n      teacherWeeklyMaxHours: safeNum(prevData?.teacherWeeklyMaxHours ?? DEFAULT_MAX_HOURS) || DEFAULT_MAX_HOURS,\r\n      curriculumWeeklyHours: structuredClone(prevCurr),\r\n    };\r\n\r\n    onChange({ years: nextNorm.years });\r\n    onDirty?.(normPath(\"teacherWeeklyMaxHours\"), nextNorm.years[activeYear].teacherWeeklyMaxHours);\r\n\r\n    const oldCurr = norm.years?.[activeYear]?.curriculumWeeklyHours || {};\r\n    const newCurr = nextNorm.years?.[activeYear]?.curriculumWeeklyHours || {};\r\n    ALL_GRADES.forEach((g) => {\r\n      const oldRow = oldCurr?.[g] || {};\r\n      const newRow = newCurr?.[g] || {};\r\n      Object.keys(oldRow).forEach((key) => {\r\n        if (!(key in newRow)) onDirty?.(normPath(`curriculumWeeklyHours.${g}.${key}`), undefined);\r\n      });\r\n      Object.entries(newRow).forEach(([key, val]) => {\r\n        onDirty?.(normPath(`curriculumWeeklyHours.${g}.${key}`), val);\r\n      });\r\n    });\r\n\r\n    if (typeof onPlanningGradesChange === \"function\") {\r\n      const prevPlan = planningByYear?.[prevYearKey] || [];\r\n      const nextPlanning = { ...planningByYear, [activeYear]: structuredClone(prevPlan) };\r\n      onPlanningGradesChange(nextPlanning);\r\n      const normalizedPlan = normalizeGrades(nextPlanning[activeYear], ALL_GRADES);\r\n      normalizedPlan.forEach((row) => {\r\n        onDirty?.(`${planningPath}.${row.grade}.branchCount`, row.branchCount);\r\n        onDirty?.(`${planningPath}.${row.grade}.studentsPerBranch`, row.studentsPerBranch);\r\n      });\r\n    }\r\n  }\r\n\r\n  const rowTotals = useMemo(() => {\r\n    const totals = {};\r\n    rows.forEach((r) => {\r\n      let sum = 0;\r\n      visibleGrades.forEach((g) => {\r\n        const h = safeNum(curriculumWeeklyHours?.[g]?.[r.key]);\r\n        const bc = safeNum(branchByGrade[g]);\r\n        sum += h * bc;\r\n      });\r\n      totals[r.key] = sum;\r\n    });\r\n    return totals;\r\n  }, [rows, curriculumWeeklyHours, branchByGrade, visibleGrades]);\r\n\r\n  const gradeClassHourTotals = useMemo(() => {\r\n    const out = {};\r\n    visibleGrades.forEach((g) => {\r\n      let sum = 0;\r\n      rows.forEach((r) => {\r\n        sum += safeNum(curriculumWeeklyHours?.[g]?.[r.key]);\r\n      });\r\n      out[g] = sum;\r\n    });\r\n    return out;\r\n  }, [rows, curriculumWeeklyHours, visibleGrades]);\r\n\r\n  const summary = useMemo(() => {\r\n    const totalTeachingHours = Object.values(rowTotals).reduce((s, v) => s + safeNum(v), 0);\r\n    const requiredTeachersOverall = teacherWeeklyMaxHours > 0 ? Math.ceil(totalTeachingHours / teacherWeeklyMaxHours) : 0;\r\n\r\n    const byTeacher = new Map();\r\n    rows.forEach((r) => {\r\n      const t = String(r.teacher || \"\").trim() || \"(No Teacher)\";\r\n      const v = safeNum(rowTotals[r.key]);\r\n      byTeacher.set(t, (byTeacher.get(t) || 0) + v);\r\n    });\r\n\r\n    const teacherRows = Array.from(byTeacher.entries())\r\n      .map(([teacher, hours]) => {\r\n        const fte = teacherWeeklyMaxHours > 0 ? hours / teacherWeeklyMaxHours : 0;\r\n        const needed = teacherWeeklyMaxHours > 0 ? Math.ceil(hours / teacherWeeklyMaxHours) : 0;\r\n        return { teacher, hours, fte, needed };\r\n      })\r\n      .sort((a, b) => b.hours - a.hours);\r\n\r\n    const requiredTeachersByBranch = teacherRows.reduce((s, r) => s + safeNum(r.needed), 0);\r\n\r\n    return { totalTeachingHours, requiredTeachersOverall, teacherRows, requiredTeachersByBranch };\r\n  }, [rows, rowTotals, teacherWeeklyMaxHours]);\r\n\r\n\r\n  const planKpis = useMemo(() => {\r\n    const totalBranches = visibleGrades.reduce((s, g) => s + safeNum(branchByGrade[g]), 0);\r\n    const totalStudents = visibleGrades.reduce(\r\n      (s, g) => s + safeNum(studentsPerBranchByGrade[g]),\r\n      0\r\n    );\r\n\r\n    const kgBranches = visibleGrades.includes(\"KG\") ? safeNum(branchByGrade[\"KG\"]) : 0;\r\n    const kgStudents = visibleGrades.includes(\"KG\")\r\n      ? safeNum(studentsPerBranchByGrade[\"KG\"])\r\n      : 0;\r\n\r\n    // Okul ncesi kademesinde 50 renciye 1 personel istihdam yaplr.\r\n    const okulOncesiPersonel50 = kgStudents > 0 ? Math.ceil(kgStudents / 50) : 0;\r\n\r\n    // \"Genel\" retmen ihtiyacna ek olarak okul ncesi personeli eklenir.\r\n    const totalEducatorsWithOkulOncesi = summary.requiredTeachersOverall + okulOncesiPersonel50;\r\n\r\n    const studentTeacherRatio =\r\n      totalEducatorsWithOkulOncesi > 0 ? totalStudents / totalEducatorsWithOkulOncesi : null;\r\n    const teacherClassRatio = totalBranches > 0 ? totalEducatorsWithOkulOncesi / totalBranches : null;\r\n    const studentClassRatio = totalBranches > 0 ? totalStudents / totalBranches : null;\r\n\r\n    return {\r\n      totalBranches,\r\n      totalStudents,\r\n      kgBranches,\r\n      kgStudents,\r\n      okulOncesiPersonel50,\r\n      totalEducatorsWithOkulOncesi,\r\n      studentTeacherRatio,\r\n      teacherClassRatio,\r\n      studentClassRatio,\r\n    };\r\n  }, [visibleGrades, branchByGrade, studentsPerBranchByGrade, summary.requiredTeachersOverall]);\r\n\r\n  const CLASS_HOUR_COL_W = 34;\r\n  const CLASS_HOUR_INPUT_W = 26;\r\n\r\n  const tableTextInputStyle = {\r\n    width: \"100%\",\r\n    minWidth: 0,\r\n    maxWidth: \"100%\",\r\n    boxSizing: \"border-box\",\r\n    overflow: \"hidden\",\r\n    textOverflow: \"ellipsis\",\r\n    whiteSpace: \"nowrap\",\r\n  };\r\n\r\n  const addTeacherInputStyle = {\r\n    flex: \"0 1 240px\",\r\n    minWidth: 200,\r\n    maxWidth: \"100%\",\r\n    boxSizing: \"border-box\",\r\n    overflow: \"hidden\",\r\n    textOverflow: \"ellipsis\",\r\n    whiteSpace: \"nowrap\",\r\n  };\r\n\r\n  const addLessonInputStyle = {\r\n    flex: \"1 1 320px\",\r\n    minWidth: 220,\r\n    maxWidth: \"100%\",\r\n    boxSizing: \"border-box\",\r\n    overflow: \"hidden\",\r\n    textOverflow: \"ellipsis\",\r\n    whiteSpace: \"nowrap\",\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"card\">\r\n        <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\r\n          <div>\r\n            <div style={{ fontWeight: 800 }}>N.Kadro / Norm</div>\r\n            <div className=\"small\">\r\n              Planlanan (senaryo) ube bilgileri + ders dalm (haftalk). Sa tarafta brana gre toplam ders saati ve\r\n              retmen ihtiyac hesaplanr.\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"row\">\r\n            <label>\r\n              <div className=\"small\">retmen Haftalk Max Saat ({yearLabel(activeYear)})</div>\r\n              <NumberInput\r\n                className={inputClass(\"input sm\", normPath(\"teacherWeeklyMaxHours\"))}\r\n\r\n                min=\"1\"\r\n                step=\"1\"\r\n                value={teacherWeeklyMaxHours}\r\n                onChange={(value) => setMaxHours(value)}\r\n              />\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"row\" style={{ justifyContent: \"space-between\", marginTop: 10 }}>\r\n          <div className=\"tabs\">\r\n            {YEAR_KEYS.map((y) => (\r\n              <div key={y} className={\"tab \" + (activeYear === y ? \"active \" : \"\")} onClick={() => setActiveYear(y)}>\r\n                {yearLabel(y)}\r\n              </div>\r\n            ))}\r\n          </div>\r\n          {prevYearKey ? (\r\n            <button className=\"btn\" onClick={copyFromPrevYear}>\r\n              Copy from {yearLabel(prevYearKey)}\r\n            </button>\r\n          ) : null}\r\n        </div>\r\n\r\n        {missingPlanYears.length ? (\r\n          <div className=\"small\" style={{ marginTop: 6, color: \"#b91c1c\" }}>\r\n            Warning: {missingPlanYears.join(\" and \")} planlanan ogrenci bilgisi bos.\r\n          </div>\r\n        ) : null}\r\n\r\n        <hr />\r\n\r\n        <div className=\"grid2\" style={{ alignItems: \"start\" }}>\r\n          <div>\r\n            <div style={{ fontWeight: 800 }}>zet</div>\r\n            <div className=\"grid2 norm-summary-grid\" style={{ marginTop: 8 }}>\r\n              <div className=\"stat\">\r\n                <div className=\"label\">Toplam Ders Saati (Haftalk)</div>\r\n                <div className=\"value\">{summary.totalTeachingHours.toFixed(2)}</div>\r\n              </div>\r\n\r\n              <div className=\"stat\">\r\n                <div className=\"label\">Toplam Eitimci (Genel)</div>\r\n                <div className=\"value\">{summary.requiredTeachersOverall}</div>\r\n              </div>\r\n\r\n              <div className=\"stat\">\r\n                <div className=\"label\">Okul ncesi (KG) Yardmc Snf rt. (Snf Says)</div>\r\n                <div className=\"value\">{planKpis.kgBranches.toFixed(0)}</div>\r\n              </div>\r\n\r\n              <div className=\"stat\">\r\n                <div className=\"label\">Okul ncesi Personeli (50 renci / 1)</div>\r\n                <div className=\"value\">{planKpis.okulOncesiPersonel50}</div>\r\n              </div>\r\n\r\n              <div className=\"stat\">\r\n                <div className=\"label\">Toplam Eitimci (Genel + Okul ncesi)</div>\r\n                <div className=\"value\">{planKpis.totalEducatorsWithOkulOncesi}</div>\r\n              </div>\r\n\r\n              <div className=\"stat\">\r\n                <div className=\"label\">renci / retmen</div>\r\n                <div className=\"value\">\r\n                  {planKpis.studentTeacherRatio == null ? \"\" : planKpis.studentTeacherRatio.toFixed(2)}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"stat\">\r\n                <div className=\"label\">retmen / Snf</div>\r\n                <div className=\"value\">\r\n                  {planKpis.teacherClassRatio == null ? \"\" : planKpis.teacherClassRatio.toFixed(2)}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"stat\">\r\n                <div className=\"label\">renci / Snf</div>\r\n                <div className=\"value\">\r\n                  {planKpis.studentClassRatio == null ? \"\" : planKpis.studentClassRatio.toFixed(2)}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"stat\">\r\n                <div className=\"label\">Eitimci (Brana Gre Toplam)</div>\r\n                <div className=\"value\">{summary.requiredTeachersByBranch}</div>\r\n              </div>\r\n\r\n              <div className=\"stat\">\r\n                <div className=\"label\">Not</div>\r\n                <div className=\"value\" style={{ fontSize: 12, fontWeight: 600, lineHeight: 1.25 }}>\r\n                  <div>Brana gre toplam, bran dalm nedeniyle genel toplamdan byk olabilir.</div>\r\n                  <div style={{ marginTop: 4 }}>\r\n                    Okul ncesi personelinin pedagojik adan renci iletiiminin yksek olmas gerekir.\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <div style={{ fontWeight: 800 }}>Bran Bazl (Toplam Ders Saati)</div>\r\n            <div style={{ overflowX: \"auto\", marginTop: 8 }}>\r\n              <table className=\"table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Bran retmeni</th>\r\n                    <th style={{ textAlign: \"right\" }}>Toplam Ders Saati</th>\r\n                    <th style={{ textAlign: \"right\" }}>Limit</th>\r\n                    <th style={{ textAlign: \"right\" }}>FTE</th>\r\n                    <th style={{ textAlign: \"right\" }}>Eitimci</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {summary.teacherRows.length === 0 ? (\r\n                    <tr>\r\n                      <td colSpan=\"5\" className=\"small\">\r\n                        Henz ders satr yok.\r\n                      </td>\r\n                    </tr>\r\n                  ) : (\r\n                    summary.teacherRows.map((r) => (\r\n                      <tr key={r.teacher}>\r\n                        <td>{r.teacher}</td>\r\n                        <td style={{ textAlign: \"right\" }}>{r.hours.toFixed(2)}</td>\r\n                        <td style={{ textAlign: \"right\" }}>{teacherWeeklyMaxHours}</td>\r\n                        <td style={{ textAlign: \"right\" }}>{r.fte.toFixed(2)}</td>\r\n                        <td style={{ textAlign: \"right\", fontWeight: 800 }}>{r.needed}</td>\r\n                      </tr>\r\n                    ))\r\n                  )}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"row\" style={{ alignItems: \"stretch\" }}>\r\n        <div style={{ flex: \"1 1 520px\", minWidth: 0 }}>\r\n          <GradeTable\r\n            title=\"PLANLANAN DNEM BLGLER\"\r\n            subtitle=\"Her snf dzeyi iin ube says ve renci says (senaryo).\"\r\n            grades={activePlanningGrades}\r\n            onChange={setPlanningGrades}\r\n            dirtyPaths={dirtyPaths}\r\n            onDirty={onDirty}\r\n            pathPrefix={planningPath}\r\n            gradeColWidth={34}\r\n            inputWidth={30}\r\n            gradeOrder={visibleGrades}\r\n            allGrades={ALL_GRADES}\r\n            kademeConfig={kademeConfig}\r\n          />\r\n        </div>\r\n\r\n        <div style={{ flex: \"1 1 520px\", minWidth: 0 }}>\r\n          <GradeTable\r\n            title=\"MEVCUT DNEM BLGLER\"\r\n            subtitle=\"Mevcut dnem ube ve toplam renci saylar (karlatrma iin).\"\r\n            grades={currentGrades}\r\n            onChange={canEditCurrent ? onCurrentGradesChange : null}\r\n            dirtyPaths={dirtyPaths}\r\n            onDirty={onDirty}\r\n            pathPrefix=\"inputs.gradesCurrent\"\r\n            gradeOrder={visibleGrades}\r\n            allGrades={ALL_GRADES}\r\n            kademeConfig={kademeConfig}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {!canEditCurrent ? (\r\n        <div className=\"small\" style={{ marginTop: 6 }}>\r\n          Note: Mevcut donem bilgileri sadece Y1 icin duzenlenir.\r\n        </div>\r\n      ) : null}\r\n\r\n      <div className=\"card\" style={{ marginTop: 12 }}>\r\n        <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\r\n          <div>\r\n            <div style={{ fontWeight: 800 }}>Ders Dalm (Haftalk)</div>\r\n            <div className=\"small\">\r\n              Her ders satrnda: dersin snflara gre haftalk saatini gir. Toplam ders saati = (saat  ube) toplam.\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"row\" style={{ marginTop: 10 }}>\r\n          <input\r\n            className=\"input\"\r\n            style={addTeacherInputStyle}\r\n            placeholder=\"Bran retmeni (rn: ngilizce retmeni)\"\r\n            value={newTeacher}\r\n            onChange={(e) => setNewTeacher(e.target.value)}\r\n          />\r\n          <input\r\n            className=\"input\"\r\n            style={addLessonInputStyle}\r\n            placeholder=\"Ders Ad (rn: English)\"\r\n            value={newLesson}\r\n            onChange={(e) => setNewLesson(e.target.value)}\r\n          />\r\n          <button className=\"btn\" onClick={addRow}>\r\n            Ders Ekle\r\n          </button>\r\n          <div className=\"small\">Not: Dersler veritabannda \"Bran||Ders\" formatnda saklanr.</div>\r\n        </div>\r\n\r\n        <div style={{ overflowX: \"auto\", marginTop: 12 }}>\r\n          <table className=\"table\" style={{ tableLayout: \"fixed\" }}>\r\n            <thead>\r\n              <tr>\r\n                <th style={{ minWidth: 160, width: 160 }}>Bran retmeni</th>\r\n                <th style={{ minWidth: 160, width: 160 }}>Ders Ad</th>\r\n                {visibleGrades.map((g) => (\r\n                  <th\r\n                    key={g}\r\n                    style={{\r\n                      textAlign: \"right\",\r\n                      minWidth: CLASS_HOUR_COL_W,\r\n                      width: CLASS_HOUR_COL_W,\r\n                      maxWidth: CLASS_HOUR_COL_W,\r\n                      paddingLeft: 2,\r\n                      paddingRight: 2,\r\n                    }}\r\n                  >\r\n                    {g}\r\n                  </th>\r\n                ))}\r\n                <th style={{ textAlign: \"right\", minWidth: 140, width: 140 }}>Toplam Ders Saati</th>\r\n                <th style={{ minWidth: 70, width: 70 }}>Sil</th>\r\n              </tr>\r\n              <tr>\r\n                <th />\r\n                <th className=\"small\">Planlanan ube</th>\r\n                {visibleGrades.map((g) => (\r\n                  <th\r\n                    key={g}\r\n                    className=\"small\"\r\n                    style={{\r\n                      textAlign: \"right\",\r\n                      minWidth: CLASS_HOUR_COL_W,\r\n                      width: CLASS_HOUR_COL_W,\r\n                      maxWidth: CLASS_HOUR_COL_W,\r\n                      paddingLeft: 2,\r\n                      paddingRight: 2,\r\n                    }}\r\n                  >\r\n                    {safeNum(branchByGrade[g]).toFixed(0)}\r\n                  </th>\r\n                ))}\r\n                <th />\r\n                <th />\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {rows.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={2 + visibleGrades.length + 2} className=\"small\">\r\n                    Henuz ders satiri yok. Ders ekleyerek baslayabilirsin.\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                rows.map((r) => (\r\n                  <tr key={r.key}>\r\n                    <td>\r\n                      <input\r\n                        className=\"input\"\r\n                        style={tableTextInputStyle}\r\n                        value={(draftLabels[r.key]?.teacher ?? r.teacher) || \"\"}\r\n                        onChange={(e) => setDraft(r.key, { teacher: e.target.value })}\r\n                        onBlur={() => commitDraftRename(r.key)}\r\n                        onKeyDown={(e) => {\r\n                          if (e.key === \"Enter\") e.currentTarget.blur();\r\n                        }}\r\n                      />\r\n                    </td>\r\n                    <td>\r\n                      <input\r\n                        className=\"input\"\r\n                        style={tableTextInputStyle}\r\n                        value={(draftLabels[r.key]?.lesson ?? r.lesson) || \"\"}\r\n                        onChange={(e) => setDraft(r.key, { lesson: e.target.value })}\r\n                        onBlur={() => commitDraftRename(r.key)}\r\n                        onKeyDown={(e) => {\r\n                          if (e.key === \"Enter\") e.currentTarget.blur();\r\n                        }}\r\n                      />\r\n                    </td>\r\n\r\n                    {visibleGrades.map((g) => (\r\n                      <td key={g} style={{ textAlign: \"right\", paddingLeft: 2, paddingRight: 2 }}>\r\n                        <NumberInput\r\n                          className={inputClass(\"input sm\", normPath(`curriculumWeeklyHours.${g}.${r.key}`))}\r\n                          style={{\r\n                            width: CLASS_HOUR_INPUT_W,\r\n                            boxSizing: \"border-box\",\r\n                            textAlign: \"right\",\r\n                            paddingLeft: 4,\r\n                            paddingRight: 4,\r\n                          }}\r\n\r\n                          min=\"0\"\r\n                          step=\"0.25\"\r\n                          value={safeNum(curriculumWeeklyHours?.[g]?.[r.key])}\r\n                          onChange={(value) => setCell(g, r.key, value)}\r\n                        />\r\n                      </td>\r\n                    ))}\r\n\r\n                    <td style={{ textAlign: \"right\", fontWeight: 800 }}>{safeNum(rowTotals[r.key]).toFixed(2)}</td>\r\n                    <td>\r\n                      <button className=\"btn danger\" onClick={() => removeRow(r.key)}>\r\n                        x\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n\r\n              {rows.length > 0 ? (\r\n                <tr style={{ fontWeight: 900 }}>\r\n                  <td>TOPLAM</td>\r\n                  <td />\r\n                  {visibleGrades.map((g) => (\r\n                    <td key={g} style={{ textAlign: \"right\", paddingLeft: 2, paddingRight: 2 }}>\r\n                      {safeNum(gradeClassHourTotals[g]).toFixed(0)}\r\n                    </td>\r\n                  ))}\r\n                  <td style={{ textAlign: \"right\" }}>{summary.totalTeachingHours.toFixed(0)}</td>\r\n                  <td />\r\n                </tr>\r\n              ) : null}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { useOutletContext } from \"react-router-dom\";\r\nimport NormConfigEditor from \"../../components/NormConfigEditor\";\r\nimport TabProgressHeatmap from \"../../components/ui/TabProgressHeatmap\";\r\n\r\nexport default function NormPage() {\r\n  const {\r\n    norm,\r\n    setNorm,\r\n    inputs,\r\n    handlePlanningGradesChange,\r\n    setField,\r\n    programType,\r\n    dirtyPaths,\r\n    markDirty,\r\n    normAvgPct,\r\n    normMissingLines,\r\n\r\n  } = useOutletContext();\r\n\r\n  const missingPreview = Array.isArray(normMissingLines) ? normMissingLines.join(\" / \") : \"\";\r\n\r\n\r\n\r\n  return (\r\n    <div style={{ marginTop: 12 }}>\r\n\r\n      <TabProgressHeatmap\r\n        pct={normAvgPct}\r\n        title=\"Norm\"\r\n        missingLines={normMissingLines}\r\n        missingPreview={missingPreview}\r\n      >\r\n        <NormConfigEditor\r\n          value={norm || null}\r\n          onChange={(v) => {\r\n            setNorm((prev) => ({ ...(prev || {}), ...v }));\r\n          }}\r\n          lastUpdatedAt={norm?.updatedAt}\r\n          planningGrades={inputs?.gradesYears || inputs?.grades}\r\n          currentGrades={inputs?.gradesCurrent}\r\n          onPlanningGradesChange={inputs ? handlePlanningGradesChange : null}\r\n          onCurrentGradesChange={inputs ? (v) => setField(\"gradesCurrent\", v) : null}\r\n          kademeConfig={inputs?.temelBilgiler?.kademeler}\r\n          programType={programType}\r\n          dirtyPaths={dirtyPaths}\r\n          onDirty={markDirty}\r\n        />\r\n      </TabProgressHeatmap>\r\n    </div>\r\n  );\r\n}\r\n","const GRADES = [\"KG\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"];\r\n\r\nconst KADEME_DEFS = [\r\n  { key: \"okulOncesi\", label: \"Okul ncesi\", defaultFrom: \"KG\", defaultTo: \"KG\" },\r\n  { key: \"ilkokul\", label: \"lkokul\", defaultFrom: \"1\", defaultTo: \"5\" },\r\n  { key: \"ortaokul\", label: \"Ortaokul\", defaultFrom: \"6\", defaultTo: \"9\" },\r\n  { key: \"lise\", label: \"Lise\", defaultFrom: \"10\", defaultTo: \"12\" },\r\n];\r\n\r\nfunction normalizeGrade(value) {\r\n  const v = String(value || \"\").trim().toUpperCase();\r\n  if (v === \"KG\") return \"KG\";\r\n  if (!/^\\d{1,2}$/.test(v)) return null;\r\n  const n = Number(v);\r\n  if (!Number.isFinite(n) || n < 1 || n > 12) return null;\r\n  return String(n);\r\n}\r\n\r\nfunction gradeIndex(value) {\r\n  const g = normalizeGrade(value);\r\n  if (!g) return -1;\r\n  return GRADES.indexOf(g);\r\n}\r\n\r\nfunction normalizeRange(fromValue, toValue, def) {\r\n  const from = normalizeGrade(fromValue) ?? def.defaultFrom;\r\n  const to = normalizeGrade(toValue) ?? def.defaultTo;\r\n  const fromIdx = gradeIndex(from);\r\n  const toIdx = gradeIndex(to);\r\n  if (fromIdx < 0 || toIdx < 0) return { from: def.defaultFrom, to: def.defaultTo };\r\n  if (fromIdx <= toIdx) return { from, to };\r\n  return { from: to, to: from };\r\n}\r\n\r\nexport function getKademeDefinitions() {\r\n  return KADEME_DEFS.map((d) => ({ ...d }));\r\n}\r\n\r\nexport function getDefaultKademeConfig() {\r\n  const out = {};\r\n  KADEME_DEFS.forEach((d) => {\r\n    out[d.key] = { enabled: true, from: d.defaultFrom, to: d.defaultTo };\r\n  });\r\n  return out;\r\n}\r\n\r\nexport function normalizeKademeConfig(config) {\r\n  const cfg = config && typeof config === \"object\" ? config : {};\r\n  const out = {};\r\n  KADEME_DEFS.forEach((d) => {\r\n    const row = cfg[d.key] && typeof cfg[d.key] === \"object\" ? cfg[d.key] : {};\r\n    const enabled = row.enabled !== false;\r\n    const range = normalizeRange(row.from, row.to, d);\r\n    out[d.key] = { enabled, ...range };\r\n  });\r\n  return out;\r\n}\r\n\r\nexport function getKademeRangeLabel(config, key) {\r\n  const def = KADEME_DEFS.find((d) => d.key === key);\r\n  if (!def) return \"\";\r\n  const cfg = normalizeKademeConfig(config)[key];\r\n  if (!cfg?.enabled) return \"\";\r\n  return cfg.from === cfg.to ? cfg.from : `${cfg.from}-${cfg.to}`;\r\n}\r\n\r\nexport function formatKademeLabel(label, config, key) {\r\n  const range = getKademeRangeLabel(config, key);\r\n  if (!range) return label;\r\n  return `${label} (${range})`;\r\n}\r\n\r\nexport function getKademeForGrade(grade, config) {\r\n  const idx = gradeIndex(grade);\r\n  if (idx < 0) return null;\r\n  const cfg = normalizeKademeConfig(config);\r\n  for (const def of KADEME_DEFS) {\r\n    const row = cfg[def.key];\r\n    if (!row?.enabled) continue;\r\n    const fromIdx = gradeIndex(row.from);\r\n    const toIdx = gradeIndex(row.to);\r\n    if (fromIdx <= idx && idx <= toIdx) return def.key;\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function summarizeGradesByKademe(grades, config) {\r\n  const rows = Array.isArray(grades) ? grades : [];\r\n  const out = { okulOncesi: 0, ilkokul: 0, ortaokul: 0, lise: 0, total: 0 };\r\n\r\n  for (const r of rows) {\r\n    // studentsPerBranch now represents TOTAL students for the grade (not per-branch).\r\n    const students = Number(r?.studentsPerBranch || 0);\r\n    if (!Number.isFinite(students)) continue;\r\n    out.total += students;\r\n    const key = getKademeForGrade(r?.grade, config);\r\n    if (key && Object.prototype.hasOwnProperty.call(out, key)) out[key] += students;\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\nexport function getGradeOptions() {\r\n  return GRADES.map((g) => g);\r\n}\r\n","import React from \"react\";\r\nimport { FaInfoCircle } from \"react-icons/fa\";\r\n\r\nfunction clampPct(value) {\r\n  const n = Number(value);\r\n  if (!Number.isFinite(n)) return 0;\r\n  return Math.max(0, Math.min(100, n));\r\n}\r\n\r\nfunction buildTitle({ pct, title, missingPreview, missingLines }) {\r\n  const lines = Array.isArray(missingLines)\r\n    ? missingLines.map((line) => String(line)).filter(Boolean).slice(0, 15)\r\n    : [];\r\n  if (lines.length) return lines.join(\"\\n\");\r\n  if (missingPreview) return String(missingPreview);\r\n  if (title) return `${title}: ${pct}%`;\r\n  return `${pct}%`;\r\n}\r\n\r\nexport default function TabProgressHeatmap({\r\n  pct = 0,\r\n  title = \"\",\r\n  missingPreview = \"\",\r\n  missingLines = [],\r\n  children,\r\n}) {\r\n  const clamped = clampPct(pct);\r\n  const mask = `linear-gradient(90deg, #000 0%, #000 ${clamped}%, transparent ${clamped}%, transparent 100%)`;\r\n  const tooltipText = buildTitle({\r\n    pct: Math.round(clamped),\r\n    title,\r\n    missingPreview,\r\n    missingLines,\r\n  });\r\n  const showInfo = clamped < 100;\r\n\r\n  return (\r\n    <div style={{ position: \"relative\", overflow: \"hidden\", borderRadius: 12 }}>\r\n      <div\r\n        aria-hidden=\"true\"\r\n        style={{\r\n          position: \"absolute\",\r\n          inset: 0,\r\n          pointerEvents: \"none\",\r\n          zIndex: 0,\r\n          backgroundImage:\r\n            \"linear-gradient(90deg, rgba(16,185,129, 0.05) 0%, rgba(16,185,129, 0.10) 30%, rgba(16,185,129, 0.16) 70%, rgba(16,185,129, 0.10) 100%), radial-gradient(circle at 20% 45%, rgba(16,185,129, 0.14) 0%, rgba(16,185,129, 0.00) 65%)\",\r\n          WebkitMaskImage: mask,\r\n          maskImage: mask,\r\n        }}\r\n      />\r\n\r\n      {showInfo ? (\r\n        <button\r\n          type=\"button\"\r\n          title={tooltipText}\r\n          aria-label=\"Progress details\"\r\n          style={{\r\n            position: \"absolute\",\r\n            top: 12,\r\n            right: 12,\r\n            zIndex: 20,\r\n            width: 26,\r\n            height: 26,\r\n            borderRadius: 999,\r\n            border: \"1px solid rgba(15, 23, 42, 0.15)\",\r\n            background: \"rgba(255, 255, 255, 0.9)\",\r\n            color: \"#0f172a\",\r\n            display: \"inline-flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            cursor: \"help\",\r\n            boxShadow: \"0 6px 16px rgba(15, 23, 42, 0.08)\",\r\n          }}\r\n        >\r\n          <FaInfoCircle size={12} />\r\n        </button>\r\n      ) : null}\r\n\r\n      <div style={{ position: \"relative\", zIndex: 1 }}>{children}</div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["separatorsCache","Map","parseFlexibleNumber","input","raw","String","trim","value","empty","cleaned","replace","hasDot","includes","hasComma","decimalSep","thousandSep","lastIndexOf","sep","match","RegExp","concat","length","idx","digitsAfter","normalized","split","join","Number","isFinite","NumberInput","_ref","onChange","onBlur","onFocus","className","step","disabled","placeholder","title","name","id","inputMode","rest","_objectWithoutProperties","_excluded","decimals","useMemo","s","dot","indexOf","Math","max","countStepDecimals","locale","decimal","_parts$find","_parts$find2","has","get","parts","Intl","NumberFormat","formatToParts","next","group","find","p","type","set","getSeparators","formatter","useGrouping","maximumFractionDigits","rawFormatter","editing","setEditing","useState","draft","setDraft","numericValue","hasValue","useEffect","format","_jsx","_objectSpread","event","target","parsed","rounded","autoComplete","KEY_SEP","ALL_GRADES","getGradeOptions","GRADE_INDEX","map","g","i","YEAR_KEYS","DEFAULT_MAX_HOURS","KADEME_DEFS","getKademeDefinitions","KADEME_LABELS","Object","freeze","reduce","m","d","key","label","EMPTY_ARRAY","safeNum","v","n","buildEmptyCurriculum","out","forEach","encodeKey","teacher","lesson","t","l","decodeKey","k","normalizeGrades","grades","gradeOrder","data","Array","isArray","row","x","grade","branchCount","studentsPerBranch","totalStudentsFromGrades","r","GradeTable","_ref2","subtitle","dirtyPaths","onDirty","pathPrefix","gradeColWidth","inputWidth","allGrades","kademeConfig","visibleOrder","fullOrder","fullData","inputClass","base","path","isDirty","makePath","field","totals","acc","gradeStudents","totalBranches","totalStudents","setField","nextValue","dividerStyle","borderLeft","totalColStyle","background","rowLabelStyle","fontWeight","whiteSpace","GRADE_COL_W","compactInputStyle","width","boxSizing","textAlign","paddingLeft","paddingRight","segments","order","curKey","curGrades","push","formatKademeLabel","getKademeForGrade","buildKademeSegments","segmentTotals","byGrade","seg","_jsxs","style","marginTop","children","justifyContent","toFixed","overflowX","tableLayout","rowSpan","minWidth","maxWidth","colSpan","paddingTop","paddingBottom","lineHeight","min","NormConfigEditor","_ref3","_yearData$teacherWeek","lastUpdatedAt","planningGrades","currentGrades","onPlanningGradesChange","onCurrentGradesChange","norm","_v$teacherWeeklyMaxHo","yearsSrc","years","outYears","y","_src$teacherWeeklyMax","src","hoursRaw","teacherWeeklyMaxHours","hours","curr","curriculumWeeklyHours","baseHoursRaw","baseHours","baseCurr","structuredClone","normalizeNormValue","activeYear","setActiveYear","yearData","_norm$years","visibleGrades","cfg","normalizeKademeConfig","included","Set","values","enabled","fromIdx","from","toIdx","to","isInteger","start","end","add","list","filter","resolveVisibleGrades","planningByYear","y1","y2","y3","normalizePlanningGrades","activePlanningGrades","canEditCurrent","plannedTotalsByYear","missingPlanYears","y2Missing","y3Missing","normPath","suffix","planningPath","curriculumKeys","obj","keys","rows","sort","a","b","ta","toLowerCase","tb","localeCompare","plan","branchByGrade","studentsPerBranchByGrade","newTeacher","setNewTeacher","newLesson","setNewLesson","draftLabels","setDraftLabels","yearLabel","activeYearIndex","prevYearKey","patch","prev","_rows$find","_rows$find2","commitDraftRename","orig","newKey","oldKey","nextTeacher","nextLesson","nextCurr","prevVal","undefined","nextNorm","renameRow","rowTotals","sum","_curriculumWeeklyHour","h","bc","gradeClassHourTotals","_curriculumWeeklyHour2","summary","totalTeachingHours","requiredTeachersOverall","ceil","byTeacher","teacherRows","entries","_ref5","fte","needed","requiredTeachersByBranch","planKpis","kgBranches","kgStudents","okulOncesiPersonel50","totalEducatorsWithOkulOncesi","studentTeacherRatio","teacherClassRatio","studentClassRatio","CLASS_HOUR_COL_W","tableTextInputStyle","overflow","textOverflow","val","num","setMaxHours","onClick","_norm$years2","_prevData$teacherWeek","_norm$years3","_norm$years3$activeYe","_nextNorm$years","_nextNorm$years$activ","prevData","prevCurr","oldCurr","newCurr","oldRow","newRow","_ref4","prevPlan","nextPlanning","color","alignItems","fontSize","flex","nextGrades","e","ensureKeyEveryGrade","_draftLabels$r$key$te","_draftLabels$r$key","_draftLabels$r$key$le","_draftLabels$r$key2","onKeyDown","currentTarget","blur","_curriculumWeeklyHour3","setCell","removeRow","NormPage","_inputs$temelBilgiler","setNorm","inputs","handlePlanningGradesChange","programType","markDirty","normAvgPct","normMissingLines","useOutletContext","missingPreview","TabProgressHeatmap","pct","missingLines","updatedAt","gradesYears","gradesCurrent","temelBilgiler","kademeler","GRADES","defaultFrom","defaultTo","normalizeGrade","toUpperCase","test","gradeIndex","getDefaultKademeConfig","config","range","fromValue","toValue","def","_normalizeGrade","_normalizeGrade2","normalizeRange","getKademeRangeLabel","summarizeGradesByKademe","okulOncesi","ilkokul","ortaokul","lise","total","students","prototype","hasOwnProperty","call","clamped","clampPct","mask","tooltipText","lines","line","Boolean","slice","buildTitle","round","showInfo","position","borderRadius","inset","pointerEvents","zIndex","backgroundImage","WebkitMaskImage","maskImage","top","right","height","border","display","cursor","boxShadow","FaInfoCircle","size"],"ignoreList":[],"sourceRoot":""}