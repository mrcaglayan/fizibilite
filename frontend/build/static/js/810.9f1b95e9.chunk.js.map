{"version":3,"file":"static/js/810.9f1b95e9.chunk.js","mappings":"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","sources":["components/ui/Tooltip.jsx","utils/kademe.js","components/ui/ProgressBar.jsx","components/ExpenseSplitModal.jsx","components/CountrySendModal.jsx","pages/SelectPage.jsx","utils/scenarioProfile.js","utils/programType.js"],"sourcesContent":["import React from \"react\";\r\n\r\nfunction normalizeLines(lines, text) {\r\n  if (Array.isArray(lines)) {\r\n    return lines.map((line) => String(line)).filter((line) => line.trim().length > 0);\r\n  }\r\n  if (typeof text === \"string\") {\r\n    return text\r\n      .split(\"\\n\")\r\n      .map((line) => line.trim())\r\n      .filter(Boolean);\r\n  }\r\n  return [];\r\n}\r\n\r\nexport default function Tooltip({ text, lines, children, className = \"\" }) {\r\n  const resolved = normalizeLines(lines, text);\r\n  if (!resolved.length) return children;\r\n\r\n  return (\r\n    <span className={`tooltip-wrap ${className}`.trim()}>\r\n      {children}\r\n      <span className=\"tooltip-bubble\" role=\"tooltip\">\r\n        {resolved.map((line, idx) => (\r\n          <div key={`${idx}-${line}`} className=\"tooltip-line\">\r\n            {line}\r\n          </div>\r\n        ))}\r\n      </span>\r\n    </span>\r\n  );\r\n}\r\n","const GRADES = [\"KG\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"];\r\n\r\nconst KADEME_DEFS = [\r\n  { key: \"okulOncesi\", label: \"Okul ncesi\", defaultFrom: \"KG\", defaultTo: \"KG\" },\r\n  { key: \"ilkokul\", label: \"lkokul\", defaultFrom: \"1\", defaultTo: \"5\" },\r\n  { key: \"ortaokul\", label: \"Ortaokul\", defaultFrom: \"6\", defaultTo: \"9\" },\r\n  { key: \"lise\", label: \"Lise\", defaultFrom: \"10\", defaultTo: \"12\" },\r\n];\r\n\r\nfunction normalizeGrade(value) {\r\n  const v = String(value || \"\").trim().toUpperCase();\r\n  if (v === \"KG\") return \"KG\";\r\n  if (!/^\\d{1,2}$/.test(v)) return null;\r\n  const n = Number(v);\r\n  if (!Number.isFinite(n) || n < 1 || n > 12) return null;\r\n  return String(n);\r\n}\r\n\r\nfunction gradeIndex(value) {\r\n  const g = normalizeGrade(value);\r\n  if (!g) return -1;\r\n  return GRADES.indexOf(g);\r\n}\r\n\r\nfunction normalizeRange(fromValue, toValue, def) {\r\n  const from = normalizeGrade(fromValue) ?? def.defaultFrom;\r\n  const to = normalizeGrade(toValue) ?? def.defaultTo;\r\n  const fromIdx = gradeIndex(from);\r\n  const toIdx = gradeIndex(to);\r\n  if (fromIdx < 0 || toIdx < 0) return { from: def.defaultFrom, to: def.defaultTo };\r\n  if (fromIdx <= toIdx) return { from, to };\r\n  return { from: to, to: from };\r\n}\r\n\r\nexport function getKademeDefinitions() {\r\n  return KADEME_DEFS.map((d) => ({ ...d }));\r\n}\r\n\r\nexport function getDefaultKademeConfig() {\r\n  const out = {};\r\n  KADEME_DEFS.forEach((d) => {\r\n    out[d.key] = { enabled: true, from: d.defaultFrom, to: d.defaultTo };\r\n  });\r\n  return out;\r\n}\r\n\r\nexport function normalizeKademeConfig(config) {\r\n  const cfg = config && typeof config === \"object\" ? config : {};\r\n  const out = {};\r\n  KADEME_DEFS.forEach((d) => {\r\n    const row = cfg[d.key] && typeof cfg[d.key] === \"object\" ? cfg[d.key] : {};\r\n    const enabled = row.enabled !== false;\r\n    const range = normalizeRange(row.from, row.to, d);\r\n    out[d.key] = { enabled, ...range };\r\n  });\r\n  return out;\r\n}\r\n\r\nexport function getKademeRangeLabel(config, key) {\r\n  const def = KADEME_DEFS.find((d) => d.key === key);\r\n  if (!def) return \"\";\r\n  const cfg = normalizeKademeConfig(config)[key];\r\n  if (!cfg?.enabled) return \"\";\r\n  return cfg.from === cfg.to ? cfg.from : `${cfg.from}-${cfg.to}`;\r\n}\r\n\r\nexport function formatKademeLabel(label, config, key) {\r\n  const range = getKademeRangeLabel(config, key);\r\n  if (!range) return label;\r\n  return `${label} (${range})`;\r\n}\r\n\r\nexport function getKademeForGrade(grade, config) {\r\n  const idx = gradeIndex(grade);\r\n  if (idx < 0) return null;\r\n  const cfg = normalizeKademeConfig(config);\r\n  for (const def of KADEME_DEFS) {\r\n    const row = cfg[def.key];\r\n    if (!row?.enabled) continue;\r\n    const fromIdx = gradeIndex(row.from);\r\n    const toIdx = gradeIndex(row.to);\r\n    if (fromIdx <= idx && idx <= toIdx) return def.key;\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function summarizeGradesByKademe(grades, config) {\r\n  const rows = Array.isArray(grades) ? grades : [];\r\n  const out = { okulOncesi: 0, ilkokul: 0, ortaokul: 0, lise: 0, total: 0 };\r\n\r\n  for (const r of rows) {\r\n    // studentsPerBranch now represents TOTAL students for the grade (not per-branch).\r\n    const students = Number(r?.studentsPerBranch || 0);\r\n    if (!Number.isFinite(students)) continue;\r\n    out.total += students;\r\n    const key = getKademeForGrade(r?.grade, config);\r\n    if (key && Object.prototype.hasOwnProperty.call(out, key)) out[key] += students;\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\nexport function getGradeOptions() {\r\n  return GRADES.map((g) => g);\r\n}\r\n","import React from \"react\";\r\nimport Tooltip from \"./Tooltip\";\r\n\r\nfunction normalizeLines(lines) {\r\n  if (!lines) return [];\r\n  if (Array.isArray(lines)) return lines.map((line) => String(line));\r\n  if (typeof lines === \"string\") return lines.split(\"\\n\");\r\n  return [];\r\n}\r\n\r\nexport default function ProgressBar({ value = 0, label = \"\", tooltipLines }) {\r\n  const numeric = Number(value);\r\n  const pct = Number.isFinite(numeric) ? Math.max(0, Math.min(100, numeric)) : 0;\r\n  const lines = normalizeLines(tooltipLines).filter((line) => String(line).trim().length > 0);\r\n\r\n  const track = (\r\n    <div className=\"progress-track\">\r\n      <div className=\"progress-bar\" role=\"progressbar\" aria-valuenow={pct} aria-valuemin={0} aria-valuemax={100}>\r\n        <div className=\"progress-bar-fill\" style={{ width: `${pct}%` }} />\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"progress-row\">\r\n      {label ? <div className=\"progress-label\">{label}</div> : null}\r\n      {lines.length ? (\r\n        <Tooltip lines={lines} className=\"progress-tooltip\">\r\n          {track}\r\n        </Tooltip>\r\n      ) : (\r\n        track\r\n      )}\r\n      <div className=\"progress-value\">{Math.round(pct)}%</div>\r\n    </div>\r\n  );\r\n}\r\n","// frontend/src/components/ExpenseSplitModal.jsx\r\n\r\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { FaChevronDown, FaChevronRight } from \"react-icons/fa\";\r\nimport { toast } from \"react-toastify\";\r\nimport { api } from \"../api\";\r\n\r\nconst OPERATING_ITEMS = [\r\n  { key: \"ulkeTemsilciligi\", label: \"lke Temsilciligi Giderleri\" },\r\n  { key: \"genelYonetim\", label: \"Genel Ynetim Giderleri\" },\r\n  { key: \"kira\", label: \"Isletme Giderleri (Kira)\" },\r\n  { key: \"emsalKira\", label: \"Isletme Giderleri (Emsal Kira)\" },\r\n  { key: \"enerjiKantin\", label: \"Isletme Giderleri (Elektrik, Su, vb.)\" },\r\n  { key: \"turkPersonelMaas\", label: \"Yurt disi TRK Personel Maas Giderleri\" },\r\n  { key: \"turkDestekPersonelMaas\", label: \"Yurt disi TRK DESTEK Personel Maas Giderleri\" },\r\n  { key: \"yerelPersonelMaas\", label: \"Yurt disi YEREL Personel Maas Giderleri\" },\r\n  { key: \"yerelDestekPersonelMaas\", label: \"Yurt disi YEREL DESTEK Personel Maas Giderleri\" },\r\n  { key: \"internationalPersonelMaas\", label: \"Yurt disi INTERNATIONAL Personel Maas Giderleri\" },\r\n  { key: \"disaridanHizmet\", label: \"Disaridan Saglanan Mal ve Hizmet Alimlari\" },\r\n  { key: \"egitimAracGerec\", label: \"Egitim Ara ve Gereleri\" },\r\n  { key: \"finansalGiderler\", label: \"Finansal Giderler\" },\r\n  { key: \"egitimAmacliHizmet\", label: \"Egitim Amali Hizmet Alimlari\" },\r\n  { key: \"temsilAgirlama\", label: \"Temsil ve Agirlama\" },\r\n  { key: \"ulkeIciUlasim\", label: \"lke Ii Ulasim ve Konaklama\" },\r\n  { key: \"ulkeDisiUlasim\", label: \"lke Disi Ulasim ve Konaklama\" },\r\n  { key: \"vergilerResmiIslemler\", label: \"Vergiler Resmi Islemler\" },\r\n  { key: \"vergiler\", label: \"Vergiler\" },\r\n  { key: \"demirbasYatirim\", label: \"Demirbas ve Yatirimlar\" },\r\n  { key: \"rutinBakim\", label: \"Rutin Bakim ve Onarim\" },\r\n  { key: \"pazarlamaOrganizasyon\", label: \"Pazarlama Organizasyon\" },\r\n  { key: \"reklamTanitim\", label: \"Reklam ve Tanitim\" },\r\n  { key: \"tahsilEdilemeyenGelirler\", label: \"Tahsil Edilemeyen Gelirler\" },\r\n];\r\n\r\nconst SERVICE_ITEMS = [\r\n  { key: \"yemek\", label: \"Yemek\" },\r\n  { key: \"uniforma\", label: \"niforma\" },\r\n  { key: \"kitapKirtasiye\", label: \"Kitap-Krtasiye\" },\r\n  { key: \"ulasimServis\", label: \"Servis / Ulam\" },\r\n];\r\n\r\nconst DORM_ITEMS = [\r\n  { key: \"yurtGiderleri\", label: \"Yurt Giderleri (Kampus giderleri iinde gsterilmeyecek)\" },\r\n  { key: \"digerYurt\", label: \"Dier (Yaz okulu giderleri vb.)\" },\r\n];\r\n\r\nconst DISCOUNT_ITEMS = [\r\n  { key: \"discountsTotal\", label: \"Burs ve ndirimler (Toplam)\" },\r\n];\r\n\r\nconst EXPENSE_ITEMS = [...OPERATING_ITEMS, ...SERVICE_ITEMS, ...DORM_ITEMS, ...DISCOUNT_ITEMS];\r\nconst EXPENSE_KEYS = EXPENSE_ITEMS.map((it) => it.key);\r\nconst EXPENSE_ITEM_MAP = new Map(EXPENSE_ITEMS.map((it) => [it.key, it]));\r\nconst EXPENSE_LABELS = new Map(EXPENSE_ITEMS.map((it) => [it.key, it.label]));\r\n\r\nconst EXPENSE_SECTIONS = [\r\n  {\r\n    id: \"isletme\",\r\n    label: \"letme Giderleri\",\r\n    groups: [\r\n      {\r\n        label: \"letme Giderleri\",\r\n        keys: [\r\n          \"ulkeTemsilciligi\",\r\n          \"genelYonetim\",\r\n          \"temsilAgirlama\",\r\n          \"ulkeIciUlasim\",\r\n          \"ulkeDisiUlasim\",\r\n          \"vergilerResmiIslemler\",\r\n          \"vergiler\",\r\n          \"demirbasYatirim\",\r\n          \"rutinBakim\",\r\n          \"pazarlamaOrganizasyon\",\r\n          \"reklamTanitim\",\r\n          \"tahsilEdilemeyenGelirler\",\r\n        ],\r\n      },\r\n      {\r\n        label: \"Eitim Maliyetleri\",\r\n        keys: [\r\n          \"kira\",\r\n          \"emsalKira\",\r\n          \"enerjiKantin\",\r\n          \"turkPersonelMaas\",\r\n          \"turkDestekPersonelMaas\",\r\n          \"yerelPersonelMaas\",\r\n          \"yerelDestekPersonelMaas\",\r\n          \"internationalPersonelMaas\",\r\n          \"disaridanHizmet\",\r\n          \"egitimAracGerec\",\r\n          \"finansalGiderler\",\r\n          \"egitimAmacliHizmet\",\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"ogrenimDisi\",\r\n    label: \"renim D Hizmetler\",\r\n    keys: [\"yemek\", \"uniforma\", \"kitapKirtasiye\", \"ulasimServis\"],\r\n  },\r\n  {\r\n    id: \"yurtKonaklama\",\r\n    label: \"Yurt / Konaklama\",\r\n    keys: [\"yurtGiderleri\", \"digerYurt\"],\r\n  },\r\n  {\r\n    id: \"bursIndirim\",\r\n    label: \"Burs ve ndirimler\",\r\n    keys: [\"discountsTotal\"],\r\n  },\r\n].map((section) => {\r\n  if (Array.isArray(section.groups)) {\r\n    const groups = section.groups.filter((group) => group.keys.length);\r\n    const keys = groups.flatMap((group) => group.keys);\r\n    return { ...section, groups, keys };\r\n  }\r\n  return {\r\n    ...section,\r\n    keys: section.keys,\r\n  };\r\n}).filter((section) => section.keys.length);\r\n\r\nconst fmtNum = (v, fractionDigits = 2) =>\r\n  Number.isFinite(Number(v))\r\n    ? Number(v).toLocaleString(undefined, { maximumFractionDigits: fractionDigits })\r\n    : \"-\";\r\n\r\nconst fmtPct = (v) =>\n  Number.isFinite(Number(v)) ? `${(Number(v) * 100).toFixed(2)}%` : \"-\";\n\nfunction parseAcademicYearParts(value) {\n  const raw = String(value || \"\").trim();\n  const range = raw.match(/^(\\d{4})\\s*-\\s*(\\d{4})$/);\n  if (range) {\n    const startYear = Number(range[1]);\n    const endYear = Number(range[2]);\n    if (Number.isFinite(startYear) && Number.isFinite(endYear)) {\n      return { startYear: String(startYear), endYear: String(endYear) };\n    }\n  }\n  const single = raw.match(/^(\\d{4})$/);\n  if (single) {\n    const year = Number(single[1]);\n    if (Number.isFinite(year)) return { startYear: String(year), endYear: String(year) };\n  }\n  return { startYear: null, endYear: null };\n}\n\nfunction resolveTargetYear(academicYear, yearBasis) {\n  if (!academicYear) return null;\n  if (yearBasis === \"start\" || yearBasis === \"end\") {\n    const { startYear, endYear } = parseAcademicYearParts(academicYear);\n    return yearBasis === \"start\" ? startYear : endYear;\n  }\n  return academicYear;\n}\n\nexport default function ExpenseSplitModal({\n  open,\n  onClose,\n  onApplied,\n  sourceScenario,\r\n  sourceSchoolId,\r\n  sourceSchoolName,\r\n}) {\r\n  const [targets, setTargets] = useState([]);\r\n  const [loadingTargets, setLoadingTargets] = useState(false);\r\n  const [targetSearch, setTargetSearch] = useState(\"\");\r\n  const [selectedTargets, setSelectedTargets] = useState(new Set());\n  const [basis, setBasis] = useState(\"students\");\n  const [basisYearKey, setBasisYearKey] = useState(\"y1\");\n  const [yearBasis, setYearBasis] = useState(\"academic\");\n  const [selectedExpenseKeys, setSelectedExpenseKeys] = useState(new Set());\n  const [preview, setPreview] = useState(null);\n  const [previewLoading, setPreviewLoading] = useState(false);\r\n  const [applyLoading, setApplyLoading] = useState(false);\r\n  const [revertLoading, setRevertLoading] = useState(false);\r\n  const [showPools, setShowPools] = useState(false);\r\n  const [expandedTargets, setExpandedTargets] = useState(new Set());\r\n  const [showTargets, setShowTargets] = useState(true);\r\n  const [showExpenses, setShowExpenses] = useState(true);\r\n  const [prefillScope, setPrefillScope] = useState(null);\r\n  const prefillAppliedRef = useRef(false);\r\n  const compactControlStyle = {\r\n    fontSize: 12,\r\n    height: 30,\r\n    padding: \"4px 8px\",\r\n    lineHeight: \"20px\",\r\n    boxSizing: \"border-box\",\r\n  };\r\n\r\n  const selectedTargetsKey = useMemo(\r\n    () => Array.from(selectedTargets).sort().join(\",\"),\r\n    [selectedTargets]\r\n  );\r\n  const selectedExpenseKeyStr = useMemo(\r\n    () => Array.from(selectedExpenseKeys).sort().join(\",\"),\r\n    [selectedExpenseKeys]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!open) return;\r\n    setTargetSearch(\"\");\n    setSelectedTargets(new Set());\n    setSelectedExpenseKeys(new Set());\n    setBasis(\"students\");\n    setBasisYearKey(\"y1\");\n    setYearBasis(\"academic\");\n    setPreview(null);\n    setRevertLoading(false);\n    setPrefillScope(null);\n    prefillAppliedRef.current = false;\r\n  }, [open, sourceScenario?.id]);\r\n\r\n  useEffect(() => {\r\n    setPreview(null);\n    setShowPools(false);\n    setExpandedTargets(new Set());\n    setShowTargets(true);\n    setShowExpenses(true);\n  }, [basis, basisYearKey, yearBasis, selectedTargetsKey, selectedExpenseKeyStr]);\n\n  useEffect(() => {\n    let active = true;\n    async function loadTargets() {\n      if (!open || !sourceScenario?.academic_year) return;\n      const targetYear = resolveTargetYear(sourceScenario.academic_year, yearBasis);\n      if (!targetYear) return;\n      setLoadingTargets(true);\n      try {\n        const data = await api.expenseSplitTargets(targetYear, yearBasis);\n        if (!active) return;\n        const list = Array.isArray(data) ? data : [];\n        const filtered = list.filter(\n          (row) => String(row.scenarioId) !== String(sourceScenario?.id)\r\n        );\r\n        setTargets(filtered);\r\n      } catch (e) {\r\n        if (active) {\r\n          toast.error(e.message || \"Hedef senaryolar alinamadi\");\r\n        }\r\n      } finally {\r\n        if (active) setLoadingTargets(false);\r\n      }\r\n    }\r\n    loadTargets();\n    return () => {\n      active = false;\n    };\n  }, [open, sourceScenario?.academic_year, sourceScenario?.id, yearBasis]);\n\r\n  useEffect(() => {\r\n    let active = true;\r\n    async function loadPrefill() {\r\n      if (!open || !sourceScenario?.id || !sourceSchoolId) return;\r\n      try {\r\n        const data = await api.getExpenseSplitLastScope(sourceSchoolId, sourceScenario.id);\r\n        if (!active) return;\r\n        setPrefillScope(data?.scope || null);\r\n      } catch (_) {\r\n        if (active) setPrefillScope(null);\r\n      }\r\n    }\r\n    loadPrefill();\r\n    return () => {\r\n      active = false;\r\n    };\r\n  }, [open, sourceScenario?.id, sourceSchoolId]);\r\n\r\n  useEffect(() => {\r\n    if (!open || prefillAppliedRef.current) return;\r\n    if (loadingTargets) return;\r\n    if (!prefillScope || typeof prefillScope !== \"object\") return;\r\n\r\n    const nextBasis = String(prefillScope.basis || \"\").toLowerCase();\r\n    const nextYear = String(prefillScope.basisYearKey || \"\").toLowerCase();\r\n    if (nextBasis === \"students\" || nextBasis === \"revenue\") {\r\n      setBasis(nextBasis);\r\n    }\r\n    if ([\"y1\", \"y2\", \"y3\"].includes(nextYear)) {\r\n      setBasisYearKey(nextYear);\r\n    }\r\n\r\n    const allowedExpenseKeys = new Set(EXPENSE_KEYS);\r\n    const expenseKeys = Array.isArray(prefillScope.expenseKeys)\r\n      ? prefillScope.expenseKeys.filter((key) => allowedExpenseKeys.has(key))\r\n      : [];\r\n    setSelectedExpenseKeys(new Set(expenseKeys));\r\n\r\n    const targetIdSet = new Set(targets.map((row) => String(row.scenarioId)));\r\n    const targetScenarioIds = Array.isArray(prefillScope.targetScenarioIds)\r\n      ? prefillScope.targetScenarioIds.map((id) => String(id))\r\n      : [];\r\n    const filteredTargets = targetScenarioIds.filter((id) => targetIdSet.has(id));\r\n    setSelectedTargets(new Set(filteredTargets));\r\n\r\n    prefillAppliedRef.current = true;\r\n  }, [open, loadingTargets, prefillScope, targets]);\r\n\r\n  const filteredTargets = useMemo(() => {\n    const term = targetSearch.trim().toLowerCase();\n    if (!term) return targets;\n    return targets.filter((row) => {\n      const schoolName = String(row?.schoolName || \"\").toLowerCase();\n      const scenarioName = String(row?.scenarioName || \"\").toLowerCase();\n      return schoolName.includes(term) || scenarioName.includes(term);\n    });\n  }, [targets, targetSearch]);\n\n  useEffect(() => {\n    if (!targets.length) {\n      setSelectedTargets((prev) => (prev.size ? new Set() : prev));\n      return;\n    }\n    const idSet = new Set(targets.map((row) => String(row.scenarioId)));\n    setSelectedTargets((prev) => {\n      if (!prev || prev.size === 0) return prev;\n      const next = new Set(Array.from(prev).filter((id) => idSet.has(String(id))));\n      return next.size === prev.size ? prev : next;\n    });\n  }, [targets]);\n\r\n  const toggleTarget = (id) => {\r\n    setSelectedTargets((prev) => {\r\n      const next = new Set(prev);\r\n      const key = String(id);\r\n      if (next.has(key)) next.delete(key);\r\n      else next.add(key);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const toggleExpenseKey = (key) => {\r\n    setSelectedExpenseKeys((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(key)) next.delete(key);\r\n      else next.add(key);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const setExpenseKeys = (keys, checked) => {\r\n    if (!Array.isArray(keys) || !keys.length) return;\r\n    setSelectedExpenseKeys((prev) => {\r\n      const next = new Set(prev);\r\n      keys.forEach((key) => {\r\n        if (checked) next.add(key);\r\n        else next.delete(key);\r\n      });\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const handlePreview = async () => {\r\n    if (!sourceScenario?.id || !sourceSchoolId) return;\r\n    const payload = {\r\n      targetScenarioIds: Array.from(selectedTargets).map((id) => Number(id)),\r\n      basis,\r\n      basisYearKey,\r\n      expenseKeys: Array.from(selectedExpenseKeys),\r\n    };\r\n    setShowTargets(false);\r\n    setShowExpenses(false);\r\n    setPreviewLoading(true);\r\n    try {\r\n      const data = await api.previewExpenseSplit(sourceSchoolId, sourceScenario.id, payload);\r\n      setPreview(data || null);\r\n    } catch (e) {\r\n      toast.error(e.message || \"nizleme alinamadi\");\r\n    } finally {\r\n      setPreviewLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleApply = async () => {\r\n    if (!sourceScenario?.id || !sourceSchoolId) return;\r\n    const payload = {\r\n      targetScenarioIds: Array.from(selectedTargets).map((id) => Number(id)),\r\n      basis,\r\n      basisYearKey,\r\n      expenseKeys: Array.from(selectedExpenseKeys),\r\n    };\r\n    setApplyLoading(true);\r\n    try {\r\n      await api.applyExpenseSplit(sourceSchoolId, sourceScenario.id, payload);\r\n      toast.success(\"Gider dagitimi kaydedildi.\");\r\n      onApplied?.({\r\n        sourceScenarioId: sourceScenario.id,\r\n        targetScenarioIds: payload.targetScenarioIds,\r\n      });\r\n      onClose?.();\r\n    } catch (e) {\r\n      toast.error(e.message || \"Dagitim uygulanamadi\");\r\n    } finally {\r\n      setApplyLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRevert = async () => {\r\n    if (!sourceScenario?.id || !sourceSchoolId) return;\r\n    if (!selectedTargets.size || revertLoading || applyLoading) return;\r\n    const ok = window.confirm(\"Secili hedefler icin gider dagitimi geri alinsin mi?\");\r\n    if (!ok) return;\r\n    setRevertLoading(true);\r\n    try {\r\n      const targetScenarioIds = Array.from(selectedTargets).map((id) => Number(id));\r\n      const data = await api.revertExpenseSplit(sourceSchoolId, sourceScenario.id, { targetScenarioIds });\r\n      const removed = Array.isArray(data?.removedTargetScenarioIds) ? data.removedTargetScenarioIds : [];\r\n      if (removed.length) {\r\n        setSelectedTargets((prev) => {\r\n          const next = new Set(prev);\r\n          removed.forEach((id) => next.delete(String(id)));\r\n          return next;\r\n        });\r\n      }\r\n      if (data?.deletedSet) {\r\n        setPrefillScope(null);\r\n        setSelectedExpenseKeys(new Set());\r\n      }\r\n      toast.success(\"Gider dagitimi geri alindi.\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Geri alma basarisiz\");\r\n    } finally {\r\n      setRevertLoading(false);\r\n    }\r\n  };\r\n\r\n  const previewTargets = useMemo(\r\n    () => (Array.isArray(preview?.targets) ? preview.targets : []),\r\n    [preview]\r\n  );\r\n  const previewPools = useMemo(\r\n    () => (Array.isArray(preview?.pools) ? preview.pools : []),\r\n    [preview]\r\n  );\r\n  const previewAllocations = useMemo(\r\n    () => (Array.isArray(preview?.allocations) ? preview.allocations : []),\r\n    [preview]\r\n  );\r\n  const previewWarnings = useMemo(\r\n    () => (Array.isArray(preview?.warnings) ? preview.warnings : []),\r\n    [preview]\r\n  );\r\n\r\n  const sourceLabel =\r\n    sourceSchoolName ||\r\n    sourceScenario?.schoolName ||\r\n    sourceScenario?.school?.name ||\r\n    \"\";\r\n\r\n  const allocationsByTarget = useMemo(() => {\r\n    const map = new Map();\r\n    previewAllocations.forEach((row) => {\r\n      const key = String(row.targetScenarioId);\r\n      const list = map.get(key) || [];\r\n      list.push({\r\n        expenseLabel: EXPENSE_LABELS.get(row.expenseKey) || row.expenseKey,\r\n        amount: row.allocatedAmount,\r\n      });\r\n      map.set(key, list);\r\n    });\r\n    return map;\r\n  }, [previewAllocations]);\r\n\r\n  const totalExpenseCount = EXPENSE_KEYS.length;\r\n  const selectedExpenseCount = selectedExpenseKeys.size;\r\n  const allExpensesSelected = totalExpenseCount > 0 && selectedExpenseCount === totalExpenseCount;\r\n  const someExpensesSelected = selectedExpenseCount > 0 && !allExpensesSelected;\r\n\r\n  const previewDisabled =\r\n    !selectedTargets.size || !selectedExpenseKeys.size || previewLoading || applyLoading || revertLoading;\r\n\r\n  const isletmeSection = EXPENSE_SECTIONS.find((s) => s.id === \"isletme\") || null;\r\n  const otherSections = EXPENSE_SECTIONS.filter((s) => s.id !== \"isletme\");\r\n\r\n  const renderSectionCard = (section) => {\r\n    if (!section) return null;\r\n    const total = section.keys.length;\r\n    const selected = section.keys.reduce(\r\n      (sum, key) => sum + (selectedExpenseKeys.has(key) ? 1 : 0),\r\n      0\r\n    );\r\n    const allSelected = total > 0 && selected === total;\r\n    const someSelected = selected > 0 && !allSelected;\r\n\r\n    return (\r\n      <div\r\n        key={section.id}\r\n        className=\"card\"\r\n        style={{ padding: \"10px 12px\", background: \"#f8fafc\" }}\r\n      >\r\n        <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n          <label className=\"row small\" style={{ gap: 6, alignItems: \"center\", fontWeight: 700 }}>\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={allSelected}\r\n              ref={(el) => {\r\n                if (el) el.indeterminate = someSelected;\r\n              }}\r\n              onChange={(e) => setExpenseKeys(section.keys, e.target.checked)}\r\n            />\r\n            <span>{section.label}</span>\r\n          </label>\r\n          <div className=\"row\" style={{ gap: 6 }}>\r\n            <button\r\n              className=\"btn\"\r\n              type=\"button\"\r\n              style={{ padding: \"4px 10px\" }}\r\n              onClick={() => setExpenseKeys(section.keys, true)}\r\n              disabled={!total}\r\n            >\r\n              Sec\r\n            </button>\r\n            <button\r\n              className=\"btn\"\r\n              type=\"button\"\r\n              style={{ padding: \"4px 10px\" }}\r\n              onClick={() => setExpenseKeys(section.keys, false)}\r\n              disabled={!selected}\r\n            >\r\n              Temizle\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div className=\"small muted\" style={{ marginTop: 4 }}>\r\n          Secili: {selected}/{total}\r\n        </div>\r\n        {Array.isArray(section.groups) ? (\r\n          <div style={{ marginTop: 8 }}>\r\n            {section.groups.map((group) => (\r\n              <div key={group.label} style={{ marginTop: 8 }}>\r\n                <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>\r\n                  {group.label}\r\n                </div>\r\n                <div className=\"grid2\" style={{ gap: 8 }}>\r\n                  {group.keys.map((key) => {\r\n                    const item = EXPENSE_ITEM_MAP.get(key);\r\n                    const label = item?.label || key;\r\n                    return (\r\n                      <label key={key} className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedExpenseKeys.has(key)}\r\n                          onChange={() => toggleExpenseKey(key)}\r\n                        />\r\n                        <span className=\"small\">{label}</span>\r\n                      </label>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid2\" style={{ gap: 8, marginTop: 8 }}>\r\n            {section.keys.map((key) => {\r\n              const item = EXPENSE_ITEM_MAP.get(key);\r\n              const label = item?.label || key;\r\n              return (\r\n                <label key={key} className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedExpenseKeys.has(key)}\r\n                    onChange={() => toggleExpenseKey(key)}\r\n                  />\r\n                  <span className=\"small\">{label}</span>\r\n                </label>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const toggleTargetAllocations = (scenarioId) => {\r\n    setExpandedTargets((prev) => {\r\n      const next = new Set(prev);\r\n      const key = String(scenarioId);\r\n      if (next.has(key)) next.delete(key);\r\n      else next.add(key);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  if (!open) return null;\r\n\r\n  return (\r\n    <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\" onClick={onClose}>\r\n      <div\r\n        className=\"modal\"\r\n        style={{ width: \"min(980px, 96vw)\", maxHeight: \"86vh\", overflowY: \"auto\", position: \"relative\" }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n          <button\r\n            className=\"btn\"\r\n            onClick={onClose}\r\n            disabled={applyLoading || previewLoading || revertLoading}\r\n            style={{\r\n              position: \"absolute\",\r\n              top: 10,\r\n              right: 10,\r\n              background: \"#111827\",\r\n              borderColor: \"#111827\",\r\n              color: \"#fff\",\r\n            }}\r\n          >\r\n            Kapat\r\n          </button>\r\n        </div>\r\n\r\n        {!sourceScenario ? (\r\n          <div className=\"small\" style={{ marginTop: 10 }}>\r\n            Kaynak senaryo seilmedi.\r\n          </div>\r\n        ) : (\r\n          <>\r\n            <div style={{ marginTop: 2 }}>\r\n              <div className=\"row\" style={{ gap: 12, alignItems: \"flex-end\", flexWrap: \"wrap\" }}>\r\n                <div style={{ minWidth: 170 }}>\r\n                  <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Basis</div>\r\n                  <select className=\"input sm\" style={compactControlStyle} value={basis} onChange={(e) => setBasis(e.target.value)}>\r\n                    <option value=\"students\">Students</option>\r\n                    <option value=\"revenue\">Revenue</option>\r\n                  </select>\r\n                </div>\r\n                  <div style={{ minWidth: 160 }}>\n                    <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Basis Yil</div>\n                    <select className=\"input sm\" style={compactControlStyle} value={basisYearKey} onChange={(e) => setBasisYearKey(e.target.value)}>\n                      <option value=\"y1\">Y1</option>\n                      <option value=\"y2\">Y2</option>\n                      <option value=\"y3\">Y3</option>\n                    </select>\n                  </div>\n                  <div style={{ minWidth: 210 }}>\n                    <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Yil ortasi donemleri</div>\n                    <select\n                      className=\"input sm\"\n                      style={compactControlStyle}\n                      value={yearBasis}\n                      onChange={(e) => setYearBasis(e.target.value)}\n                    >\n                      <option value=\"academic\">Ayrik (2024-2025)</option>\n                      <option value=\"start\">Baslangic yilina dahil</option>\n                      <option value=\"end\">Bitis yilina dahil</option>\n                    </select>\n                  </div>\n                  <div style={{ flex: \"1 1 220px\" }}>\n                    <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Hedef Ara</div>\n                    <input\n                      className=\"input sm\"\n                    style={compactControlStyle}\r\n                    placeholder=\"Okul veya senaryo ara\"\r\n                    value={targetSearch}\r\n                    onChange={(e) => setTargetSearch(e.target.value)}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ marginTop: 5 }}>\r\n              <div\r\n                className=\"row\"\r\n                style={{ justifyContent: \"space-between\", alignItems: \"center\", cursor: \"pointer\" }}\r\n                onClick={() => setShowTargets((prev) => !prev)}\r\n              >\r\n                <div className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                  {showTargets ? <FaChevronDown aria-hidden=\"true\" /> : <FaChevronRight aria-hidden=\"true\" />}\r\n                  <div className=\"small\" style={{ fontWeight: 700 }}>Hedef Senaryolar</div>\r\n                </div>\r\n              </div>\r\n              {showTargets ? (\r\n                loadingTargets ? (\r\n                  <div className=\"small\">Yukleniyor...</div>\r\n                ) : (\r\n                  <div className=\"table-scroll\" style={{ maxHeight: 260 }}>\r\n                    <table className=\"table\" style={{ fontSize: 12 }}>\r\n                      <thead>\r\n                        <tr>\r\n                          <th style={{ width: 40 }}></th>\r\n                          <th style={{ fontSize: 12, padding: \"6px 8px\" }}>Okul</th>\r\n                          <th style={{ fontSize: 12, padding: \"6px 8px\" }}>Senaryo</th>\r\n                          <th style={{ fontSize: 12, padding: \"6px 8px\" }}>Yil</th>\r\n                          <th style={{ fontSize: 12, padding: \"6px 8px\" }}>Para Birimi</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        {filteredTargets.length === 0 ? (\r\n                          <tr>\r\n                            <td colSpan=\"5\" className=\"small\" style={{ padding: \"6px 8px\" }}>Hedef bulunamadi.</td>\r\n                          </tr>\r\n                        ) : (\r\n                          filteredTargets.map((row) => {\r\n                            const id = String(row.scenarioId);\r\n                            const checked = selectedTargets.has(id);\r\n                            const currencyLabel =\r\n                              String(row.input_currency || \"USD\") === \"LOCAL\"\r\n                                ? `${row.input_currency}/${row.local_currency_code || \"LOCAL\"}`\r\n                                : row.input_currency || \"USD\";\r\n                            return (\r\n                              <tr\r\n                                key={row.scenarioId}\r\n                                onClick={() => toggleTarget(id)}\r\n                                style={{\r\n                                  cursor: \"pointer\",\r\n                                  ...(checked ? { background: \"#eef2ff\" } : {}),\r\n                                }}\r\n                              >\r\n                                <td style={{ padding: \"6px 8px\" }}>\r\n                                  <input\r\n                                    type=\"checkbox\"\r\n                                    checked={checked}\r\n                                    onClick={(e) => e.stopPropagation()}\r\n                                    onChange={() => toggleTarget(id)}\r\n                                  />\r\n                                </td>\r\n                                <td style={{ padding: \"6px 8px\" }}>{row.schoolName}</td>\r\n                                <td style={{ padding: \"6px 8px\" }}>{row.scenarioName}</td>\r\n                                <td style={{ padding: \"6px 8px\" }}>{row.academic_year}</td>\r\n                                <td style={{ padding: \"6px 8px\" }}>{currencyLabel}</td>\r\n                              </tr>\r\n                            );\r\n                          })\r\n                        )}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                )\r\n              ) : null}\r\n            </div>\r\n\r\n            <div style={{ marginTop: 16 }}>\r\n              <div\r\n                className=\"row\"\r\n                style={{ justifyContent: \"space-between\", alignItems: \"center\", cursor: \"pointer\" }}\r\n                onClick={() => setShowExpenses((prev) => !prev)}\r\n              >\r\n                <div className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                  {showExpenses ? <FaChevronDown aria-hidden=\"true\" /> : <FaChevronRight aria-hidden=\"true\" />}\r\n                  <div className=\"small\" style={{ fontWeight: 700 }}>Gider Kalemleri</div>\r\n                </div>\r\n                <div className=\"row\" style={{ gap: 6 }}>\r\n                  <button\r\n                    className=\"btn\"\r\n                    type=\"button\"\r\n                    style={{ padding: \"4px 10px\" }}\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      setExpenseKeys(EXPENSE_KEYS, true);\r\n                    }}\r\n                    disabled={!totalExpenseCount}\r\n                  >\r\n                    Tumunu Sec\r\n                  </button>\r\n                  <button\r\n                    className=\"btn\"\r\n                    type=\"button\"\r\n                    style={{ padding: \"4px 10px\" }}\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      setExpenseKeys(EXPENSE_KEYS, false);\r\n                    }}\r\n                    disabled={!selectedExpenseCount}\r\n                  >\r\n                    Temizle\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              {showExpenses ? (\r\n                <>\r\n                  <div className=\"row\" style={{ gap: 10, alignItems: \"center\", marginTop: 8 }}>\r\n                    <label className=\"row small\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={allExpensesSelected}\r\n                        ref={(el) => {\r\n                          if (el) el.indeterminate = someExpensesSelected;\r\n                        }}\r\n                        onChange={(e) => setExpenseKeys(EXPENSE_KEYS, e.target.checked)}\r\n                      />\r\n                      <span>Toplam Secili: {selectedExpenseCount}/{totalExpenseCount}</span>\r\n                    </label>\r\n                  </div>\r\n\r\n                  <div className=\"row\" style={{ alignItems: \"flex-start\", gap: 12, marginTop: 10 }}>\r\n                    <div style={{ flex: \"1 1 0\", minWidth: 320 }}>\r\n                      {renderSectionCard(isletmeSection)}\r\n                    </div>\r\n                    <div style={{ flex: \"1 1 0\", minWidth: 320, display: \"grid\", gap: 12 }}>\r\n                      {otherSections.map((section) => renderSectionCard(section))}\r\n                    </div>\r\n                  </div>\r\n                </>\r\n              ) : null}\r\n            </div>\r\n\r\n            <div className=\"row\" style={{ justifyContent: \"flex-end\", marginTop: 16, gap: 8 }}>\r\n              <button className=\"btn\" onClick={handlePreview} disabled={previewDisabled}>\r\n                {previewLoading ? \"nizleme...\" : \"nizle\"}\r\n              </button>\r\n              <button\r\n                className=\"btn primary\"\r\n                onClick={handleApply}\r\n                disabled={\r\n                  applyLoading ||\r\n                  revertLoading ||\r\n                  previewLoading ||\r\n                  !selectedTargets.size ||\r\n                  !selectedExpenseKeys.size\r\n                }\r\n              >\r\n                {applyLoading ? \"Uygulaniyor...\" : \"Uygula\"}\r\n              </button>\r\n              {prefillScope ? (\r\n                <button\r\n                  className=\"btn danger\"\r\n                  onClick={handleRevert}\r\n                  disabled={!selectedTargets.size || applyLoading || revertLoading}\r\n                >\r\n                  {revertLoading ? \"Geri Aliniyor...\" : \"Gider Dagitimini Geri Al\"}\r\n                </button>\r\n              ) : null}\r\n            </div>\r\n\r\n            {previewWarnings.length > 0 ? (\r\n              <div className=\"card\" style={{ marginTop: 12, background: \"#fff7ed\", borderColor: \"#fed7aa\" }}>\r\n                <div style={{ fontWeight: 700, marginBottom: 6 }}>Uyarilar</div>\r\n                {previewWarnings.map((w, idx) => (\r\n                  <div key={idx} className=\"small\"> {w}</div>\r\n                ))}\r\n              </div>\r\n            ) : null}\r\n\r\n            {preview ? (\r\n              <div style={{ marginTop: 16 }}>\r\n                {previewPools.length > 0 ? (\r\n                  <>\r\n                    <div\r\n                      className=\"row\"\r\n                      style={{\r\n                        justifyContent: \"space-between\",\r\n                        alignItems: \"center\",\r\n                        marginBottom: 6,\r\n                        cursor: \"pointer\",\r\n                      }}\r\n                      onClick={() => setShowPools((prev) => !prev)}\r\n                    >\r\n                      <div className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                        {showPools ? <FaChevronDown aria-hidden=\"true\" /> : <FaChevronRight aria-hidden=\"true\" />}\r\n                        <div className=\"small\" style={{ fontWeight: 700 }}>\r\n                          Havuz Tutarlari{sourceLabel ? ` (${sourceLabel})` : \"\"}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    {showPools ? (\r\n                      <div className=\"table-scroll\">\r\n                        <table className=\"table\">\r\n                          <thead>\r\n                            <tr>\r\n                              <th>Gider</th>\r\n                              <th>Havuz Tutari</th>\r\n                            </tr>\r\n                          </thead>\r\n                          <tbody>\r\n                            {previewPools.map((p) => (\r\n                              <tr key={p.expenseKey}>\r\n                                <td>{EXPENSE_LABELS.get(p.expenseKey) || p.expenseKey}</td>\r\n                                <td>{fmtNum(p.poolAmount)}</td>\r\n                              </tr>\r\n                            ))}\r\n                          </tbody>\r\n                        </table>\r\n                      </div>\r\n                    ) : null}\r\n                  </>\r\n                ) : null}\r\n\r\n                {previewTargets.length > 0 ? (\r\n                  <>\r\n                    <div className=\"small\" style={{ fontWeight: 700, margin: \"12px 0 6px\" }}>\r\n                      Agirliklar (satira tiklayin)\r\n                    </div>\r\n                    <div className=\"table-scroll\">\r\n                      <table className=\"table\">\r\n                        <thead>\r\n                          <tr>\r\n                            <th style={{ width: 28 }} />\r\n                            <th>Okul</th>\r\n                            <th>Senaryo</th>\r\n                            <th>Basis</th>\r\n                            <th>Agirlik</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          {previewTargets.map((t) => {\r\n                            const targetKey = String(t.targetScenarioId);\r\n                            const isExpanded = expandedTargets.has(targetKey);\r\n                            const allocRows = allocationsByTarget.get(targetKey) || [];\r\n                            return (\r\n                              <React.Fragment key={t.targetScenarioId}>\r\n                                <tr\r\n                                  onClick={() => toggleTargetAllocations(t.targetScenarioId)}\r\n                                  style={{ cursor: \"pointer\" }}\r\n                                >\r\n                                  <td style={{ textAlign: \"center\" }}>\r\n                                    {isExpanded ? (\r\n                                      <FaChevronDown aria-hidden=\"true\" />\r\n                                    ) : (\r\n                                      <FaChevronRight aria-hidden=\"true\" />\r\n                                    )}\r\n                                  </td>\r\n                                  <td>{t.schoolName}</td>\r\n                                  <td>{t.scenarioName}</td>\r\n                                  <td>{fmtNum(t.basisValue)}</td>\r\n                                  <td>{fmtPct(t.weight)}</td>\r\n                                </tr>\r\n                                {isExpanded ? (\r\n                                  <tr>\r\n                                    <td colSpan={5}>\r\n                                      {allocRows.length ? (\r\n                                        <table className=\"table\" style={{ margin: 0 }}>\r\n                                          <thead>\r\n                                            <tr>\r\n                                              <th>Gider</th>\r\n                                              <th>Tutar</th>\r\n                                            </tr>\r\n                                          </thead>\r\n                                          <tbody>\r\n                                            {allocRows.map((row, idx) => (\r\n                                              <tr key={`${targetKey}-${row.expenseLabel}-${idx}`}>\r\n                                                <td>{row.expenseLabel}</td>\r\n                                                <td>{fmtNum(row.amount)}</td>\r\n                                              </tr>\r\n                                            ))}\r\n                                          </tbody>\r\n                                        </table>\r\n                                      ) : (\r\n                                        <div className=\"small is-muted\">Dagitim bulunamadi.</div>\r\n                                      )}\r\n                                    </td>\r\n                                  </tr>\r\n                                ) : null}\r\n                              </React.Fragment>\r\n                            );\r\n                          })}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </>\r\n                ) : null}\r\n              </div>\r\n            ) : null}\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { toast } from \"react-toastify\";\nimport { api } from \"../api\";\n\nexport default function CountrySendModal({ open, onClose, countryId }) {\n  const [loading, setLoading] = useState(false);\n  const [preview, setPreview] = useState(null);\n  const [err, setErr] = useState(\"\");\n  const [years, setYears] = useState([]);\n  const [yearsLoading, setYearsLoading] = useState(false);\n  const [search, setSearch] = useState(\"\");\n  const [hideIneligible, setHideIneligible] = useState(false);\n  const [hideSent, setHideSent] = useState(false);\n  const [applyLoading, setApplyLoading] = useState(false);\n  const [applyResult, setApplyResult] = useState(null);\n  const [academicYear, setAcademicYear] = useState(\"\");\n  const [yearBasis, setYearBasis] = useState(\"academic\");\n\n  const loadPreview = useCallback(async () => {\n    if (!open || !countryId || !academicYear.trim()) return;\n    setErr(\"\");\n    setLoading(true);\n    try {\n      const data = await api.countryApprovalBatchPreview(countryId, academicYear.trim(), yearBasis);\n      setPreview(data || { rows: [] });\n    } catch (e) {\n      setErr(e.message || \"Onizleme alinamadi\");\n    } finally {\n      setLoading(false);\n    }\n    setApplyResult(null);\n  }, [open, countryId, academicYear, yearBasis]);\n\n  const loadYears = useCallback(async () => {\n    if (!open || !countryId) return;\n    setYearsLoading(true);\n    setErr(\"\");\n    try {\n      const data = await api.countryApprovalBatchYears(countryId, yearBasis);\n      const list = Array.isArray(data?.years) ? data.years : Array.isArray(data) ? data : [];\n      setYears(list);\n      setAcademicYear((prev) => {\n        if (prev && list.includes(prev)) return prev;\n        return list[0] || \"\";\n      });\n    } catch (e) {\n      setErr(e.message || \"Yillar alinamadi\");\n      setYears([]);\n    } finally {\n      setYearsLoading(false);\n    }\n  }, [open, countryId, yearBasis]);\n\n  useEffect(() => {\n    if (!open) return;\n    setPreview(null);\n    setErr(\"\");\n    setApplyResult(null);\n    setYears([]);\n    loadYears();\n  }, [open, loadYears]);\n\n  useEffect(() => {\n    if (!open) return;\n    if (!academicYear) return;\n    if (yearsLoading) return;\n    if (years.length && !years.includes(academicYear)) return;\n    loadPreview();\n  }, [open, academicYear, loadPreview, yearsLoading, years]);\n\n  const rows = useMemo(\n    () => (Array.isArray(preview?.rows) ? preview.rows : []),\n    [preview?.rows]\n  );\n  const guardDisabled = !!preview?.bulkDisabledDueToStaleSource;\n  const staleSources = Array.isArray(preview?.staleSources) ? preview.staleSources : [];\n\n  const searchTerm = search.trim().toLowerCase();\n  const filteredRows = useMemo(() => {\n    return rows.filter((row) => {\n      if (hideIneligible && !row.eligible) return false;\n      if (hideSent && row.sentAt) return false;\n      if (!searchTerm) return true;\n      const schoolName = String(row.schoolName || \"\").toLowerCase();\n      const scenarioName = String(row.scenarioName || \"\").toLowerCase();\n      return schoolName.includes(searchTerm) || scenarioName.includes(searchTerm);\n    });\n  }, [rows, hideIneligible, hideSent, searchTerm]);\n\n  const handleApply = async () => {\n    if (applyLoading || !preview?.canSubmit || !academicYear.trim()) return;\n    setErr(\"\");\n    setApplyLoading(true);\n    try {\n      const data = await api.countryApprovalBatchSend(countryId, academicYear.trim(), yearBasis);\n      setApplyResult(data || null);\n      toast.success(\"Ulke onay paketi gonderildi\");\n      await loadPreview();\n    } catch (e) {\n      setErr(e.message || \"Gonderim basarisiz\");\n    } finally {\n      setApplyLoading(false);\n    }\n  };\n\n  const statusLabel = (status) => {\n    if (status === \"approved\") return \"Kontrol edildi\";\n    if (status === \"sent_for_approval\") return \"Merkeze iletildi\";\n    return status || \"-\";\n  };\n\n  const splitLabel = (splitStatus) => {\n    if (splitStatus === \"ok\") return \"OK\";\n    if (splitStatus === \"stale\") return \"Stale\";\n    return \"none\";\n  };\n\n  if (!open) return null;\n\n  return (\n    <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\" onClick={onClose}>\n      <div\n        className=\"modal\"\n        style={{ width: \"min(1100px, 96vw)\", maxHeight: \"86vh\", overflowY: \"auto\" }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\n          <div style={{ fontWeight: 700 }}>Ulke Onay Paketi Gonder</div>\n          <button className=\"btn\" onClick={onClose} disabled={applyLoading}>\n            Kapat\n          </button>\n        </div>\n\n        <div className=\"row\" style={{ gap: 10, alignItems: \"center\", marginTop: 12, flexWrap: \"wrap\" }}>\n          <select\n            className=\"input sm\"\n            style={{ minWidth: 200 }}\n            value={academicYear}\n            onChange={(e) => setAcademicYear(e.target.value)}\n            disabled={yearsLoading || !years.length}\n          >\n            {!years.length ? (\n              <option value=\"\">Akademik yil yok</option>\n            ) : (\n              years.map((year) => (\n                <option key={year} value={year}>\n                  {year}\n                </option>\n              ))\n            )}\n          </select>\n          <label className=\"row small\" style={{ gap: 6, alignItems: \"center\" }}>\n            <span>Yil ortasi donemleri:</span>\n            <select\n              className=\"input sm\"\n              value={yearBasis}\n              onChange={(e) => setYearBasis(e.target.value)}\n              disabled={yearsLoading}\n            >\n              <option value=\"academic\">Ayrik (2024-2025)</option>\n              <option value=\"start\">Baslangic yilina dahil</option>\n              <option value=\"end\">Bitis yilina dahil</option>\n            </select>\n          </label>\n          <button className=\"btn\" type=\"button\" onClick={loadPreview} disabled={loading || !academicYear.trim()}>\n            Onizleme\n          </button>\n          <input\n            className=\"input sm\"\n            style={{ minWidth: 220 }}\n            placeholder=\"Ara: okul veya senaryo\"\n            value={search}\n            onChange={(e) => setSearch(e.target.value)}\n          />\n          <label className=\"row small\" style={{ gap: 6, alignItems: \"center\" }}>\n            <input\n              type=\"checkbox\"\n              checked={hideIneligible}\n              onChange={(e) => setHideIneligible(e.target.checked)}\n            />\n            <span>Uygun olmayanlari gizle</span>\n          </label>\n          <label className=\"row small\" style={{ gap: 6, alignItems: \"center\" }}>\n            <input\n              type=\"checkbox\"\n              checked={hideSent}\n              onChange={(e) => setHideSent(e.target.checked)}\n            />\n            <span>Gonderilenleri gizle</span>\n          </label>\n        </div>\n\n        {guardDisabled ? (\n          <div className=\"card\" style={{ marginTop: 10, background: \"#fff1f2\", borderColor: \"#fecaca\" }}>\n            <div style={{ fontWeight: 700 }}>\n              Gider paylastirma guncel degil. Kaynak senaryolar guncellenmeden gonderim yapilamaz.\n            </div>\n            {staleSources.length ? (\n              <div className=\"small\" style={{ marginTop: 6 }}>\n                {staleSources.map((row) => (\n                  <div key={`${row.schoolId}-${row.scenarioId}`}>\n                    {row.schoolName} - {row.scenarioName} ({row.yearText})\n                  </div>\n                ))}\n              </div>\n            ) : null}\n          </div>\n        ) : null}\n\n        {err ? (\n          <div className=\"card\" style={{ marginTop: 10, background: \"#fff1f2\", borderColor: \"#fecaca\" }}>\n            {err}\n          </div>\n        ) : null}\n\n        {!preview ? (\n          <div className=\"card\" style={{ marginTop: 10 }}>\n            Once akademik yil girip onizleme alin.\n          </div>\n        ) : (\n          <div className=\"table-scroll\" style={{ marginTop: 10 }}>\n            <table className=\"table\" style={{ fontSize: 12 }}>\n              <thead>\n                <tr>\n                  <th>Okul</th>\n                  <th>Senaryo</th>\n                  <th>Yil</th>\n                  <th>Durum</th>\n                  <th>Ilerleme</th>\n                  <th>Split</th>\n                  <th>Uygun</th>\n                  <th>Nedenler</th>\n                </tr>\n              </thead>\n              <tbody>\n                {loading ? (\n                  <tr>\n                    <td colSpan=\"8\" className=\"small\">Yukleniyor...</td>\n                  </tr>\n                ) : filteredRows.length === 0 ? (\n                  <tr>\n                    <td colSpan=\"8\" className=\"small\">Gosterilecek satir yok.</td>\n                  </tr>\n                ) : (\n                  filteredRows.map((row) => {\n                    const reasons = Array.isArray(row.reasons) && row.reasons.length\n                      ? row.reasons.join(\", \")\n                      : \"-\";\n                    const hasProgress = row.progress !== null && row.progress !== undefined && Number.isFinite(Number(row.progress));\n                    const progressText = hasProgress ? `${Math.round(Number(row.progress))}%` : \"-\";\n                    return (\n                      <tr key={`${row.schoolId}-${row.scenarioId || \"none\"}`}>\n                        <td>{row.schoolName}</td>\n                        <td>{row.scenarioName || \"-\"}</td>\n                        <td>{row.academicYear || \"-\"}</td>\n                        <td>{statusLabel(row.status)}</td>\n                        <td>{progressText}</td>\n                        <td>{splitLabel(row.splitStatus)}</td>\n                        <td>{row.eligible ? \"Evet\" : \"Hayir\"}</td>\n                        <td className=\"small\">{reasons}</td>\n                      </tr>\n                    );\n                  })\n                )}\n              </tbody>\n            </table>\n          </div>\n        )}\n\n        {applyResult ? (\n          <div className=\"card\" style={{ marginTop: 12, background: \"#ecfeff\", borderColor: \"#cffafe\" }}>\n            <div style={{ fontWeight: 700 }}>Sonuc</div>\n            <div className=\"small\">\n              Gonderilen senaryo sayisi: {applyResult.scenarioCount ?? 0} (Batch #{applyResult.batchId})\n            </div>\n          </div>\n        ) : null}\n\n        <div className=\"row\" style={{ justifyContent: \"flex-end\", marginTop: 12, gap: 8 }}>\n          <button\n            className=\"btn primary\"\n            onClick={handleApply}\n            disabled={!preview?.canSubmit || guardDisabled || applyLoading}\n          >\n            {applyLoading ? \"Gonderiliyor...\" : \"Merkeze Ilet\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useNavigate, useOutletContext, useSearchParams } from \"react-router-dom\";\nimport { ToastContainer, toast } from \"react-toastify\";\n// Import additional icons for better visual cues on the action buttons.\n// FaCheckCircle represents approval actions and FaTrash represents deletion actions.\nimport {\n  FaBalanceScale,\n  FaCheckCircle,\n  FaCopy,\n  FaEdit,\n  FaPlus,\n  FaSort,\n  FaSortDown,\n  FaSortUp,\n  FaTrash,\n} from \"react-icons/fa\";\nimport { api } from \"../api\";\nimport { useAuth } from \"../auth/AuthContext\";\nimport ProgressBar from \"../components/ui/ProgressBar\";\nimport ExpenseSplitModal from \"../components/ExpenseSplitModal\";\nimport CountrySendModal from \"../components/CountrySendModal\";\nimport {\n  getDefaultKademeConfig,\n  getKademeDefinitions,\n  getGradeOptions,\n  normalizeKademeConfig,\n} from \"../utils/kademe\";\nimport { PROGRAM_TYPES, normalizeProgramType } from \"../utils/programType\";\nimport {\n  readSelectedScenarioId,\n  writeSelectedScenarioId,\n  readGlobalLastRouteSegment,\n  writeLastActiveSchoolId,\n  writeScenarioFlags,\n} from \"../utils/schoolNavStorage\";\nimport { isHeadquarterScenario } from \"../utils/scenarioProfile\";\nimport { can } from \"../utils/permissions\";\n\nconst COPY_SELECT_TABS = [\n  {\n    key: \"temel\",\n    label: \"Temel Bilgiler\",\n    sections: [\n      { id: \"temel.core\", label: \"Kademeler + Program\" },\n      { id: \"temel.pricing\", label: \"Enflasyon + Ucret Artis Oranlari + Ucret Hesaplama Ayari\" },\n      { id: \"temel.schoolInfo\", label: \"Yetkililer + Okul/Egitim Bilgileri\" },\n      { id: \"temel.discountsMeta\", label: \"IK Mevcut + Burs/Indirim Ogrenci Sayilari\" },\n      { id: \"temel.competitors\", label: \"Rakip Analizi\" },\n      { id: \"temel.performance\", label: \"Performans + Degerlendirme\" },\n    ],\n  },\n  {\n    key: \"kapasite\",\n    label: \"Kapasite\",\n    sections: [{ id: \"kapasite.all\", label: \"Kapasite (tumu)\" }],\n  },\n  {\n    key: \"norm\",\n    label: \"Norm\",\n    sections: [\n      { id: \"norm.planned\", label: \"Planlanan donem bilgileri\" },\n      { id: \"norm.current\", label: \"Mevcut donem bilgileri\" },\n      { id: \"norm.lessonY1\", label: \"Ders dagilimi (yalnizca Y1)\" },\n    ],\n  },\n  {\n    key: \"hr\",\n    label: \"IK (HR)\",\n    sections: [{ id: \"hr.ik\", label: \"IK Plan (tumu)\" }],\n  },\n  {\n    key: \"gelirler\",\n    label: \"Gelirler\",\n    sections: [{ id: \"income.gelirler\", label: \"Gelirler (tumu)\" }],\n  },\n  {\n    key: \"giderler\",\n    label: \"Giderler\",\n    sections: [\n      { id: \"expenses.giderler\", label: \"Giderler (tumu)\" },\n      { id: \"expenses.discounts\", label: \"BURS VE INDIRIMLER / YIL\" },\n    ],\n  },\n];\n\n// Mapping from copy selection section IDs to permission resources.  When a\n// scenario is copied, we must specify which permission resources are\n// modified so the backend can authorize writes.  Each entry maps a\n// selection key to an array of resource strings.  Pagelevel resources\n// (e.g. 'page.temel_bilgiler') grant write access to the entire module,\n// while sectionlevel resources (e.g. 'section.temel_bilgiler.inflation')\n// grant write access only to that portion.  Adjust this mapping if new\n// copy sections are introduced.\nconst COPY_SECTION_RESOURCES = {\n  // Temel Bilgiler: core data (kademeler & program type) require pagelevel permission\n  'temel.core': ['page.temel_bilgiler'],\n  // Temel Bilgiler: pricing (inflation, fee increases, fee calculation)\n  'temel.pricing': ['section.temel_bilgiler.inflation'],\n  // Temel Bilgiler: school info and administrators\n  'temel.schoolInfo': ['page.temel_bilgiler'],\n  // Temel Bilgiler: IK mevcut + burs/indirim counts\n  'temel.discountsMeta': ['section.temel_bilgiler.ik_mevcut', 'section.temel_bilgiler.burs_ogr'],\n  // Temel Bilgiler: competitors\n  'temel.competitors': ['section.temel_bilgiler.rakip'],\n  // Temel Bilgiler: performance and evaluation\n  'temel.performance': ['section.temel_bilgiler.performans'],\n  // Kapasite: all capacity values\n  'kapasite.all': ['section.kapasite.caps'],\n  // Norm: planned semesters (y2,y3) rely on the norm page\n  'norm.planned': ['page.norm'],\n  // Norm: current semester values (gradesCurrent) rely on the norm page\n  'norm.current': ['page.norm'],\n  // Norm: lesson distribution (Y1) maps to the ders_dagilimi section\n  'norm.lessonY1': ['section.norm.ders_dagilimi'],\n  // HR (IK): all HR data.  Use pagelevel resource since there is only one section defined.\n  'hr.ik': ['section.ik.local_staff'],\n  // Gelirler: income.  Use pagelevel resource (covers all income categories)\n  // For the Gelirler module, use the unit_fee section instead of the page\n  // resource.  This allows users who only have sectionlevel write access\n  // (e.g. unit_fee) to copy incomes without requiring page.gelirler\n  // permission.  See SchoolPage.pathToResources for section mapping logic.\n  'income.gelirler': ['section.gelirler.unit_fee'],\n  // Giderler: expenses.  The isletme section covers operating expenses\n  'expenses.giderler': ['section.giderler.isletme'],\n  // Discounts: burs/indirim values (yearlevel discounts)\n  'expenses.discounts': ['section.discounts.discounts'],\n};\n\n/**\n * Build a list of modified permission resources based on the user's copy\n * selection.  For each selected section key whose value is truthy in\n * `selection`, this function looks up the corresponding resource(s) in\n * COPY_SECTION_RESOURCES and collects them into a unique list.  Unknown\n * section keys are ignored.\n *\n * @param {Object} selection Mapping of section keys to boolean (selected)\n * @returns {string[]} List of unique permission resource keys\n */\nfunction buildModifiedResourcesFromCopySelection(selection) {\n  const out = new Set();\n  if (!selection || typeof selection !== 'object') return [];\n  Object.entries(selection).forEach(([key, value]) => {\n    if (!value) return;\n    const resources = COPY_SECTION_RESOURCES[key];\n    if (Array.isArray(resources)) {\n      resources.forEach((r) => out.add(r));\n    }\n  });\n  return Array.from(out);\n}\n\nfunction isScenarioLocked(scenario) {\n  const status = String(scenario?.status || \"draft\");\n  const submittedAt = scenario?.submitted_at != null;\n  const sentAt = scenario?.sent_at != null;\n  return (\n    status === \"sent_for_approval\" ||\n    status === \"submitted\" ||\n    (status === \"approved\" && sentAt) ||\n    (status === \"in_review\" && submittedAt)\n  );\n}\n\nconst DEFAULT_START_YEAR = \"2026\";\nconst DEFAULT_END_YEAR = \"2027\";\nconst CURRENCY_CODE_REGEX = /^[A-Z0-9]{2,10}$/;\nconst LOCAL_CURRENCY_OPTIONS = [\"USD\", \"EUR\", \"TRY\", \"GBP\", \"JPY\", \"CNY\", \"INR\", \"RUB\", \"AED\", \"SAR\", \"AFN\"];\n\nfunction normalizeYearInput(value) {\n  const s = String(value || \"\").trim();\n  if (!/^\\d{4}$/.test(s)) return null;\n  return Number(s);\n}\n\nfunction formatAcademicYear(periodType, startYearValue, endYearValue) {\n  const start = normalizeYearInput(startYearValue);\n  if (!start) return \"\";\n  if (periodType === \"full\") return String(start);\n  const end = normalizeYearInput(endYearValue);\n  if (!end) return \"\";\n  return `${start}-${end}`;\n}\n\nfunction parseAcademicYear(academicYear) {\n  const s = String(academicYear || \"\").trim();\n  const range = s.match(/(\\d{4})\\s*-\\s*(\\d{4})/);\n  if (range) {\n    const startYear = Number(range[1]);\n    const endYear = Number(range[2]);\n    if (Number.isFinite(startYear) && Number.isFinite(endYear)) {\n      return { startYear, endYear };\n    }\n  }\n  const single = s.match(/^(\\d{4})$/);\n  if (single) {\n    const startYear = Number(single[1]);\n    if (Number.isFinite(startYear)) return { startYear, endYear: startYear };\n  }\n  return { startYear: null, endYear: null };\n}\n\nfunction incrementAcademicYearString(academicYear) {\n  const raw = String(academicYear || \"\").trim();\n  const single = raw.match(/^(\\d{4})$/);\n  if (single) {\n    const start = Number(single[1]);\n    return Number.isFinite(start) ? String(start + 1) : \"\";\n  }\n  const range = raw.match(/^(\\d{4})\\s*-\\s*(\\d{4})$/);\n  if (range) {\n    const start = Number(range[1]);\n    const end = Number(range[2]);\n    if (Number.isFinite(start) && Number.isFinite(end)) return `${start + 1}-${end + 1}`;\n  }\n  return \"\";\n}\n\nfunction getAllCopySectionIds() {\n  return COPY_SELECT_TABS.flatMap((tab) => tab.sections.map((section) => section.id));\n}\n\nfunction enforceIkGiderlerPair(selection) {\n  const next = { ...(selection || {}) };\n  const ikSelected = !!next[\"hr.ik\"];\n  const giderlerSelected = !!next[\"expenses.giderler\"];\n  if (ikSelected !== giderlerSelected) {\n    const nextValue = ikSelected || giderlerSelected;\n    next[\"hr.ik\"] = nextValue;\n    next[\"expenses.giderler\"] = nextValue;\n  }\n  return next;\n}\n\nfunction buildDefaultCopySelection(presetKey = \"all\") {\n  const sectionIds = getAllCopySectionIds();\n  const selection = Object.fromEntries(sectionIds.map((id) => [id, false]));\n  if (presetKey === \"all\") {\n    sectionIds.forEach((id) => {\n      selection[id] = true;\n    });\n  } else if (presetKey === \"structure\") {\n    [\"temel.core\", \"kapasite.all\", \"norm.planned\", \"norm.lessonY1\"].forEach((id) => {\n      selection[id] = true;\n    });\n  } else if (presetKey === \"financial\") {\n    [\"temel.core\", \"income.gelirler\", \"expenses.discounts\", \"hr.ik\", \"expenses.giderler\"].forEach((id) => {\n      selection[id] = true;\n    });\n  }\n  return enforceIkGiderlerPair(selection);\n}\n\nfunction filterInputsForCopyBySelection(srcInputs, selection) {\n  const sel = selection || {};\n  const keep = (id) => !!sel[id];\n  const next = structuredClone(srcInputs || {});\n  const buildDefaultGrades = () =>\n    getGradeOptions().map((g) => ({ grade: g, branchCount: 0, studentsPerBranch: 0 }));\n  const srcGradesYears =\n    srcInputs?.gradesYears && typeof srcInputs.gradesYears === \"object\" ? srcInputs.gradesYears : {};\n  const srcGrades = Array.isArray(srcInputs?.grades) ? srcInputs.grades : null;\n  const y1Source = Array.isArray(srcGradesYears?.y1)\n    ? srcGradesYears.y1\n    : Array.isArray(srcGrades)\n      ? srcGrades\n      : buildDefaultGrades();\n  const keepPlanned = keep(\"norm.planned\");\n  const keepLessonY1 = keep(\"norm.lessonY1\");\n  const y2Source = Array.isArray(srcGradesYears?.y2)\n    ? srcGradesYears.y2\n    : keepLessonY1\n      ? y1Source\n      : buildDefaultGrades();\n  const y3Source = Array.isArray(srcGradesYears?.y3)\n    ? srcGradesYears.y3\n    : keepLessonY1\n      ? y1Source\n      : buildDefaultGrades();\n  next.temelBilgiler = next.temelBilgiler || {};\n\n  if (!keep(\"temel.core\")) {\n    delete next.temelBilgiler.kademeler;\n    delete next.temelBilgiler.programType;\n  }\n\n  if (!keep(\"temel.pricing\")) {\n    delete next.temelBilgiler.inflation;\n    delete next.temelBilgiler.ucretArtisOranlari;\n    delete next.temelBilgiler.okulUcretleriHesaplama;\n  }\n\n  if (!keep(\"temel.schoolInfo\")) {\n    delete next.temelBilgiler.yetkililer;\n    delete next.temelBilgiler.okulEgitimBilgileri;\n  }\n\n  if (!keep(\"temel.discountsMeta\")) {\n    delete next.temelBilgiler.ikMevcut;\n    delete next.temelBilgiler.bursIndirimOgrenciSayilari;\n  }\n\n  if (!keep(\"temel.competitors\")) {\n    delete next.temelBilgiler.rakipAnalizi;\n  }\n\n  if (!keep(\"temel.performance\")) {\n    delete next.temelBilgiler.performans;\n    delete next.temelBilgiler.degerlendirme;\n  }\n  if (next.temelBilgiler?.performans && typeof next.temelBilgiler.performans === \"object\") {\n    delete next.temelBilgiler.performans.gerceklesen;\n  }\n\n  if (!keep(\"kapasite.all\")) {\n    delete next.kapasite;\n    delete next.schoolCapacity;\n  }\n\n  if (!keep(\"norm.current\")) {\n    delete next.gradesCurrent;\n  }\n\n  if (!keepPlanned && !keepLessonY1) {\n    delete next.gradesYears;\n    delete next.grades;\n  } else {\n    const y1 = keepLessonY1 ? structuredClone(y1Source) : structuredClone(buildDefaultGrades());\n    const y2 = keepPlanned ? structuredClone(y2Source) : structuredClone(buildDefaultGrades());\n    const y3 = keepPlanned ? structuredClone(y3Source) : structuredClone(buildDefaultGrades());\n    next.gradesYears = { y1, y2, y3 };\n    if (keepLessonY1) {\n      next.grades = structuredClone(y1);\n    } else {\n      delete next.grades;\n    }\n  }\n\n  if (!keep(\"hr.ik\")) {\n    delete next.ik;\n  }\n\n  if (!keep(\"income.gelirler\")) {\n    delete next.gelirler;\n  }\n\n  if (!keep(\"expenses.giderler\")) {\n    delete next.giderler;\n  }\n\n  if (!keep(\"expenses.discounts\")) {\n    delete next.discounts;\n  }\n\n  return next;\n}\n\nfunction buildEmptyNormCurriculum() {\n  const empty = {};\n  getGradeOptions().forEach((g) => {\n    empty[g] = {};\n  });\n  return empty;\n}\n\nfunction buildEmptyNormYear(maxHours) {\n  return {\n    teacherWeeklyMaxHours: Number.isFinite(maxHours) && maxHours > 0 ? maxHours : 24,\n    curriculumWeeklyHours: buildEmptyNormCurriculum(),\n  };\n}\n\nfunction convertInputsUsdToLocalForCopy(inputs, fx) {\n  const rate = Number(fx);\n  if (!Number.isFinite(rate) || rate <= 0) return inputs;\n\n  const mulMoney = (v) => {\n    const n = Number(v);\n    if (!Number.isFinite(n)) return v;\n    return Math.round(n * rate * 100) / 100;\n  };\n\n  if (inputs?.gelirler) {\n    const g = inputs.gelirler;\n\n    const convertRows = (rows) => {\n      if (!Array.isArray(rows)) return;\n      rows.forEach((r) => {\n        if (!r || typeof r !== \"object\") return;\n        if (\"unitFee\" in r) r.unitFee = mulMoney(r.unitFee);\n        if (\"amount\" in r) r.amount = mulMoney(r.amount);\n      });\n    };\n\n    convertRows(g?.tuition?.rows);\n    convertRows(g?.nonEducationFees?.rows);\n    convertRows(g?.dormitory?.rows);\n    convertRows(g?.otherInstitutionIncome?.rows);\n\n    if (g?.governmentIncentives != null) {\n      g.governmentIncentives = mulMoney(g.governmentIncentives);\n    }\n  }\n\n  if (inputs?.giderler && typeof inputs.giderler === \"object\") {\n    Object.values(inputs.giderler).forEach((grp) => {\n      if (!grp || typeof grp !== \"object\") return;\n      if (!grp.items || typeof grp.items !== \"object\") return;\n      Object.keys(grp.items).forEach((k) => {\n        grp.items[k] = mulMoney(grp.items[k]);\n      });\n    });\n  }\n\n  if (inputs?.ik?.years && typeof inputs.ik.years === \"object\") {\n    Object.values(inputs.ik.years).forEach((yearObj) => {\n      if (!yearObj || typeof yearObj !== \"object\") return;\n      if (!yearObj.unitCosts || typeof yearObj.unitCosts !== \"object\") return;\n      Object.keys(yearObj.unitCosts).forEach((k) => {\n        yearObj.unitCosts[k] = mulMoney(yearObj.unitCosts[k]);\n      });\n    });\n  }\n\n  if (Array.isArray(inputs?.discounts)) {\n    inputs.discounts.forEach((d) => {\n      if (!d || typeof d !== \"object\") return;\n      if (String(d.mode || \"\").toLowerCase() === \"amount\") {\n        d.value = mulMoney(d.value);\n      }\n    });\n  }\n\n  const tb = inputs?.temelBilgiler;\n  if (tb) {\n    if (tb?.inflation?.currentSeasonAvgFee != null) {\n      tb.inflation.currentSeasonAvgFee = mulMoney(tb.inflation.currentSeasonAvgFee);\n    }\n\n    if (tb?.rakipAnalizi && typeof tb.rakipAnalizi === \"object\") {\n      Object.values(tb.rakipAnalizi).forEach((obj) => {\n        if (!obj || typeof obj !== \"object\") return;\n        [\"a\", \"b\", \"c\"].forEach((k) => {\n          if (k in obj) obj[k] = mulMoney(obj[k]);\n        });\n      });\n    }\n\n    if (tb?.performans?.gerceklesen && typeof tb.performans.gerceklesen === \"object\") {\n      Object.keys(tb.performans.gerceklesen).forEach((k) => {\n        tb.performans.gerceklesen[k] = mulMoney(tb.performans.gerceklesen[k]);\n      });\n    }\n  }\n\n  return inputs;\n}\n\nfunction convertInputsLocalToUsdForCopy(inputs, fx) {\n  const rate = Number(fx);\n  if (!Number.isFinite(rate) || rate <= 0) return inputs;\n  return convertInputsUsdToLocalForCopy(inputs, 1 / rate);\n}\n\nfunction InlineSpinner({ size = 12 }) {\n  return (\n    <span\n      aria-hidden\n      style={{\n        width: size,\n        height: size,\n        borderRadius: \"50%\",\n        border: \"2px solid rgba(0,0,0,0.18)\",\n        borderTopColor: \"rgba(0,0,0,0.65)\",\n        display: \"inline-block\",\n        animation: \"schoolSpin .8s linear infinite\",\n      }}\n    />\n  );\n}\n\nfunction applyIkSalariesToGiderler(inInputs) {\n  const src = inInputs || {};\n  const ik = src.ik || {};\n  const yearIK = ik?.years?.y1 ? ik.years.y1 : ik;\n\n  const unitCosts = yearIK?.unitCosts || {};\n  const headcountsByLevel = yearIK?.headcountsByLevel || {};\n\n  const roles = [\n    \"turk_mudur\",\n    \"turk_mdyard\",\n    \"turk_egitimci\",\n    \"turk_temsil\",\n    \"yerel_yonetici_egitimci\",\n    \"yerel_destek\",\n    \"yerel_ulke_temsil_destek\",\n    \"int_yonetici_egitimci\",\n  ];\n\n  const levels = [\n    \"okulOncesi\",\n    \"ilkokulYerel\",\n    \"ilkokulInt\",\n    \"ortaokulYerel\",\n    \"ortaokulInt\",\n    \"liseYerel\",\n    \"liseInt\",\n  ];\n\n  const roleAnnual = {};\n  for (const r of roles) {\n    let count = 0;\n    for (const lvl of levels) count += Number(headcountsByLevel?.[lvl]?.[r] || 0);\n    roleAnnual[r] = Number(unitCosts?.[r] || 0) * count;\n  }\n\n  const patch = {\n    turkPersonelMaas:\n      (roleAnnual.turk_mudur || 0) +\n      (roleAnnual.turk_mdyard || 0) +\n      (roleAnnual.turk_egitimci || 0),\n    turkDestekPersonelMaas: roleAnnual.turk_temsil || 0,\n    yerelPersonelMaas: roleAnnual.yerel_yonetici_egitimci || 0,\n    yerelDestekPersonelMaas:\n      (roleAnnual.yerel_destek || 0) + (roleAnnual.yerel_ulke_temsil_destek || 0),\n    internationalPersonelMaas: roleAnnual.int_yonetici_egitimci || 0,\n  };\n\n  const prevItems = src?.giderler?.isletme?.items || {};\n  const keys = Object.keys(patch);\n\n  let changed = false;\n  for (const k of keys) {\n    const a = Number(prevItems?.[k] || 0);\n    const b = Number(patch?.[k] || 0);\n    if (Math.abs(a - b) > 1e-6) {\n      changed = true;\n      break;\n    }\n  }\n  if (!changed) return src;\n\n  const next = structuredClone(src);\n  next.giderler = next.giderler || {};\n  next.giderler.isletme = next.giderler.isletme || {};\n  next.giderler.isletme.items = next.giderler.isletme.items || {};\n  for (const k of keys) next.giderler.isletme.items[k] = Number(patch[k] || 0);\n  return next;\n}\n\nfunction normalizeCapacityInputs(src) {\n  const safeNum = (v) => {\n    const n = Number(v);\n    return Number.isFinite(n) ? n : 0;\n  };\n\n  const s = src || {};\n  const legacy = safeNum(s.schoolCapacity);\n\n  const cap = s.kapasite && typeof s.kapasite === \"object\" ? s.kapasite : {};\n  const years = cap.years && typeof cap.years === \"object\" ? cap.years : {};\n\n  const y1 = safeNum(years.y1 != null ? years.y1 : legacy);\n  const y2 = safeNum(years.y2 != null ? years.y2 : y1);\n  const y3 = safeNum(years.y3 != null ? years.y3 : y1);\n\n  const currentStudents = safeNum(cap.currentStudents);\n  const byKademe = cap.byKademe && typeof cap.byKademe === \"object\" ? cap.byKademe : {};\n\n  const needsPatch =\n    \"schoolCapacity\" in s ||\n    !s.kapasite ||\n    typeof s.kapasite !== \"object\" ||\n    !cap.years ||\n    typeof cap.years !== \"object\" ||\n    safeNum(cap?.years?.y1) !== y1 ||\n    safeNum(cap?.years?.y2) !== y2 ||\n    safeNum(cap?.years?.y3) !== y3 ||\n    safeNum(cap?.currentStudents) !== currentStudents ||\n    !cap.byKademe ||\n    typeof cap.byKademe !== \"object\";\n\n  if (!needsPatch) return s;\n\n  const next = structuredClone(s);\n  next.kapasite = {\n    ...(cap || {}),\n    currentStudents,\n    years: { y1, y2, y3 },\n    byKademe,\n  };\n  if (\"schoolCapacity\" in next) delete next.schoolCapacity;\n  return next;\n}\n\nfunction normalizeTemelBilgilerInputs(src) {\n  const s = src || {};\n  const t = s.temelBilgiler && typeof s.temelBilgiler === \"object\" ? s.temelBilgiler : {};\n  const next = structuredClone(s);\n\n  const inf = t.inflation && typeof t.inflation === \"object\" ? t.inflation : {};\n  const toFinite = (v) => (Number.isFinite(Number(v)) ? Number(v) : 0);\n  next.temelBilgiler = {\n    inflation: {\n      ...inf,\n      expenseDeviationPct: toFinite(inf.expenseDeviationPct),\n      y2023: toFinite(inf.y2023),\n      y2024: toFinite(inf.y2024),\n      y2025: toFinite(inf.y2025),\n      y1: toFinite(inf.y1),\n      y2: toFinite(inf.y2),\n      y3: toFinite(inf.y3),\n      currentSeasonAvgFee: toFinite(inf.currentSeasonAvgFee),\n    },\n    yetkililer: t.yetkililer || { mudur: \"\", ulkeTemsilcisi: \"\", raporuHazirlayan: \"\" },\n    okulEgitimBilgileri: t.okulEgitimBilgileri || {\n      egitimBaslamaTarihi: \"\",\n      zorunluEgitimDonemleri: \"\",\n      birDersSuresiDakika: 0,\n      gunlukDersSaati: 0,\n      haftalikDersSaatiToplam: 0,\n      sabahciOglenci: \"\",\n      ogretmenHaftalikDersOrt: 0,\n      gecisSinaviBilgisi: \"\",\n      uygulananProgram: \"\",\n    },\n    kademeler: normalizeKademeConfig(t.kademeler),\n    programType: normalizeProgramType(t.programType),\n    okulUcretleriHesaplama: typeof t.okulUcretleriHesaplama === \"boolean\" ? t.okulUcretleriHesaplama : true,\n    ucretArtisOranlari: t.ucretArtisOranlari || {\n      okulOncesi: 0,\n      ilkokulYerel: 0,\n      ilkokulInt: 0,\n      ortaokulYerel: 0,\n      ortaokulInt: 0,\n      liseYerel: 0,\n      liseInt: 0,\n    },\n    ikMevcut: t.ikMevcut || {\n      turkPersonelYoneticiEgitimci: 0,\n      turkPersonelTemsilcilik: 0,\n      yerelKadroluEgitimci: 0,\n      yerelUcretliVakaterEgitimci: 0,\n      yerelDestek: 0,\n      yerelTemsilcilik: 0,\n      international: 0,\n    },\n    bursIndirimOgrenciSayilari: t.bursIndirimOgrenciSayilari || {\n      magisBasariBursu: 0,\n      maarifYetenekBursu: 0,\n      ihtiyacBursu: 0,\n      okulBasariBursu: 0,\n      tamEgitimBursu: 0,\n      barinmaBursu: 0,\n      turkceBasariBursu: 0,\n      uluslararasiYukumlulukIndirimi: 0,\n      vakifCalisaniIndirimi: 0,\n      kardesIndirimi: 0,\n      erkenKayitIndirimi: 0,\n      pesinOdemeIndirimi: 0,\n      kademeGecisIndirimi: 0,\n      temsilIndirimi: 0,\n      kurumIndirimi: 0,\n      istisnaiIndirim: 0,\n      yerelMevzuatIndirimi: 0,\n    },\n    rakipAnalizi: t.rakipAnalizi || {\n      okulOncesi: { a: 0, b: 0, c: 0 },\n      ilkokul: { a: 0, b: 0, c: 0 },\n      ortaokul: { a: 0, b: 0, c: 0 },\n      lise: { a: 0, b: 0, c: 0 },\n    },\n    performans: t.performans || {\n      gerceklesen: { ogrenciSayisi: 0, gelirler: 0, giderler: 0, karZarar: 0, bursVeIndirimler: 0 },\n    },\n    degerlendirme: typeof t.degerlendirme === \"string\" ? t.degerlendirme : \"\",\n  };\n\n  return next;\n}\n\nfunction normalizeGradesInputs(src) {\n  const s = src || {};\n  const defaultGrades = getGradeOptions().map((g) => ({ grade: g, branchCount: 0, studentsPerBranch: 0 }));\n  const baseGrades = Array.isArray(s.grades) ? s.grades : defaultGrades;\n  const years = s.gradesYears && typeof s.gradesYears === \"object\" ? s.gradesYears : {};\n\n  const y1 = Array.isArray(years.y1) ? years.y1 : baseGrades;\n  const y2 = Array.isArray(years.y2) ? years.y2 : y1;\n  const y3 = Array.isArray(years.y3) ? years.y3 : y1;\n\n  const normalizeRow = (row) => ({\n    grade: String(row?.grade ?? \"\"),\n    branchCount: Number(row?.branchCount ?? 0),\n    studentsPerBranch: Number(row?.studentsPerBranch ?? 0),\n  });\n\n  const toMap = (list) => {\n    const m = new Map();\n    (Array.isArray(list) ? list : []).forEach((row) => {\n      const r = normalizeRow(row);\n      if (!r.grade) return;\n      m.set(r.grade, r);\n    });\n    return m;\n  };\n\n  const areGradesEqual = (a, b) => {\n    if (!Array.isArray(a) || !Array.isArray(b)) return false;\n    if (a.length !== b.length) return false;\n    const ma = toMap(a);\n    const mb = toMap(b);\n    if (ma.size !== mb.size) return false;\n    for (const [grade, ra] of ma.entries()) {\n      const rb = mb.get(grade);\n      if (!rb) return false;\n      if (Number(ra.branchCount) !== Number(rb.branchCount)) return false;\n      if (Number(ra.studentsPerBranch) !== Number(rb.studentsPerBranch)) return false;\n    }\n    return true;\n  };\n\n  const needsPatch =\n    !s.gradesYears ||\n    !Array.isArray(s.grades) ||\n    !Array.isArray(years.y1) ||\n    !Array.isArray(years.y2) ||\n    !Array.isArray(years.y3) ||\n    !areGradesEqual(s.grades, y1);\n\n  if (!needsPatch) return s;\n\n  const next = structuredClone(s);\n  next.gradesYears = {\n    y1: structuredClone(y1),\n    y2: structuredClone(y2),\n    y3: structuredClone(y3),\n  };\n  next.grades = structuredClone(next.gradesYears.y1);\n  return next;\n}\n\nfunction getScenarioStatusMeta(scenarioOrStatus) {\n  const obj = scenarioOrStatus && typeof scenarioOrStatus === 'object' ? scenarioOrStatus : { status: scenarioOrStatus };\n  const status = obj.status;\n  const sentAt = obj.sent_at;\n  switch (status) {\n    case 'revision_requested':\n      return { label: 'Revize istendi', cls: 'is-revision', help: 'Revize istendi: senaryoda dzeltme gerekiyor.' };\n    case 'sent_for_approval':\n      return { label: 'Merkeze iletildi', cls: 'is-submitted', help: 'Merkeze iletildi: admin onay bekleniyor.' };\n    case 'submitted':\n      // Legacy status; treat similarly to sent_for_approval\n      return { label: 'Merkeze iletildi', cls: 'is-submitted', help: 'Merkeze iletildi: admin onay bekleniyor.' };\n    case 'approved':\n      if (sentAt) {\n        return { label: 'Onayland', cls: 'is-approved', help: 'Onayland: admin tarafndan onayland.' };\n      }\n      return { label: 'Kontrol edildi', cls: 'is-approved', help: 'Kontrol edildi: ynetici tarafndan kontrol edildi.' };\n    case 'in_review':\n      return { label: 'ncelemede', cls: 'is-submitted', help: 'ncelemede: ynetici incelemesinde.' };\n    case 'draft':\n      return { label: 'Taslak', cls: 'is-draft', help: 'Taslak: senaryo zerinde allyor.' };\n    default:\n      return { label: status || '-', cls: 'is-unknown', help: '' };\n  }\n}\n\nexport default function SelectPage() {\n  const navigate = useNavigate();\n  const outlet = useOutletContext();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const auth = useAuth();\n\n  const [schools, setSchools] = useState([]);\n  const [scenarios, setScenarios] = useState([]);\n  const [scenariosSchoolId, setScenariosSchoolId] = useState(null);\n  const [selectedSchoolId, setSelectedSchoolId] = useState(null);\n  const [selectedScenarioIdLocal, setSelectedScenarioIdLocal] = useState(null);\n  const [selectedScenario, setSelectedScenario] = useState(null);\n  const [inputs, setInputs] = useState(null);\n  const [, setReport] = useState(null);\n  const [err, setErr] = useState(\"\");\n  const [loadingSchools, setLoadingSchools] = useState(false);\n  const [loadingScenarios, setLoadingScenarios] = useState(false);\n  const [schoolProgress, setSchoolProgress] = useState({});\n  const [schoolProgressLoading, setSchoolProgressLoading] = useState(false);\n  const [schoolExpenseSplitStaleMap, setSchoolExpenseSplitStaleMap] = useState({});\n  const [scenarioProgressMap, setScenarioProgressMap] = useState({});\n  const [scenarioProgressLoading, setScenarioProgressLoading] = useState(false);\n\n  const [newScenarioName, setNewScenarioName] = useState(\"\");\n  const [newScenarioPeriod, setNewScenarioPeriod] = useState(\"split\");\n  const [newScenarioStartYear, setNewScenarioStartYear] = useState(DEFAULT_START_YEAR);\n  const [newScenarioEndYear, setNewScenarioEndYear] = useState(DEFAULT_END_YEAR);\n  const [newScenarioKademeler, setNewScenarioKademeler] = useState(getDefaultKademeConfig());\n  // Some branches (e.g. Headquarter / Merkez) may not have any academic \"kademe\".\n  // We support this by allowing an explicit \"no kademe\" toggle in the wizard.\n  const [newScenarioNoKademe, setNewScenarioNoKademe] = useState(false);\n  const [newScenarioInputCurrency, setNewScenarioInputCurrency] = useState(\"USD\");\n  const [newScenarioLocalCurrencyCode, setNewScenarioLocalCurrencyCode] = useState(\"\");\n  const [newScenarioFxUsdToLocal, setNewScenarioFxUsdToLocal] = useState(\"\");\n  const [newScenarioProgramType, setNewScenarioProgramType] = useState(null);\n  const [newScenarioStep, setNewScenarioStep] = useState(0);\n  const [scenarioWizardOpen, setScenarioWizardOpen] = useState(false);\n  const [scenarioWizardMode, setScenarioWizardMode] = useState(\"create\");\n  const [scenarioWizardScenario, setScenarioWizardScenario] = useState(null);\n  const [scenarioWizardLoading, setScenarioWizardLoading] = useState(false);\n  const [scenarioWizardSaving, setScenarioWizardSaving] = useState(false);\n\n  const [scenarioSort, setScenarioSort] = useState({ key: null, dir: \"asc\" });\n  const [submittingScenarioId, setSubmittingScenarioId] = useState(null);\n  const [copyingScenarioId, setCopyingScenarioId] = useState(null);\n  const [deletingScenarioId, setDeletingScenarioId] = useState(null);\n  const [deleteConfirmScenarioId, setDeleteConfirmScenarioId] = useState(null);\n  const [copyModalOpen, setCopyModalOpen] = useState(false);\n  const [expenseSplitOpen, setExpenseSplitOpen] = useState(false);\n  const [bulkSendOpen, setBulkSendOpen] = useState(false);\n  const [copyModalError, setCopyModalError] = useState(\"\");\n  const [copySelection, setCopySelection] = useState(null);\n  const [copySelectionMsg, setCopySelectionMsg] = useState(\"\");\n  const [copyTargetCurrency, setCopyTargetCurrency] = useState(\"USD\");\n  const [copyLocalCurrencyCode, setCopyLocalCurrencyCode] = useState(\"\");\n  const [copyPlannedFxUsdToLocal, setCopyPlannedFxUsdToLocal] = useState(\"\");\n  const [copyFxUsdToLocal, setCopyFxUsdToLocal] = useState(\"\");\n  const [calculating, setCalculating] = useState(false);\n\n  const copySelectionMsgTimerRef = useRef(null);\n  const kademeBeforeNoKademeRef = useRef(null);\n\n  useEffect(() => {\n    if (!outlet?.setHeaderMeta) return;\n    outlet.setHeaderMeta({\n      title: \"Okul & Senaryo Sec\",\n      subtitle: \"Okul ve senaryoyu secip Uygula'ya basin.\",\n      centered: true,\n    });\n    return () => {\n      outlet.clearHeaderMeta?.();\n    };\n  }, [outlet]);\n\n  const loadSchools = useCallback(async () => {\n    setErr(\"\");\n    setLoadingSchools(true);\n    try {\n      const data = await api.listSchools({\n        limit: 50,\n        offset: 0,\n        fields: \"brief\",\n        order: \"name:asc\",\n      });\n      setSchools(Array.isArray(data?.items) ? data.items : []);\n    } catch (e) {\n      setErr(e.message || \"Okullar yuklenemedi.\");\n    } finally {\n      setLoadingSchools(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    loadSchools();\n  }, [loadSchools]);\n\n  const loadSchoolProgress = useCallback(async (rows) => {\n    if (!Array.isArray(rows) || !rows.length) {\n      setSchoolProgress({});\n      return;\n    }\n    setSchoolProgressLoading(true);\n    try {\n      const ids = rows.map((s) => s.id);\n      const data = await api.getSchoolsProgressBulk(ids);\n      const map = data?.progressBySchoolId && typeof data.progressBySchoolId === \"object\"\n        ? data.progressBySchoolId\n        : {};\n      setSchoolProgress(map);\n    } catch (_) {\n      const fallback = {};\n      rows.forEach((s) => {\n        fallback[s.id] = { state: \"error\", label: \"lerleme hesaplanamad\" };\n      });\n      setSchoolProgress(fallback);\n    } finally {\n      setSchoolProgressLoading(false);\n    }\n  }, []);\n\n  const loadSchoolExpenseSplitStale = useCallback(async (rows) => {\n    if (!Array.isArray(rows) || !rows.length) {\n      setSchoolExpenseSplitStaleMap({});\n      return;\n    }\n    try {\n      const ids = rows.map((s) => s.id);\n      const data = await api.getSchoolsExpenseSplitStale(ids);\n      const map =\n        data?.staleBySchoolId && typeof data.staleBySchoolId === \"object\"\n          ? data.staleBySchoolId\n          : {};\n      setSchoolExpenseSplitStaleMap(map);\n    } catch (_) {\n      setSchoolExpenseSplitStaleMap({});\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!schools.length) {\n      setSchoolProgress({});\n      setSchoolProgressLoading(false);\n      return;\n    }\n    loadSchoolProgress(schools);\n  }, [schools, loadSchoolProgress]);\n\n  useEffect(() => {\n    if (!schools.length) {\n      setSchoolExpenseSplitStaleMap({});\n      return;\n    }\n    loadSchoolExpenseSplitStale(schools);\n  }, [schools, loadSchoolExpenseSplitStale]);\n\n  useEffect(() => {\n    const raw = searchParams.get(\"schoolId\");\n    const paramId = Number(raw || 0);\n    if (!raw || !Number.isFinite(paramId)) return;\n    if (!schools.length) return;\n    if (!schools.some((s) => String(s.id) === String(paramId))) return;\n    setSelectedSchoolId((prev) => {\n      if (String(prev) === String(paramId)) return prev;\n      setScenarios([]);\n      setScenariosSchoolId(null);\n      setScenarioProgressMap({});\n      setScenarioProgressLoading(false);\n      return paramId;\n    });\n  }, [searchParams, schools]);\n\n  const handleSelectSchool = useCallback(\n    (schoolId) => {\n      const isDifferent = String(selectedSchoolId) !== String(schoolId);\n      if (isDifferent) {\n        setSelectedScenarioIdLocal(null);\n        setSelectedScenario(null);\n        setInputs(null);\n        setReport(null);\n        setScenarios([]);\n        setScenariosSchoolId(null);\n        setScenarioProgressMap({});\n        setScenarioProgressLoading(false);\n      }\n      setSelectedSchoolId(schoolId);\n      if (isDifferent) {\n        setSearchParams((prev) => {\n          const next = new URLSearchParams(prev);\n          next.set(\"schoolId\", String(schoolId));\n          return next;\n        });\n      }\n    },\n    [selectedSchoolId, setSearchParams]\n  );\n\n  const clearSchoolSelection = useCallback(() => {\n    setSelectedSchoolId(null);\n    setSelectedScenarioIdLocal(null);\n    setSelectedScenario(null);\n    setInputs(null);\n    setReport(null);\n    setScenarios([]);\n    setScenariosSchoolId(null);\n    setScenarioProgressMap({});\n    setSearchParams((prev) => {\n      const next = new URLSearchParams(prev);\n      next.delete(\"schoolId\");\n      return next;\n    });\n  }, [setSearchParams]);\n\n  const clearScenarioSelection = useCallback(() => {\n    setSelectedScenarioIdLocal(null);\n    setSelectedScenario(null);\n    setInputs(null);\n    setReport(null);\n  }, []);\n\n  useEffect(() => {\n    if (!selectedSchoolId) {\n      setScenarios([]);\n      setScenariosSchoolId(null);\n      setSelectedScenarioIdLocal(null);\n      setSelectedScenario(null);\n      setInputs(null);\n      setReport(null);\n      setScenarioProgressMap({});\n      setScenarioProgressLoading(false);\n      setLoadingScenarios(false);\n      return;\n    }\n\n    setSelectedScenarioIdLocal(null);\n    setSelectedScenario(null);\n    setInputs(null);\n    setReport(null);\n    setScenarios([]);\n    setScenariosSchoolId(null);\n    setScenarioProgressMap({});\n    setScenarioProgressLoading(false);\n\n    let active = true;\n    setErr(\"\");\n    setLoadingScenarios(true);\n    async function loadScenarios() {\n      try {\n        const sc = await api.listScenarios(selectedSchoolId, {\n          limit: 50,\n          offset: 0,\n          fields: \"brief\",\n          order: \"created_at:desc\",\n        });\n        if (!active) return;\n        const rows = Array.isArray(sc?.items) ? sc.items : [];\n        setScenarios(rows);\n        setScenariosSchoolId(selectedSchoolId);\n        setSelectedScenarioIdLocal((prev) => {\n          const exists = rows.some((s) => String(s.id) === String(prev));\n          if (exists) return prev;\n          const stored = readSelectedScenarioId(selectedSchoolId);\n          if (stored != null && rows.some((s) => String(s.id) === String(stored))) return stored;\n          return null;\n        });\n      } catch (e) {\n        if (!active) return;\n        setErr(e.message || \"Senaryolar yuklenemedi.\");\n        setScenarios([]);\n      } finally {\n        if (active) setLoadingScenarios(false);\n      }\n    }\n\n    loadScenarios();\n    return () => {\n      active = false;\n    };\n  }, [selectedSchoolId]);\n\n  useEffect(() => {\n    if (!selectedSchoolId) {\n      setScenarioProgressMap({});\n      setScenarioProgressLoading(false);\n      return;\n    }\n    if (scenariosSchoolId != null && String(scenariosSchoolId) !== String(selectedSchoolId)) {\n      setScenarioProgressMap({});\n      setScenarioProgressLoading(false);\n      return;\n    }\n    if (!scenarios.length) {\n      setScenarioProgressMap({});\n      setScenarioProgressLoading(false);\n      return;\n    }\n    let active = true;\n    setScenarioProgressLoading(true);\n    async function loadScenarioProgress() {\n      try {\n        const results = await Promise.all(\n          scenarios.map(async (scenario) => {\n            try {\n              const data = await api.getScenarioProgress(selectedSchoolId, scenario.id);\n              const progress = data?.progress;\n              if (!progress) return { id: scenario.id, error: true };\n              const missingLines = Array.isArray(progress.missingDetailsLines)\n                ? progress.missingDetailsLines\n                : [];\n              const tooltipLines = missingLines.length\n                ? [\"Eksik:\", ...missingLines]\n                : [\"Tm tablolar tamamland\"];\n              return { id: scenario.id, pct: progress.pct ?? 0, tooltipLines };\n            } catch (_) {\n              return { id: scenario.id, error: true };\n            }\n          })\n        );\n        if (!active) return;\n        const map = {};\n        results.forEach((row) => {\n          map[row.id] = row;\n        });\n        setScenarioProgressMap(map);\n      } finally {\n        if (active) setScenarioProgressLoading(false);\n      }\n    }\n    loadScenarioProgress();\n    return () => {\n      active = false;\n    };\n  }, [selectedSchoolId, scenarios, scenariosSchoolId]);\n\n  useEffect(() => {\n    if (!selectedSchoolId || !selectedScenarioIdLocal) {\n      setSelectedScenario(null);\n      setInputs(null);\n      setReport(null);\n      return;\n    }\n\n    let active = true;\n    setErr(\"\");\n    async function loadScenario() {\n      try {\n        const data = await api.getScenarioInputs(selectedSchoolId, selectedScenarioIdLocal);\n        if (!active) return;\n        setSelectedScenario(data?.scenario || null);\n        const raw = data?.inputs;\n        const normalized =\n          raw && typeof raw === \"object\"\n            ? normalizeGradesInputs(normalizeTemelBilgilerInputs(normalizeCapacityInputs(raw)))\n            : raw;\n        setInputs(normalized);\n        const isHQ = isHeadquarterScenario(normalized);\n        writeScenarioFlags(selectedSchoolId, selectedScenarioIdLocal, { isHeadquarter: isHQ });\n        setReport(null);\n      } catch (e) {\n        if (!active) return;\n        setErr(e.message || \"Senaryo yuklenemedi.\");\n      }\n    }\n\n    loadScenario();\n    return () => {\n      active = false;\n    };\n  }, [selectedSchoolId, selectedScenarioIdLocal]);\n\n  const refreshScenarios = useCallback(async () => {\n    if (!selectedSchoolId) return null;\n    try {\n      const sc = await api.listScenarios(selectedSchoolId, {\n        limit: 50,\n        offset: 0,\n        fields: \"brief\",\n        order: \"created_at:desc\",\n      });\n      const rows = Array.isArray(sc?.items) ? sc.items : [];\n      setScenarios(rows);\n      setScenariosSchoolId(selectedSchoolId);\n      return rows;\n    } catch (_) {\n      return null;\n    }\n  }, [selectedSchoolId]);\n\n  const handleExpenseSplitApplied = useCallback(\n    ({ sourceScenarioId } = {}) => {\n      if (!sourceScenarioId) return;\n      setScenarios((prev) => {\n        if (!Array.isArray(prev)) return prev;\n        return prev.map((row) => {\n          if (String(row.id) !== String(sourceScenarioId)) return row;\n          return {\n            ...row,\n            expense_split_applied: true,\n            expense_split_stale: false,\n          };\n        });\n      });\n      refreshScenarios();\n      loadSchoolExpenseSplitStale(schools);\n    },\n    [refreshScenarios, loadSchoolExpenseSplitStale, schools]\n  );\n\n  const kademeDefs = useMemo(() => getKademeDefinitions(), []);\n  const gradeOptions = useMemo(() => getGradeOptions(), []);\n\n  const draftStartYear = normalizeYearInput(newScenarioStartYear);\n  const draftEndYear = normalizeYearInput(newScenarioEndYear);\n  const draftAcademicYear = formatAcademicYear(newScenarioPeriod, newScenarioStartYear, newScenarioEndYear);\n  const draftRangeOk = newScenarioPeriod === \"full\" || (draftStartYear != null && draftEndYear === draftStartYear + 1);\n  const yearConflict = useMemo(() => {\n    if (!draftAcademicYear) return false;\n    const excludeId =\n      scenarioWizardMode === \"edit\"\n        ? Number(scenarioWizardScenario?.id || selectedScenarioIdLocal || 0)\n        : null;\n    return scenarios.some(\n      (s) =>\n        String(s?.academic_year || \"\").trim() === String(draftAcademicYear).trim() &&\n        (excludeId == null || Number(s?.id) !== excludeId)\n    );\n  }, [draftAcademicYear, scenarios, scenarioWizardMode, scenarioWizardScenario?.id, selectedScenarioIdLocal]);\n\n  const draftKademeConfig = useMemo(() => normalizeKademeConfig(newScenarioKademeler), [newScenarioKademeler]);\n  const hasEnabledKademe = useMemo(\n    () => Object.values(draftKademeConfig).some((row) => row && row.enabled),\n    [draftKademeConfig]\n  );\n  const kademeStepOk = newScenarioNoKademe || hasEnabledKademe;\n  const normalizedLocalCode = String(newScenarioLocalCurrencyCode || \"\").trim().toUpperCase();\n  const localCodeOk = newScenarioInputCurrency !== \"LOCAL\" || CURRENCY_CODE_REGEX.test(normalizedLocalCode);\n  const fxValue = Number(newScenarioFxUsdToLocal);\n  const fxOk = newScenarioInputCurrency !== \"LOCAL\" || (Number.isFinite(fxValue) && fxValue > 0);\n  const currencyStepOk = newScenarioInputCurrency === \"USD\" || (localCodeOk && fxOk);\n  const draftReady =\n    Boolean(newScenarioName.trim()) &&\n    Boolean(draftAcademicYear) &&\n    draftRangeOk &&\n    !yearConflict &&\n    kademeStepOk &&\n    currencyStepOk;\n  const scenarioStepTotal = 6;\n  const scenarioStepLabels = [\n    \"Donem Turu\",\n    \"Para Birimi\",\n    \"Program Turu\",\n    \"Yil\",\n    \"Kademeler\",\n    \"Senaryo Adi\",\n  ];\n  const scenarioStepOk = [\n    true,\n    currencyStepOk,\n    Boolean(newScenarioProgramType),\n    Boolean(draftAcademicYear) && draftRangeOk && !yearConflict,\n    kademeStepOk,\n    draftReady,\n  ];\n\n  const scenarioOpsBusy = Boolean(\n    copyingScenarioId ||\n    submittingScenarioId ||\n    deletingScenarioId ||\n    scenarioWizardSaving ||\n    scenarioWizardLoading\n  );\n  const busyRowId = copyingScenarioId ?? submittingScenarioId ?? deletingScenarioId ?? null;\n  const selectedRowScenario = useMemo(\n    () => scenarios.find((s) => String(s.id) === String(selectedScenarioIdLocal)) || null,\n    [scenarios, selectedScenarioIdLocal]\n  );\n  const selectedSchoolName = useMemo(() => {\n    const match = schools.find((s) => String(s.id) === String(selectedSchoolId));\n    return match?.name || \"\";\n  }, [schools, selectedSchoolId]);\n  const sortedScenarios = useMemo(() => {\n    if (!scenarioSort.key) return scenarios;\n    const indexed = scenarios.map((s, idx) => ({ s, idx }));\n    const dirMul = scenarioSort.dir === \"asc\" ? 1 : -1;\n\n    const getYearParts = (ay) => {\n      const m = String(ay || \"\").match(/(\\d{4})(?:\\s*-\\s*(\\d{4}))?/);\n      const a = m ? Number(m[1]) : 0;\n      const b = m && m[2] ? Number(m[2]) : a;\n      return [a || 0, b || 0];\n    };\n\n    const getCurrencyCode = (s) =>\n      String(s.input_currency || \"USD\").toUpperCase() === \"LOCAL\"\n        ? String(s.local_currency_code || \"LOCAL\").toUpperCase()\n        : \"USD\";\n\n    const getStatusLabel = (status) => {\n      switch (status) {\n        case 'in_review':\n          return 'ncelemede';\n        case 'sent_for_approval':\n          return 'Onaya Gonderildi';\n        case 'submitted':\n          return 'Gonderildi';\n        case \"revision_requested\":\n          return \"Revizyon Istendi\";\n        case \"approved\":\n          return \"Onaylandi\";\n        default:\n          return \"Taslak\";\n      }\n    };\n\n    indexed.sort((a, b) => {\n      const A = a.s;\n      const B = b.s;\n      let res = 0;\n\n      switch (scenarioSort.key) {\n        case \"name\":\n          res = String(A.name || \"\").localeCompare(String(B.name || \"\"), \"tr\", {\n            sensitivity: \"base\",\n            numeric: true,\n          });\n          break;\n        case \"year\": {\n          const [a1, a2] = getYearParts(A.academic_year);\n          const [b1, b2] = getYearParts(B.academic_year);\n          res = a1 - b1 || a2 - b2;\n          break;\n        }\n        case \"currency\":\n          res = getCurrencyCode(A).localeCompare(getCurrencyCode(B), \"tr\", {\n            sensitivity: \"base\",\n            numeric: true,\n          });\n          break;\n        case \"status\":\n          res = getStatusLabel(A.status).localeCompare(getStatusLabel(B.status), \"tr\", {\n            sensitivity: \"base\",\n            numeric: true,\n          });\n          break;\n        case \"date\":\n          res = new Date(A.created_at).getTime() - new Date(B.created_at).getTime();\n          break;\n        default:\n          res = 0;\n      }\n\n      if (res === 0) res = a.idx - b.idx;\n      return res * dirMul;\n    });\n\n    return indexed.map((item) => item.s);\n  }, [scenarios, scenarioSort]);\n  const toggleScenarioSort = (key) => {\n    setScenarioSort((prev) =>\n      prev.key === key ? { key, dir: prev.dir === \"asc\" ? \"desc\" : \"asc\" } : { key, dir: \"asc\" }\n    );\n  };\n  const getSortAria = (key) => {\n    if (scenarioSort.key !== key) return \"none\";\n    return scenarioSort.dir === \"asc\" ? \"ascending\" : \"descending\";\n  };\n  const sortIcon = (key) => {\n    if (scenarioSort.key !== key) {\n      return (\n        <span className=\"sort-icon is-idle\">\n          <FaSort aria-hidden=\"true\" />\n        </span>\n      );\n    }\n    return (\n      <span className=\"sort-icon\">\n        {scenarioSort.dir === \"asc\" ? <FaSortUp aria-hidden=\"true\" /> : <FaSortDown aria-hidden=\"true\" />}\n      </span>\n    );\n  };\n\n  const copySectionIds = useMemo(() => getAllCopySectionIds(), []);\n  const selectedCopyCount = copySelection\n    ? copySectionIds.reduce((sum, id) => sum + (copySelection[id] ? 1 : 0), 0)\n    : 0;\n  const selIk = !!copySelection?.[\"hr.ik\"];\n  const selGiderler = !!copySelection?.[\"expenses.giderler\"];\n  const isIkGiderlerValid = selIk === selGiderler;\n  const sourceCurrency = String(selectedScenario?.input_currency || \"USD\").toUpperCase();\n  const inputCurrencyCode =\n    selectedScenario?.input_currency === \"LOCAL\"\n      ? selectedScenario.local_currency_code || \"LOCAL\"\n      : \"USD\";\n  const isLocalScenario = selectedScenario?.input_currency === \"LOCAL\";\n  const prevRealFxValue = Number(inputs?.temelBilgiler?.performans?.prevYearRealizedFxUsdToLocal || 0);\n  const prevRealFxMissing = isLocalScenario && !(Number.isFinite(prevRealFxValue) && prevRealFxValue > 0);\n\n  const permissionScope = useMemo(\n    () => ({\n      countryId: auth.user?.country_id ?? null,\n      schoolId: selectedSchoolId != null ? Number(selectedSchoolId) : null,\n    }),\n    [auth.user?.country_id, selectedSchoolId]\n  );\n  const role = String(auth.user?.role || \"\");\n  const canCreateScenario = can(auth.user, \"scenario.create\", \"write\", permissionScope);\n    const canEditScenarioPlan = can(auth.user, \"scenario.plan_edit\", \"write\", permissionScope);\n    const canCopyScenario = can(auth.user, \"scenario.copy\", \"write\", permissionScope);\n    const canExpenseSplit = can(auth.user, \"scenario.expense_split\", \"write\", permissionScope);\n    const canSubmitScenario = can(auth.user, \"scenario.submit\", \"write\", permissionScope);\n    const canBulkSend = role === \"manager\" || role === \"accountant\";\n    const canDeleteScenario = can(auth.user, \"scenario.delete\", \"write\", permissionScope);\n\n  // Lock editing when the scenario has been forwarded to admins (sent_for_approval)\n  // or when it has been adminapproved.  Managerapproved scenarios (status\n  // 'approved' with sent_at null) remain editable until they are sent\n  // onward via the manager workflow.\n  const toolbarLocked = Boolean(selectedRowScenario) && isScenarioLocked(selectedRowScenario);\n  const canEditToolbar = Boolean(selectedRowScenario) && !toolbarLocked && canEditScenarioPlan;\n  const canDeleteToolbar = Boolean(selectedRowScenario) && !toolbarLocked && canDeleteScenario;\n  const isSubmitStage =\n    Boolean(selectedRowScenario) &&\n    (selectedRowScenario.status === \"draft\" || selectedRowScenario.status === \"revision_requested\");\n  const canSubmitToolbar = isSubmitStage && canSubmitScenario;\n  const canCopyToolbar = Boolean(selectedRowScenario) && inputs && canCopyScenario;\n  const toolbarIsCopying =\n    selectedRowScenario && String(copyingScenarioId) === String(selectedRowScenario.id);\n  const toolbarIsSubmitting =\n    selectedRowScenario && String(submittingScenarioId) === String(selectedRowScenario.id);\n  const toolbarIsDeleting =\n    selectedRowScenario && String(deletingScenarioId) === String(selectedRowScenario.id);\n\n  const selectedScenarioProgress =\n    selectedRowScenario && scenarioProgressMap\n      ? scenarioProgressMap[selectedRowScenario.id]\n      : null;\n  const selectedScenarioProgressPct =\n    selectedScenarioProgress && !selectedScenarioProgress.error\n      ? Number(selectedScenarioProgress.pct ?? 0)\n      : null;\n  const selectedScenarioProgressComplete =\n    Number.isFinite(selectedScenarioProgressPct) && selectedScenarioProgressPct >= 100;\n  const submitToolbarProgressReady = Boolean(selectedRowScenario) && selectedScenarioProgressComplete;\n  let submitToolbarTitle = \"Onaya Gonder\";\n  if (canSubmitToolbar && !submitToolbarProgressReady) {\n    if (scenarioProgressLoading) {\n      submitToolbarTitle = \"Ilerleme hesaplanyor.\";\n    } else if (!selectedScenarioProgress || selectedScenarioProgress.error) {\n      submitToolbarTitle = \"Ilerleme bilgisi alinmadi.\";\n    } else {\n      submitToolbarTitle = \"Ilerleme %100 degil.\";\n    }\n  }\n\n  const handleScenarioCurrencyChange = (next) => {\n    setNewScenarioInputCurrency(next);\n    if (next !== \"LOCAL\") {\n      setNewScenarioLocalCurrencyCode(\"\");\n      setNewScenarioFxUsdToLocal(\"\");\n    }\n  };\n  const handleScenarioPeriodChange = (nextPeriod) => {\n    setNewScenarioPeriod(nextPeriod);\n    if (nextPeriod === \"split\") {\n      const start = normalizeYearInput(newScenarioStartYear);\n      if (start != null) setNewScenarioEndYear(String(start + 1));\n    }\n  };\n  const handleScenarioStartYearChange = (value) => {\n    setNewScenarioStartYear(value);\n    if (newScenarioPeriod === \"split\") {\n      const start = normalizeYearInput(value);\n      if (start != null) setNewScenarioEndYear(String(start + 1));\n    }\n  };\n\n  function getScenarioStepError(step) {\n    if (step === 1) {\n      if (newScenarioInputCurrency === \"LOCAL\") {\n        if (!localCodeOk) return \"Local currency code zorunludur.\";\n        if (!fxOk) return \"Kur degeri zorunlu ve 0'dan buyuk olmali.\";\n      }\n    }\n    if (step === 2) {\n      if (!newScenarioProgramType) return \"Program Turu secilmelidir.\";\n    }\n    if (step === 3) {\n      if (!draftAcademicYear) return \"Lutfen gecerli bir akademik yil girin.\";\n      if (!draftRangeOk) return \"Bitis yili, baslangic yilindan 1 fazla olmali.\";\n      if (yearConflict) return \"Bu yil turu icin zaten bir senaryo var. Lutfen baska bir yil secin.\";\n    }\n    if (step === 4 && !kademeStepOk) return \"En az bir kademe secmelisiniz.\";\n    if (step === 5 && !newScenarioName.trim()) return \"Senaryo adi zorunludur.\";\n    return \"\";\n  }\n\n  function goScenarioNext() {\n    setErr(\"\");\n    if (scenarioWizardSaving) return;\n    const msg = getScenarioStepError(newScenarioStep);\n    if (msg) {\n      setErr(msg);\n      return;\n    }\n    if (newScenarioStep < scenarioStepTotal - 1) {\n      setNewScenarioStep((prev) => Math.min(prev + 1, scenarioStepTotal - 1));\n      return;\n    }\n    submitScenarioWizard();\n  }\n\n  function goScenarioBack() {\n    setErr(\"\");\n    setNewScenarioStep((prev) => Math.max(0, prev - 1));\n  }\n\n  function resetScenarioWizard() {\n    setNewScenarioName(\"\");\n    setNewScenarioPeriod(\"split\");\n    setNewScenarioStartYear(DEFAULT_START_YEAR);\n    setNewScenarioEndYear(DEFAULT_END_YEAR);\n    setNewScenarioKademeler(getDefaultKademeConfig());\n    setNewScenarioNoKademe(false);\n    kademeBeforeNoKademeRef.current = null;\n    setNewScenarioInputCurrency(\"USD\");\n    setNewScenarioLocalCurrencyCode(\"\");\n    setNewScenarioFxUsdToLocal(\"\");\n    setNewScenarioProgramType(null);\n    setNewScenarioStep(0);\n  }\n\n  function closeScenarioWizard() {\n    setErr(\"\");\n    setScenarioWizardOpen(false);\n    setScenarioWizardLoading(false);\n    setScenarioWizardSaving(false);\n    setNewScenarioStep(0);\n  }\n\n  function openScenarioWizardCreate() {\n    if (!canCreateScenario) return;\n    if (!selectedSchoolId) {\n      setErr(\"Once okul secin.\");\n      return;\n    }\n    setErr(\"\");\n    resetScenarioWizard();\n    setScenarioWizardMode(\"create\");\n    setScenarioWizardScenario(null);\n    setScenarioWizardOpen(true);\n  }\n\n  async function openScenarioWizardEdit(scenarioId) {\n    if (!canEditScenarioPlan) return;\n    if (!selectedSchoolId) return;\n    setErr(\"\");\n    const targetScenario = scenarios.find((s) => String(s.id) === String(scenarioId));\n    if (targetScenario && isScenarioLocked(targetScenario)) {\n      setErr(\"Senaryo onayda veya onaylandi, duzenlenemez.\");\n      return;\n    }\n    setSelectedScenarioIdLocal(scenarioId);\n    setScenarioWizardMode(\"edit\");\n    setScenarioWizardScenario(null);\n    setScenarioWizardOpen(true);\n    setScenarioWizardLoading(true);\n    setNewScenarioStep(0);\n    try {\n      const data = await api.getScenarioInputs(selectedSchoolId, scenarioId);\n      const scenario = data?.scenario;\n      if (!scenario) throw new Error(\"Senaryo bulunamadi.\");\n      setScenarioWizardScenario(scenario);\n      setNewScenarioName(scenario.name || \"\");\n      const years = parseAcademicYear(scenario.academic_year);\n      if (years.startYear && years.endYear && years.endYear !== years.startYear) {\n        setNewScenarioPeriod(\"split\");\n        setNewScenarioStartYear(String(years.startYear));\n        setNewScenarioEndYear(String(years.endYear));\n      } else if (years.startYear) {\n        setNewScenarioPeriod(\"full\");\n        setNewScenarioStartYear(String(years.startYear));\n        setNewScenarioEndYear(String(years.startYear + 1));\n      } else {\n        setNewScenarioPeriod(\"split\");\n        setNewScenarioStartYear(DEFAULT_START_YEAR);\n        setNewScenarioEndYear(DEFAULT_END_YEAR);\n      }\n      const existingKademe = data?.inputs?.temelBilgiler?.kademeler;\n      const normalizedKademe = existingKademe\n        ? normalizeKademeConfig(existingKademe)\n        : getDefaultKademeConfig();\n      const hasAnyEnabled = Object.values(normalizedKademe).some((row) => row && row.enabled);\n      setNewScenarioKademeler(normalizedKademe);\n      setNewScenarioNoKademe(!hasAnyEnabled);\n      kademeBeforeNoKademeRef.current = hasAnyEnabled ? structuredClone(normalizedKademe) : null;\n      const scenarioCurrency = scenario.input_currency || \"USD\";\n      setNewScenarioInputCurrency(scenarioCurrency);\n      setNewScenarioLocalCurrencyCode(scenario.local_currency_code || \"\");\n      setNewScenarioFxUsdToLocal(\n        scenario.fx_usd_to_local != null ? String(scenario.fx_usd_to_local) : \"\"\n      );\n      setNewScenarioProgramType(scenario.program_type || PROGRAM_TYPES.LOCAL);\n    } catch (e) {\n      setErr(e.message || \"Senaryo yuklenemedi.\");\n      setScenarioWizardOpen(false);\n    } finally {\n      setScenarioWizardLoading(false);\n    }\n  }\n\n  async function submitScenarioWizard() {\n    if (scenarioWizardMode === \"edit\") {\n      await updateScenario();\n      return;\n    }\n    await createScenario();\n  }\n\n  async function createScenario() {\n    if (!selectedSchoolId) return;\n    const name = newScenarioName.trim();\n    if (!name) return;\n    if (!draftAcademicYear) {\n      setErr(\"Lutfen gecerli bir akademik yil girin.\");\n      return;\n    }\n    if (!draftRangeOk) {\n      setErr(\"Bitis yili, baslangic yilindan 1 fazla olmali.\");\n      return;\n    }\n    if (yearConflict) {\n      setErr(\"Bu yil turu icin zaten bir senaryo var. Lutfen baska bir yil secin.\");\n      return;\n    }\n    if (!kademeStepOk) {\n      setErr(\"En az bir kademe secmelisiniz.\");\n      return;\n    }\n    if (newScenarioInputCurrency === \"LOCAL\") {\n      if (!localCodeOk) {\n        setErr(\"Local currency code zorunludur.\");\n        return;\n      }\n      if (!fxOk) {\n        setErr(\"Kur degeri zorunlu ve 0'dan buyuk olmali.\");\n        return;\n      }\n    }\n    setErr(\"\");\n    setScenarioWizardSaving(true);\n    try {\n      const scenarioProgramType = newScenarioProgramType || PROGRAM_TYPES.LOCAL;\n      const baseKademe = normalizeKademeConfig(newScenarioKademeler);\n      const kademeConfig = newScenarioNoKademe\n        ? Object.fromEntries(Object.entries(baseKademe).map(([k, v]) => [k, { ...v, enabled: false }]))\n        : baseKademe;\n      const created = await api.createScenario(selectedSchoolId, {\n        name,\n        academicYear: draftAcademicYear,\n        kademeConfig,\n        inputCurrency: newScenarioInputCurrency,\n        localCurrencyCode: newScenarioInputCurrency === \"LOCAL\" ? normalizedLocalCode : null,\n        fxUsdToLocal: newScenarioInputCurrency === \"LOCAL\" ? newScenarioFxUsdToLocal : null,\n        programType: scenarioProgramType,\n      });\n      await refreshScenarios();\n      setSelectedScenarioIdLocal(created.id);\n      setScenarioWizardOpen(false);\n      setNewScenarioStep(0);\n    } catch (e) {\n      setErr(e.message || \"Senaryo olusturulamadi.\");\n    } finally {\n      setScenarioWizardSaving(false);\n    }\n  }\n\n  async function updateScenario() {\n    if (!selectedSchoolId || !scenarioWizardScenario?.id) return;\n    const name = newScenarioName.trim();\n    if (!name) return;\n    if (!draftAcademicYear) {\n      setErr(\"Lutfen gecerli bir akademik yil girin.\");\n      return;\n    }\n    if (!draftRangeOk) {\n      setErr(\"Bitis yili, baslangic yilindan 1 fazla olmali.\");\n      return;\n    }\n    if (yearConflict) {\n      setErr(\"Bu yil turu icin zaten bir senaryo var. Lutfen baska bir yil secin.\");\n      return;\n    }\n    if (!kademeStepOk) {\n      setErr(\"En az bir kademe secmelisiniz.\");\n      return;\n    }\n    if (scenarioWizardScenario?.input_currency === \"LOCAL\") {\n      if (!localCodeOk) {\n        setErr(\"Local currency code zorunludur.\");\n        return;\n      }\n      if (!fxOk) {\n        setErr(\"Kur degeri zorunlu ve 0'dan buyuk olmali.\");\n        return;\n      }\n    }\n    setErr(\"\");\n    setScenarioWizardSaving(true);\n    try {\n      const scenarioProgramType = newScenarioProgramType || PROGRAM_TYPES.LOCAL;\n      const baseKademe = normalizeKademeConfig(newScenarioKademeler);\n      const kademeConfig = newScenarioNoKademe\n        ? Object.fromEntries(Object.entries(baseKademe).map(([k, v]) => [k, { ...v, enabled: false }]))\n        : baseKademe;\n      await api.updateScenario(selectedSchoolId, scenarioWizardScenario.id, {\n        name,\n        academicYear: draftAcademicYear,\n        kademeConfig,\n        programType: scenarioProgramType,\n        localCurrencyCode:\n          scenarioWizardScenario?.input_currency === \"LOCAL\" ? normalizedLocalCode : undefined,\n        fxUsdToLocal:\n          scenarioWizardScenario?.input_currency === \"LOCAL\" ? newScenarioFxUsdToLocal : undefined,\n      });\n      await refreshScenarios();\n      setSelectedScenarioIdLocal(scenarioWizardScenario.id);\n      setSelectedScenario((prev) =>\n        prev && prev.id === scenarioWizardScenario.id\n          ? {\n            ...prev,\n            name,\n            academic_year: draftAcademicYear,\n            program_type: scenarioProgramType,\n            ...(scenarioWizardScenario?.input_currency === \"LOCAL\"\n              ? { local_currency_code: normalizedLocalCode, fx_usd_to_local: fxValue }\n              : {}),\n          }\n          : prev\n      );\n      setInputs((prev) => {\n        if (!prev || typeof prev !== \"object\") return prev;\n        const next = structuredClone(prev);\n        next.temelBilgiler = next.temelBilgiler || {};\n        next.temelBilgiler.kademeler = kademeConfig;\n        next.temelBilgiler.programType = scenarioProgramType;\n        return next;\n      });\n      setScenarioWizardOpen(false);\n      setNewScenarioStep(0);\n    } catch (e) {\n      setErr(e.message || \"Senaryo guncellenemedi.\");\n    } finally {\n      setScenarioWizardSaving(false);\n    }\n  }\n\n  const updateNewKademe = (key, patch) => {\n    setNewScenarioKademeler((prev) => {\n      const base = normalizeKademeConfig(prev);\n      const next = { ...base, [key]: { ...base[key], ...patch } };\n      return normalizeKademeConfig(next);\n    });\n  };\n\n  const setNoKademeMode = (enabled) => {\n    const nextEnabled = Boolean(enabled);\n    setNewScenarioNoKademe(nextEnabled);\n    setNewScenarioKademeler((prev) => {\n      const base = normalizeKademeConfig(prev);\n      if (nextEnabled) {\n        kademeBeforeNoKademeRef.current = structuredClone(base);\n        return Object.fromEntries(Object.entries(base).map(([k, v]) => [k, { ...v, enabled: false }]));\n      }\n      const restored = kademeBeforeNoKademeRef.current;\n      kademeBeforeNoKademeRef.current = null;\n      return restored ? normalizeKademeConfig(restored) : getDefaultKademeConfig();\n    });\n  };\n\n  const parseFxInput = (value) => {\n    const raw = String(value ?? \"\").trim();\n    if (!raw) return NaN;\n    const normalized = raw.replace(\",\", \".\");\n    const match = normalized.match(/-?\\d+(?:\\.\\d+)?/);\n    if (!match) return NaN;\n    const num = Number.parseFloat(match[0]);\n    return Number.isFinite(num) ? num : NaN;\n  };\n\n  const showCopySelectionMsg = (message) => {\n    if (copySelectionMsgTimerRef.current) {\n      clearTimeout(copySelectionMsgTimerRef.current);\n    }\n    setCopySelectionMsg(message);\n    copySelectionMsgTimerRef.current = setTimeout(() => {\n      setCopySelectionMsg(\"\");\n    }, 2000);\n  };\n\n  const applyPresetSelection = (presetKey) => {\n    setCopySelection(buildDefaultCopySelection(presetKey));\n    setCopySelectionMsg(\"\");\n  };\n\n  const toggleCopySelection = (id, value) => {\n    if (scenarioOpsBusy) return;\n    setCopySelection((prev) => {\n      const base = prev || buildDefaultCopySelection(\"all\");\n      const next = { ...base };\n      if (id === \"hr.ik\" || id === \"expenses.giderler\") {\n        next[\"hr.ik\"] = value;\n        next[\"expenses.giderler\"] = value;\n        showCopySelectionMsg(`IK ve Giderler birlikte ${value ? \"secildi\" : \"kaldirildi\"}.`);\n      } else {\n        next[id] = value;\n      }\n      return enforceIkGiderlerPair(next);\n    });\n  };\n\n  const setCopyTabSelectionAll = (tabKey, value) => {\n    if (scenarioOpsBusy) return;\n    const tab = COPY_SELECT_TABS.find((entry) => entry.key === tabKey);\n    if (!tab) return;\n    setCopySelection((prev) => {\n      const base = prev || buildDefaultCopySelection(\"all\");\n      const next = { ...base };\n      tab.sections.forEach((section) => {\n        next[section.id] = value;\n      });\n      return enforceIkGiderlerPair(next);\n    });\n  };\n\n  function openCopyScenarioModal() {\n    if (!canCopyScenario) return;\n    if (!selectedScenarioIdLocal || !selectedScenario || !inputs) return;\n    if (copyingScenarioId) return;\n    setErr(\"\");\n    setCopyModalError(\"\");\n    setCopySelection(buildDefaultCopySelection(\"all\"));\n    setCopySelectionMsg(\"\");\n    setCopyTargetCurrency(sourceCurrency === \"LOCAL\" ? \"LOCAL\" : \"USD\");\n    setCopyLocalCurrencyCode(\"\");\n    setCopyPlannedFxUsdToLocal(\"\");\n    setCopyFxUsdToLocal(\"\");\n    setCopyModalOpen(true);\n  }\n\n  function closeCopyScenarioModal() {\n    setCopyModalOpen(false);\n    setCopyModalError(\"\");\n  }\n\n  async function confirmCopyScenarioModal() {\n    if (!copySelection) return;\n    if (copyingScenarioId) return;\n    const selection = enforceIkGiderlerPair(copySelection);\n\n    const targetCurrency = String(copyTargetCurrency || sourceCurrency).toUpperCase();\n    let localCurrencyCodeValue = null;\n    let plannedFxUsdToLocalValue = null;\n    let copyFxUsdToLocalValue = null;\n\n    if (sourceCurrency === \"USD\" && targetCurrency === \"LOCAL\") {\n      const normalizedLocalCode = String(copyLocalCurrencyCode || \"\")\n        .toUpperCase()\n        .replace(/[^A-Z0-9]/g, \"\")\n        .slice(0, 10);\n      if (!CURRENCY_CODE_REGEX.test(normalizedLocalCode)) {\n        setCopyModalError(\"Local para birimi kodu gecersiz.\");\n        return;\n      }\n      const plannedFxNumber = parseFxInput(copyPlannedFxUsdToLocal);\n      if (!Number.isFinite(plannedFxNumber) || plannedFxNumber <= 0) {\n        setCopyModalError(\"Gecerli bir kur girilmelidir.\");\n        return;\n      }\n      const copyFxNumber = parseFxInput(copyFxUsdToLocal);\n      if (!Number.isFinite(copyFxNumber) || copyFxNumber <= 0) {\n        setCopyModalError(\"Gecerli bir kopyalama kuru girilmelidir.\");\n        return;\n      }\n      localCurrencyCodeValue = normalizedLocalCode;\n      plannedFxUsdToLocalValue = plannedFxNumber;\n      copyFxUsdToLocalValue = copyFxNumber;\n    }\n\n    if (sourceCurrency === \"LOCAL\" && targetCurrency === \"USD\") {\n      const copyFxNumber = parseFxInput(copyFxUsdToLocal);\n      if (!Number.isFinite(copyFxNumber) || copyFxNumber <= 0) {\n        setCopyModalError(\"Gecerli bir kopyalama kuru girilmelidir.\");\n        return;\n      }\n      copyFxUsdToLocalValue = copyFxNumber;\n    }\n\n    closeCopyScenarioModal();\n    await copySelectedScenario({\n      targetCurrency,\n      localCurrencyCode: localCurrencyCodeValue,\n      plannedFxUsdToLocal: plannedFxUsdToLocalValue,\n      copyFxUsdToLocal: copyFxUsdToLocalValue,\n      selection,\n    });\n  }\n\n  async function copySelectedScenario(copyOptions = {}) {\n    if (!canCopyScenario) return;\n    if (!selectedScenarioIdLocal || !selectedScenario || !inputs) return;\n    if (copyingScenarioId) return;\n    if (!selectedScenario.academic_year) {\n      setErr(\"Akademik yil bulunamadi.\");\n      return;\n    }\n\n    setErr(\"\");\n    const selection = enforceIkGiderlerPair(copyOptions?.selection || buildDefaultCopySelection(\"all\"));\n    if (!!selection[\"hr.ik\"] !== !!selection[\"expenses.giderler\"]) {\n      toast.warn(\"IK ve Giderler birlikte secilmelidir.\");\n      return;\n    }\n    const targetCurrency = String(copyOptions?.targetCurrency || sourceCurrency).toUpperCase();\n    let localCurrencyCode = copyOptions?.localCurrencyCode ?? null;\n    let plannedFxUsdToLocal = copyOptions?.plannedFxUsdToLocal ?? null;\n    let copyFxUsdToLocal = copyOptions?.copyFxUsdToLocal ?? null;\n    let plannedFxParsed = parseFxInput(plannedFxUsdToLocal);\n    let copyFxParsed = parseFxInput(copyFxUsdToLocal);\n\n    if (sourceCurrency === \"LOCAL\" && targetCurrency === \"LOCAL\") {\n      localCurrencyCode = localCurrencyCode ?? selectedScenario.local_currency_code ?? \"\";\n      plannedFxUsdToLocal = plannedFxUsdToLocal ?? selectedScenario.fx_usd_to_local;\n      plannedFxParsed = parseFxInput(plannedFxUsdToLocal);\n    }\n\n    if (sourceCurrency === \"LOCAL\" && targetCurrency === \"USD\") {\n      copyFxUsdToLocal = copyFxUsdToLocal ?? selectedScenario.fx_usd_to_local;\n      copyFxParsed = parseFxInput(copyFxUsdToLocal);\n      if (!Number.isFinite(copyFxParsed) || copyFxParsed <= 0) {\n        toast.warn(\"Gecerli bir kopyalama kuru girilmelidir.\");\n        return;\n      }\n    }\n\n    if (sourceCurrency === \"USD\" && targetCurrency === \"LOCAL\") {\n      if (!localCurrencyCode || !CURRENCY_CODE_REGEX.test(localCurrencyCode)) {\n        toast.warn(\"Local para birimi kodu gecersiz.\");\n        return;\n      }\n      if (!Number.isFinite(plannedFxParsed) || plannedFxParsed <= 0) {\n        toast.warn(\"Gecerli bir kur girilmelidir.\");\n        return;\n      }\n      if (!Number.isFinite(copyFxParsed) || copyFxParsed <= 0) {\n        toast.warn(\"Gecerli bir kopyalama kuru girilmelidir.\");\n        return;\n      }\n    }\n\n    setCopyingScenarioId(selectedScenarioIdLocal);\n    try {\n      const baseName = selectedScenario.name || \"Senaryo\";\n      const copyName = `${baseName} (Kopya)`;\n      let candidateYear = incrementAcademicYearString(selectedScenario.academic_year);\n      if (!candidateYear) {\n        throw new Error(\"Akademik yil formati gecersiz.\");\n      }\n      let guard = 0;\n      const hasAcademicYear = (yearStr) =>\n        scenarios.some((s) => String(s?.academic_year || \"\").trim() === String(yearStr).trim());\n\n      while (hasAcademicYear(candidateYear)) {\n        candidateYear = incrementAcademicYearString(candidateYear);\n        guard += 1;\n        if (!candidateYear || guard > 20) {\n          throw new Error(\"Uygun yeni akademik yil bulunamadi.\");\n        }\n      }\n\n      const shouldCopyCore = !!selection[\"temel.core\"];\n      const kademeConfig = normalizeKademeConfig(\n        shouldCopyCore ? inputs?.temelBilgiler?.kademeler || getDefaultKademeConfig() : getDefaultKademeConfig()\n      );\n      const programType = shouldCopyCore\n        ? selectedScenario?.program_type || PROGRAM_TYPES.LOCAL\n        : PROGRAM_TYPES.LOCAL;\n      const fxForCreate =\n        targetCurrency === \"LOCAL\" && Number.isFinite(plannedFxParsed) && plannedFxParsed > 0\n          ? plannedFxParsed\n          : null;\n      const created = await api.createScenario(selectedSchoolId, {\n        name: copyName,\n        academicYear: candidateYear,\n        kademeConfig,\n        inputCurrency: targetCurrency,\n        localCurrencyCode: targetCurrency === \"LOCAL\" ? localCurrencyCode || \"\" : null,\n        fxUsdToLocal: fxForCreate,\n        programType,\n      });\n\n      let clonedInputs = filterInputsForCopyBySelection(inputs, selection);\n      if (selection[\"hr.ik\"] && selection[\"expenses.giderler\"]) {\n        clonedInputs = applyIkSalariesToGiderler(clonedInputs);\n      }\n      clonedInputs = normalizeTemelBilgilerInputs(clonedInputs);\n      clonedInputs = normalizeCapacityInputs(clonedInputs);\n      clonedInputs = normalizeGradesInputs(clonedInputs);\n\n      if (sourceCurrency === \"USD\" && targetCurrency === \"LOCAL\") {\n        clonedInputs = convertInputsUsdToLocalForCopy(clonedInputs, copyFxParsed);\n        clonedInputs.temelBilgiler = clonedInputs.temelBilgiler || {};\n        clonedInputs.temelBilgiler.performans = clonedInputs.temelBilgiler.performans || {};\n        clonedInputs.temelBilgiler.performans.prevYearRealizedFxUsdToLocal = Number(copyFxParsed);\n      }\n\n      if (sourceCurrency === \"LOCAL\" && targetCurrency === \"USD\") {\n        clonedInputs = convertInputsLocalToUsdForCopy(clonedInputs, copyFxParsed);\n        clonedInputs.temelBilgiler = clonedInputs.temelBilgiler || {};\n        clonedInputs.temelBilgiler.performans = clonedInputs.temelBilgiler.performans || {};\n        clonedInputs.temelBilgiler.performans.prevYearRealizedFxUsdToLocal = Number(copyFxParsed);\n      }\n\n      // Determine which permission resources are modified based on the user's selection.  The\n      // backend requires a list of modifiedResources for nonadmin users to enforce\n      // granular write permissions.  Without this list, principals and managers\n      // would be blocked from copying scenarios.  See COPY_SECTION_RESOURCES\n      // mapping above for how selection keys map to permission resources.\n      const modifiedResources = buildModifiedResourcesFromCopySelection(selection);\n      await api.saveScenarioInputs(selectedSchoolId, created.id, clonedInputs, modifiedResources);\n\n      if (selection[\"norm.lessonY1\"]) {\n        try {\n          const sourceNorm = await api.getNormConfig(selectedSchoolId, selectedScenarioIdLocal);\n          if (sourceNorm) {\n            const sourceYears = sourceNorm?.years && typeof sourceNorm.years === \"object\" ? sourceNorm.years : {};\n            const baseHours = Number(\n              sourceYears?.y1?.teacherWeeklyMaxHours ??\n                sourceNorm?.teacherWeeklyMaxHours ??\n                24\n            );\n            const y1 = sourceYears?.y1\n              ? structuredClone(sourceYears.y1)\n              : {\n                teacherWeeklyMaxHours: Number.isFinite(baseHours) && baseHours > 0 ? baseHours : 24,\n                curriculumWeeklyHours:\n                  sourceNorm?.curriculumWeeklyHours && typeof sourceNorm.curriculumWeeklyHours === \"object\"\n                    ? structuredClone(sourceNorm.curriculumWeeklyHours)\n                    : buildEmptyNormCurriculum(),\n              };\n            const payload = {\n              years: {\n                y1,\n                y2: buildEmptyNormYear(baseHours),\n                y3: buildEmptyNormYear(baseHours),\n              },\n            };\n            await api.saveNormConfig(selectedSchoolId, created.id, payload);\n          }\n        } catch (err) {\n          console.warn(\"[copyScenario] norm copy skipped\", err);\n        }\n      }\n\n      await refreshScenarios();\n      setSelectedScenarioIdLocal(created.id);\n      toast.success(\"Senaryo kopyalandi.\");\n    } catch (e) {\n      setErr(e.message || \"Scenario copy failed\");\n    } finally {\n      setCopyingScenarioId(null);\n    }\n  }\n\n  function openDeleteScenarioModal(scenarioId) {\n    if (!canDeleteScenario) return;\n    if (!scenarioId || scenarioOpsBusy) return;\n    setDeleteConfirmScenarioId(scenarioId);\n  }\n\n  async function confirmDeleteScenario() {\n    if (!deleteConfirmScenarioId) return;\n    const scenarioId = deleteConfirmScenarioId;\n    setDeleteConfirmScenarioId(null);\n    await deleteScenario(scenarioId);\n  }\n\n  async function deleteScenario(scenarioId) {\n    if (!canDeleteScenario) return;\n    if (!selectedSchoolId || !scenarioId) return;\n    if (scenarioOpsBusy) return;\n    const target = scenarios.find((s) => String(s.id) === String(scenarioId));\n    if (!target) return;\n    if (isScenarioLocked(target)) {\n      setErr(\"Senaryo onayda veya onaylandi, silinemez.\");\n      return;\n    }\n\n    setErr(\"\");\n    setDeletingScenarioId(scenarioId);\n    try {\n      await api.deleteScenario(selectedSchoolId, scenarioId);\n      const sc = await refreshScenarios();\n      if (Array.isArray(sc)) {\n        if (!sc.length) {\n          setSelectedScenarioIdLocal(null);\n          setInputs(null);\n          setReport(null);\n        } else if (!sc.some((s) => String(s.id) === String(selectedScenarioIdLocal))) {\n          setSelectedScenarioIdLocal(sc[0].id);\n        }\n      }\n      toast.success(\"Senaryo silindi.\");\n    } catch (e) {\n      setErr(e.message || \"Senaryo silinemedi.\");\n    } finally {\n      setDeletingScenarioId(null);\n    }\n  }\n\n  function sumPlannedStudents(grades) {\n    const list = Array.isArray(grades) ? grades : [];\n    let sum = 0;\n    for (const row of list) {\n      const n = Number(row?.studentsPerBranch ?? 0);\n      if (Number.isFinite(n)) sum += n;\n    }\n    return sum;\n  }\n\n  function getPlannedStudentTotalsByYear(srcInputs) {\n    const s = srcInputs && typeof srcInputs === \"object\" ? srcInputs : {};\n    const years = s.gradesYears && typeof s.gradesYears === \"object\" ? s.gradesYears : {};\n    return {\n      y1: sumPlannedStudents(Array.isArray(years.y1) ? years.y1 : s.grades),\n      y2: sumPlannedStudents(years.y2),\n      y3: sumPlannedStudents(years.y3),\n    };\n  }\n\n  function showBlockingToast(message, toastId = \"blocking-toast\") {\n    toast.warn(message, {\n      toastId,\n      position: \"bottom-right\",\n      autoClose: false,\n      closeOnClick: false,\n      draggable: true,\n      icon: \"!\",\n      style: {\n        background: \"rgba(15, 23, 42, 0.96)\",\n        color: \"#f8fafc\",\n        border: \"1px solid rgba(251, 191, 36, 0.35)\",\n        boxShadow: \"0 18px 40px rgba(0,0,0,.28)\",\n        borderRadius: 14,\n      },\n    });\n  }\n\n  function ensurePlanningStudentsForY2Y3(actionLabel = \"Islem\") {\n    if (!inputs) return true;\n    if (isHeadquarterScenario(inputs)) return true;\n\n    const totals = getPlannedStudentTotalsByYear(inputs);\n    const missing = [];\n    if (!(totals.y2 > 0)) missing.push(\"Y2\");\n    if (!(totals.y3 > 0)) missing.push(\"Y3\");\n    if (!missing.length) return true;\n\n    const msg =\n      `${actionLabel} yapilamaz: Norm > Planlanan Donem Bilgileri bolumunde ` +\n      `${missing.join(\" ve \")} toplam ogrenci 0 gorunuyor. Lutfen Y2/Y3 ogrenci sayilarini girin.`;\n\n    setErr(\"\");\n    showBlockingToast(msg, \"norm-y2y3-missing\");\n    return false;\n  }\n\n  function ensurePrevRealFxForLocal(actionLabel = \"Islem\") {\n    if (!inputs) return true;\n    if (!isLocalScenario) return true;\n    if (!prevRealFxMissing) return true;\n\n    const msg =\n      `${actionLabel} yapilamaz: Temel Bilgiler > Performans alanindaki ` +\n      `\"Onceki Donem Ortalama Kur (Gerceklesen)\" girilmelidir.`;\n\n    setErr(\"\");\n    showBlockingToast(msg, \"prev-realized-fx-missing\");\n    return false;\n  }\n\n  async function calculate(options = {}) {\n    if (!selectedSchoolId || !selectedScenarioIdLocal) return false;\n    if (!ensurePrevRealFxForLocal(\"Hesaplama\")) return false;\n    if (!options.skipPlanValidation && !ensurePlanningStudentsForY2Y3(\"Hesaplama\")) return false;\n    setCalculating(true);\n    setErr(\"\");\n    let ok = false;\n    try {\n      const data = await api.calculateScenario(selectedSchoolId, selectedScenarioIdLocal);\n      setReport(data.results);\n      ok = true;\n    } catch (e) {\n      setErr(e.message || \"Calculation failed\");\n    } finally {\n      setCalculating(false);\n    }\n    return ok;\n  }\n\n  async function ensureScenarioProgressComplete(scenarioId, actionLabel = \"Gonderme\") {\n    let pct = null;\n    const cached = scenarioProgressMap?.[scenarioId];\n    if (cached && !cached.error) {\n      const n = Number(cached.pct ?? 0);\n      if (Number.isFinite(n)) pct = n;\n    }\n\n    if (!Number.isFinite(pct)) {\n      try {\n        if (selectedSchoolId) {\n          const data = await api.getScenarioProgress(selectedSchoolId, scenarioId);\n          const progress = data?.progress;\n          const n = Number(progress?.pct ?? 0);\n          if (Number.isFinite(n)) pct = n;\n        }\n      } catch (_) {\n        // ignore; handle below\n      }\n    }\n\n    if (!Number.isFinite(pct) || pct < 100) {\n      const msg = `${actionLabel} yapilamaz: Ilerleme %100 degil.`;\n      toast.warn(msg);\n      return false;\n    }\n    return true;\n  }\n\n  async function submitScenarioForApproval(scenarioId) {\n    if (!canSubmitScenario) return;\n    if (!selectedSchoolId || !scenarioId || String(scenarioId) !== String(selectedScenarioIdLocal)) return;\n    const status = String(selectedRowScenario?.status || selectedScenario?.status || \"draft\");\n    if (![\"draft\", \"revision_requested\"].includes(status)) {\n      setErr(\"Senaryo onayda veya onaylandi, gonderilemez.\");\n      return;\n    }\n    if (!ensurePrevRealFxForLocal(\"Onaya gonderme\")) return;\n    if (!ensurePlanningStudentsForY2Y3(\"Onaya gonderme\")) return;\n    if (submittingScenarioId) return;\n    const progressOk = await ensureScenarioProgressComplete(scenarioId, \"Onaya gonderme\");\n    if (!progressOk) return;\n\n    setErr(\"\");\n    setSubmittingScenarioId(scenarioId);\n    try {\n      const calcOk = await calculate({ keepTab: true });\n      if (!calcOk) return;\n      const workData = await api.listWorkItems(selectedSchoolId, scenarioId);\n      const requiredWorkIds = Array.isArray(workData?.requiredWorkIds) ? workData.requiredWorkIds : [];\n      const workItems = Array.isArray(workData?.workItems) ? workData.workItems : [];\n      const workItemMap = new Map(workItems.map((item) => [String(item.work_id), item]));\n      const toSubmit = requiredWorkIds.filter((wid) => {\n        const item = workItemMap.get(String(wid));\n        const state = String(item?.state || \"not_started\");\n        return [\"not_started\", \"in_progress\", \"needs_revision\"].includes(state);\n      });\n\n      if (toSubmit.length === 0) {\n        toast.warn(\"Gonderilecek modul yok.\");\n      } else {\n        const results = await Promise.allSettled(\n          toSubmit.map((wid) => api.submitWorkItem(selectedSchoolId, scenarioId, wid))\n        );\n        const failed = results.filter((r) => r.status === \"rejected\");\n        if (failed.length) {\n          const firstErr = failed[0]?.reason;\n          toast.error(firstErr?.message || \"Moduller gonderilemedi.\");\n        } else {\n          toast.success(\"Moduller onaya gonderildi.\");\n        }\n      }\n      const rows = await refreshScenarios();\n      if (Array.isArray(rows)) {\n        const match = rows.find((row) => String(row.id) === String(scenarioId));\n        if (match) {\n          setSelectedScenario((prev) => (prev ? { ...prev, ...match } : prev));\n        }\n      }\n    } catch (e) {\n      setErr(e.message || \"Gonderme basarisiz\");\n    } finally {\n      setSubmittingScenarioId(null);\n    }\n  }\n\n  const deleteConfirmScenario =\n    deleteConfirmScenarioId != null\n      ? scenarios.find((s) => String(s.id) === String(deleteConfirmScenarioId))\n      : null;\n  const deleteConfirmLabel = deleteConfirmScenario?.name\n    ? `\"${deleteConfirmScenario.name}\"`\n    : \"Senaryo\";\n  const deleteConfirmMessage =\n    deleteConfirmScenarioId != null &&\n      String(deleteConfirmScenarioId) === String(selectedScenarioIdLocal) &&\n      scenarios.length <= 1\n      ? `${deleteConfirmLabel} son senaryo. Silerseniz senaryo secimi temizlenir.`\n      : `${deleteConfirmLabel} silinecek. Devam edilsin mi?`;\n\n  const handleApply = () => {\n    if (!selectedSchoolId || !selectedScenarioIdLocal) return;\n    // Persist the selected scenario. Regardless of which scenario the user\n    // chooses, navigate to the globally last viewed sidebar page. This ensures\n    // that when switching schools or scenarios the user lands on the same\n    // section (e.g. Gelirler). If no global route has been recorded, default\n    // to the \"temel-bilgiler\" page.\n    // Persist the selected scenario for the chosen school.  Also write\n    // the last active school ID so that the sidebar can immediately\n    // render navigation items without requiring a page refresh.  Without\n    // this call, users have reported that the nav menu only appears\n    // after refreshing the page.  See issue reported by testers.\n    writeSelectedScenarioId(selectedSchoolId, selectedScenarioIdLocal);\n    writeLastActiveSchoolId(selectedSchoolId);\n    const seg = readGlobalLastRouteSegment() || \"temel-bilgiler\";\n    navigate(`/schools/${selectedSchoolId}/${seg}`, { replace: true });\n  };\n\n  return (\n    <div className=\"container select-page\">\n      <ToastContainer position=\"bottom-right\" autoClose={3500} newestOnTop closeOnClick pauseOnFocusLoss pauseOnHover hideProgressBar theme=\"dark\" />\n      <style>{`@keyframes schoolSpin{to{transform:rotate(360deg)}}`}</style>\n\n      {err ? (\n        <div className=\"card\" style={{ marginTop: 10, background: \"#fff1f2\", borderColor: \"#fecaca\" }}>\n          {err}\n        </div>\n      ) : null}\n\n      {deleteConfirmScenarioId ? (\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\n          <div className=\"modal\">\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Senaryo Sil</div>\n            <div className=\"small\">{deleteConfirmMessage}</div>\n            <div className=\"row\" style={{ justifyContent: \"flex-end\", marginTop: 12 }}>\n              <button className=\"btn\" onClick={() => setDeleteConfirmScenarioId(null)} disabled={scenarioOpsBusy}>\n                Iptal\n              </button>\n              <button className=\"btn danger\" onClick={confirmDeleteScenario} disabled={scenarioOpsBusy}>\n                Sil\n              </button>\n            </div>\n          </div>\n        </div>\n      ) : null}\n\n      {copyModalOpen ? (\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\n          <div\n            className=\"modal\"\n            style={{\n              width: \"min(980px, 96vw)\",\n              maxHeight: \"86vh\",\n              overflowY: \"auto\",\n            }}\n          >\n            <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\n              <div style={{ fontWeight: 700 }}>Senaryo Kopyalama</div>\n              <button className=\"btn\" onClick={closeCopyScenarioModal} disabled={scenarioOpsBusy}>\n                Kapat\n              </button>\n            </div>\n            <div className=\"small\" style={{ marginTop: 6 }}>\n              Yeni senaryo icin para birimini secin.\n            </div>\n\n            {copyModalError ? (\n              <div className=\"card\" style={{ marginTop: 10, background: \"#fff1f2\", borderColor: \"#fecaca\" }}>\n                {copyModalError}\n              </div>\n            ) : null}\n\n            <div style={{ marginTop: 12 }}>\n              <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Para Birimi</div>\n              <div className=\"row\" style={{ gap: 12, alignItems: \"center\" }}>\n                <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\n                  <input\n                    type=\"radio\"\n                    name=\"copy-currency\"\n                    checked={copyTargetCurrency === \"USD\"}\n                    onChange={() => {\n                      setCopyTargetCurrency(\"USD\");\n                      setCopyModalError(\"\");\n                    }}\n                  />\n                  <span>USD</span>\n                </label>\n                <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\n                  <input\n                    type=\"radio\"\n                    name=\"copy-currency\"\n                    checked={copyTargetCurrency === \"LOCAL\"}\n                    onChange={() => {\n                      setCopyTargetCurrency(\"LOCAL\");\n                      setCopyModalError(\"\");\n                    }}\n                  />\n                  <span>LOCAL</span>\n                </label>\n              </div>\n            </div>\n\n            {sourceCurrency === \"USD\" && copyTargetCurrency === \"LOCAL\" ? (\n              <div style={{ marginTop: 12 }}>\n                <div className=\"row\" style={{ gap: 8, alignItems: \"center\" }}>\n                  <div className=\"small\" style={{ fontWeight: 700 }}>Local currency code</div>\n                  <input\n                    className=\"input sm\"\n                    list=\"local-currency-codes-copy\"\n                    placeholder=\"TRY\"\n                    value={copyLocalCurrencyCode}\n                    onChange={(e) =>\n                      setCopyLocalCurrencyCode(\n                        e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, \"\").slice(0, 10)\n                      )\n                    }\n                  />\n                  <datalist id=\"local-currency-codes-copy\">\n                    {LOCAL_CURRENCY_OPTIONS.map((code) => (\n                      <option key={code} value={code} />\n                    ))}\n                  </datalist>\n                </div>\n\n                <div className=\"row\" style={{ gap: 8, alignItems: \"center\", marginTop: 10 }}>\n                  <span>1 USD =</span>\n                  <input\n                    className=\"input sm\"\n                    type=\"number\"\n                    step=\"0.000001\"\n                    value={copyPlannedFxUsdToLocal}\n                    onChange={(e) => setCopyPlannedFxUsdToLocal(e.target.value)}\n                  />\n                  <span>{copyLocalCurrencyCode || \"LOCAL\"}</span>\n                </div>\n                <div className=\"small muted\" style={{ marginTop: 6 }}>\n                  Planlanan kur (senaryo ayarlari icin).\n                </div>\n\n                <div className=\"row\" style={{ gap: 8, alignItems: \"center\", marginTop: 10 }}>\n                  <span>Kopyalama kuru:</span>\n                  <input\n                    className=\"input sm\"\n                    type=\"number\"\n                    step=\"0.000001\"\n                    value={copyFxUsdToLocal}\n                    onChange={(e) => setCopyFxUsdToLocal(e.target.value)}\n                  />\n                  <span>{copyLocalCurrencyCode || \"LOCAL\"}</span>\n                </div>\n                <div className=\"small muted\" style={{ marginTop: 6 }}>\n                  Kopyalama kuruna gore tum rakamlar cevrilir.\n                </div>\n              </div>\n            ) : null}\n\n            {sourceCurrency === \"LOCAL\" && copyTargetCurrency === \"USD\" ? (\n              <div style={{ marginTop: 12 }}>\n                <div className=\"row\" style={{ gap: 8, alignItems: \"center\" }}>\n                  <span>1 USD =</span>\n                  <input\n                    className=\"input sm\"\n                    type=\"number\"\n                    step=\"0.000001\"\n                    value={copyFxUsdToLocal}\n                    onChange={(e) => setCopyFxUsdToLocal(e.target.value)}\n                  />\n                  <span>{inputCurrencyCode}</span>\n                </div>\n                <div className=\"small muted\" style={{ marginTop: 6 }}>\n                  Kopyalama kuru (LOCAL -&gt; USD).\n                </div>\n              </div>\n            ) : null}\n\n            {copySelectionMsg ? (\n              <div className=\"small\" style={{ marginTop: 10, color: \"#0369a1\" }}>\n                {copySelectionMsg}\n              </div>\n            ) : null}\n\n            <div style={{ marginTop: 16 }}>\n              <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\n                <div style={{ fontWeight: 700 }}>Kopyalanacak Bolumler</div>\n                <div className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\n                  <div className=\"small muted\">Secili: {selectedCopyCount}</div>\n                  <button\n                    type=\"button\"\n                    className=\"btn\"\n                    onClick={() => applyPresetSelection(\"all\")}\n                    disabled={scenarioOpsBusy}\n                  >\n                    Tumu\n                  </button>\n                  <button\n                    type=\"button\"\n                    className=\"btn\"\n                    onClick={() => applyPresetSelection(\"structure\")}\n                    disabled={scenarioOpsBusy}\n                  >\n                    Yapisi\n                  </button>\n                  <button\n                    type=\"button\"\n                    className=\"btn\"\n                    onClick={() => applyPresetSelection(\"financial\")}\n                    disabled={scenarioOpsBusy}\n                  >\n                    Finans\n                  </button>\n                </div>\n              </div>\n\n              <div style={{ marginTop: 10, display: \"grid\", gap: 12, gridTemplateColumns: \"repeat(auto-fit, minmax(240px, 1fr))\" }}>\n                {COPY_SELECT_TABS.map((tab) => (\n                  <div key={tab.key} className=\"card\" style={{ padding: 12 }}>\n                    <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\n                      <div style={{ fontWeight: 700 }}>{tab.label}</div>\n                      <div className=\"row\" style={{ gap: 4 }}>\n                        <button\n                          type=\"button\"\n                          className=\"btn\"\n                          style={{ padding: \"2px 6px\", fontSize: 12 }}\n                          onClick={() => setCopyTabSelectionAll(tab.key, true)}\n                          disabled={scenarioOpsBusy}\n                        >\n                          Tumu\n                        </button>\n                        <button\n                          type=\"button\"\n                          className=\"btn\"\n                          style={{ padding: \"2px 6px\", fontSize: 12 }}\n                          onClick={() => setCopyTabSelectionAll(tab.key, false)}\n                          disabled={scenarioOpsBusy}\n                        >\n                          Temizle\n                        </button>\n                      </div>\n                    </div>\n                    <div style={{ marginTop: 8, display: \"flex\", flexDirection: \"column\", gap: 6 }}>\n                      {tab.sections.map((section) => (\n                        <label key={section.id} className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\n                          <input\n                            type=\"checkbox\"\n                            checked={!!copySelection?.[section.id]}\n                            onChange={(e) => toggleCopySelection(section.id, e.target.checked)}\n                            disabled={scenarioOpsBusy}\n                          />\n                          <span className=\"small\">{section.label}</span>\n                        </label>\n                      ))}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            <div className=\"row\" style={{ justifyContent: \"flex-end\", marginTop: 14 }}>\n              <button className=\"btn\" onClick={closeCopyScenarioModal} disabled={scenarioOpsBusy}>\n                Iptal\n              </button>\n              <button\n                className=\"btn primary\"\n                onClick={confirmCopyScenarioModal}\n                disabled={scenarioOpsBusy || copyingScenarioId || !copySelection || !isIkGiderlerValid}\n              >\n                {copyingScenarioId ? (\n                  <span style={{ display: \"inline-flex\", gap: 6, alignItems: \"center\" }}>\n                    <InlineSpinner />\n                    <span>Kopyalaniyor...</span>\n                  </span>\n                ) : (\n                  \"Tamam\"\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      ) : null}\n\n      {expenseSplitOpen ? (\n        <ExpenseSplitModal\n          open={expenseSplitOpen}\n          onClose={() => setExpenseSplitOpen(false)}\n          onApplied={handleExpenseSplitApplied}\n          sourceScenario={selectedRowScenario}\n          sourceSchoolId={selectedSchoolId}\n          sourceSchoolName={selectedSchoolName}\n        />\n      ) : null}\n\n      {bulkSendOpen ? (\n        <CountrySendModal\n          open={bulkSendOpen}\n          onClose={() => setBulkSendOpen(false)}\n          countryId={auth.user?.country_id}\n        />\n      ) : null}\n\n      {scenarioWizardOpen ? (\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\n          <div className=\"modal scenario-wizard-modal\">\n            <div className=\"scenario-wizard-header\">\n              <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\n                <div style={{ fontWeight: 700 }}>\n                  {scenarioWizardMode === \"edit\" ? \"Senaryo Kurulumunu Duzenle\" : \"Yeni Senaryo Kurulumu\"}\n                </div>\n                <button\n                  className=\"btn\"\n                  onClick={closeScenarioWizard}\n                  disabled={scenarioWizardSaving || scenarioWizardLoading}\n                >\n                  Kapat\n                </button>\n              </div>\n              <div className=\"small\" style={{ marginTop: 6 }}>\n                {scenarioWizardMode === \"edit\"\n                  ? \"Senaryo ayarlarini guncelleyip kaydedebilirsiniz.\"\n                  : \"Adim adim kurulum tamamlayin.\"}\n              </div>\n            </div>\n            <div className=\"scenario-wizard-body\">\n              {err ? (\n                <div className=\"card\" style={{ marginTop: 10, background: \"#fff1f2\", borderColor: \"#fecaca\" }}>\n                  {err}\n                </div>\n              ) : null}\n\n              {scenarioWizardLoading ? (\n                <div className=\"card\" style={{ marginTop: 12 }}>Yukleniyor...</div>\n              ) : (\n                <div style={{ marginTop: 12 }}>\n                  <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\n                    <div style={{ fontWeight: 700 }}>Kurulum Adimi</div>\n                    <div className=\"small\">{`Adim ${newScenarioStep + 1} / ${scenarioStepTotal}: ${scenarioStepLabels[newScenarioStep]}`}</div>\n                  </div>\n\n                  {newScenarioStep === 0 && (\n                    <div style={{ marginTop: 10 }}>\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Donem Turu</div>\n                      <div className=\"row\" style={{ gap: 12, alignItems: \"center\" }}>\n                        <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\n                          <input\n                            type=\"radio\"\n                            name=\"scenario-period\"\n                            checked={newScenarioPeriod === \"full\"}\n                            onChange={() => handleScenarioPeriodChange(\"full\")}\n                          />\n                          <span>Tam Yil (tek yil)</span>\n                        </label>\n                        <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\n                          <input\n                            type=\"radio\"\n                            name=\"scenario-period\"\n                            checked={newScenarioPeriod === \"split\"}\n                            onChange={() => handleScenarioPeriodChange(\"split\")}\n                          />\n                          <span>Yil ortasinda baslar, sonraki yil biter</span>\n                        </label>\n                      </div>\n                    </div>\n                  )}\n\n                  {newScenarioStep === 1 && (\n                    <div style={{ marginTop: 10 }}>\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Para Birimi</div>\n                      <div className=\"row\" style={{ gap: 12, alignItems: \"center\" }}>\n                        <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\n                          <input\n                            type=\"radio\"\n                            name=\"scenario-currency\"\n                            checked={newScenarioInputCurrency === \"USD\"}\n                            onChange={() => handleScenarioCurrencyChange(\"USD\")}\n                            disabled={scenarioWizardMode === \"edit\"}\n                          />\n                          <span>USD</span>\n                        </label>\n                        <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\n                          <input\n                            type=\"radio\"\n                            name=\"scenario-currency\"\n                            checked={newScenarioInputCurrency === \"LOCAL\"}\n                            onChange={() => handleScenarioCurrencyChange(\"LOCAL\")}\n                            disabled={scenarioWizardMode === \"edit\"}\n                          />\n                          <span>Local currency</span>\n                        </label>\n                      </div>\n\n                      {newScenarioInputCurrency === \"LOCAL\" && (\n                        <div style={{ marginTop: 10 }}>\n                          <div className=\"row\" style={{ gap: 8, alignItems: \"center\" }}>\n                            <div className=\"small\" style={{ fontWeight: 700 }}>Local currency code</div>\n                            <input\n                              className=\"input sm\"\n                              list=\"local-currency-codes\"\n                              placeholder=\"TRY\"\n                              value={newScenarioLocalCurrencyCode}\n                              onChange={(e) =>\n                                setNewScenarioLocalCurrencyCode(\n                                  e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, \"\").slice(0, 10)\n                                )\n                              }\n                            />\n                            <datalist id=\"local-currency-codes\">\n                              {LOCAL_CURRENCY_OPTIONS.map((code) => (\n                                <option key={code} value={code} />\n                              ))}\n                            </datalist>\n                          </div>\n                          {!localCodeOk ? (\n                            <div className=\"small\" style={{ color: \"#b91c1c\", marginTop: 6 }}>\n                              Code 2-10 chars, A-Z0-9.\n                            </div>\n                          ) : null}\n\n                          <div className=\"row\" style={{ gap: 8, alignItems: \"center\", marginTop: 10 }}>\n                            <span>1 USD =</span>\n                            <input\n                              className=\"input sm\"\n                              type=\"number\"\n                              step=\"0.000001\"\n                              value={newScenarioFxUsdToLocal}\n                              onChange={(e) => setNewScenarioFxUsdToLocal(e.target.value)}\n                            />\n                            <span>{normalizedLocalCode || \"LOCAL\"}</span>\n                          </div>\n                          {!fxOk ? (\n                            <div className=\"small\" style={{ color: \"#b91c1c\", marginTop: 6 }}>\n                              FX rate must be &gt; 0.\n                            </div>\n                          ) : null}\n                          <div className=\"small muted\" style={{ marginTop: 6 }}>\n                            Kur formati: 1 USD = X LOCAL\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                  {newScenarioStep === 2 && (\n                    <div style={{ marginTop: 10 }}>\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Program Turu</div>\n                      <div className=\"row\" style={{ gap: 12 }}>\n                        {[\n                          {\n                            key: PROGRAM_TYPES.LOCAL,\n                            label: \"Yerel\",\n                            hint: \"Yerel kademeleri planlayin\",\n                          },\n                          {\n                            key: PROGRAM_TYPES.INTERNATIONAL,\n                            label: \"International\",\n                            hint: \"Uluslararasi kademeleri planlayin\",\n                          },\n                        ].map((option) => (\n                          <button\n                            key={option.key}\n                            type=\"button\"\n                            className={`btn ${newScenarioProgramType === option.key ? \"primary\" : \"ghost\"}`}\n                            aria-pressed={newScenarioProgramType === option.key}\n                            onClick={() => setNewScenarioProgramType(option.key)}\n                          >\n                            <div style={{ fontWeight: 700 }}>{option.label}</div>\n                            <div className=\"small\" style={{ opacity: 0.75 }}>{option.hint}</div>\n                          </button>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  {newScenarioStep === 3 && (\n                    <div style={{ marginTop: 10 }}>\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Yil</div>\n                      {newScenarioPeriod === \"full\" ? (\n                        <input\n                          className=\"input sm num-spin\"\n                          type=\"number\"\n                          step=\"1\"\n                          placeholder={DEFAULT_START_YEAR}\n                          value={newScenarioStartYear}\n                          onChange={(e) => handleScenarioStartYearChange(e.target.value)}\n                        />\n                      ) : (\n                        <div className=\"row\" style={{ gap: 8, alignItems: \"center\" }}>\n                          <input\n                            className=\"input sm num-spin\"\n                            type=\"number\"\n                            step=\"1\"\n                            placeholder={DEFAULT_START_YEAR}\n                            value={newScenarioStartYear}\n                            onChange={(e) => handleScenarioStartYearChange(e.target.value)}\n                          />\n                          <span className=\"muted\">-</span>\n                          <input\n                            className=\"input sm num-spin\"\n                            type=\"number\"\n                            step=\"1\"\n                            placeholder={DEFAULT_END_YEAR}\n                            value={newScenarioEndYear}\n                            readOnly\n                          />\n                        </div>\n                      )}\n                      <div className=\"small muted\" style={{ marginTop: 6 }}>\n                        Akademik yil: {draftAcademicYear || \"-\"}\n                        {newScenarioPeriod === \"split\" && draftAcademicYear && !draftRangeOk ? (\n                          <span style={{ color: \"#b91c1c\", marginLeft: 8 }}>\n                            Bitis yili, baslangic yilindan 1 fazla olmali.\n                          </span>\n                        ) : null}\n                        {draftAcademicYear && yearConflict ? (\n                          <span style={{ color: \"#b91c1c\", marginLeft: 8 }}>\n                            Bu yil turu icin zaten bir senaryo var.\n                          </span>\n                        ) : null}\n                      </div>\n                    </div>\n                  )}\n\n                  {newScenarioStep === 4 && (\n                    <div style={{ marginTop: 10 }}>\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Kademeler</div>\n                      <label className=\"row small\" style={{ gap: 8, alignItems: \"center\", marginBottom: 8 }}>\n                        <input\n                          type=\"checkbox\"\n                          checked={newScenarioNoKademe}\n                          onChange={(e) => setNoKademeMode(e.target.checked)}\n                        />\n                        <span>Kademe yok (Merkez / Headquarter)</span>\n                      </label>\n                      {newScenarioNoKademe ? (\n                        <div className=\"small muted\" style={{ marginBottom: 8 }}>\n                          Bu senaryo icin kademe secmeye gerek yok. Kademe-bagimli alanlar ilerleme hesabina dahil edilmez.\n                        </div>\n                      ) : null}\n                      <table className=\"table\">\n                        <thead>\n                          <tr>\n                            <th>Kademe</th>\n                            <th style={{ width: 120 }}>Aktif</th>\n                            <th style={{ width: 160 }}>Baslangic</th>\n                            <th style={{ width: 160 }}>Bitis</th>\n                          </tr>\n                        </thead>\n                        <tbody>\n                          {kademeDefs.map((def) => {\n                            const row = draftKademeConfig[def.key];\n                            return (\n                              <tr key={def.key}>\n                                <td style={{ fontWeight: 700 }}>{def.label}</td>\n                                <td>\n                                  <input\n                                    type=\"checkbox\"\n                                    checked={!!row?.enabled}\n                                    disabled={newScenarioNoKademe}\n                                    onChange={(e) => updateNewKademe(def.key, { enabled: e.target.checked })}\n                                  />\n                                </td>\n                                <td>\n                                  <select\n                                    className=\"input sm\"\n                                    value={row?.from || \"\"}\n                                    onChange={(e) => updateNewKademe(def.key, { from: e.target.value })}\n                                    disabled={newScenarioNoKademe || !row?.enabled}\n                                  >\n                                    {gradeOptions.map((g) => (\n                                      <option key={g} value={g}>{g}</option>\n                                    ))}\n                                  </select>\n                                </td>\n                                <td>\n                                  <select\n                                    className=\"input sm\"\n                                    value={row?.to || \"\"}\n                                    onChange={(e) => updateNewKademe(def.key, { to: e.target.value })}\n                                    disabled={newScenarioNoKademe || !row?.enabled}\n                                  >\n                                    {gradeOptions.map((g) => (\n                                      <option key={g} value={g}>{g}</option>\n                                    ))}\n                                  </select>\n                                </td>\n                              </tr>\n                            );\n                          })}\n                        </tbody>\n                      </table>\n                      {!newScenarioNoKademe && !hasEnabledKademe ? (\n                        <div className=\"small\" style={{ color: \"#b91c1c\" }}>En az bir kademe secmelisiniz.</div>\n                      ) : null}\n                    </div>\n                  )}\n\n                  {newScenarioStep === 5 && (\n                    <div style={{ marginTop: 10 }}>\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Senaryo Adi</div>\n                      <div className=\"row\">\n                        <input\n                          className=\"input\"\n                          placeholder=\"Senaryo adi\"\n                          value={newScenarioName}\n                          onChange={(e) => setNewScenarioName(e.target.value)}\n                        />\n                      </div>\n                      {!newScenarioName.trim() ? (\n                        <div className=\"small\" style={{ color: \"#b91c1c\", marginTop: 6 }}>Senaryo adi zorunludur.</div>\n                      ) : null}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n            {!scenarioWizardLoading ? (\n              <div className=\"scenario-wizard-footer\">\n                <button\n                  className=\"btn\"\n                  onClick={goScenarioBack}\n                  disabled={newScenarioStep === 0 || scenarioWizardSaving}\n                >\n                  Geri\n                </button>\n                <button\n                  className=\"btn primary\"\n                  onClick={goScenarioNext}\n                  disabled={scenarioWizardSaving || !scenarioStepOk[newScenarioStep]}\n                >\n                  {scenarioWizardSaving ? (\n                    <span style={{ display: \"inline-flex\", gap: 6, alignItems: \"center\" }}>\n                      <InlineSpinner />\n                      <span>{scenarioWizardMode === \"edit\" ? \"Kaydediliyor...\" : \"Olusturuluyor...\"}</span>\n                    </span>\n                  ) : (\n                    newScenarioStep < scenarioStepTotal - 1\n                      ? \"Ileri\"\n                      : scenarioWizardMode === \"edit\"\n                        ? \"Kaydet\"\n                        : \"Bitir\"\n                  )}\n                </button>\n              </div>\n            ) : null}\n          </div>\n        </div>\n      ) : null}\n\n      <div\n        className=\"row select-page-tables\"\n        style={{ gap: 12, alignItems: \"stretch\", flexWrap: \"wrap\" }}\n      >\n        <div className=\"card select-table-card\" style={{ flex: \"1 1 320px\", minWidth: 280 }}>\n          <div style={{ fontWeight: 700, marginBottom: 8 }}>Okullar</div>\n          {loadingSchools ? (\n            <div className=\"small\">Yukleniyor...</div>\n          ) : (\n            <div className=\"select-table-body\">\n              <table className=\"table select-school-table\">\n                <colgroup>\n                  <col style={{ width: 32 }} />\n                  <col style={{ width: 32 }} />\n                  <col />\n                  <col style={{ width: 180 }} />\n                </colgroup>\n              <thead>\n                <tr>\n                  <th>#</th>\n                  <th></th>\n                  <th>Okul</th>\n                  <th>lerleme</th>\n                </tr>\n              </thead>\n              <tbody>\n                {schools.length === 0 ? (\n                  <tr>\n                    <td colSpan=\"4\" className=\"small\">Okul bulunamadi.</td>\n                  </tr>\n                ) : (\n                  schools.map((s, idx) => {\n                    const isSelected = String(selectedSchoolId) === String(s.id);\n                    const showStaleSplit = !!schoolExpenseSplitStaleMap?.[s.id];\n                    const rowClassName = `scenario-row${isSelected ? \" is-selected\" : \"\"}${\n                      showStaleSplit ? \" is-expense-split-stale\" : \"\"\n                    }`;\n                    const progress = schoolProgress[s.id];\n                    return (\n                      <tr\n                        key={s.id}\n                        className={rowClassName}\n                        // Provide a pointer cursor for the whole row to indicate interactivity. Clicking the row or any\n                        // cell will select the school.\n                        style={{ cursor: isSelected ? \"default\" : \"pointer\" }}\n                        onClick={() => {\n                          if (isSelected) return;\n                          handleSelectSchool(s.id);\n                        }}\n                      >\n                        <td className=\"small\" style={{ padding: \"6px 8px\" }}>\n                          {idx + 1}\n                        </td>\n                        <td\n                          onClick={(e) => {\n                            e.stopPropagation();\n                          }}\n                        >\n                          <input\n                            type=\"checkbox\"\n                            className=\"select-checkbox\"\n                            checked={isSelected}\n                            aria-label={`${s.name} okulunu se`}\n                            onChange={(e) => {\n                              e.stopPropagation();\n                              if (isSelected) {\n                                clearSchoolSelection();\n                                return;\n                              }\n                              handleSelectSchool(s.id);\n                            }}\n                          />\n                        </td>\n                        <td\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            if (isSelected) return;\n                            handleSelectSchool(s.id);\n                          }}\n                          style={{ cursor: \"pointer\" }}\n                        >\n                          <b>{s.name}</b>\n                        </td>\n                        <td style={{ minWidth: 180 }}>\n                          {progress ? (\n                            progress.state === \"active\" ? (\n                              <ProgressBar value={progress.pct} tooltipLines={progress.tooltipLines} />\n                            ) : (\n                              <div className=\"small\">{progress.label || \"-\"}</div>\n                            )\n                          ) : (\n                            <div className=\"small\">{schoolProgressLoading ? \"Hesaplanyor...\" : \"-\"}</div>\n                          )}\n                        </td>\n                      </tr>\n                    );\n                  })\n                )}\n              </tbody>\n              </table>\n            </div>\n          )}\n          {canBulkSend ? (\n            <div className=\"row select-table-footer\" style={{ justifyContent: \"flex-end\" }}>\n              <button\n                className=\"btn primary\"\n                onClick={() => setBulkSendOpen(true)}\n                disabled={!schools.length || loadingSchools}\n              >\n                Ulke Onay Paketi Gonder\n              </button>\n            </div>\n          ) : null}\n        </div>\n\n        <div className=\"card select-table-card\" style={{ flex: \"2 1 420px\", minWidth: 320 }}>\n          {/* Header for the scenarios list. The \"Yeni Senaryo\" button has been moved into the scenario toolbar\n              below so it appears alongside the other scenario actions. */}\n          <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\", gap: 12 }}>\n            <div style={{ fontWeight: 700 }}>Senaryolar</div>\n          </div>\n\n          {!selectedSchoolId ? (\n            <div className=\"small muted\" style={{ marginTop: 10 }}>Once okul secin.</div>\n          ) : (\n            <>\n              <div className=\"scenario-toolbar\" style={{ marginTop: 10 }}>\n                {/* Yeni Senaryo button moved here to be the first action in the toolbar. It remains disabled when\n                    no school is selected or an operation is in progress. */}\n                {canCreateScenario ? (\n                  <button\n                    type=\"button\"\n                    className=\"btn primary\"\n                    onClick={openScenarioWizardCreate}\n                    disabled={!selectedSchoolId || scenarioOpsBusy}\n                    title=\"Yeni Senaryo\"\n                  >\n                    <span className=\"btn-inner\">\n                      <FaPlus aria-hidden=\"true\" />\n                      <span>Yeni Senaryo</span>\n                    </span>\n                  </button>\n                ) : null}\n                {canEditScenarioPlan ? (\n                  <button\n                    type=\"button\"\n                    className=\"btn\"\n                    onClick={() => {\n                      if (!selectedRowScenario) return;\n                      openScenarioWizardEdit(selectedRowScenario.id);\n                    }}\n                    disabled={!canEditToolbar || scenarioOpsBusy}\n                    title=\"Planlamayi Duzenle\"\n                  >\n                    <span className=\"btn-inner\">\n                      <FaEdit aria-hidden=\"true\" />\n                      <span>Planlamayi Duzenle</span>\n                    </span>\n                  </button>\n                ) : null}\n                {canCopyScenario ? (\n                  <button\n                    type=\"button\"\n                    className=\"btn\"\n                    onClick={openCopyScenarioModal}\n                    disabled={!canCopyToolbar || calculating || scenarioOpsBusy}\n                    title=\"Kopyala\"\n                  >\n                    <span className=\"btn-inner\">\n                      {toolbarIsCopying ? <InlineSpinner /> : <FaCopy aria-hidden=\"true\" />}\n                      <span>Kopyala</span>\n                    </span>\n                  </button>\n                ) : null}\n                {canExpenseSplit ? (\n                  <button\n                    type=\"button\"\n                    className=\"btn\"\n                    onClick={() => setExpenseSplitOpen(true)}\n                    disabled={!selectedRowScenario || scenarioOpsBusy}\n                    title=\"Gider Paylatr\"\n                  >\n                    <span className=\"btn-inner\">\n                      <FaBalanceScale aria-hidden=\"true\" />\n                      <span>Gider Paylatr</span>\n                    </span>\n                  </button>\n                ) : null}\n                {canSubmitScenario && isSubmitStage ? (\n                  <button\n                    type=\"button\"\n                    className=\"btn primary\"\n                    onClick={() => {\n                      if (!selectedRowScenario) return;\n                      submitScenarioForApproval(selectedRowScenario.id);\n                    }}\n                    disabled={\n                      !canSubmitToolbar ||\n                      !submitToolbarProgressReady ||\n                      calculating ||\n                      scenarioOpsBusy\n                    }\n                    title={submitToolbarTitle}\n                  >\n                    <span className=\"btn-inner\">\n                      {/* Show a spinner while submitting; otherwise show an approval icon. */}\n                      {toolbarIsSubmitting ? <InlineSpinner /> : <FaCheckCircle style={{ marginRight: 4 }} />}\n                      <span>Onaya Gonder</span>\n                    </span>\n                  </button>\n                ) : null}\n                {canDeleteScenario ? (\n                  <button\n                    type=\"button\"\n                    className=\"btn danger\"\n                    onClick={() => {\n                      if (!selectedRowScenario) return;\n                      openDeleteScenarioModal(selectedRowScenario.id);\n                    }}\n                    disabled={!canDeleteToolbar || calculating || scenarioOpsBusy}\n                    title=\"Sil\"\n                  >\n                    <span className=\"btn-inner\">\n                      {/* Show a spinner while deleting; otherwise show a trash icon. */}\n                      {toolbarIsDeleting ? <InlineSpinner /> : <FaTrash style={{ marginRight: 4 }} />}\n                      <span>Sil</span>\n                    </span>\n                  </button>\n                ) : null}\n              </div>\n              <div className=\"select-table-body select-table-body-gap\">\n                <table className=\"table scenario-table\">\n                <thead>\n                  <tr>\n                    <th></th>\n                    <th aria-sort={getSortAria(\"name\")}>\n                      <button\n                        type=\"button\"\n                        className=\"sort-th\"\n                        onClick={() => toggleScenarioSort(\"name\")}\n                        aria-label=\"Sirala: Ad\"\n                      >\n                        <span>Ad</span>\n                        {sortIcon(\"name\")}\n                      </button>\n                    </th>\n                    <th aria-sort={getSortAria(\"year\")}>\n                      <button\n                        type=\"button\"\n                        className=\"sort-th\"\n                        onClick={() => toggleScenarioSort(\"year\")}\n                        aria-label=\"Sirala: Yil\"\n                      >\n                        <span>Yil</span>\n                        {sortIcon(\"year\")}\n                      </button>\n                    </th>\n                    <th aria-sort={getSortAria(\"currency\")}>\n                      <button\n                        type=\"button\"\n                        className=\"sort-th\"\n                        onClick={() => toggleScenarioSort(\"currency\")}\n                        aria-label=\"Sirala: Para Birimi\"\n                      >\n                        <span>Para Birimi</span>\n                        {sortIcon(\"currency\")}\n                      </button>\n                    </th>\n                    <th aria-sort={getSortAria(\"status\")}>\n                      <button\n                        type=\"button\"\n                        className=\"sort-th\"\n                        onClick={() => toggleScenarioSort(\"status\")}\n                        aria-label=\"Sirala: Durum\"\n                      >\n                        <span>Durum</span>\n                        {sortIcon(\"status\")}\n                      </button>\n                    </th>\n                    <th>lerleme</th>\n                      <th aria-sort={getSortAria(\"date\")}>\n                        <button\n                          type=\"button\"\n                          className=\"sort-th\"\n                        onClick={() => toggleScenarioSort(\"date\")}\n                        aria-label=\"Sirala: Tarih\"\n                      >\n                        <span>Tarih</span>\n                        {sortIcon(\"date\")}\n                        </button>\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {loadingScenarios ? (\n                      <tr>\n                        <td colSpan=\"7\" className=\"small\">Yukleniyor...</td>\n                      </tr>\n                    ) : sortedScenarios.length === 0 ? (\n                      <tr>\n                        <td colSpan=\"7\" className=\"small\">Gosterilecek senaryo yok.</td>\n                      </tr>\n                    ) : (\n                      sortedScenarios.map((s) => {\n                        const statusMeta = getScenarioStatusMeta(s);\n                        const isSelected = String(selectedScenarioIdLocal) === String(s.id);\n                      const isThisRowBusy = String(s.id) === String(busyRowId);\n                      const isOtherRowDisabled = scenarioOpsBusy && busyRowId && !isThisRowBusy;\n                      const disableThisRowActions = scenarioOpsBusy;\n                      const currencyLabel =\n                        s.input_currency === \"LOCAL\"\n                          ? `${s.local_currency_code || \"LOCAL\"} (LOCAL)`\n                          : \"USD\";\n                      return (\n                        <tr\n                          key={s.id}\n                          className={`${isSelected ? \"scenario-row is-selected\" : \"scenario-row\"}${\n                            s?.expense_split_applied\n                              ? s?.expense_split_stale\n                                ? \" is-expense-split-stale\"\n                                : \" is-expense-split\"\n                              : \"\"\n                          }`}\n                          // Apply opacity and pointer-event rules as before. Also set cursor to pointer when\n                          // selection is possible. When another row is busy or this row is disabled/selected, the\n                          // cursor remains default and clicking does nothing.\n                          style={{\n                            opacity: isOtherRowDisabled ? 0.5 : 1,\n                            pointerEvents: isOtherRowDisabled ? \"none\" : \"auto\",\n                            cursor:\n                              isSelected || disableThisRowActions || isOtherRowDisabled ? \"default\" : \"pointer\",\n                          }}\n                          onClick={() => {\n                            if (isSelected || disableThisRowActions || isOtherRowDisabled) return;\n                            setSelectedScenarioIdLocal(s.id);\n                          }}\n                        >\n                          <td>\n                            <input\n                              type=\"checkbox\"\n                              className=\"select-checkbox\"\n                              checked={isSelected}\n                              disabled={disableThisRowActions || isOtherRowDisabled}\n                              aria-label={`${s.name} senaryosunu se`}\n                              onChange={(e) => {\n                                e.stopPropagation();\n                                if (disableThisRowActions || isOtherRowDisabled) return;\n                                if (isSelected) {\n                                  clearScenarioSelection();\n                                  return;\n                                }\n                                setSelectedScenarioIdLocal(s.id);\n                              }}\n                            />\n                          </td>\n                          <td>\n                            <b className=\"scenario-name\" title={s.name}>\n                              {s.name}\n                            </b>\n                          </td>\n                          <td>{s.academic_year}</td>\n                          <td>{currencyLabel}</td>\n                          <td>\n                            <span className={`status-badge ${statusMeta.cls}`} title={statusMeta.help}>\n                              {statusMeta.label}\n                            </span>\n                          </td>\n                          <td style={{ minWidth: 160 }}>\n                            {scenarioProgressMap[s.id] && !scenarioProgressMap[s.id].error ? (\n                              <ProgressBar\n                                value={scenarioProgressMap[s.id].pct}\n                                tooltipLines={scenarioProgressMap[s.id].tooltipLines}\n                              />\n                            ) : (\n                              <span className=\"small\">\n                                {scenarioProgressLoading ? \"Hesaplanyor...\" : \"-\"}\n                              </span>\n                            )}\n                            </td>\n                            <td className=\"small\">{new Date(s.created_at).toLocaleString()}</td>\n                          </tr>\n                        );\n                      })\n                    )}\n                </tbody>\n                </table>\n              </div>\n            </>\n          )}\n          <div className=\"row select-table-footer\" style={{ justifyContent: \"flex-end\" }}>\n            <button\n              className=\"btn primary\"\n              onClick={handleApply}\n              disabled={!selectedSchoolId || !selectedScenarioIdLocal}\n            >\n              Uygula\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","const KADEME_BASE_KEYS = [\"okulOncesi\", \"ilkokul\", \"ortaokul\", \"lise\"];\n\nexport function isHeadquarterScenario(inputs) {\n  const kademeler = inputs?.temelBilgiler?.kademeler;\n  if (!kademeler || typeof kademeler !== \"object\") return false;\n  return KADEME_BASE_KEYS.every((key) => kademeler?.[key]?.enabled === false);\n}\n","const PROGRAM_TYPES = {\r\n  LOCAL: \"local\",\r\n  INTERNATIONAL: \"international\",\r\n};\r\n\r\nconst ALLOWED_PROGRAM_TYPES = new Set(Object.values(PROGRAM_TYPES));\r\n\r\nfunction normalizeProgramType(value) {\r\n  const raw = String(value || \"\").trim().toLowerCase();\r\n  if (ALLOWED_PROGRAM_TYPES.has(raw)) return raw;\r\n  return PROGRAM_TYPES.LOCAL;\r\n}\r\n\r\nfunction getProgramType(inputs = {}, scenario = null) {\r\n  const programFromInputs =\r\n    inputs?.temelBilgiler?.programType ?? inputs?.programType ?? inputs?.program_type;\r\n  if (programFromInputs) {\r\n    return normalizeProgramType(programFromInputs);\r\n  }\r\n  const programFromScenario = scenario?.program_type || scenario?.programType;\r\n  if (programFromScenario) return normalizeProgramType(programFromScenario);\r\n  return PROGRAM_TYPES.LOCAL;\r\n}\r\n\r\nfunction isKademeKeyVisible(key, programType = PROGRAM_TYPES.LOCAL) {\r\n  const type = normalizeProgramType(programType);\r\n  if (!key) return true;\r\n  if (key === \"okulOncesi\") return true;\r\n  if (key.endsWith(\"Yerel\")) return type === PROGRAM_TYPES.LOCAL;\r\n  if (key.endsWith(\"Int\")) return type === PROGRAM_TYPES.INTERNATIONAL;\r\n  return true;\r\n}\r\n\r\nfunction mapBaseKademeToVariant(baseKademe, programType = PROGRAM_TYPES.LOCAL) {\r\n  const type = normalizeProgramType(programType);\r\n  if (baseKademe === \"okulOncesi\") return \"okulOncesi\";\r\n  const suffix = type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\";\r\n  return `${baseKademe}${suffix}`;\r\n}\r\n\r\nfunction getVariantKeysForProgramType(programType = PROGRAM_TYPES.LOCAL) {\r\n  const type = normalizeProgramType(programType);\r\n  return new Set([\r\n    \"okulOncesi\",\r\n    `ilkokul${type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\"}`,\r\n    `ortaokul${type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\"}`,\r\n    `lise${type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\"}`,\r\n  ]);\r\n}\r\n\r\nexport {\r\n  PROGRAM_TYPES,\r\n  ALLOWED_PROGRAM_TYPES,\r\n  getProgramType,\r\n  normalizeProgramType,\r\n  isKademeKeyVisible,\r\n  mapBaseKademeToVariant,\r\n  getVariantKeysForProgramType,\r\n};\r\n"],"names":["Tooltip","_ref","text","lines","children","className","resolved","Array","isArray","map","line","String","filter","trim","length","split","Boolean","normalizeLines","_jsxs","concat","_jsx","role","idx","GRADES","KADEME_DEFS","key","label","defaultFrom","defaultTo","normalizeGrade","value","v","toUpperCase","test","n","Number","isFinite","gradeIndex","g","indexOf","getKademeDefinitions","d","_objectSpread","getDefaultKademeConfig","out","forEach","enabled","from","to","normalizeKademeConfig","config","cfg","row","range","fromValue","toValue","def","_normalizeGrade","_normalizeGrade2","fromIdx","toIdx","normalizeRange","formatKademeLabel","find","getKademeRangeLabel","getKademeForGrade","grade","summarizeGradesByKademe","grades","rows","okulOncesi","ilkokul","ortaokul","lise","total","r","students","studentsPerBranch","Object","prototype","hasOwnProperty","call","getGradeOptions","ProgressBar","tooltipLines","numeric","pct","Math","max","min","track","style","width","round","EXPENSE_ITEMS","EXPENSE_KEYS","it","EXPENSE_ITEM_MAP","Map","EXPENSE_LABELS","EXPENSE_SECTIONS","id","groups","keys","section","group","flatMap","fmtNum","fractionDigits","arguments","undefined","toLocaleString","maximumFractionDigits","resolveTargetYear","academicYear","yearBasis","startYear","endYear","raw","match","single","year","parseAcademicYearParts","ExpenseSplitModal","_sourceScenario$schoo","open","onClose","onApplied","sourceScenario","sourceSchoolId","sourceSchoolName","targets","setTargets","useState","loadingTargets","setLoadingTargets","targetSearch","setTargetSearch","selectedTargets","setSelectedTargets","Set","basis","setBasis","basisYearKey","setBasisYearKey","setYearBasis","selectedExpenseKeys","setSelectedExpenseKeys","preview","setPreview","previewLoading","setPreviewLoading","applyLoading","setApplyLoading","revertLoading","setRevertLoading","showPools","setShowPools","expandedTargets","setExpandedTargets","showTargets","setShowTargets","showExpenses","setShowExpenses","prefillScope","setPrefillScope","prefillAppliedRef","useRef","compactControlStyle","fontSize","height","padding","lineHeight","boxSizing","selectedTargetsKey","useMemo","sort","join","selectedExpenseKeyStr","useEffect","current","active","async","academic_year","targetYear","data","api","expenseSplitTargets","filtered","scenarioId","e","toast","error","message","loadTargets","getExpenseSplitLastScope","scope","_","loadPrefill","nextBasis","toLowerCase","nextYear","includes","allowedExpenseKeys","expenseKeys","has","targetIdSet","filteredTargets","targetScenarioIds","term","schoolName","scenarioName","prev","size","idSet","next","toggleTarget","delete","add","toggleExpenseKey","setExpenseKeys","checked","previewTargets","previewPools","pools","previewAllocations","allocations","previewWarnings","warnings","sourceLabel","school","name","allocationsByTarget","targetScenarioId","list","get","push","expenseLabel","expenseKey","amount","allocatedAmount","set","totalExpenseCount","selectedExpenseCount","allExpensesSelected","someExpensesSelected","previewDisabled","isletmeSection","s","otherSections","renderSectionCard","selected","reduce","sum","allSelected","someSelected","background","justifyContent","alignItems","gap","fontWeight","type","ref","el","indeterminate","onChange","target","onClick","disabled","marginTop","marginBottom","item","maxHeight","overflowY","position","stopPropagation","top","right","borderColor","color","_Fragment","flexWrap","minWidth","flex","placeholder","cursor","FaChevronDown","FaChevronRight","colSpan","currencyLabel","input_currency","local_currency_code","display","payload","previewExpenseSplit","applyExpenseSplit","success","sourceScenarioId","window","confirm","revertExpenseSplit","removed","removedTargetScenarioIds","deletedSet","w","p","poolAmount","margin","t","targetKey","isExpanded","allocRows","React","toggleTargetAllocations","textAlign","basisValue","weight","toFixed","CountrySendModal","_applyResult$scenario","countryId","loading","setLoading","err","setErr","years","setYears","yearsLoading","setYearsLoading","search","setSearch","hideIneligible","setHideIneligible","hideSent","setHideSent","applyResult","setApplyResult","setAcademicYear","loadPreview","useCallback","countryApprovalBatchPreview","loadYears","countryApprovalBatchYears","guardDisabled","bulkDisabledDueToStaleSource","staleSources","searchTerm","filteredRows","eligible","sentAt","yearText","schoolId","reasons","progressText","progress","status","splitStatus","scenarioCount","batchId","canSubmit","countryApprovalBatchSend","COPY_SELECT_TABS","sections","COPY_SECTION_RESOURCES","isScenarioLocked","scenario","submittedAt","submitted_at","sent_at","DEFAULT_START_YEAR","DEFAULT_END_YEAR","CURRENCY_CODE_REGEX","LOCAL_CURRENCY_OPTIONS","normalizeYearInput","incrementAcademicYearString","start","end","getAllCopySectionIds","tab","enforceIkGiderlerPair","selection","ikSelected","giderlerSelected","nextValue","buildDefaultCopySelection","presetKey","sectionIds","fromEntries","buildEmptyNormCurriculum","empty","buildEmptyNormYear","maxHours","teacherWeeklyMaxHours","curriculumWeeklyHours","convertInputsUsdToLocalForCopy","inputs","fx","_inputs$ik","rate","mulMoney","gelirler","_g$tuition","_g$nonEducationFees","_g$dormitory","_g$otherInstitutionIn","convertRows","unitFee","tuition","nonEducationFees","dormitory","otherInstitutionIncome","governmentIncentives","giderler","values","grp","items","k","ik","yearObj","unitCosts","discounts","mode","tb","temelBilgiler","_tb$inflation","_tb$performans","inflation","currentSeasonAvgFee","rakipAnalizi","obj","performans","gerceklesen","InlineSpinner","_ref2","borderRadius","border","borderTopColor","animation","normalizeCapacityInputs","src","_cap$years","_cap$years2","_cap$years3","safeNum","legacy","schoolCapacity","cap","kapasite","y1","y2","y3","currentStudents","byKademe","structuredClone","normalizeTemelBilgilerInputs","inf","toFinite","expenseDeviationPct","y2023","y2024","y2025","yetkililer","mudur","ulkeTemsilcisi","raporuHazirlayan","okulEgitimBilgileri","egitimBaslamaTarihi","zorunluEgitimDonemleri","birDersSuresiDakika","gunlukDersSaati","haftalikDersSaatiToplam","sabahciOglenci","ogretmenHaftalikDersOrt","gecisSinaviBilgisi","uygulananProgram","kademeler","programType","normalizeProgramType","okulUcretleriHesaplama","ucretArtisOranlari","ilkokulYerel","ilkokulInt","ortaokulYerel","ortaokulInt","liseYerel","liseInt","ikMevcut","turkPersonelYoneticiEgitimci","turkPersonelTemsilcilik","yerelKadroluEgitimci","yerelUcretliVakaterEgitimci","yerelDestek","yerelTemsilcilik","international","bursIndirimOgrenciSayilari","magisBasariBursu","maarifYetenekBursu","ihtiyacBursu","okulBasariBursu","tamEgitimBursu","barinmaBursu","turkceBasariBursu","uluslararasiYukumlulukIndirimi","vakifCalisaniIndirimi","kardesIndirimi","erkenKayitIndirimi","pesinOdemeIndirimi","kademeGecisIndirimi","temsilIndirimi","kurumIndirimi","istisnaiIndirim","yerelMevzuatIndirimi","a","b","c","ogrenciSayisi","karZarar","bursVeIndirimler","degerlendirme","normalizeGradesInputs","defaultGrades","branchCount","baseGrades","gradesYears","toMap","m","_row$grade","_row$branchCount","_row$studentsPerBranc","normalizeRow","areGradesEqual","ma","mb","ra","entries","rb","SelectPage","_ref3","_ref4","_inputs$temelBilgiler","_inputs$temelBilgiler2","_auth$user2","_auth$user3","_selectedScenarioProg","_auth$user4","navigate","useNavigate","outlet","useOutletContext","searchParams","setSearchParams","useSearchParams","auth","useAuth","schools","setSchools","scenarios","setScenarios","scenariosSchoolId","setScenariosSchoolId","selectedSchoolId","setSelectedSchoolId","selectedScenarioIdLocal","setSelectedScenarioIdLocal","selectedScenario","setSelectedScenario","setInputs","setReport","loadingSchools","setLoadingSchools","loadingScenarios","setLoadingScenarios","schoolProgress","setSchoolProgress","schoolProgressLoading","setSchoolProgressLoading","schoolExpenseSplitStaleMap","setSchoolExpenseSplitStaleMap","scenarioProgressMap","setScenarioProgressMap","scenarioProgressLoading","setScenarioProgressLoading","newScenarioName","setNewScenarioName","newScenarioPeriod","setNewScenarioPeriod","newScenarioStartYear","setNewScenarioStartYear","newScenarioEndYear","setNewScenarioEndYear","newScenarioKademeler","setNewScenarioKademeler","newScenarioNoKademe","setNewScenarioNoKademe","newScenarioInputCurrency","setNewScenarioInputCurrency","newScenarioLocalCurrencyCode","setNewScenarioLocalCurrencyCode","newScenarioFxUsdToLocal","setNewScenarioFxUsdToLocal","newScenarioProgramType","setNewScenarioProgramType","newScenarioStep","setNewScenarioStep","scenarioWizardOpen","setScenarioWizardOpen","scenarioWizardMode","setScenarioWizardMode","scenarioWizardScenario","setScenarioWizardScenario","scenarioWizardLoading","setScenarioWizardLoading","scenarioWizardSaving","setScenarioWizardSaving","scenarioSort","setScenarioSort","dir","submittingScenarioId","setSubmittingScenarioId","copyingScenarioId","setCopyingScenarioId","deletingScenarioId","setDeletingScenarioId","deleteConfirmScenarioId","setDeleteConfirmScenarioId","copyModalOpen","setCopyModalOpen","expenseSplitOpen","setExpenseSplitOpen","bulkSendOpen","setBulkSendOpen","copyModalError","setCopyModalError","copySelection","setCopySelection","copySelectionMsg","setCopySelectionMsg","copyTargetCurrency","setCopyTargetCurrency","copyLocalCurrencyCode","setCopyLocalCurrencyCode","copyPlannedFxUsdToLocal","setCopyPlannedFxUsdToLocal","copyFxUsdToLocal","setCopyFxUsdToLocal","calculating","setCalculating","copySelectionMsgTimerRef","kademeBeforeNoKademeRef","setHeaderMeta","title","subtitle","centered","_outlet$clearHeaderMe","clearHeaderMeta","loadSchools","listSchools","limit","offset","fields","order","loadSchoolProgress","ids","getSchoolsProgressBulk","progressBySchoolId","fallback","state","loadSchoolExpenseSplitStale","getSchoolsExpenseSplitStale","staleBySchoolId","paramId","some","handleSelectSchool","isDifferent","URLSearchParams","clearSchoolSelection","clearScenarioSelection","sc","listScenarios","stored","readSelectedScenarioId","loadScenarios","results","Promise","all","_progress$pct","getScenarioProgress","missingLines","missingDetailsLines","loadScenarioProgress","getScenarioInputs","normalized","isHQ","isHeadquarterScenario","writeScenarioFlags","isHeadquarter","loadScenario","refreshScenarios","handleExpenseSplitApplied","expense_split_applied","expense_split_stale","kademeDefs","gradeOptions","draftStartYear","draftEndYear","draftAcademicYear","periodType","startYearValue","endYearValue","formatAcademicYear","draftRangeOk","yearConflict","excludeId","draftKademeConfig","hasEnabledKademe","kademeStepOk","normalizedLocalCode","localCodeOk","fxValue","fxOk","currencyStepOk","draftReady","scenarioStepOk","scenarioOpsBusy","busyRowId","selectedRowScenario","selectedSchoolName","sortedScenarios","indexed","dirMul","getYearParts","ay","getCurrencyCode","getStatusLabel","A","B","res","localeCompare","sensitivity","a1","a2","b1","b2","Date","created_at","getTime","toggleScenarioSort","getSortAria","sortIcon","FaSort","FaSortUp","FaSortDown","copySectionIds","selectedCopyCount","isIkGiderlerValid","sourceCurrency","inputCurrencyCode","isLocalScenario","prevRealFxValue","prevYearRealizedFxUsdToLocal","prevRealFxMissing","permissionScope","_auth$user$country_id","_auth$user","user","country_id","canCreateScenario","can","canEditScenarioPlan","canCopyScenario","canExpenseSplit","canSubmitScenario","canBulkSend","canDeleteScenario","toolbarLocked","canEditToolbar","canDeleteToolbar","isSubmitStage","canSubmitToolbar","canCopyToolbar","toolbarIsCopying","toolbarIsSubmitting","toolbarIsDeleting","selectedScenarioProgress","selectedScenarioProgressPct","selectedScenarioProgressComplete","submitToolbarProgressReady","submitToolbarTitle","handleScenarioCurrencyChange","handleScenarioPeriodChange","nextPeriod","handleScenarioStartYearChange","openScenarioWizardEdit","targetScenario","_data$inputs","_data$inputs$temelBil","Error","parseAcademicYear","existingKademe","normalizedKademe","hasAnyEnabled","scenarioCurrency","fx_usd_to_local","program_type","PROGRAM_TYPES","LOCAL","updateNewKademe","patch","base","parseFxInput","NaN","replace","num","parseFloat","applyPresetSelection","toggleCopySelection","clearTimeout","setTimeout","setCopyTabSelectionAll","tabKey","entry","closeCopyScenarioModal","sumPlannedStudents","_row$studentsPerBranc2","showBlockingToast","toastId","warn","autoClose","closeOnClick","draggable","icon","boxShadow","ensurePlanningStudentsForY2Y3","actionLabel","totals","srcInputs","getPlannedStudentTotalsByYear","missing","msg","ensurePrevRealFxForLocal","submitScenarioForApproval","progressOk","cached","_cached$pct","_progress$pct2","ensureScenarioProgressComplete","calcOk","options","skipPlanValidation","ok","calculateScenario","calculate","keepTab","workData","listWorkItems","requiredWorkIds","workItems","workItemMap","work_id","toSubmit","wid","failed","allSettled","submitWorkItem","_failed$","firstErr","reason","deleteConfirmScenario","deleteConfirmLabel","deleteConfirmMessage","ToastContainer","newestOnTop","pauseOnFocusLoss","pauseOnHover","hideProgressBar","theme","deleteScenario","slice","code","step","gridTemplateColumns","flexDirection","targetCurrency","localCurrencyCodeValue","plannedFxUsdToLocalValue","copyFxUsdToLocalValue","plannedFxNumber","copyFxNumber","_copyOptions$localCur","_copyOptions$plannedF","_copyOptions$copyFxUs","copyOptions","localCurrencyCode","plannedFxUsdToLocal","plannedFxParsed","copyFxParsed","_ref8","_localCurrencyCode","_plannedFxUsdToLocal","_copyFxUsdToLocal","_inputs$temelBilgiler3","baseName","copyName","candidateYear","guard","hasAcademicYear","yearStr","shouldCopyCore","kademeConfig","fxForCreate","created","createScenario","inputCurrency","fxUsdToLocal","clonedInputs","_next$temelBilgiler","sel","keep","buildDefaultGrades","srcGradesYears","srcGrades","y1Source","keepPlanned","keepLessonY1","y2Source","y3Source","gradesCurrent","filterInputsForCopyBySelection","inInputs","_ik$years","_src$giderler","_src$giderler$isletme","yearIK","headcountsByLevel","roles","levels","roleAnnual","count","lvl","_headcountsByLevel$lv","turkPersonelMaas","turk_mudur","turk_mdyard","turk_egitimci","turkDestekPersonelMaas","turk_temsil","yerelPersonelMaas","yerel_yonetici_egitimci","yerelDestekPersonelMaas","yerel_destek","yerel_ulke_temsil_destek","internationalPersonelMaas","int_yonetici_egitimci","prevItems","isletme","changed","abs","applyIkSalariesToGiderler","convertInputsLocalToUsdForCopy","modifiedResources","resources","buildModifiedResourcesFromCopySelection","saveScenarioInputs","sourceNorm","getNormConfig","_ref9","_sourceYears$y1$teach","_sourceYears$y","sourceYears","baseHours","saveNormConfig","console","copySelectedScenario","hint","INTERNATIONAL","option","opacity","readOnly","marginLeft","nextEnabled","_ref7","restored","setNoKademeMode","getScenarioStepError","scenarioStepTotal","scenarioProgramType","baseKademe","_ref6","updateScenario","_ref5","submitScenarioWizard","isSelected","showStaleSplit","rowClassName","FaPlus","FaEdit","FaCopy","FaBalanceScale","FaCheckCircle","marginRight","FaTrash","statusMeta","scenarioOrStatus","cls","help","getScenarioStatusMeta","isThisRowBusy","isOtherRowDisabled","disableThisRowActions","pointerEvents","handleApply","writeSelectedScenarioId","writeLastActiveSchoolId","seg","readGlobalLastRouteSegment","KADEME_BASE_KEYS","every","_kademeler$key","ALLOWED_PROGRAM_TYPES","getProgramType","programFromInputs","programFromScenario","isKademeKeyVisible","endsWith","mapBaseKademeToVariant","suffix"],"ignoreList":[],"sourceRoot":""}