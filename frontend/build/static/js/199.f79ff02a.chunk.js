"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[199],{2894(e,l,s){s.d(l,{A:()=>o});var a=s(2555),i=s(3986),r=s(5043),t=s(579);const n=["variant","size","loading","disabled","className","as","onClick","type","children"],c=r.forwardRef((e,l)=>{let{variant:s="primary",size:r="md",loading:c=!1,disabled:o=!1,className:d="",as:u="button",onClick:m,type:h,children:p}=e,f=(0,i.A)(e,n);const v="button"===u,j=o||c,x=["btn","btn-".concat(s),"btn-".concat(r),d].filter(Boolean).join(" "),y=c?"Yukleniyor...":p;return v?(0,t.jsx)(u,(0,a.A)((0,a.A)({ref:l,type:h||"button",className:x,disabled:j,onClick:m},f),{},{children:y})):(0,t.jsx)(u,(0,a.A)((0,a.A)({ref:l,className:x,"aria-disabled":!!j||void 0,onClick:e=>{if(j)return e.preventDefault(),void e.stopPropagation();null===m||void 0===m||m(e)}},f),{},{children:y}))});c.displayName="Button";const o=c},4199(e,l,s){s.r(l),s.d(l,{default:()=>h});var a=s(5043),i=s(3248),r=s(7559),t=s(5685),n=s(3182),c=s(2894),o=s(3204),d=s(7452),u=s(579);const m={limit:50,offset:0,fields:"brief",order:"created_at:desc"};function h(){var e,l;const s=(0,n.A)(),h=(0,t.KC)(),p=(0,i.jE)(),f=(0,a.useRef)(!1),[v,j]=(0,a.useState)([]),[x,y]=(0,a.useState)(""),[g,b]=(0,a.useState)({}),[N,k]=(0,a.useState)(!1),A=null!=(null===(e=s.user)||void 0===e?void 0:e.country_id);(0,a.useEffect)(()=>{document.title="Schools \xb7 Feasibility Studio"},[]),(0,a.useEffect)(()=>{if(null!==h&&void 0!==h&&h.setHeaderMeta)return h.setHeaderMeta({title:"Okullar",subtitle:"Atanan okullar\u0131n\u0131z listelenir.",centered:!0}),()=>{var e;return null===(e=h.clearHeaderMeta)||void 0===e?void 0:e.call(h)}},[h]);const S=(0,a.useCallback)(async e=>{if(Array.isArray(e)&&e.length){k(!0);try{const l=e.map(e=>e.id),s=await r.FH.getSchoolsProgressBulk(l),a=null!==s&&void 0!==s&&s.progressBySchoolId&&"object"===typeof s.progressBySchoolId?s.progressBySchoolId:{};b(a)}catch(l){const s={};e.forEach(e=>{s[e.id]={state:"error",label:"\u0130lerleme hesaplanamad\u0131"}}),b(s)}finally{k(!1)}}else b({})},[]),w=(0,a.useCallback)(e=>{e&&p.prefetchQuery({queryKey:["scenarios",e,m],queryFn:()=>r.FH.listScenarios(e,m),staleTime:6e4})},[p]),C=(0,a.useCallback)(async()=>{y("");try{const e=await r.FH.listSchools({limit:50,offset:0,fields:"brief",order:"name:asc"}),l=Array.isArray(null===e||void 0===e?void 0:e.items)?e.items:[];j(l)}catch(e){y(e.message||"Failed to load schools")}},[]);return(0,a.useEffect)(()=>{if(s.user)return A?void C():(j([]),y(""),b({}),void k(!1))},[s.user,A,C]),(0,a.useEffect)(()=>{v.length&&S(v)},[v,S]),(0,a.useEffect)(()=>{var e;v.length&&!f.current&&(w(null===(e=v[0])||void 0===e?void 0:e.id),f.current=!0)},[v,w]),(0,u.jsxs)("div",{className:"container",children:[x?(0,u.jsx)("div",{className:"card",style:{marginTop:10,background:"#fff1f2",borderColor:"#fecaca"},children:x}):null,!A&&s.user?(0,u.jsxs)("div",{className:"card",style:{marginTop:12},children:[(0,u.jsx)("div",{style:{fontWeight:700},children:"\xdclke atamas\u0131 yap\u0131lmas\u0131 gerekir."}),(0,u.jsx)("div",{className:"small",style:{marginTop:6},children:"Okul olu\u015fturman\u0131z i\xe7in hesab\u0131n\u0131z \xfclke atamas\u0131 yap\u0131lmas\u0131 gerekir. L\xfctfen y\xf6neticiniz ile ileti\u015fime ge\xe7in."})]}):null,A?(0,u.jsx)("div",{className:"card",style:{marginTop:12},children:(0,u.jsxs)("table",{className:"table",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{children:"Okul/Kamp\xfcs Ad\u0131"}),(0,u.jsx)("th",{children:"Ilerleme"}),(0,u.jsx)("th",{children:"Olu\u015fturma Tarihi"}),(0,u.jsx)("th",{children:"En son guncelleme"}),(0,u.jsx)("th",{})]})}),(0,u.jsx)("tbody",{children:0===v.length?(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:"5",className:"small",children:"Henuz okul tanimlanmamis. Lutfen yoneticiniz ile iletisime gecin."})}):v.map(e=>(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:(0,u.jsx)("b",{children:e.name})}),(0,u.jsx)("td",{style:{minWidth:180},children:g[e.id]?"active"===g[e.id].state?(0,u.jsx)(d.A,{value:g[e.id].pct,tooltipLines:g[e.id].tooltipLines}):(0,u.jsx)("div",{className:"small",children:g[e.id].label||"-"}):(0,u.jsx)("div",{className:"small",children:N?"Hesaplaniyor...":"-"})}),(0,u.jsx)("td",{className:"small",children:new Date(e.created_at).toLocaleString()}),(0,u.jsx)("td",{className:"small",children:new Date(e.updated_at||e.created_at).toLocaleString()}),(0,u.jsx)("td",{children:(0,u.jsx)("div",{className:"row",children:(0,u.jsxs)(c.A,{as:t.N_,variant:"primary",size:"sm",to:"/select?schoolId=".concat(e.id),onMouseEnter:()=>w(e.id),children:[(0,u.jsx)(o.g1V,{})," A\xe7"]})})})]},e.id))})]})}):null,"admin"===(null===(l=s.user)||void 0===l?void 0:l.role)?(0,u.jsx)("div",{className:"card",style:{marginTop:12},children:(0,u.jsx)("div",{className:"small",children:"Okullari ulkelere gore Admin panelinden yonetebilirsiniz."})}):null]})}},4405(e,l,s){s.d(l,{A:()=>i});s(5043);var a=s(579);function i(e){let{text:l,lines:s,children:i,className:r=""}=e;const t=function(e,l){return Array.isArray(e)?e.map(e=>String(e)).filter(e=>e.trim().length>0):"string"===typeof l?l.split("\n").map(e=>e.trim()).filter(Boolean):[]}(s,l);return t.length?(0,a.jsxs)("span",{className:"tooltip-wrap ".concat(r).trim(),children:[i,(0,a.jsx)("span",{className:"tooltip-bubble",role:"tooltip",children:t.map((e,l)=>(0,a.jsx)("div",{className:"tooltip-line",children:e},"".concat(l,"-").concat(e)))})]}):i}},7452(e,l,s){s.d(l,{A:()=>r});s(5043);var a=s(4405),i=s(579);function r(e){let{value:l=0,label:s="",tooltipLines:r}=e;const t=Number(l),n=Number.isFinite(t)?Math.max(0,Math.min(100,t)):0,c=function(e){return e?Array.isArray(e)?e.map(e=>String(e)):"string"===typeof e?e.split("\n"):[]:[]}(r).filter(e=>String(e).trim().length>0),o=(0,i.jsx)("div",{className:"progress-track",children:(0,i.jsx)("div",{className:"progress-bar",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,children:(0,i.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(n,"%")}})})});return(0,i.jsxs)("div",{className:"progress-row",children:[s?(0,i.jsx)("div",{className:"progress-label",children:s}):null,c.length?(0,i.jsx)(a.A,{lines:c,className:"progress-tooltip",children:o}):o,(0,i.jsxs)("div",{className:"progress-value",children:[Math.round(n),"%"]})]})}}}]);
//# sourceMappingURL=199.f79ff02a.chunk.js.map