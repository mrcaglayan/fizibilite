{"version":3,"file":"static/js/399.60b497ee.chunk.js","mappings":"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","sources":["components/NumberInput.jsx","utils/discounts.js","utils/kademe.js","components/ui/TabProgressHeatmap.jsx","components/IncomeEditor.jsx","pages/school/GelirlerPage.jsx","utils/programType.js"],"sourcesContent":["// frontend/src/components/NumberInput.jsx\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\n\r\nconst DEFAULT_LOCALE = \"tr-TR\";\r\n\r\nconst separatorsCache = new Map();\r\n\r\nfunction getSeparators(locale) {\r\n  if (separatorsCache.has(locale)) return separatorsCache.get(locale);\r\n  const parts = new Intl.NumberFormat(locale).formatToParts(1000.1);\r\n  const group = parts.find((p) => p.type === \"group\")?.value || \",\";\r\n  const decimal = parts.find((p) => p.type === \"decimal\")?.value || \".\";\r\n  const next = { group, decimal };\r\n  separatorsCache.set(locale, next);\r\n  return next;\r\n}\r\n\r\nfunction countStepDecimals(step) {\r\n  if (step == null) return 2;\r\n  const s = String(step).trim();\r\n  if (!s || s === \"any\") return 6;\r\n  const dot = s.indexOf(\".\");\r\n  if (dot === -1) return 0;\r\n  return Math.max(0, s.length - dot - 1);\r\n}\r\n\r\nfunction parseFlexibleNumber(input) {\r\n  const raw = String(input ?? \"\").trim();\r\n  if (!raw) return { value: null, empty: true };\r\n\r\n  // Remove spaces and keep only digits/separators/sign.\r\n  const cleaned = raw.replace(/\\s+/g, \"\");\r\n  const hasDot = cleaned.includes(\".\");\r\n  const hasComma = cleaned.includes(\",\");\r\n\r\n  let decimalSep = null;\r\n  let thousandSep = null;\r\n\r\n  if (hasDot && hasComma) {\r\n    const lastDot = cleaned.lastIndexOf(\".\");\r\n    const lastComma = cleaned.lastIndexOf(\",\");\r\n    decimalSep = lastDot > lastComma ? \".\" : \",\";\r\n    thousandSep = decimalSep === \".\" ? \",\" : \".\";\r\n  } else if (hasDot || hasComma) {\r\n    const sep = hasDot ? \".\" : \",\";\r\n    const count = (cleaned.match(new RegExp(`\\\\${sep}`, \"g\")) || []).length;\r\n    if (count > 1) {\r\n      thousandSep = sep;\r\n    } else {\r\n      const idx = cleaned.lastIndexOf(sep);\r\n      const digitsAfter = cleaned.length - idx - 1;\r\n      if (digitsAfter >= 1 && digitsAfter <= 2) {\r\n        decimalSep = sep;\r\n      } else {\r\n        thousandSep = sep;\r\n      }\r\n    }\r\n  }\r\n\r\n  let normalized = cleaned;\r\n  if (thousandSep) normalized = normalized.split(thousandSep).join(\"\");\r\n  if (decimalSep) normalized = normalized.replace(decimalSep, \".\");\r\n  if (!decimalSep) normalized = normalized.replace(/[.,]/g, \"\");\r\n\r\n  // Keep a single leading minus.\r\n  normalized = normalized.replace(/(?!^)-/g, \"\");\r\n  normalized = normalized.replace(/[^0-9.-]/g, \"\");\r\n\r\n  const value = Number(normalized);\r\n  if (!Number.isFinite(value)) return { value: null, empty: false };\r\n  return { value, empty: false };\r\n}\r\n\r\nexport default function NumberInput({\r\n  value,\r\n  onChange,\r\n  onBlur,\r\n  onFocus,\r\n  className,\r\n  step,\r\n  disabled,\r\n  placeholder,\r\n  title,\r\n  name,\r\n  id,\r\n  inputMode,\r\n  ...rest\r\n}) {\r\n  const decimals = useMemo(() => countStepDecimals(step), [step]);\r\n  const locale = DEFAULT_LOCALE;\r\n  const { decimal } = useMemo(() => getSeparators(locale), [locale]);\r\n\r\n  const formatter = useMemo(\r\n    () =>\r\n      new Intl.NumberFormat(locale, {\r\n        useGrouping: true,\r\n        maximumFractionDigits: decimals,\r\n      }),\r\n    [locale, decimals]\r\n  );\r\n\r\n  const rawFormatter = useMemo(\r\n    () =>\r\n      new Intl.NumberFormat(locale, {\r\n        useGrouping: false,\r\n        maximumFractionDigits: decimals,\r\n      }),\r\n    [locale, decimals]\r\n  );\r\n\r\n  const [editing, setEditing] = useState(false);\r\n  const [draft, setDraft] = useState(\"\");\r\n\r\n  const numericValue = Number(value);\r\n  const hasValue = value !== \"\" && value != null && Number.isFinite(numericValue);\r\n\r\n  useEffect(() => {\r\n    if (editing) return;\r\n    if (!hasValue) {\r\n      setDraft(\"\");\r\n      return;\r\n    }\r\n    setDraft(formatter.format(numericValue));\r\n  }, [editing, formatter, hasValue, numericValue]);\r\n\r\n  const handleFocus = (event) => {\r\n    setEditing(true);\r\n    if (hasValue) {\r\n      setDraft(rawFormatter.format(numericValue));\r\n    } else {\r\n      setDraft(\"\");\r\n    }\r\n    onFocus?.(event);\r\n  };\r\n\r\n  const handleChange = (event) => {\r\n    const next = event.target.value;\r\n    setDraft(next);\r\n\r\n    const parsed = parseFlexibleNumber(next);\r\n    if (parsed.empty) {\r\n      onChange?.(\"\");\r\n      return;\r\n    }\r\n    if (parsed.value == null) return;\r\n    onChange?.(parsed.value);\r\n  };\r\n\r\n  const handleBlur = (event) => {\r\n    setEditing(false);\r\n\r\n    const parsed = parseFlexibleNumber(draft);\r\n    if (parsed.empty) {\r\n      setDraft(\"\");\r\n      onChange?.(\"\");\r\n      onBlur?.(event);\r\n      return;\r\n    }\r\n    if (parsed.value != null) {\r\n      const rounded = Number(parsed.value);\r\n      setDraft(formatter.format(rounded));\r\n      onChange?.(rounded);\r\n    }\r\n    onBlur?.(event);\r\n  };\r\n\r\n  return (\r\n    <input\r\n      {...rest}\r\n      id={id}\r\n      name={name}\r\n      className={className}\r\n      value={editing ? draft : draft || \"\"}\r\n      onChange={handleChange}\r\n      onFocus={handleFocus}\r\n      onBlur={handleBlur}\r\n      disabled={disabled}\r\n      placeholder={placeholder}\r\n      title={title}\r\n      inputMode={inputMode || \"decimal\"}\r\n      autoComplete=\"off\"\r\n      aria-invalid={rest[\"aria-invalid\"]}\r\n      data-decimal-separator={decimal}\r\n    />\r\n  );\r\n}\r\n","const clamp = (v, min, max) => Math.min(max, Math.max(min, v));\r\nconst toNum = (v) => {\r\n  const n = Number(v);\r\n  return Number.isFinite(n) ? n : 0;\r\n};\r\n\r\nexport function computeDiscountTotalForYear({\r\n  yearKey,\r\n  discounts,\r\n  grossTuition,\r\n  tuitionStudents,\r\n  avgTuitionFee,\r\n  factor,\r\n}) {\r\n  const students = toNum(tuitionStudents);\r\n  const gross = toNum(grossTuition);\r\n  const tuition = toNum(avgTuitionFee);\r\n  if (gross <= 0 || students <= 0) return 0;\r\n\r\n  // pick helpers WITHOUT cascading fallbacks across years\r\n  const pick = (d, baseKey, yk) => {\r\n    if (!d) return undefined;\r\n    if (yk === \"y2\") return d?.[baseKey + \"Y2\"];\r\n    if (yk === \"y3\") return d?.[baseKey + \"Y3\"];\r\n    return d?.[baseKey];\r\n  };\r\n\r\n  const hasYearSpecific = (d, baseKey, yk) => {\r\n    if (!d) return false;\r\n    if (yk === \"y2\") return d?.[baseKey + \"Y2\"] != null && d?.[baseKey + \"Y2\"] !== \"\";\r\n    if (yk === \"y3\") return d?.[baseKey + \"Y3\"] != null && d?.[baseKey + \"Y3\"] !== \"\";\r\n    return d?.[baseKey] != null && d?.[baseKey] !== \"\";\r\n  };\r\n\r\n  const pickCount = (d, yk) => {\r\n    if (!d) return null;\r\n    if (yk === \"y2\") return d?.studentCountY2;\r\n    if (yk === \"y3\") return d?.studentCountY3;\r\n    return d?.studentCount;\r\n  };\r\n\r\n  let avgRate = 0;\r\n\r\n  for (const d of discounts || []) {\r\n    if (!d) continue;\r\n\r\n    const mode = String(d.mode || \"percent\");\r\n\r\n    const scRaw = pickCount(d, yearKey);\r\n    const sc = scRaw == null || scRaw === \"\" ? null : Math.max(0, Math.round(toNum(scRaw)));\r\n    const ratioFromCount = sc != null && students > 0 ? clamp(sc / students, 0, 1) : null;\r\n    const ratio = ratioFromCount != null ? ratioFromCount : clamp(toNum(pick(d, \"ratio\", yearKey)), 0, 1);\r\n\r\n    const rawValue = pick(d, \"value\", yearKey);\r\n    const value = toNum(rawValue);\r\n\r\n    if (mode === \"fixed\") {\r\n      const perStudent = hasYearSpecific(d, \"value\", yearKey)\r\n        ? Math.max(0, value)\r\n        : Math.max(0, value) * (factor ?? 1);\r\n      if (tuition > 0) avgRate += (ratio * perStudent) / tuition;\r\n    } else {\r\n      const pct = clamp(value, 0, 1);\r\n      avgRate += ratio * pct;\r\n    }\r\n  }\r\n\r\n  const capped = clamp(avgRate, 0, 1);\r\n  const total = gross * capped;\r\n  return Math.min(total, gross);\r\n}\r\n","const GRADES = [\"KG\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"];\r\n\r\nconst KADEME_DEFS = [\r\n  { key: \"okulOncesi\", label: \"Okul Öncesi\", defaultFrom: \"KG\", defaultTo: \"KG\" },\r\n  { key: \"ilkokul\", label: \"İlkokul\", defaultFrom: \"1\", defaultTo: \"5\" },\r\n  { key: \"ortaokul\", label: \"Ortaokul\", defaultFrom: \"6\", defaultTo: \"9\" },\r\n  { key: \"lise\", label: \"Lise\", defaultFrom: \"10\", defaultTo: \"12\" },\r\n];\r\n\r\nfunction normalizeGrade(value) {\r\n  const v = String(value || \"\").trim().toUpperCase();\r\n  if (v === \"KG\") return \"KG\";\r\n  if (!/^\\d{1,2}$/.test(v)) return null;\r\n  const n = Number(v);\r\n  if (!Number.isFinite(n) || n < 1 || n > 12) return null;\r\n  return String(n);\r\n}\r\n\r\nfunction gradeIndex(value) {\r\n  const g = normalizeGrade(value);\r\n  if (!g) return -1;\r\n  return GRADES.indexOf(g);\r\n}\r\n\r\nfunction normalizeRange(fromValue, toValue, def) {\r\n  const from = normalizeGrade(fromValue) ?? def.defaultFrom;\r\n  const to = normalizeGrade(toValue) ?? def.defaultTo;\r\n  const fromIdx = gradeIndex(from);\r\n  const toIdx = gradeIndex(to);\r\n  if (fromIdx < 0 || toIdx < 0) return { from: def.defaultFrom, to: def.defaultTo };\r\n  if (fromIdx <= toIdx) return { from, to };\r\n  return { from: to, to: from };\r\n}\r\n\r\nexport function getKademeDefinitions() {\r\n  return KADEME_DEFS.map((d) => ({ ...d }));\r\n}\r\n\r\nexport function getDefaultKademeConfig() {\r\n  const out = {};\r\n  KADEME_DEFS.forEach((d) => {\r\n    out[d.key] = { enabled: true, from: d.defaultFrom, to: d.defaultTo };\r\n  });\r\n  return out;\r\n}\r\n\r\nexport function normalizeKademeConfig(config) {\r\n  const cfg = config && typeof config === \"object\" ? config : {};\r\n  const out = {};\r\n  KADEME_DEFS.forEach((d) => {\r\n    const row = cfg[d.key] && typeof cfg[d.key] === \"object\" ? cfg[d.key] : {};\r\n    const enabled = row.enabled !== false;\r\n    const range = normalizeRange(row.from, row.to, d);\r\n    out[d.key] = { enabled, ...range };\r\n  });\r\n  return out;\r\n}\r\n\r\nexport function getKademeRangeLabel(config, key) {\r\n  const def = KADEME_DEFS.find((d) => d.key === key);\r\n  if (!def) return \"\";\r\n  const cfg = normalizeKademeConfig(config)[key];\r\n  if (!cfg?.enabled) return \"\";\r\n  return cfg.from === cfg.to ? cfg.from : `${cfg.from}-${cfg.to}`;\r\n}\r\n\r\nexport function formatKademeLabel(label, config, key) {\r\n  const range = getKademeRangeLabel(config, key);\r\n  if (!range) return label;\r\n  return `${label} (${range})`;\r\n}\r\n\r\nexport function getKademeForGrade(grade, config) {\r\n  const idx = gradeIndex(grade);\r\n  if (idx < 0) return null;\r\n  const cfg = normalizeKademeConfig(config);\r\n  for (const def of KADEME_DEFS) {\r\n    const row = cfg[def.key];\r\n    if (!row?.enabled) continue;\r\n    const fromIdx = gradeIndex(row.from);\r\n    const toIdx = gradeIndex(row.to);\r\n    if (fromIdx <= idx && idx <= toIdx) return def.key;\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function summarizeGradesByKademe(grades, config) {\r\n  const rows = Array.isArray(grades) ? grades : [];\r\n  const out = { okulOncesi: 0, ilkokul: 0, ortaokul: 0, lise: 0, total: 0 };\r\n\r\n  for (const r of rows) {\r\n    // studentsPerBranch now represents TOTAL students for the grade (not per-branch).\r\n    const students = Number(r?.studentsPerBranch || 0);\r\n    if (!Number.isFinite(students)) continue;\r\n    out.total += students;\r\n    const key = getKademeForGrade(r?.grade, config);\r\n    if (key && Object.prototype.hasOwnProperty.call(out, key)) out[key] += students;\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\nexport function getGradeOptions() {\r\n  return GRADES.map((g) => g);\r\n}\r\n","import React from \"react\";\r\nimport { FaInfoCircle } from \"react-icons/fa\";\r\n\r\nfunction clampPct(value) {\r\n  const n = Number(value);\r\n  if (!Number.isFinite(n)) return 0;\r\n  return Math.max(0, Math.min(100, n));\r\n}\r\n\r\nfunction buildTitle({ pct, title, missingPreview, missingLines }) {\r\n  const lines = Array.isArray(missingLines)\r\n    ? missingLines.map((line) => String(line)).filter(Boolean).slice(0, 15)\r\n    : [];\r\n  if (lines.length) return lines.join(\"\\n\");\r\n  if (missingPreview) return String(missingPreview);\r\n  if (title) return `${title}: ${pct}%`;\r\n  return `${pct}%`;\r\n}\r\n\r\nexport default function TabProgressHeatmap({\r\n  pct = 0,\r\n  title = \"\",\r\n  missingPreview = \"\",\r\n  missingLines = [],\r\n  children,\r\n}) {\r\n  const clamped = clampPct(pct);\r\n  const mask = `linear-gradient(90deg, #000 0%, #000 ${clamped}%, transparent ${clamped}%, transparent 100%)`;\r\n  const tooltipText = buildTitle({\r\n    pct: Math.round(clamped),\r\n    title,\r\n    missingPreview,\r\n    missingLines,\r\n  });\r\n  const showInfo = clamped < 100;\r\n\r\n  return (\r\n    <div style={{ position: \"relative\", overflow: \"hidden\", borderRadius: 12 }}>\r\n      <div\r\n        aria-hidden=\"true\"\r\n        style={{\r\n          position: \"absolute\",\r\n          inset: 0,\r\n          pointerEvents: \"none\",\r\n          zIndex: 0,\r\n          backgroundImage:\r\n            \"linear-gradient(90deg, rgba(16,185,129, 0.05) 0%, rgba(16,185,129, 0.10) 30%, rgba(16,185,129, 0.16) 70%, rgba(16,185,129, 0.10) 100%), radial-gradient(circle at 20% 45%, rgba(16,185,129, 0.14) 0%, rgba(16,185,129, 0.00) 65%)\",\r\n          WebkitMaskImage: mask,\r\n          maskImage: mask,\r\n        }}\r\n      />\r\n\r\n      {showInfo ? (\r\n        <button\r\n          type=\"button\"\r\n          title={tooltipText}\r\n          aria-label=\"Progress details\"\r\n          style={{\r\n            position: \"absolute\",\r\n            top: 12,\r\n            right: 12,\r\n            zIndex: 20,\r\n            width: 26,\r\n            height: 26,\r\n            borderRadius: 999,\r\n            border: \"1px solid rgba(15, 23, 42, 0.15)\",\r\n            background: \"rgba(255, 255, 255, 0.9)\",\r\n            color: \"#0f172a\",\r\n            display: \"inline-flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            cursor: \"help\",\r\n            boxShadow: \"0 6px 16px rgba(15, 23, 42, 0.08)\",\r\n          }}\r\n        >\r\n          <FaInfoCircle size={12} />\r\n        </button>\r\n      ) : null}\r\n\r\n      <div style={{ position: \"relative\", zIndex: 1 }}>{children}</div>\r\n    </div>\r\n  );\r\n}\r\n","//frontend/src/components/IncomeEditor.jsx\r\n\r\nimport React, { useCallback, useMemo } from \"react\";\r\nimport { formatKademeLabel, summarizeGradesByKademe } from \"../utils/kademe\";\r\nimport { getProgramType, isKademeKeyVisible } from \"../utils/programType\";\r\nimport { computeDiscountTotalForYear } from \"../utils/discounts\";\r\nimport NumberInput from \"./NumberInput\";\r\n\r\nconst toNum = (v) => {\r\n  const n = Number(v);\r\n  return Number.isFinite(n) ? n : 0;\r\n};\r\n\r\nconst fmtMoney = (v) =>\r\n  Number.isFinite(v) ? v.toLocaleString(undefined, { maximumFractionDigits: 2 }) : \"-\";\r\nconst fmt0 = (v) =>\r\n  Number.isFinite(v) ? v.toLocaleString(undefined, { maximumFractionDigits: 0 }) : \"-\";\r\nconst fmtPct = (v) =>\r\n  Number.isFinite(v) ? (v * 100).toFixed(2) + \"%\" : \"-\";\r\n\r\nconst YEAR_KEYS = [\"y1\", \"y2\", \"y3\"];\r\nconst EMPTY_ROWS = Object.freeze([]);\r\n\r\nconst TUITION_ROWS = [\r\n  { key: \"okulOncesi\", label: \"Okul Öncesi\" },\r\n  { key: \"ilkokulYerel\", label: \"İlkokul-YEREL\" },\r\n  { key: \"ilkokulInt\", label: \"İlkokul-INT.\" },\r\n  { key: \"ortaokulYerel\", label: \"Ortaokul-YEREL\" },\r\n  { key: \"ortaokulInt\", label: \"Ortaokul-INT.\" },\r\n  { key: \"liseYerel\", label: \"Lise-YEREL\" },\r\n  { key: \"liseInt\", label: \"Lise-INT.\" },\r\n];\r\n\r\nconst NON_ED_ROWS = [\r\n  { key: \"yemek\", label: \"Yemek\" },\r\n  { key: \"uniforma\", label: \"Üniforma\" },\r\n  { key: \"kitap\", label: \"Kitap\" },\r\n  { key: \"ulasim\", label: \"Ulaşım\" },\r\n];\r\n\r\nconst DORM_ROWS = [\r\n  { key: \"yurt\", label: \"Yurt Gelirleri\" },\r\n  { key: \"yazOkulu\", label: \"Yaz Okulu Dersleri Gelirleri\" },\r\n];\r\n\r\nconst OTHER_INCOME_ROWS = [\r\n  { key: \"gayrimenkulKira\", label: \"Gayrimenkul Kira Gelirleri ve Diğer Gelirler\" },\r\n  { key: \"isletmeGelirleri\", label: \"İşletme Gelirleri (Kantin, Kafeterya, Sosyal Faaliyet ve Spor Kulüpleri vb.)\" },\r\n  { key: \"tesisKira\", label: \"Bina ve Tesislerin Konaklama, Sosyal, Kültür, Spor vb. Amaçlı Kullanımından Kaynaklı Tesis Kira Gelirleri\" },\r\n  { key: \"egitimDisiHizmet\", label: \"Eğitim Dışı Verilen Hizmetler (Danışmanlık vb.) Karşılığı Gelirler\" },\r\n  { key: \"yazOkuluOrganizasyon\", label: \"Yaz Okulları, Organizasyon, Kurs vb. İkinci Eğitim Gelirleri\" },\r\n  { key: \"kayitUcreti\", label: \"Kayıt Ücreti\" },\r\n  { key: \"bagislar\", label: \"Bağışlar\" },\r\n  { key: \"stkKamu\", label: \"STK/Kamu Sübvansiyonları\" },\r\n  { key: \"faizPromosyon\", label: \"Faiz, Banka Promosyon/Komisyon vb. Kaynaklı Gelirler\" },\r\n];\r\n\r\nfunction computeStudentsFromGrades(grades, kademeConfig) {\r\n  const sums = summarizeGradesByKademe(grades, kademeConfig);\r\n  return {\r\n    kg: toNum(sums.okulOncesi),\r\n    ilkokul: toNum(sums.ilkokul),\r\n    ortaokul: toNum(sums.ortaokul),\r\n    lise: toNum(sums.lise),\r\n    total: toNum(sums.total),\r\n  };\r\n}\r\n\r\nfunction defaultGelirler() {\r\n  return {\r\n    tuition: {\r\n      rows: TUITION_ROWS.map((r) => ({ key: r.key, label: r.label, studentCount: 0, unitFee: 0 })),\r\n    },\r\n    nonEducationFees: {\r\n      rows: NON_ED_ROWS.map((r) => ({\r\n        key: r.key,\r\n        label: r.label,\r\n        studentCount: 0,\r\n        studentCountY2: 0,\r\n        studentCountY3: 0,\r\n        unitFee: 0,\r\n      })),\r\n    },\r\n    dormitory: {\r\n      rows: DORM_ROWS.map((r) => ({\r\n        key: r.key,\r\n        label: r.label,\r\n        studentCount: 0,\r\n        studentCountY2: 0,\r\n        studentCountY3: 0,\r\n        unitFee: 0,\r\n      })),\r\n    },\r\n    otherInstitutionIncome: {\r\n      rows: OTHER_INCOME_ROWS.map((r) => ({ key: r.key, label: r.label, amount: 0 })),\r\n    },\r\n    governmentIncentives: 0,\r\n  };\r\n}\r\n\r\nfunction normalizeRows(baseRows, savedRows, keyField) {\r\n  const base = Array.isArray(baseRows) ? baseRows : [];\r\n  const saved = Array.isArray(savedRows) ? savedRows : [];\r\n  const byKey = new Map(saved.map((r) => [String(r?.[keyField] ?? r?.key ?? \"\"), r]));\r\n\r\n  const merged = base.map((b) => {\r\n    const k = String(b?.[keyField] ?? b?.key ?? \"\");\r\n    const s = byKey.get(k);\r\n    return s ? { ...b, ...s, key: b.key, label: b.label } : b;\r\n  });\r\n\r\n  const baseKeys = new Set(base.map((b) => String(b?.[keyField] ?? b?.key ?? \"\")));\r\n  const extras = saved.filter((s) => !baseKeys.has(String(s?.[keyField] ?? s?.key ?? \"\")));\r\n\r\n  return [...merged, ...extras];\r\n}\r\n\r\nfunction normalizeGelirler(saved, grades, kademeConfig) {\r\n  const base = defaultGelirler();\r\n  const g = saved && typeof saved === \"object\" ? saved : {};\r\n\r\n  // Legacy mapping (old per-student fields)\r\n  const isLegacy =\r\n    !g.tuition &&\r\n    (g.tuitionFeePerStudentYearly != null ||\r\n      g.lunchFeePerStudentYearly != null ||\r\n      g.dormitoryFeePerStudentYearly != null ||\r\n      g.otherFeePerStudentYearly != null);\r\n\r\n  const suggested = computeStudentsFromGrades(grades, kademeConfig);\r\n\r\n  const next = {\r\n    ...base,\r\n    ...g,\r\n    tuition: {\r\n      ...base.tuition,\r\n      ...(g.tuition || {}),\r\n      rows: normalizeRows(base.tuition.rows, g.tuition?.rows, \"key\"),\r\n    },\r\n    nonEducationFees: {\r\n      ...base.nonEducationFees,\r\n      ...(g.nonEducationFees || {}),\r\n      rows: normalizeRows(base.nonEducationFees.rows, g.nonEducationFees?.rows, \"key\"),\r\n    },\r\n    dormitory: {\r\n      ...base.dormitory,\r\n      ...(g.dormitory || {}),\r\n      rows: normalizeRows(base.dormitory.rows, g.dormitory?.rows, \"key\"),\r\n    },\r\n    otherInstitutionIncome: {\r\n      ...base.otherInstitutionIncome,\r\n      ...(g.otherInstitutionIncome || {}),\r\n      rows: normalizeRows(base.otherInstitutionIncome.rows, g.otherInstitutionIncome?.rows, \"key\"),\r\n    },\r\n    governmentIncentives: g.governmentIncentives ?? base.governmentIncentives,\r\n  };\r\n\r\n  // Backward compatible: if a scenario didn't store Y2/Y3 student counts for manual tables,\r\n  // initialize them to Year-1 counts so the table isn't blank.\r\n  const withManualYearCounts = (rows) =>\r\n    (Array.isArray(rows) ? rows : []).map((r) => {\r\n      const sc = toNum(r?.studentCount);\r\n      const y2 = r?.studentCountY2 == null ? sc : toNum(r?.studentCountY2);\r\n      const y3 = r?.studentCountY3 == null ? sc : toNum(r?.studentCountY3);\r\n      return { ...r, studentCount: sc, studentCountY2: y2, studentCountY3: y3 };\r\n    });\r\n\r\n  next.nonEducationFees.rows = withManualYearCounts(next.nonEducationFees.rows);\r\n  next.dormitory.rows = withManualYearCounts(next.dormitory.rows);\r\n\r\n  if (isLegacy) {\r\n    const tuitionFee = toNum(g.tuitionFeePerStudentYearly);\r\n    const lunchFee = toNum(g.lunchFeePerStudentYearly);\r\n    const dormFee = toNum(g.dormitoryFeePerStudentYearly);\r\n\r\n    next.tuition.rows = next.tuition.rows.map((r) => (r.unitFee ? r : { ...r, unitFee: tuitionFee }));\r\n    next.nonEducationFees.rows = next.nonEducationFees.rows.map((r) =>\r\n      r.key === \"yemek\" && !r.unitFee ? { ...r, unitFee: lunchFee } : r\r\n    );\r\n    next.dormitory.rows = next.dormitory.rows.map((r) =>\r\n      r.key === \"yurt\" && !r.unitFee ? { ...r, unitFee: dormFee } : r\r\n    );\r\n\r\n    const anyTuitionStudents = next.tuition.rows.some((r) => toNum(r.studentCount) > 0);\r\n    if (!anyTuitionStudents) {\r\n      next.tuition.rows = next.tuition.rows.map((r, idx) => {\r\n        let sc = 0;\r\n        if (r.key === \"okulOncesi\") sc = suggested.kg;\r\n        else if (r.key === \"ilkokulYerel\") sc = suggested.ilkokul;\r\n        else if (r.key === \"ortaokulYerel\") sc = suggested.ortaokul;\r\n        else if (r.key === \"liseYerel\") sc = suggested.lise;\r\n        return { ...r, studentCount: sc };\r\n      });\r\n    }\r\n  }\r\n\r\n  return next;\r\n}\r\n\r\nfunction getInflationFactors(temelBilgiler) {\r\n  const infl = temelBilgiler?.inflation || {};\r\n  const y2 = toNum(infl.y2);\r\n  const y3 = toNum(infl.y3);\r\n  return {\r\n    y1: 1,\r\n    y2: 1 + y2,\r\n    y3: (1 + y2) * (1 + y3),\r\n  };\r\n}\r\n\r\nexport default function IncomeEditor({\r\n  gelirler,\r\n  temelBilgiler,\r\n  baseYear,\r\n  onChange,\r\n  grades,\r\n  gradesYears,\r\n  discounts,\r\n  currencyCode = \"USD\",\r\n  dirtyPaths,\r\n  onDirty,\r\n}) {\r\n  const normalizedGradesYears = useMemo(() => {\r\n    const src = gradesYears && typeof gradesYears === \"object\" ? gradesYears : null;\r\n    const fallback = grades || {};\r\n    const y1 = src?.y1 || fallback;\r\n    const y2 = src?.y2 || y1;\r\n    const y3 = src?.y3 || y2;\r\n    return { y1, y2, y3 };\r\n  }, [gradesYears, grades]);\r\n\r\n  const suggestedByYear = useMemo(() => {\r\n    const kademeConfig = temelBilgiler?.kademeler;\r\n    return {\r\n      y1: computeStudentsFromGrades(normalizedGradesYears.y1, kademeConfig),\r\n      y2: computeStudentsFromGrades(normalizedGradesYears.y2, kademeConfig),\r\n      y3: computeStudentsFromGrades(normalizedGradesYears.y3, kademeConfig),\r\n    };\r\n  }, [normalizedGradesYears, temelBilgiler?.kademeler]);\r\n\r\n  // Backward compatibility: places that still expect a single \"suggested\" use Year-1 values.\r\n  const suggested = suggestedByYear.y1;\r\n\r\n  const g = useMemo(\r\n    () => normalizeGelirler(gelirler, normalizedGradesYears.y1, temelBilgiler?.kademeler),\r\n    [gelirler, normalizedGradesYears, temelBilgiler?.kademeler]\r\n  );\r\n  const programType = useMemo(() => getProgramType({ temelBilgiler }), [temelBilgiler]);\r\n  const kademeLabels = useMemo(\r\n    () => ({\r\n      okulOncesi: formatKademeLabel(\"Okul Öncesi\", temelBilgiler?.kademeler, \"okulOncesi\"),\r\n      ilkokulYerel: `${formatKademeLabel(\"İlkokul\", temelBilgiler?.kademeler, \"ilkokul\")}-YEREL`,\r\n      ilkokulInt: `${formatKademeLabel(\"İlkokul\", temelBilgiler?.kademeler, \"ilkokul\")}-INT.`,\r\n      ortaokulYerel: `${formatKademeLabel(\"Ortaokul\", temelBilgiler?.kademeler, \"ortaokul\")}-YEREL`,\r\n      ortaokulInt: `${formatKademeLabel(\"Ortaokul\", temelBilgiler?.kademeler, \"ortaokul\")}-INT.`,\r\n      liseYerel: `${formatKademeLabel(\"Lise\", temelBilgiler?.kademeler, \"lise\")}-YEREL`,\r\n      liseInt: `${formatKademeLabel(\"Lise\", temelBilgiler?.kademeler, \"lise\")}-INT.`,\r\n    }),\r\n    [temelBilgiler?.kademeler]\r\n  );\r\n  const tuitionBaseByKey = useMemo(\r\n    () => ({\r\n      okulOncesi: \"okulOncesi\",\r\n      ilkokulYerel: \"ilkokul\",\r\n      ilkokulInt: \"ilkokul\",\r\n      ortaokulYerel: \"ortaokul\",\r\n      ortaokulInt: \"ortaokul\",\r\n      liseYerel: \"lise\",\r\n      liseInt: \"lise\",\r\n    }),\r\n    []\r\n  );\r\n  const factors = useMemo(() => getInflationFactors(temelBilgiler), [temelBilgiler]);\r\n  const pathForRow = (sectionKey, rowKey, field) =>\r\n    `inputs.gelirler.${sectionKey}.rows.${rowKey}.${field}`;\r\n  const pathForOtherRow = (rowKey) => `inputs.gelirler.otherInstitutionIncome.rows.${rowKey}.amount`;\r\n  const govtPath = \"inputs.gelirler.governmentIncentives\";\r\n  const isDirty = (path) => (dirtyPaths ? dirtyPaths.has(path) : false);\r\n  const inputClass = (base, path) => base + (isDirty(path) ? \" input-dirty\" : \"\");\r\n\r\n  const tuitionRows = useMemo(() => g.tuition?.rows || EMPTY_ROWS, [g.tuition?.rows]);\r\n  const visibleTuitionRows = useMemo(\r\n    () =>\r\n      tuitionRows.filter((r) => {\r\n        const baseKey = tuitionBaseByKey[r.key];\r\n        const baseEnabled = !baseKey || temelBilgiler?.kademeler?.[baseKey]?.enabled !== false;\r\n        return baseEnabled && isKademeKeyVisible(r.key, programType);\r\n      }),\r\n    [tuitionRows, tuitionBaseByKey, temelBilgiler?.kademeler, programType]\r\n  );\r\n  const nonEdRows = useMemo(() => g.nonEducationFees?.rows || EMPTY_ROWS, [g.nonEducationFees?.rows]);\r\n  const dormRows = useMemo(() => g.dormitory?.rows || EMPTY_ROWS, [g.dormitory?.rows]);\r\n  const otherRows = useMemo(\r\n    () => g.otherInstitutionIncome?.rows || EMPTY_ROWS,\r\n    [g.otherInstitutionIncome?.rows]\r\n  );\r\n  const nonEdRowByKey = useMemo(\r\n    () => new Map(nonEdRows.map((r) => [String(r.key), r])),\r\n    [nonEdRows]\r\n  );\r\n  const dormRowByKey = useMemo(\r\n    () => new Map(dormRows.map((r) => [String(r.key), r])),\r\n    [dormRows]\r\n  );\r\n\r\n  const getManualStudentCount = useCallback((row, yearKey) => {\r\n    if (!row) return 0;\r\n    const v =\r\n      yearKey === \"y1\"\r\n        ? row.studentCount\r\n        : yearKey === \"y2\"\r\n          ? row.studentCountY2 ?? row.studentCount\r\n          : row.studentCountY3 ?? row.studentCount;\r\n    return toNum(v);\r\n  }, []);\r\n\r\n  const suggestedForTuitionKeyYear = useCallback(\r\n    (key, yearKey) => {\r\n      const s = suggestedByYear?.[yearKey] || suggestedByYear?.y1 || suggested;\r\n      if (key === \"okulOncesi\") return s.kg;\r\n      if (key === \"ilkokulYerel\" || key === \"ilkokulInt\") return s.ilkokul;\r\n      if (key === \"ortaokulYerel\" || key === \"ortaokulInt\") return s.ortaokul;\r\n      if (key === \"liseYerel\" || key === \"liseInt\") return s.lise;\r\n      return 0;\r\n    },\r\n    [suggested, suggestedByYear]\r\n  );\r\n\r\n  const studentCountForRowYear = useCallback(\r\n    (sectionKey, rowKey, yearKey) => {\r\n      if (sectionKey === \"tuition\") return toNum(suggestedForTuitionKeyYear(rowKey, yearKey));\r\n      if (sectionKey === \"nonEducationFees\")\r\n        return getManualStudentCount(nonEdRowByKey.get(String(rowKey)), yearKey);\r\n      if (sectionKey === \"dormitory\")\r\n        return getManualStudentCount(dormRowByKey.get(String(rowKey)), yearKey);\r\n      return 0;\r\n    },\r\n    [dormRowByKey, getManualStudentCount, nonEdRowByKey, suggestedForTuitionKeyYear]\r\n  );\r\n\r\n  const tuitionStudentsByYear = useMemo(() => {\r\n    const out = { y1: 0, y2: 0, y3: 0 };\r\n    for (const y of YEAR_KEYS) {\r\n      out[y] = visibleTuitionRows.reduce(\r\n        (s, r) => s + studentCountForRowYear(\"tuition\", r.key, y),\r\n        0\r\n      );\r\n    }\r\n    return out;\r\n  }, [studentCountForRowYear, visibleTuitionRows]);\r\n\r\n  const byYear = useMemo(() => {\r\n    const out = {};\r\n\r\n    for (const y of YEAR_KEYS) {\r\n      const f = factors?.[y] ?? 1;\r\n\r\n      const tuitionTotal = visibleTuitionRows.reduce(\r\n        (s, r) => s + studentCountForRowYear(\"tuition\", r.key, y) * (toNum(r.unitFee) * f),\r\n        0\r\n      );\r\n      const nonEdTotal = nonEdRows.reduce(\r\n        (s, r) => s + studentCountForRowYear(\"nonEducationFees\", r.key, y) * (toNum(r.unitFee) * f),\r\n        0\r\n      );\r\n      const dormTotal = dormRows.reduce(\r\n        (s, r) => s + studentCountForRowYear(\"dormitory\", r.key, y) * (toNum(r.unitFee) * f),\r\n        0\r\n      );\r\n      const activityGross = tuitionTotal + nonEdTotal + dormTotal;\r\n\r\n      const otherInstitutionTotal = otherRows.reduce((s, r) => s + (toNum(r.amount) * f), 0);\r\n      const govt = toNum(g.governmentIncentives) * f;\r\n      const otherTotal = otherInstitutionTotal + govt;\r\n      const grossTotal = activityGross + otherTotal;\r\n\r\n      const fallbackStudents = suggestedByYear?.[y]?.total ?? suggested.total;\r\n      const tuitionBaseStudents = tuitionStudentsByYear?.[y] > 0 ? tuitionStudentsByYear[y] : fallbackStudents;\r\n      const avgTuitionFee = tuitionBaseStudents > 0 ? tuitionTotal / tuitionBaseStudents : 0;\r\n      const totalDiscounts = computeDiscountTotalForYear({\r\n        yearKey: y,\r\n        discounts,\r\n        grossTuition: tuitionTotal,\r\n        tuitionStudents: tuitionBaseStudents,\r\n        avgTuitionFee,\r\n        factor: f,\r\n      });\r\n\r\n      const netActivity = activityGross - totalDiscounts;\r\n      const netIncome = grossTotal - totalDiscounts;\r\n      const netCiroPerStudent = tuitionBaseStudents > 0 ? netActivity / tuitionBaseStudents : null;\r\n      const otherIncomeRatio = netIncome > 0 ? otherTotal / netIncome : null;\r\n\r\n      out[y] = {\r\n        tuitionTotal,\r\n        nonEdTotal,\r\n        dormTotal,\r\n        activityGross,\r\n        otherInstitutionTotal,\r\n        govt,\r\n        otherTotal,\r\n        grossTotal,\r\n        totalDiscounts,\r\n        netActivity,\r\n        netIncome,\r\n        netCiroPerStudent,\r\n        otherIncomeRatio,\r\n      };\r\n    }\r\n\r\n    return out;\r\n  }, [\r\n    discounts,\r\n    dormRows,\r\n    factors,\r\n    g.governmentIncentives,\r\n    nonEdRows,\r\n    otherRows,\r\n    suggested,\r\n    suggestedByYear,\r\n    tuitionStudentsByYear,\r\n    visibleTuitionRows,\r\n    studentCountForRowYear,\r\n  ]);\r\n\r\n  function update(path, value) {\r\n    const next = structuredClone(g);\r\n    const keys = path.split(\".\");\r\n    let obj = next;\r\n    for (let i = 0; i < keys.length - 1; i++) {\r\n      obj[keys[i]] = obj[keys[i]] || {};\r\n      obj = obj[keys[i]];\r\n    }\r\n    obj[keys[keys.length - 1]] = value;\r\n    onChange(next);\r\n  }\r\n\r\n  function setRow(sectionKey, rowKey, field, value) {\r\n    const nextValue = value === \"\" ? 0 : toNum(value);\r\n    const rows = (g[sectionKey]?.rows || []).map((r) => {\r\n      if (String(r.key) !== String(rowKey)) return r;\r\n      return { ...r, [field]: nextValue };\r\n    });\r\n    update(sectionKey + \".rows\", rows);\r\n    onDirty?.(pathForRow(sectionKey, rowKey, field), nextValue);\r\n  }\r\n\r\n  function setOtherRow(rowKey, value) {\r\n    const nextValue = value === \"\" ? 0 : toNum(value);\r\n    const rows = (g.otherInstitutionIncome?.rows || []).map((r) => {\r\n      if (String(r.key) !== String(rowKey)) return r;\r\n      return { ...r, amount: nextValue };\r\n    });\r\n    update(\"otherInstitutionIncome.rows\", rows);\r\n    onDirty?.(pathForOtherRow(rowKey), nextValue);\r\n  }\r\n\r\n\r\n\r\n  const yearMeta = useMemo(() => {\r\n    const y = Number.isFinite(Number(baseYear)) ? Number(baseYear) : null;\r\n    const mk = (idx) => {\r\n      const n = idx + 1;\r\n      const start = y != null ? y + idx : null;\r\n      const end = start != null ? start + 1 : null;\r\n      const range = start != null && end != null ? `${start}-${end}` : \"\";\r\n      const labelLong = range ? `${n}.Yıl (${range} EĞİTİM ÖĞRETİM YILI)` : `${n}.Yıl`;\r\n      const labelShort = range ? `${n}.Yıl (${range})` : `${n}.Yıl`;\r\n      return { n, start, end, range, labelLong, labelShort };\r\n    };\r\n    return { y1: mk(0), y2: mk(1), y3: mk(2) };\r\n  }, [baseYear]);\r\n\r\n\r\n  const sectionTable = (title, rows, sectionKey, unitField = \"unitFee\") => {\r\n    const totals = { y1: 0, y2: 0, y3: 0 };\r\n    const totalStudents = { y1: 0, y2: 0, y3: 0 };\r\n\r\n    for (const r of rows) {\r\n      const uf1 = toNum(r[unitField]);\r\n      const uf2 = uf1 * factors.y2;\r\n      const uf3 = uf1 * factors.y3;\r\n\r\n      const sc1 = studentCountForRowYear(sectionKey, r.key, \"y1\");\r\n      const sc2 = studentCountForRowYear(sectionKey, r.key, \"y2\");\r\n      const sc3 = studentCountForRowYear(sectionKey, r.key, \"y3\");\r\n\r\n      totalStudents.y1 += sc1;\r\n      totalStudents.y2 += sc2;\r\n      totalStudents.y3 += sc3;\r\n\r\n      totals.y1 += sc1 * uf1;\r\n      totals.y2 += sc2 * uf2;\r\n      totals.y3 += sc3 * uf3;\r\n    }\r\n\r\n    const isTuitionSection = sectionKey === \"tuition\";\r\n\r\n    const isTuition = sectionKey === \"tuition\";\r\n    return (\r\n      <>\r\n        <div className={`section-head ${isTuition ? \"is-tuition\" : \"\"}`}>\r\n          <div className=\"section-title\">{title}</div>\r\n        </div>\r\n        <div className=\"table-scroll income-section-table\" style={{ marginTop: 8 }}>\r\n          <table className={`table data-table table-3y income-3block ${isTuition ? \"is-tuition\" : \"\"}`}>\r\n            <thead>\r\n              <tr className=\"group\">\r\n                <th rowSpan={2}>Kalem</th>\r\n                <th colSpan={3} className=\"sep-left\" style={{ textAlign: \"center\" }}>\r\n                  {yearMeta.y1.labelLong}\r\n                </th>\r\n                <th colSpan={3} className=\"sep-left\" style={{ textAlign: \"center\" }}>\r\n                  {yearMeta.y2.labelLong}\r\n                </th>\r\n                <th colSpan={3} className=\"sep-left\" style={{ textAlign: \"center\" }}>\r\n                  {yearMeta.y3.labelLong}\r\n                </th>\r\n              </tr>\r\n              <tr>\r\n                <th className=\"sep-left\" style={{ width: 130, textAlign: \"right\" }}>\r\n                  Öğrenci Sayısı\r\n                </th>\r\n\r\n                <th style={{ width: 120, textAlign: \"right\" }}>{`Birim Ücret (${currencyCode})`}</th>\r\n                <th style={{ width: 140, textAlign: \"right\" }}>{`Toplam (${currencyCode})`}</th>\r\n\r\n                <th className=\"sep-left\" style={{ width: 130, textAlign: \"right\" }}>\r\n                  Öğrenci Sayısı\r\n                </th>\r\n                <th style={{ width: 120, textAlign: \"right\" }}>{`Birim Ücret (${currencyCode})`}</th>\r\n                <th style={{ width: 140, textAlign: \"right\" }}>{`Toplam (${currencyCode})`}</th>\r\n\r\n                <th className=\"sep-left\" style={{ width: 130, textAlign: \"right\" }}>\r\n                  Öğrenci Sayısı\r\n                </th>\r\n                <th style={{ width: 120, textAlign: \"right\" }}>{`Birim Ücret (${currencyCode})`}</th>\r\n                <th style={{ width: 140, textAlign: \"right\" }}>{`Toplam (${currencyCode})`}</th>\r\n              </tr>\r\n            </thead>\r\n\r\n            <tbody>\r\n              {rows.map((r, idx) => {\r\n                const uf1 = toNum(r[unitField]);\r\n                const uf2 = uf1 * factors.y2;\r\n                const uf3 = uf1 * factors.y3;\r\n\r\n                const sc1 = studentCountForRowYear(sectionKey, r.key, \"y1\");\r\n                const sc2 = studentCountForRowYear(sectionKey, r.key, \"y2\");\r\n                const sc3 = studentCountForRowYear(sectionKey, r.key, \"y3\");\r\n\r\n                const t1 = sc1 * uf1;\r\n                const t2 = sc2 * uf2;\r\n                const t3 = sc3 * uf3;\r\n\r\n                const displayLabel = isTuitionSection ? (kademeLabels[r.key] || r.label) : r.label;\r\n\r\n                return (\r\n                  <tr key={r.key} className={idx === 0 ? \"row-group-start\" : \"\"}>\r\n                    <td>{displayLabel}</td>\r\n\r\n                    {/* 1. Yıl */}\r\n                    <td className=\"sep-left cell-count\">\r\n                      <NumberInput\r\n                        className={inputClass(\"input xs\", pathForRow(sectionKey, r.key, \"studentCount\"))}\r\n                       \r\n                        min=\"0\"\r\n                        step=\"1\"\r\n                        value={sc1}\r\n                        disabled={isTuitionSection}\r\n                        onChange={(value) => setRow(sectionKey, r.key, \"studentCount\", value)}\r\n                      />\r\n                    </td>\r\n                    <td className=\"cell-num\">\r\n                      <NumberInput\r\n                        className={inputClass(\"input xs\", pathForRow(sectionKey, r.key, unitField))}\r\n                       \r\n                        min=\"0\"\r\n                        step=\"0.01\"\r\n                        value={uf1}\r\n                        onChange={(value) => setRow(sectionKey, r.key, unitField, value)}\r\n                      />\r\n                    </td>\r\n                    <td className=\"cell-num\">{fmtMoney(t1)}</td>\r\n\r\n                    {/* 2. Yıl */}\r\n                    <td className=\"sep-left cell-count\">\r\n                      {isTuitionSection ? (\r\n                        <span className=\"muted\">{fmt0(sc2)}</span>\r\n                      ) : (\r\n                        <NumberInput\r\n                          className={inputClass(\r\n                            \"input xs\",\r\n                            pathForRow(sectionKey, r.key, \"studentCountY2\")\r\n                          )}\r\n                         \r\n                          min=\"0\"\r\n                          step=\"1\"\r\n                          value={sc2}\r\n                          onChange={(value) => setRow(sectionKey, r.key, \"studentCountY2\", value)}\r\n                        />\r\n                      )}\r\n                    </td>\r\n                    <td className=\"cell-num muted\">{fmtMoney(uf2)}</td>\r\n                    <td className=\"cell-num\">{fmtMoney(t2)}</td>\r\n\r\n                    {/* 3. Yıl */}\r\n                    <td className=\"sep-left cell-count\">\r\n                      {isTuitionSection ? (\r\n                        <span className=\"muted\">{fmt0(sc3)}</span>\r\n                      ) : (\r\n                        <NumberInput\r\n                          className={inputClass(\r\n                            \"input xs\",\r\n                            pathForRow(sectionKey, r.key, \"studentCountY3\")\r\n                          )}\r\n                         \r\n                          min=\"0\"\r\n                          step=\"1\"\r\n                          value={sc3}\r\n                          onChange={(value) => setRow(sectionKey, r.key, \"studentCountY3\", value)}\r\n                        />\r\n                      )}\r\n                    </td>\r\n                    <td className=\"cell-num muted\">{fmtMoney(uf3)}</td>\r\n                    <td className=\"cell-num\">{fmtMoney(t3)}</td>\r\n                  </tr>\r\n                );\r\n              })}\r\n\r\n              <tr className=\"row-group-start\" style={{ fontWeight: 800 }}>\r\n                <td>TOPLAM</td>\r\n\r\n                {/* 1. Yıl */}\r\n              <td className=\"cell-count sep-left\">\r\n                {isTuitionSection ? fmt0(totalStudents.y1) : \"\"}\r\n              </td>\r\n              <td />\r\n              <td className=\"cell-num\">{fmtMoney(totals.y1)}</td>\r\n\r\n                {/* 2. Yıl */}\r\n              <td className=\"cell-count muted sep-left\">\r\n                {isTuitionSection ? fmt0(totalStudents.y2) : \"\"}\r\n              </td>\r\n              <td />\r\n              <td className=\"cell-num\">{fmtMoney(totals.y2)}</td>\r\n\r\n                {/* 3. Yıl */}\r\n              <td className=\"cell-count muted sep-left\">\r\n                {isTuitionSection ? fmt0(totalStudents.y3) : \"\"}\r\n              </td>\r\n              <td />\r\n              <td className=\"cell-num\">{fmtMoney(totals.y3)}</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"card income-table\">\r\n\r\n\r\n      {sectionTable(`EĞİTİM FAALİYET GELİRLERİ / YIL (${currencyCode})`, visibleTuitionRows, \"tuition\")}\r\n      {sectionTable(`ÖĞRENİM DIŞI ÜCRETLER / YIL (${currencyCode})`, nonEdRows, \"nonEducationFees\")}\r\n      {sectionTable(`YURT / KONAKLAMA GELİRLERİ / YIL (${currencyCode})`, dormRows, \"dormitory\")}\r\n\r\n      {/* Other institutional income */}\r\n      <div className=\"section-head\">\r\n        <div className=\"section-title\">\r\n          {`ÖĞRENCİ ÜCRETLERİ HARİÇ KURUMUN DİĞER GELİRLERİ (BRÜT) / YIL (${currencyCode})`}\r\n        </div>\r\n      </div>\r\n      <div className=\"table-scroll\" style={{ marginTop: 8 }}>\r\n        <table className=\"table data-table table-3y\">\r\n          <thead>\r\n            <tr className=\"group\">\r\n              <th rowSpan={2}>Gelir Kalemi</th>\r\n              <th className=\"sep-left\" style={{ width: 160, textAlign: \"center\" }}>{yearMeta.y1.labelLong}</th>\r\n              <th className=\"sep-left\" style={{ width: 160, textAlign: \"center\" }}>\r\n                {yearMeta.y2.labelLong}\r\n              </th>\r\n              <th className=\"sep-left\" style={{ width: 160, textAlign: \"center\" }}>\r\n                {yearMeta.y3.labelLong}\r\n              </th>\r\n            </tr>\r\n            <tr>\r\n              <th className=\"sep-left\" style={{ width: 140, textAlign: \"right\" }}>{`Tutar (${currencyCode})`}</th>\r\n              <th className=\"sep-left\" style={{ width: 140, textAlign: \"right\" }}>{`Tutar (${currencyCode})`}</th>\r\n              <th className=\"sep-left\" style={{ width: 140, textAlign: \"right\" }}>{`Tutar (${currencyCode})`}</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {otherRows.map((r, idx) => {\r\n              const a1 = toNum(r.amount);\r\n              const a2 = a1 * factors.y2;\r\n              const a3 = a1 * factors.y3;\r\n              return (\r\n                <tr key={r.key} className={idx === 0 ? \"row-group-start\" : \"\"}>\r\n                  <td>{r.label}</td>\r\n                  <td className=\"sep-left cell-num\">\r\n                    <NumberInput\r\n                      className={inputClass(\"input xs\", pathForOtherRow(r.key))}\r\n                     \r\n                      min=\"0\"\r\n                      step=\"0.01\"\r\n                      value={a1}\r\n                      onChange={(value) => setOtherRow(r.key, value)}\r\n                    />\r\n                  </td>\r\n                  <td className=\"cell-num muted sep-left\">{fmtMoney(a2)}</td>\r\n                  <td className=\"cell-num muted sep-left\">{fmtMoney(a3)}</td>\r\n                </tr>\r\n              );\r\n            })}\r\n            <tr className=\"row-group-start\" style={{ fontWeight: 800 }}>\r\n              <td>TOPLAM</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y1.otherInstitutionTotal)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y2.otherInstitutionTotal)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y3.otherInstitutionTotal)}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Government incentives */}\r\n      <div className=\"section-head\">\r\n        <div className=\"section-title\">{`DEVLET TEŞVİKLERİ / YIL (${currencyCode})`}</div>\r\n      </div>\r\n      <div className=\"table-scroll\" style={{ marginTop: 8 }}>\r\n        <table className=\"table data-table table-3y\">\r\n          <thead>\r\n            <tr className=\"group\">\r\n              <th rowSpan={2}></th>\r\n              <th className=\"sep-left\" style={{ width: 160, textAlign: \"center\" }}>{yearMeta.y1.labelLong}</th>\r\n              <th className=\"sep-left\" style={{ width: 160, textAlign: \"center\" }}>\r\n                {yearMeta.y2.labelLong}\r\n              </th>\r\n              <th className=\"sep-left\" style={{ width: 160, textAlign: \"center\" }}>\r\n                {yearMeta.y3.labelLong}\r\n              </th>\r\n            </tr>\r\n            <tr>\r\n              <th className=\"sep-left\" style={{ width: 140, textAlign: \"right\" }}>{`Tutar (${currencyCode})`}</th>\r\n              <th className=\"sep-left\" style={{ width: 140, textAlign: \"right\" }}>{`Tutar (${currencyCode})`}</th>\r\n              <th className=\"sep-left\" style={{ width: 140, textAlign: \"right\" }}>{`Tutar (${currencyCode})`}</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td>Devlet Teşvikleri</td>\r\n              <td className=\"sep-left cell-num\">\r\n                <NumberInput\r\n                  className={inputClass(\"input xs\", govtPath)}\r\n                 \r\n                  min=\"0\"\r\n                  step=\"0.01\"\r\n                  value={toNum(g.governmentIncentives)}\r\n                  onChange={(value) => {\r\n                    const nextValue = value === \"\" ? 0 : toNum(value);\r\n                    onDirty?.(govtPath, nextValue);\r\n                    update(\"governmentIncentives\", nextValue);\r\n                  }}\r\n                />\r\n              </td>\r\n              <td className=\"cell-num muted\">{fmtMoney(byYear.y2.govt)}</td>\r\n              <td className=\"cell-num muted\">{fmtMoney(byYear.y3.govt)}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Summary */}\r\n      <div className=\"section-head\">\r\n        <div className=\"section-title\">ÖZET</div>\r\n      </div>\r\n      <div className=\"table-scroll\" style={{ marginTop: 8 }}>\r\n        <table className=\"table data-table table-3y\">\r\n          <thead>\r\n            <tr className=\"group\">\r\n              <th rowSpan={2}></th>\r\n              <th className=\"sep-left\" style={{ textAlign: \"center\", width: 200 }}>{yearMeta.y1.labelLong}</th>\r\n              <th className=\"sep-left\" style={{ textAlign: \"center\", width: 200 }}>\r\n                {yearMeta.y2.labelLong}\r\n              </th>\r\n              <th className=\"sep-left\" style={{ textAlign: \"center\", width: 200 }}>\r\n                {yearMeta.y3.labelLong}\r\n              </th>\r\n            </tr>\r\n            <tr>\r\n              <th className=\"sep-left\" style={{ textAlign: \"right\", width: 160 }}>{currencyCode}</th>\r\n              <th className=\"sep-left\" style={{ textAlign: \"right\", width: 160 }}>{currencyCode}</th>\r\n              <th className=\"sep-left\" style={{ textAlign: \"right\", width: 160 }}>{currencyCode}</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td>FAALİYET GELİRLERİ (Brüt)</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y1.activityGross)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y2.activityGross)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y3.activityGross)}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>BURS VE İNDİRİMLER (Önizleme)</td>\r\n              <td className=\"cell-num sep-left\">-{fmtMoney(byYear.y1.totalDiscounts)}</td>\r\n              <td className=\"cell-num sep-left\">-{fmtMoney(byYear.y2.totalDiscounts)}</td>\r\n              <td className=\"cell-num sep-left\">-{fmtMoney(byYear.y3.totalDiscounts)}</td>\r\n            </tr>\r\n            <tr className=\"row-group-start\" style={{ fontWeight: 800 }}>\r\n              <td>NET FAALİYET GELİRLERİ</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y1.netActivity)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y2.netActivity)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y3.netActivity)}</td>\r\n            </tr>\r\n            <tr>\r\n              <td className=\"small\">Net Kişi Başı Ciro (Tuition öğrenci sayısı)</td>\r\n              <td className=\"cell-num sep-left\">{byYear.y1.netCiroPerStudent == null ? \"-\" : fmtMoney(byYear.y1.netCiroPerStudent)}</td>\r\n              <td className=\"cell-num sep-left\">{byYear.y2.netCiroPerStudent == null ? \"-\" : fmtMoney(byYear.y2.netCiroPerStudent)}</td>\r\n              <td className=\"cell-num sep-left\">{byYear.y3.netCiroPerStudent == null ? \"-\" : fmtMoney(byYear.y3.netCiroPerStudent)}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>DİĞER GELİRLER (Brüt + Devlet Teşvikleri)</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y1.otherTotal)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y2.otherTotal)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y3.otherTotal)}</td>\r\n            </tr>\r\n            <tr>\r\n              <td className=\"small\">Diğer Gelirler % (Net Toplam Gelir içinde)</td>\r\n              <td className=\"cell-pct sep-left\">{byYear.y1.otherIncomeRatio == null ? \"-\" : fmtPct(byYear.y1.otherIncomeRatio)}</td>\r\n              <td className=\"cell-pct sep-left\">{byYear.y2.otherIncomeRatio == null ? \"-\" : fmtPct(byYear.y2.otherIncomeRatio)}</td>\r\n              <td className=\"cell-pct sep-left\">{byYear.y3.otherIncomeRatio == null ? \"-\" : fmtPct(byYear.y3.otherIncomeRatio)}</td>\r\n            </tr>\r\n            <tr className=\"row-group-start\" style={{ fontWeight: 800 }}>\r\n              <td>NET TOPLAM GELİR</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y1.netIncome)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y2.netIncome)}</td>\r\n              <td className=\"cell-num sep-left\">{fmtMoney(byYear.y3.netIncome)}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { useOutletContext } from \"react-router-dom\";\r\nimport IncomeEditor from \"../../components/IncomeEditor\";\r\nimport TabProgressHeatmap from \"../../components/ui/TabProgressHeatmap\";\r\n\r\nfunction pctValue(tab) {\r\n  const n = Number(tab?.pct);\r\n  return Number.isFinite(n) ? n : 0;\r\n}\r\n\r\nexport default function GelirlerPage() {\r\n  const {\r\n    inputs,\r\n    setField,\r\n    baseYear,\r\n    inputCurrencyCode,\r\n    dirtyPaths,\r\n    markDirty,\r\n    progMap,\r\n  } = useOutletContext();\r\n\r\n  if (!inputs) return null;\r\n\r\n\r\n\r\n  return (\r\n    <div style={{ marginTop: 12 }}>\r\n\r\n      <TabProgressHeatmap\r\n        pct={pctValue(progMap?.gelirler)}\r\n        title=\"Gelirler\"\r\n        missingLines={progMap?.gelirler?.missingLines}\r\n        missingPreview={progMap?.gelirler?.missingPreview}\r\n      >\r\n        <IncomeEditor\r\n          gelirler={inputs.gelirler}\r\n          temelBilgiler={inputs.temelBilgiler}\r\n          baseYear={baseYear}\r\n          gradesYears={inputs.gradesYears}\r\n          grades={inputs.gradesYears?.y1 || inputs.grades}\r\n          discounts={inputs.discounts}\r\n          currencyCode={inputCurrencyCode}\r\n          onChange={(v) => {\r\n            setField(\"gelirler\", v);\r\n          }}\r\n          dirtyPaths={dirtyPaths}\r\n          onDirty={markDirty}\r\n        />\r\n      </TabProgressHeatmap>\r\n    </div>\r\n  );\r\n}\r\n","const PROGRAM_TYPES = {\r\n  LOCAL: \"local\",\r\n  INTERNATIONAL: \"international\",\r\n};\r\n\r\nconst ALLOWED_PROGRAM_TYPES = new Set(Object.values(PROGRAM_TYPES));\r\n\r\nfunction normalizeProgramType(value) {\r\n  const raw = String(value || \"\").trim().toLowerCase();\r\n  if (ALLOWED_PROGRAM_TYPES.has(raw)) return raw;\r\n  return PROGRAM_TYPES.LOCAL;\r\n}\r\n\r\nfunction getProgramType(inputs = {}, scenario = null) {\r\n  const programFromInputs =\r\n    inputs?.temelBilgiler?.programType ?? inputs?.programType ?? inputs?.program_type;\r\n  if (programFromInputs) {\r\n    return normalizeProgramType(programFromInputs);\r\n  }\r\n  const programFromScenario = scenario?.program_type || scenario?.programType;\r\n  if (programFromScenario) return normalizeProgramType(programFromScenario);\r\n  return PROGRAM_TYPES.LOCAL;\r\n}\r\n\r\nfunction isKademeKeyVisible(key, programType = PROGRAM_TYPES.LOCAL) {\r\n  const type = normalizeProgramType(programType);\r\n  if (!key) return true;\r\n  if (key === \"okulOncesi\") return true;\r\n  if (key.endsWith(\"Yerel\")) return type === PROGRAM_TYPES.LOCAL;\r\n  if (key.endsWith(\"Int\")) return type === PROGRAM_TYPES.INTERNATIONAL;\r\n  return true;\r\n}\r\n\r\nfunction mapBaseKademeToVariant(baseKademe, programType = PROGRAM_TYPES.LOCAL) {\r\n  const type = normalizeProgramType(programType);\r\n  if (baseKademe === \"okulOncesi\") return \"okulOncesi\";\r\n  const suffix = type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\";\r\n  return `${baseKademe}${suffix}`;\r\n}\r\n\r\nfunction getVariantKeysForProgramType(programType = PROGRAM_TYPES.LOCAL) {\r\n  const type = normalizeProgramType(programType);\r\n  return new Set([\r\n    \"okulOncesi\",\r\n    `ilkokul${type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\"}`,\r\n    `ortaokul${type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\"}`,\r\n    `lise${type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\"}`,\r\n  ]);\r\n}\r\n\r\nexport {\r\n  PROGRAM_TYPES,\r\n  ALLOWED_PROGRAM_TYPES,\r\n  getProgramType,\r\n  normalizeProgramType,\r\n  isKademeKeyVisible,\r\n  mapBaseKademeToVariant,\r\n  getVariantKeysForProgramType,\r\n};\r\n"],"names":["separatorsCache","Map","parseFlexibleNumber","input","raw","String","trim","value","empty","cleaned","replace","hasDot","includes","hasComma","decimalSep","thousandSep","lastIndexOf","sep","match","RegExp","concat","length","idx","digitsAfter","normalized","split","join","Number","isFinite","NumberInput","_ref","onChange","onBlur","onFocus","className","step","disabled","placeholder","title","name","id","inputMode","rest","_objectWithoutProperties","_excluded","decimals","useMemo","s","dot","indexOf","Math","max","countStepDecimals","locale","decimal","_parts$find","_parts$find2","has","get","parts","Intl","NumberFormat","formatToParts","next","group","find","p","type","set","getSeparators","formatter","useGrouping","maximumFractionDigits","rawFormatter","editing","setEditing","useState","draft","setDraft","numericValue","hasValue","useEffect","format","_jsx","_objectSpread","event","target","parsed","rounded","autoComplete","clamp","v","min","toNum","n","computeDiscountTotalForYear","yearKey","discounts","grossTuition","tuitionStudents","avgTuitionFee","factor","students","gross","tuition","pick","d","baseKey","yk","hasYearSpecific","pickCount","studentCountY2","studentCountY3","studentCount","avgRate","mode","scRaw","sc","round","ratioFromCount","ratio","rawValue","perStudent","total","GRADES","KADEME_DEFS","key","label","defaultFrom","defaultTo","normalizeGrade","toUpperCase","test","gradeIndex","g","getKademeDefinitions","map","getDefaultKademeConfig","out","forEach","enabled","from","to","normalizeKademeConfig","config","cfg","row","range","fromValue","toValue","def","_normalizeGrade","_normalizeGrade2","fromIdx","toIdx","normalizeRange","formatKademeLabel","getKademeRangeLabel","getKademeForGrade","grade","summarizeGradesByKademe","grades","rows","Array","isArray","okulOncesi","ilkokul","ortaokul","lise","r","studentsPerBranch","Object","prototype","hasOwnProperty","call","getGradeOptions","TabProgressHeatmap","_ref2","pct","missingPreview","missingLines","children","clamped","clampPct","mask","tooltipText","lines","line","filter","Boolean","slice","buildTitle","showInfo","_jsxs","style","position","overflow","borderRadius","inset","pointerEvents","zIndex","backgroundImage","WebkitMaskImage","maskImage","top","right","width","height","border","background","color","display","alignItems","justifyContent","cursor","boxShadow","FaInfoCircle","size","fmtMoney","toLocaleString","undefined","fmt0","fmtPct","toFixed","YEAR_KEYS","EMPTY_ROWS","freeze","TUITION_ROWS","NON_ED_ROWS","DORM_ROWS","OTHER_INCOME_ROWS","computeStudentsFromGrades","kademeConfig","sums","kg","normalizeRows","baseRows","savedRows","keyField","base","saved","byKey","_r$keyField","merged","b","_b$keyField","k","baseKeys","Set","_ref3","_b$keyField2","_ref4","_s$keyField","normalizeGelirler","_g$tuition","_g$nonEducationFees","_g$dormitory","_g$otherInstitutionIn","_g$governmentIncentiv","unitFee","nonEducationFees","dormitory","otherInstitutionIncome","amount","governmentIncentives","isLegacy","tuitionFeePerStudentYearly","lunchFeePerStudentYearly","dormitoryFeePerStudentYearly","otherFeePerStudentYearly","suggested","withManualYearCounts","y2","y3","tuitionFee","lunchFee","dormFee","some","IncomeEditor","_ref5","_g$tuition3","_g$nonEducationFees3","_g$dormitory3","_g$otherInstitutionIn3","gelirler","temelBilgiler","baseYear","gradesYears","currencyCode","dirtyPaths","onDirty","normalizedGradesYears","src","fallback","y1","suggestedByYear","kademeler","programType","getProgramType","kademeLabels","ilkokulYerel","ilkokulInt","ortaokulYerel","ortaokulInt","liseYerel","liseInt","tuitionBaseByKey","factors","infl","inflation","getInflationFactors","pathForRow","sectionKey","rowKey","field","pathForOtherRow","govtPath","inputClass","path","isDirty","tuitionRows","_g$tuition2","visibleTuitionRows","_temelBilgiler$kademe","_temelBilgiler$kademe2","isKademeKeyVisible","nonEdRows","_g$nonEducationFees2","dormRows","_g$dormitory2","otherRows","_g$otherInstitutionIn2","nonEdRowByKey","dormRowByKey","getManualStudentCount","useCallback","_row$studentCountY","_row$studentCountY2","suggestedForTuitionKeyYear","studentCountForRowYear","tuitionStudentsByYear","y","reduce","byYear","_factors$y","_suggestedByYear$y$to","_suggestedByYear$y","f","tuitionTotal","nonEdTotal","dormTotal","activityGross","otherInstitutionTotal","govt","otherTotal","grossTotal","fallbackStudents","tuitionBaseStudents","totalDiscounts","netActivity","netIncome","netCiroPerStudent","otherIncomeRatio","update","structuredClone","keys","obj","i","setRow","_g$sectionKey","nextValue","yearMeta","mk","start","end","labelLong","labelShort","sectionTable","unitField","arguments","totals","totalStudents","uf1","uf2","uf3","sc1","sc2","sc3","isTuitionSection","isTuition","_Fragment","marginTop","rowSpan","colSpan","textAlign","t1","t2","t3","displayLabel","fontWeight","a1","a2","a3","_g$otherInstitutionIn4","setOtherRow","pctValue","tab","GelirlerPage","_progMap$gelirler","_progMap$gelirler2","_inputs$gradesYears","inputs","setField","inputCurrencyCode","markDirty","progMap","useOutletContext","PROGRAM_TYPES","LOCAL","INTERNATIONAL","ALLOWED_PROGRAM_TYPES","values","normalizeProgramType","toLowerCase","_inputs$temelBilgiler","_inputs$temelBilgiler2","scenario","programFromInputs","program_type","programFromScenario","endsWith","mapBaseKademeToVariant","baseKademe","suffix"],"ignoreList":[],"sourceRoot":""}