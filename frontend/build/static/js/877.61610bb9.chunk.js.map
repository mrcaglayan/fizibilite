{"version":3,"file":"static/js/877.61610bb9.chunk.js","mappings":"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","sources":["pages/ManagerReviewQueuePage.jsx","hooks/useOutsideClick.js"],"sourcesContent":["// frontend/src/pages/ManagerReviewQueuePage.jsx\r\n\r\nimport React, { useEffect, useState, useMemo, useCallback, useId, useRef } from 'react';\r\nimport { AnimatePresence, motion } from 'motion/react';\r\nimport { useNavigate, useOutletContext } from 'react-router-dom';\r\nimport { toast } from 'react-toastify';\r\nimport { FaCheck, FaCheckCircle, FaExclamationTriangle, FaPaperPlane, FaSearch, FaStar, FaThLarge } from 'react-icons/fa';\r\nimport { api } from '../api';\r\nimport { useOutsideClick } from '../hooks/useOutsideClick';\r\nimport { useAuth } from '../auth/AuthContext';\r\nimport { writeGlobalLastRouteSegment, writeLastVisitedPath, writeSelectedScenarioId } from '../utils/schoolNavStorage';\r\n\r\n/**\r\n * ManagerReviewQueuePage\r\n *\r\n * Displays a list of scenarios for manager review.  Managers,\r\n * accountants, admins, or users granted the manage_permissions permission can\r\n * access this page.  The page lists each scenario's required modules and\r\n * allows the reviewer to approve or request revision for submitted modules.\r\n * When all required modules are approved, the reviewer can forward the\r\n * scenario to administrators for final approval via the \"Onaya Gönder\"\r\n * button.  The list refreshes automatically after each action.\r\n */\r\n\r\n// Define the stable required work item identifiers and their friendly labels.\r\nconst REQUIRED_WORK_IDS = [\r\n  'temel_bilgiler',\r\n  'kapasite',\r\n  'norm.ders_dagilimi',\r\n  'ik.local_staff',\r\n  'gelirler.unit_fee',\r\n  'giderler.isletme',\r\n];\r\n\r\nconst WORK_ID_LABELS = {\r\n  'temel_bilgiler': 'Temel Bilgiler',\r\n  'kapasite': 'Kapasite',\r\n  'norm.ders_dagilimi': 'Norm',\r\n  'ik.local_staff': 'İK',\r\n  'gelirler.unit_fee': 'Gelirler',\r\n  'giderler.isletme': 'Giderler',\r\n};\r\n\r\nconst WORK_ID_TO_ROUTE = {\r\n  'temel_bilgiler': 'temel-bilgiler',\r\n  'kapasite': 'kapasite',\r\n  'norm.ders_dagilimi': 'norm',\r\n  'ik.local_staff': 'ik',\r\n  'gelirler.unit_fee': 'gelirler',\r\n  'giderler.isletme': 'giderler',\r\n};\r\n\r\nconst FILTER_TABS = [\r\n  { key: 'all', label: 'Tümü' },\r\n  { key: 'ready', label: 'Merkeze İletilmeye Hazır' },\r\n  { key: 'in_review', label: 'İncelemede' },\r\n  { key: 'revision', label: 'Revize İstendi' },\r\n  { key: 'approved', label: 'Kontrol Edildi' },\r\n  { key: 'sent', label: 'Merkeze İletildi' },\r\n  { key: 'approved_final', label: 'Onaylandı' },\r\n];\r\n\r\nconst FILTER_TAB_ICONS = {\r\n  all: FaThLarge,\r\n  ready: FaCheckCircle,\r\n  in_review: FaSearch,\r\n  revision: FaExclamationTriangle,\r\n  approved: FaCheck,\r\n  sent: FaPaperPlane,\r\n  approved_final: FaStar,\r\n};\r\n\r\n\r\n// Map scenario status and sent_at to visual badge metadata.  A scenario\r\n// that is approved but has not yet been forwarded to administrators\r\n// (sent_at is null) is considered manager-approved (“Kontrol edildi”).\r\nfunction getScenarioStatusMeta(scenario) {\r\n  const status = scenario?.status;\r\n  const sentAt = scenario?.sent_at;\r\n  switch (status) {\r\n    case 'revision_requested':\r\n      return { label: 'Revize İstendi', className: 'is-bad' };\r\n    case 'sent_for_approval':\r\n      return { label: 'Merkeze iletildi', className: 'is-warn' };\r\n    case 'approved':\r\n      if (sentAt) {\r\n        return { label: 'Onaylandı', className: 'is-ok' };\r\n      }\r\n      return { label: 'Kontrol edildi', className: 'is-ok' };\r\n    case 'in_review':\r\n      return { label: 'İncelemede', className: 'is-warn' };\r\n    case 'submitted':\r\n      return { label: 'Onayda', className: 'is-warn' };\r\n    default:\r\n      return { label: 'Taslak', className: 'is-muted' };\r\n  }\r\n}\r\n\r\n// Map work item states to badge metadata.\r\nfunction getWorkItemStateMeta(state) {\r\n  switch (state) {\r\n    case 'approved':\r\n      // Manager approval of a work item is tracked as \"Kontrol edildi\"\r\n      return { label: 'Kontrol edildi', className: 'is-ok' };\r\n    case 'needs_revision':\r\n      return { label: 'Revize İstendi', className: 'is-bad' };\r\n    case 'submitted':\r\n      return { label: 'İncelemede', className: 'is-warn' };\r\n    case 'in_progress':\r\n      return { label: 'Hazırlanıyor', className: 'is-warn' };\r\n    default:\r\n      return { label: 'Başlanmadı', className: 'is-muted' };\r\n  }\r\n}\r\n\r\nexport default function ManagerReviewQueuePage() {\r\n  const auth = useAuth();\r\n  const outlet = useOutletContext();\r\n  const navigate = useNavigate();\r\n  const [queueData, setQueueData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [activeFilter, setActiveFilter] = useState('all');\r\n  const [activeCard, setActiveCard] = useState(null);\r\n  const modalRef = useRef(null);\r\n  const motionId = useId();\r\n  const tabsId = useId();\r\n\r\n  const closeModal = useCallback(() => setActiveCard(null), []);\r\n  useOutsideClick(modalRef, closeModal, Boolean(activeCard));\r\n\r\n  useEffect(() => {\r\n    function onKeyDown(event) {\r\n      if (event.key === 'Escape') {\r\n        closeModal();\r\n      }\r\n    }\r\n\r\n    if (activeCard && typeof activeCard === 'object') {\r\n      document.body.style.overflow = 'hidden';\r\n    } else {\r\n      document.body.style.overflow = 'auto';\r\n    }\r\n\r\n    window.addEventListener('keydown', onKeyDown);\r\n    return () => window.removeEventListener('keydown', onKeyDown);\r\n  }, [activeCard, closeModal]);\r\n\r\n\r\n  // Determine whether the current user is allowed to view the review queue.\r\n  const canView = useMemo(() => {\r\n    const role = auth.user?.role;\r\n    if (role === 'admin' || role === 'manager' || role === 'accountant') return true;\r\n    const perms = auth.user?.permissions;\r\n    if (!Array.isArray(perms)) return false;\r\n    return perms.some(\r\n      (p) =>\r\n        p.resource === 'page.manage_permissions' &&\r\n        (p.action === 'read' || p.action === 'write')\r\n    );\r\n  }, [auth.user]);\r\n\r\n  // Configure the top bar header on mount.  Align text to center per spec.\r\n  useEffect(() => {\r\n    outlet?.setHeaderMeta?.({\r\n      title: 'Review Queue',\r\n      subtitle: 'Modül onay kuyruğu',\r\n      centered: true,\r\n    });\r\n    return () => {\r\n      outlet?.clearHeaderMeta?.();\r\n    };\r\n  }, [outlet]);\r\n\r\n  // Load the queue.  Fetch schools, then scenarios for each school, then work items.\r\n  const loadQueue = useCallback(async () => {\r\n    if (!canView) return;\r\n    setLoading(true);\r\n    try {\r\n      const results = await api.managerGetReviewQueue();\r\n      setQueueData(Array.isArray(results) ? results : []);\r\n    } catch (err) {\r\n      console.error(err);\r\n      toast.error(err?.message || 'Failed to load review queue');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [canView]);\r\n\r\n  useEffect(() => {\r\n    loadQueue();\r\n  }, [loadQueue]);\r\n\r\n  const matchFilter = useCallback((entry, filterKey) => {\r\n    if (!entry) return false;\r\n    const scenario = entry.scenario || {};\r\n    const status = scenario.status;\r\n    const sentAt = scenario.sent_at;\r\n    const approvedCount = Number(entry.approvedCount || 0);\r\n    const allApproved = approvedCount === REQUIRED_WORK_IDS.length;\r\n    const isManagerApproved = status === 'approved' && !sentAt;\r\n    const isFinalApproved = status === 'approved' && !!sentAt;\r\n    switch (filterKey) {\r\n      case 'ready':\r\n        return isManagerApproved && allApproved;\r\n      case 'in_review':\r\n        return status === 'in_review' || status === 'submitted';\r\n      case 'revision':\r\n        return status === 'revision_requested';\r\n      case 'approved':\r\n        return isManagerApproved;\r\n      case 'sent':\r\n        return status === 'sent_for_approval';\r\n      case 'approved_final':\r\n        return isFinalApproved;\r\n      case 'all':\r\n      default:\r\n        return true;\r\n    }\r\n  }, []);\r\n\r\n  const filterCounts = useMemo(() => {\r\n    const base = Object.fromEntries(FILTER_TABS.map((t) => [t.key, 0]));\r\n    base.all = Array.isArray(queueData) ? queueData.length : 0;\r\n    if (!Array.isArray(queueData)) return base;\r\n    queueData.forEach((entry) => {\r\n      FILTER_TABS.forEach((tab) => {\r\n        if (tab.key === 'all') return;\r\n        if (matchFilter(entry, tab.key)) base[tab.key] += 1;\r\n      });\r\n    });\r\n    return base;\r\n  }, [queueData, matchFilter]);\r\n\r\n  const filteredRows = useMemo(() => {\r\n    if (!Array.isArray(queueData)) return [];\r\n    if (activeFilter === 'all') return queueData;\r\n    return queueData.filter((entry) => matchFilter(entry, activeFilter));\r\n  }, [queueData, activeFilter, matchFilter]);\r\n\r\n  const activeTabIndex = Math.max(\r\n    0,\r\n    FILTER_TABS.findIndex((tab) => tab.key === activeFilter)\r\n  );\r\n\r\n  const handleNavigateToModule = useCallback(\r\n    (schoolId, scenarioId, workId) => {\r\n      const segment = WORK_ID_TO_ROUTE[workId];\r\n      if (!segment) return;\r\n      writeSelectedScenarioId(schoolId, scenarioId);\r\n      writeLastVisitedPath(schoolId, scenarioId, segment);\r\n      writeGlobalLastRouteSegment(segment);\r\n      navigate(`/schools/${schoolId}/${segment}`);\r\n    },\r\n    [navigate]\r\n  );\r\n\r\n  const handleTabKeyDown = useCallback((event, tabKey) => {\r\n    if (event.key === 'Enter' || event.key === ' ') {\r\n      event.preventDefault();\r\n      setActiveFilter(tabKey);\r\n    }\r\n  }, []);\r\n\r\n  // Handlers for approving or revising a work item\r\n  const handleApprove = async (schoolId, scenarioId, workId) => {\r\n    try {\r\n      await api.reviewWorkItem(schoolId, scenarioId, workId, { action: 'approve' });\r\n      toast.success('Onaylandı');\r\n      loadQueue();\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error(e?.message || 'Failed to approve work item');\r\n    }\r\n  };\r\n\r\n  const handleRevise = async (schoolId, scenarioId, workId) => {\r\n    // Prompt the reviewer for a comment.  Use the browser prompt for simplicity.\r\n    const comment = window.prompt('Revizyon notu (opsiyonel):');\r\n    if (comment === undefined) return;\r\n    try {\r\n      await api.reviewWorkItem(schoolId, scenarioId, workId, {\r\n        action: 'revise',\r\n        comment: comment && comment.trim() ? comment.trim() : undefined,\r\n      });\r\n      toast.success('Revizyon istendi');\r\n      loadQueue();\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error(e?.message || 'Failed to request revision');\r\n    }\r\n  };\r\n\r\n  // Handler for sending a scenario for admin approval\r\n  const handleSendForApproval = async (schoolId, scenarioId) => {\r\n    try {\r\n      const calcRes = await api.calculateScenario(schoolId, scenarioId);\r\n      if (!calcRes || !calcRes.results) {\r\n        toast.error('Hesaplama tamamlanamadı');\r\n        return;\r\n      }\r\n      await api.sendForApproval(schoolId, scenarioId);\r\n      toast.success('Merkeze iletildi');\r\n      loadQueue();\r\n    } catch (e) {\r\n      console.error(e);\r\n      toast.error(e?.message || 'Failed to send for approval');\r\n    }\r\n  };\r\n\r\n  if (!canView) {\r\n    return (\r\n      <div className=\"container\">\r\n        <div className=\"card\">\r\n          <div style={{ fontWeight: 700 }}>Access Denied</div>\r\n          <div className=\"small\" style={{ marginTop: 6 }}>\r\n            You do not have permission to view the review queue.\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const activeScenario = activeCard?.scenario;\r\n  const activeSchool = activeCard?.school;\r\n  const activeStatusMeta = activeScenario ? getScenarioStatusMeta(activeScenario) : null;\r\n  const activeAllApproved = activeCard ? activeCard.approvedCount === REQUIRED_WORK_IDS.length : false;\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <AnimatePresence>\r\n        {activeCard && typeof activeCard === 'object' ? (\r\n          <motion.div\r\n            key=\"rq-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"rq-overlay\"\r\n          />\r\n        ) : null}\r\n      </AnimatePresence>\r\n\r\n      <AnimatePresence>\r\n        {activeCard && typeof activeCard === 'object' ? (\r\n          <div className=\"rq-modal-wrap\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Scenario details\">\r\n            <motion.button\r\n              key={`rq-close-${activeScenario?.id}-${motionId}`}\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0, transition: { duration: 0.05 } }}\r\n              className=\"rq-close-btn\"\r\n              type=\"button\"\r\n              onClick={closeModal}\r\n              aria-label=\"Close\"\r\n            >\r\n              <CloseIcon />\r\n            </motion.button>\r\n\r\n            <motion.div\r\n              layoutId={`rq-card-${activeScenario?.id}-${motionId}`}\r\n              ref={modalRef}\r\n              className=\"card rq-modal\"\r\n            >\r\n              <div className=\"rq-modal-head\">\r\n                <motion.div\r\n                  layoutId={`rq-thumb-${activeScenario?.id}-${motionId}`}\r\n                  className=\"rq-thumb rq-thumb--lg\"\r\n                >\r\n                  {getScenarioInitials(activeScenario)}\r\n                </motion.div>\r\n\r\n                <div className=\"rq-modal-head-text\">\r\n                  <motion.div\r\n                    layoutId={`rq-title-${activeScenario?.id}-${motionId}`}\r\n                    className=\"rq-title rq-title--lg\"\r\n                  >\r\n                    {activeScenario?.name} ({activeScenario?.academic_year})\r\n                  </motion.div>\r\n                  <div className=\"rq-subtitle\">{activeSchool?.name}</div>\r\n                </div>\r\n\r\n                <div className=\"rq-modal-top-actions\">\r\n                  {activeStatusMeta ? (\r\n                    <span className={`status-badge ${activeStatusMeta.className}`}>{activeStatusMeta.label}</span>\r\n                  ) : null}\r\n                  {activeCard ? (\r\n                    <span className=\"small is-muted\">\r\n                      {activeCard.approvedCount}/{REQUIRED_WORK_IDS.length} onaylandı\r\n                    </span>\r\n                  ) : null}\r\n\r\n                  <button\r\n                    className=\"btn sm primary\"\r\n                    type=\"button\"\r\n                    onClick={() => handleSendForApproval(activeSchool.id, activeScenario.id)}\r\n                    disabled={!activeAllApproved || activeScenario?.status !== 'approved' || activeScenario?.sent_at != null}\r\n                    title={\r\n                      !activeAllApproved\r\n                        ? 'Tüm modüller tamamlanmalı'\r\n                        : activeScenario?.status !== 'approved' || activeScenario?.sent_at\r\n                        ? 'Durum izin vermiyor'\r\n                        : undefined\r\n                    }\r\n                  >\r\n                    Merkeze ilet\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"rq-modal-body\">\r\n                <div className=\"small is-muted\" style={{ marginBottom: 10 }}>\r\n                  Modülleri inceleyin. &ldquo;Gönderildi&rdquo; durumundaki modüller için <b>Onayla</b> veya{' '}\r\n                  <b>Revizyon İste</b> kullanın.\r\n                </div>\r\n\r\n                <div className=\"review-queue-card-inner\">\r\n                  <table className=\"table\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Modül</th>\r\n                        <th>Durum</th>\r\n                        <th>Gönderildi</th>\r\n                        <th>Yorum</th>\r\n                        <th />\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {activeCard?.requiredItems?.map(({ workId, item }) => {\r\n                        const state = item?.state || 'not_started';\r\n                        const meta = getWorkItemStateMeta(state);\r\n                        const submittedAt = item?.submitted_at ? new Date(item.submitted_at).toLocaleString() : '-';\r\n                        const comment = item?.manager_comment || '-';\r\n                        const canApprove = state === 'submitted';\r\n                        const canRevise = state === 'submitted';\r\n                        const canNavigate = Boolean(WORK_ID_TO_ROUTE[workId]);\r\n\r\n                        return (\r\n                          <tr key={workId} className={state === 'submitted' ? 'highlight-row' : ''}>\r\n                            <td>\r\n                              {canNavigate ? (\r\n                                <button\r\n                                  type=\"button\"\r\n                                  className=\"review-queue-module-link\"\r\n                                  onClick={() => {\r\n                                    closeModal();\r\n                                    handleNavigateToModule(activeSchool.id, activeScenario.id, workId);\r\n                                  }}\r\n                                  title=\"Modüle git\"\r\n                                >\r\n                                  {WORK_ID_LABELS[workId] || workId}\r\n                                </button>\r\n                              ) : (\r\n                                WORK_ID_LABELS[workId] || workId\r\n                              )}\r\n                            </td>\r\n                            <td>\r\n                              <span className={`status-badge ${meta.className}`}>{meta.label}</span>\r\n                            </td>\r\n                            <td className=\"small\">{submittedAt}</td>\r\n                            <td className=\"small\" style={{ maxWidth: 260, whiteSpace: 'pre-wrap' }}>\r\n                              {comment}\r\n                            </td>\r\n                            <td>\r\n                              {canApprove ? (\r\n                                <button\r\n                                  className=\"btn sm primary\"\r\n                                  type=\"button\"\r\n                                  onClick={() => handleApprove(activeSchool.id, activeScenario.id, workId)}\r\n                                >\r\n                                  Onayla\r\n                                </button>\r\n                              ) : null}\r\n                              {canRevise ? (\r\n                                <button\r\n                                  className=\"btn sm danger\"\r\n                                  type=\"button\"\r\n                                  onClick={() => handleRevise(activeSchool.id, activeScenario.id, workId)}\r\n                                >\r\n                                  Revizyon İste\r\n                                </button>\r\n                              ) : null}\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      })}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        ) : null}\r\n      </AnimatePresence>\r\n\r\n      <section\r\n        className=\"review-queue-tabs\"\r\n        style={{\r\n          '--rq-tab-count': FILTER_TABS.length,\r\n          '--rq-active-index': activeTabIndex,\r\n        }}\r\n      >\r\n        {FILTER_TABS.map((tab) => {\r\n          const inputId = `${tabsId}-${tab.key}`;\r\n          return (\r\n            <input\r\n              key={inputId}\r\n              id={inputId}\r\n              type=\"radio\"\r\n              name={`review-queue-filter-${tabsId}`}\r\n              className=\"rq-tab-input\"\r\n              checked={activeFilter === tab.key}\r\n              onChange={() => setActiveFilter(tab.key)}\r\n            />\r\n          );\r\n        })}\r\n\r\n        <nav className=\"rq-tab-nav\" role=\"tablist\" aria-label=\"Senaryo filtresi\">\r\n          {FILTER_TABS.map((tab) => {\r\n            const inputId = `${tabsId}-${tab.key}`;\r\n            const isActive = activeFilter === tab.key;\r\n            const Icon = FILTER_TAB_ICONS[tab.key];\r\n            return (\r\n              <label\r\n                key={tab.key}\r\n                htmlFor={inputId}\r\n                role=\"tab\"\r\n                aria-selected={isActive}\r\n                tabIndex={0}\r\n                className={`review-queue-tab ${isActive ? 'is-active' : ''}`}\r\n                onKeyDown={(event) => handleTabKeyDown(event, tab.key)}\r\n              >\r\n                <span className=\"rq-tab-icon\">{Icon ? <Icon aria-hidden=\"true\" /> : null}</span>\r\n                <span className=\"rq-tab-text\">{tab.label}</span>\r\n                <span className=\"review-queue-count\">{filterCounts[tab.key] ?? 0}</span>\r\n              </label>\r\n            );\r\n          })}\r\n        </nav>\r\n      </section>\r\n\r\n      {loading ? (\r\n        <div className=\"card\">Loading...</div>\r\n      ) : filteredRows.length === 0 ? (\r\n        <div className=\"card\">\r\n          <div>No scenarios to review</div>\r\n        </div>\r\n      ) : (\r\n        <div className=\"review-queue-cards\">\r\n          {filteredRows.map(({ school, scenario, requiredItems, approvedCount }) => {\r\n            const statusMeta = getScenarioStatusMeta(scenario);\r\n            const allApproved = approvedCount === REQUIRED_WORK_IDS.length;\r\n\r\n            const cardPayload = { school, scenario, requiredItems, approvedCount };\r\n\r\n            return (\r\n              <motion.div\r\n                key={scenario.id}\r\n                layoutId={`rq-card-${scenario.id}-${motionId}`}\r\n                className=\"card rq-card-compact\"\r\n                onClick={() => setActiveCard(cardPayload)}\r\n              >\r\n                <div className=\"rq-compact-row\">\r\n                  <div className=\"rq-compact-left\">\r\n                    <motion.div\r\n                      layoutId={`rq-thumb-${scenario.id}-${motionId}`}\r\n                      className=\"rq-thumb\"\r\n                    >\r\n                      {getScenarioInitials(scenario)}\r\n                    </motion.div>\r\n\r\n                    <div>\r\n                      <div className=\"rq-kicker\">{school?.name}</div>\r\n                      <motion.div\r\n                        layoutId={`rq-title-${scenario.id}-${motionId}`}\r\n                        className=\"rq-title\"\r\n                      >\r\n                        {scenario.name} ({scenario.academic_year})\r\n                      </motion.div>\r\n\r\n                      <div className=\"rq-subtitle\">\r\n                        <span className={`status-badge ${statusMeta.className}`}>{statusMeta.label}</span>\r\n                        <span className=\"small is-muted\" style={{ marginLeft: 8 }}>\r\n                          {approvedCount}/{REQUIRED_WORK_IDS.length} onaylandı\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"rq-actions\">\r\n                    <button\r\n                      type=\"button\"\r\n                      className=\"rq-open-pill\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        setActiveCard(cardPayload);\r\n                      }}\r\n                    >\r\n                      İncele\r\n                    </button>\r\n\r\n                    <button\r\n                      className=\"btn sm primary\"\r\n                      type=\"button\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        handleSendForApproval(school.id, scenario.id);\r\n                      }}\r\n                      disabled={!allApproved || scenario.status !== 'approved' || scenario.sent_at != null}\r\n                      title={\r\n                        !allApproved\r\n                          ? 'Tüm modüller tamamlanmalı'\r\n                          : scenario.status !== 'approved' || scenario.sent_at\r\n                          ? 'Durum izin vermiyor'\r\n                          : undefined\r\n                      }\r\n                    >\r\n                      Merkeze ilet\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </motion.div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction CloseIcon() {\r\n  return (\r\n    <motion.svg\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      exit={{ opacity: 0, transition: { duration: 0.05 } }}\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"24\"\r\n      height=\"24\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      className=\"rq-close-icon\"\r\n    >\r\n      <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" />\r\n      <path d=\"M18 6l-12 12\" />\r\n      <path d=\"M6 6l12 12\" />\r\n    </motion.svg>\r\n  );\r\n}\r\n\r\nfunction getScenarioInitials(scenario) {\r\n  const name = String(scenario?.name || '').trim();\r\n  if (!name) return 'S';\r\n  const parts = name.split(/\\s+/).filter(Boolean);\r\n  const a = parts[0]?.[0] || 'S';\r\n  const b = parts[1]?.[0] || '';\r\n  return (a + b).toUpperCase();\r\n}\r\n","// frontend/src/hooks/useOutsideClick.js\nimport { useEffect } from \"react\";\n\n/**\n * useOutsideClick\n * Calls `handler` when a click/touch happens outside of `ref.current`.\n *\n * @param {React.RefObject<HTMLElement>} ref\n * @param {(event: Event) => void} handler\n * @param {boolean} enabled\n */\nexport function useOutsideClick(ref, handler, enabled = true) {\n  useEffect(() => {\n    if (!enabled) return;\n\n    const listener = (event) => {\n      const el = ref?.current;\n      if (!el) return;\n      // Ignore clicks on the element or its descendants.\n      if (el.contains(event.target)) return;\n      handler?.(event);\n    };\n\n    // Capture phase so we reliably catch even if inner elements stopPropagation.\n    document.addEventListener(\"mousedown\", listener, true);\n    document.addEventListener(\"touchstart\", listener, true);\n\n    return () => {\n      document.removeEventListener(\"mousedown\", listener, true);\n      document.removeEventListener(\"touchstart\", listener, true);\n    };\n  }, [ref, handler, enabled]);\n}\n"],"names":["REQUIRED_WORK_IDS","WORK_ID_LABELS","WORK_ID_TO_ROUTE","FILTER_TABS","key","label","FILTER_TAB_ICONS","all","FaThLarge","ready","FaCheckCircle","in_review","FaSearch","revision","FaExclamationTriangle","approved","FaCheck","sent","FaPaperPlane","approved_final","FaStar","getScenarioStatusMeta","scenario","status","sentAt","sent_at","className","ManagerReviewQueuePage","_activeCard$requiredI","auth","useAuth","outlet","useOutletContext","navigate","useNavigate","queueData","setQueueData","useState","loading","setLoading","activeFilter","setActiveFilter","activeCard","setActiveCard","modalRef","useRef","motionId","useId","tabsId","closeModal","useCallback","ref","handler","enabled","arguments","length","undefined","useEffect","listener","event","el","current","contains","target","document","addEventListener","removeEventListener","useOutsideClick","Boolean","onKeyDown","body","style","overflow","window","canView","useMemo","_auth$user","_auth$user2","role","user","perms","permissions","Array","isArray","some","p","resource","action","_outlet$setHeaderMeta","setHeaderMeta","call","title","subtitle","centered","_outlet$clearHeaderMe","clearHeaderMeta","loadQueue","async","results","api","managerGetReviewQueue","err","console","error","toast","message","matchFilter","entry","filterKey","allApproved","Number","approvedCount","isManagerApproved","isFinalApproved","filterCounts","base","Object","fromEntries","map","t","forEach","tab","filteredRows","filter","activeTabIndex","Math","max","findIndex","handleNavigateToModule","schoolId","scenarioId","workId","segment","writeSelectedScenarioId","writeLastVisitedPath","writeGlobalLastRouteSegment","concat","handleTabKeyDown","tabKey","preventDefault","handleSendForApproval","calcRes","calculateScenario","sendForApproval","success","e","_jsx","children","_jsxs","fontWeight","marginTop","activeScenario","activeSchool","school","activeStatusMeta","activeAllApproved","AnimatePresence","motion","div","initial","opacity","animate","exit","button","transition","duration","type","onClick","CloseIcon","id","layoutId","getScenarioInitials","name","academic_year","disabled","marginBottom","requiredItems","_ref","item","state","meta","getWorkItemStateMeta","submittedAt","submitted_at","Date","toLocaleString","comment","manager_comment","canApprove","canRevise","canNavigate","maxWidth","whiteSpace","reviewWorkItem","handleApprove","prompt","trim","handleRevise","inputId","checked","onChange","_filterCounts$tab$key","isActive","Icon","htmlFor","tabIndex","_ref2","statusMeta","cardPayload","marginLeft","stopPropagation","svg","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","_parts$","_parts$2","String","parts","split","toUpperCase"],"ignoreList":[],"sourceRoot":""}