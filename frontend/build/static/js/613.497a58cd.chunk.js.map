{"version":3,"file":"static/js/613.497a58cd.chunk.js","mappings":"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","sources":["pages/AdminPage.jsx"],"sourcesContent":["//frontend/src/pages/AdminPage.jsx\r\n\r\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { Link, useLocation, useOutletContext } from \"react-router-dom\";\r\nimport { ToastContainer, toast } from \"react-toastify\";\r\nimport { FaSchool, FaUserPlus } from \"react-icons/fa\";\r\nimport { api } from \"../api\";\r\nimport { useAuth } from \"../auth/AuthContext\";\r\nimport Tooltip from \"../components/ui/Tooltip\";\r\nimport { buildProgressCatalog, DEFAULT_PROGRESS_CONFIG } from \"../utils/progressCatalog\";\r\nimport { ADMIN_TABS } from \"../data/adminTabs\";\r\n\r\n\r\n\r\nconst YEAR_KEYS = [\"y1\", \"y2\", \"y3\"];\r\n\r\n// Required module identifiers used in the scenario workflow.  When\r\n// requesting a revision, the admin can choose which of these modules\r\n// should be unlocked for editing.  These values must stay in sync\r\n// with the backend REQUIRED_WORK_IDS constant defined in\r\n// backend/src/utils/scenarioWorkflow.js.\r\nconst REQUIRED_WORK_IDS = [\r\n  \"temel_bilgiler\",\r\n  \"kapasite\",\r\n  \"norm.ders_dagilimi\",\r\n  \"ik.local_staff\",\r\n  \"gelirler.unit_fee\",\r\n  \"giderler.isletme\",\r\n];\r\n\r\n// Human-readable labels for each required module.  Used in the\r\n// admin revision modal to present checkboxes to select which\r\n// modules should be sent back for revision.\r\nconst WORK_ID_LABELS = {\r\n  temel_bilgiler: \"Temel Bilgiler\",\r\n  kapasite: \"Kapasite\",\r\n  \"norm.ders_dagilimi\": \"Norm\",\r\n  \"ik.local_staff\": \"K\",\r\n  \"gelirler.unit_fee\": \"Gelirler\",\r\n  \"giderler.isletme\": \"Giderler\",\r\n};\r\nconst DEFAULT_ADMIN_TAB = ADMIN_TABS[0]?.key || \"users\";\r\nconst isValidAdminTab = (value) => ADMIN_TABS.some((tab) => tab.key === value);\r\nconst getTabFromSearch = (search) => {\r\n  if (!search) return null;\r\n  const params = new URLSearchParams(search);\r\n  const value = params.get(\"tab\");\r\n  return isValidAdminTab(value) ? value : null;\r\n};\r\n\r\nconst fmt = (v) => {\r\n  const n = Number(v);\r\n  return Number.isFinite(n) ? n.toLocaleString(undefined, { maximumFractionDigits: 0 }) : \"-\";\r\n};\r\n\r\nconst fmtPct = (v) => {\r\n  const n = Number(v);\r\n  return Number.isFinite(n)\r\n    ? (n * 100).toLocaleString(undefined, { maximumFractionDigits: 2 }) + \"%\"\r\n    : \"-\";\r\n};\r\n\r\nconst formatDateTime = (value) => {\r\n  if (!value) return \"-\";\r\n  const d = new Date(value);\r\n  return Number.isFinite(d.getTime()) ? d.toLocaleString() : \"-\";\r\n};\r\n\r\nconst SAMPLE_DISCOUNTS = [\r\n  \"Magis Basari Bursu\",\r\n  \"Maarif Yetenek Bursu\",\r\n  \"Ihtiyac Bursu\",\r\n  \"Okul Basari Bursu\",\r\n  \"Tam Egitim Bursu\",\r\n  \"Barinma Bursu\",\r\n  \"Turkce Basari Bursu\",\r\n  \"Uluslararasi Yukumluluk Indirimi\",\r\n  \"Vakif Calisani Indirimi\",\r\n  \"Kardes Indirimi\",\r\n  \"Erken Kayit Indirimi\",\r\n  \"Pesin Odeme Indirimi\",\r\n  \"Kademe Gecis Indirimi\",\r\n  \"Temsil Indirimi\",\r\n  \"Kurum Indirimi\",\r\n  \"Istisnai Indirim\",\r\n  \"Yerel Mevzuat Indirimi\",\r\n];\r\n\r\nfunction normalizeProgressConfig(config) {\r\n  const defaults = DEFAULT_PROGRESS_CONFIG();\r\n  const input = config && typeof config === \"object\" ? config : {};\r\n  const sectionsInput = input.sections && typeof input.sections === \"object\" ? input.sections : {};\r\n  const out = { version: defaults.version, sections: {} };\r\n\r\n  Object.keys(defaults.sections).forEach((id) => {\r\n    const base = defaults.sections[id] || {};\r\n    const incoming = sectionsInput[id] && typeof sectionsInput[id] === \"object\" ? sectionsInput[id] : {};\r\n    out.sections[id] = {\r\n      enabled: typeof incoming.enabled === \"boolean\" ? incoming.enabled : base.enabled !== false,\r\n      mode: typeof incoming.mode === \"string\" && incoming.mode ? incoming.mode : base.mode,\r\n      min: incoming.min != null ? Number(incoming.min) : base.min,\r\n      selectedFields:\r\n        incoming.selectedFields && typeof incoming.selectedFields === \"object\" ? incoming.selectedFields : {},\r\n    };\r\n  });\r\n\r\n  return out;\r\n}\r\n\r\n// Compute status badge metadata for a scenario.  Accepts either a status\r\n// string or a full scenario object.  When a scenario is approved but\r\n// has not yet been forwarded to administrators (sent_at is null), it\r\n// is considered manager-approved (Kontrol edildi).\r\nconst getStatusMeta = (scenarioOrStatus) => {\r\n  const obj = scenarioOrStatus && typeof scenarioOrStatus === 'object' ? scenarioOrStatus : { status: scenarioOrStatus };\r\n  const status = obj.status;\r\n  const sentAt = obj.sent_at;\r\n  switch (status) {\r\n    case 'revision_requested':\r\n      return { label: 'Revize istendi', className: 'is-bad' };\r\n    case 'sent_for_approval':\r\n      return { label: 'Merkeze iletildi', className: 'is-warn' };\r\n    case 'approved':\r\n      if (sentAt) {\r\n        return { label: 'Onayland', className: 'is-ok' };\r\n      }\r\n      return { label: 'Kontrol edildi', className: 'is-ok' };\r\n    case 'in_review':\r\n      return { label: 'ncelemede', className: 'is-warn' };\r\n    case 'submitted':\r\n      return { label: 'Onayda', className: 'is-warn' };\r\n    case 'draft':\r\n      return { label: 'Taslak', className: 'is-muted' };\r\n    default:\r\n      return { label: 'Taslak', className: 'is-muted' };\r\n  }\r\n};\r\n\r\nconst getSchoolStatusMeta = (status) => {\r\n  if (status === \"closed\") return { label: \"Closed\", className: \"is-muted\" };\r\n  return { label: \"Active\", className: \"is-ok\" };\r\n};\r\n\r\nconst getDynamicHint = (sectionId, field) => {\r\n  if (!field) return null;\r\n  const id = String(field.id || \"\");\r\n  const label = String(field.label || \"\");\r\n  if (sectionId === \"gradesPlan.plan\") {\r\n    if (id.startsWith(\"gradesPlan.\") || label.includes(\"Plan \")) return \"grade\";\r\n  }\r\n  if (sectionId === \"ik.localStaff\" && id.startsWith(\"ik.headcount.\")) return \"type\";\r\n  if (sectionId === \"gelirler.unitFee\" && id.startsWith(\"gelirler.tuition.\")) return \"type\";\r\n  return null;\r\n};\r\n\r\nexport default function AdminPage({ forcedTab = null } = {}) {\r\n  const auth = useAuth();\r\n  const outlet = useOutletContext();\r\n  const location = useLocation();\r\n  const normalizedForcedTab = isValidAdminTab(forcedTab) ? forcedTab : null;\r\n  const [activeTab, setActiveTab] = useState(() => {\r\n    if (normalizedForcedTab) return normalizedForcedTab;\r\n    const fromSearch = getTabFromSearch(location.search);\r\n    if (fromSearch) return fromSearch;\r\n    try {\r\n      const stored = localStorage.getItem(\"admin.activeTab\");\r\n      if (isValidAdminTab(stored)) return stored;\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n    return DEFAULT_ADMIN_TAB;\r\n  });\r\n  useEffect(() => {\r\n    if (normalizedForcedTab) return;\r\n    const fromSearch = getTabFromSearch(location.search);\r\n    if (fromSearch && fromSearch !== activeTab) {\r\n      setActiveTab(fromSearch);\r\n      return;\r\n    }\r\n    if (!fromSearch && activeTab !== DEFAULT_ADMIN_TAB) {\r\n      setActiveTab(DEFAULT_ADMIN_TAB);\r\n    }\r\n  }, [location.search, activeTab, normalizedForcedTab]);\r\n  useEffect(() => {\r\n    if (!normalizedForcedTab) return;\r\n    if (activeTab !== normalizedForcedTab) setActiveTab(normalizedForcedTab);\r\n  }, [normalizedForcedTab, activeTab]);\r\n  useEffect(() => {\r\n    if (normalizedForcedTab) return;\r\n    try {\r\n      localStorage.setItem(\"admin.activeTab\", activeTab);\r\n    } catch (_) {\r\n      // ignore\r\n    }\r\n  }, [activeTab, normalizedForcedTab]);\r\n\r\n  const [countries, setCountries] = useState([]);\r\n  const [users, setUsers] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [userUpdateLoading, setUserUpdateLoading] = useState(false);\r\n  const [confirmAssign, setConfirmAssign] = useState(null);\r\n  const [confirmDelete, setConfirmDelete] = useState(null);\r\n  const [confirmReset, setConfirmReset] = useState(null);\r\n  const [resetResult, setResetResult] = useState(null);\r\n  const [resetLoadingId, setResetLoadingId] = useState(null);\r\n\r\n  const [countryName, setCountryName] = useState(\"\");\r\n  const [countryCode, setCountryCode] = useState(\"\");\r\n  const [countryRegion, setCountryRegion] = useState(\"\");\r\n\r\n  const [newUserName, setNewUserName] = useState(\"\");\r\n  const [newUserEmail, setNewUserEmail] = useState(\"\");\r\n  const [newUserPassword, setNewUserPassword] = useState(\"\");\r\n  const [newUserRole, setNewUserRole] = useState(\"user\");\r\n  const [newUserCountryId, setNewUserCountryId] = useState(\"\");\r\n\r\n  const [assignUserId, setAssignUserId] = useState(\"\");\r\n  const [assignCountryId, setAssignCountryId] = useState(\"\");\r\n  const [showUnassigned, setShowUnassigned] = useState(true);\r\n\r\n  const [schoolsCountryId, setSchoolsCountryId] = useState(\"\");\r\n  const [countrySchools, setCountrySchools] = useState([]);\r\n  const [countrySchoolsLoading, setCountrySchoolsLoading] = useState(false);\r\n  const [schoolsSearch, setSchoolsSearch] = useState(\"\");\r\n  const [newSchoolName, setNewSchoolName] = useState(\"\");\r\n  const [schoolCreateLoading, setSchoolCreateLoading] = useState(false);\r\n  const [schoolBulkCreateLoading, setSchoolBulkCreateLoading] = useState(false);\r\n  const [schoolCreateRows, setSchoolCreateRows] = useState([\"\"]);\r\n  const [schoolSavingId, setSchoolSavingId] = useState(null);\r\n  const [schoolNameDrafts, setSchoolNameDrafts] = useState({});\r\n\r\n  const [progressCountryId, setProgressCountryId] = useState(\"\");\r\n  const [progressConfig, setProgressConfig] = useState(null);\r\n  const [progressLoading, setProgressLoading] = useState(false);\r\n  const [progressSaving, setProgressSaving] = useState(false);\r\n  const [progressSearch, setProgressSearch] = useState(\"\");\r\n  const [progressTargetIds, setProgressTargetIds] = useState(() => new Set());\r\n  const [progressCountryListSearch, setProgressCountryListSearch] = useState(\"\");\r\n  const [progressBulkSaving, setProgressBulkSaving] = useState(false);\r\n  const [showOnlySelectedBySection, setShowOnlySelectedBySection] = useState({});\r\n  const [expandedProgressTabs, setExpandedProgressTabs] = useState(new Set());\r\n  const [expandedProgressSections, setExpandedProgressSections] = useState(new Set());\r\n\r\n  const [queueRows, setQueueRows] = useState([]);\r\n\r\n  // Permissions catalog & user permissions state (for admin permission editor)\r\n  const [permissionsCatalog, setPermissionsCatalog] = useState(null);\r\n  // Map of permission key (resource|action) to boolean indicating selected for the current user\r\n  const [permissionSelections, setPermissionSelections] = useState({});\r\n  // Map of permission key to scope identifier: \"country\" or \"school:<id>\"\r\n  const [permissionScopes, setPermissionScopes] = useState({});\r\n  const [permissionsLoading, setPermissionsLoading] = useState(false);\r\n  const [permissionsSaving, setPermissionsSaving] = useState(false);\r\n  // List of schools in the selected user's country for scope selection\r\n  const [userSchools, setUserSchools] = useState([]);\r\n  // Define role options for admin when editing a user's role.  Admins can\r\n  // assign any role, including manager/accountant and admin.\r\n  const roleOptions = useMemo(\r\n    () => [\r\n      { value: \"user\", label: \"User\" },\r\n      { value: \"principal\", label: \"Principal\" },\r\n      { value: \"hr\", label: \"HR\" },\r\n      { value: \"manager\", label: \"Manager\" },\r\n      { value: \"accountant\", label: \"Accountant\" },\r\n      { value: \"admin\", label: \"Admin\" },\r\n    ],\r\n    []\r\n  );\r\n\r\n  // Track updating of a user's role when editing via the admin Users tab.\r\n  const [roleUpdating, setRoleUpdating] = useState(false);\r\n\r\n  // Principal assignments state per school\r\n  // principalLists maps schoolId -> array of user objects assigned as principals\r\n  const [principalLists, setPrincipalLists] = useState({});\r\n  // principalDrafts maps schoolId -> array of userIds currently selected in the editor\r\n  const [principalDrafts, setPrincipalDrafts] = useState({});\r\n  // Track saving state per school when updating principal assignments\r\n  const [principalSaving, setPrincipalSaving] = useState({});\r\n  const [queueLoading, setQueueLoading] = useState(false);\r\n  const [queueFilters, setQueueFilters] = useState({\r\n    status: \"\",\r\n    academicYear: \"\",\r\n    region: \"\",\r\n    countryId: \"\",\r\n  });\r\n\r\n  const [queueSort, setQueueSort] = useState({ key: null, dir: null });\r\n\r\n  const [reviewModal, setReviewModal] = useState(null);\r\n  const [reviewNote, setReviewNote] = useState(\"\");\r\n  const [reviewIncludedYears, setReviewIncludedYears] = useState({\r\n    y1: true,\r\n    y2: true,\r\n    y3: true,\r\n  });\r\n\r\n  // When the admin requests a revision on a scenario, they must select\r\n  // which modules should be reopened for editing.  This state maps\r\n  // module identifiers (work ids) to booleans indicating whether\r\n  // that module is selected for revision.  It is initialized when\r\n  // opening the revision modal.\r\n  const [reviewRevisionSelection, setReviewRevisionSelection] = useState(() => {\r\n    const initial = {};\r\n    REQUIRED_WORK_IDS.forEach((id) => (initial[id] = false));\r\n    return initial;\r\n  });\r\n\r\n  // Helpers to select or clear all modules in the revision selection.  These\r\n  // functions are memoized via useCallback to avoid re-creating on\r\n  // every render.\r\n  const selectAllRevisionWork = useCallback(() => {\r\n    const next = {};\r\n    REQUIRED_WORK_IDS.forEach((id) => (next[id] = true));\r\n    setReviewRevisionSelection(next);\r\n  }, []);\r\n\r\n  const clearRevisionWork = useCallback(() => {\r\n    const next = {};\r\n    REQUIRED_WORK_IDS.forEach((id) => (next[id] = false));\r\n    setReviewRevisionSelection(next);\r\n  }, []);\r\n  const [reviewSaving, setReviewSaving] = useState(false);\r\n\r\n  const [rollupYear, setRollupYear] = useState(\"\");\r\n  const [rollupData, setRollupData] = useState(null);\r\n  const [rollupLoading, setRollupLoading] = useState(false);\r\n  const [rollupExportOpen, setRollupExportOpen] = useState(false);\r\n  const rollupExportRef = useRef(null);\r\n  const [expandedRegions, setExpandedRegions] = useState(new Set());\r\n  const [expandedCountries, setExpandedCountries] = useState(new Set());\r\n\r\n  useEffect(() => {\r\n    document.title = \"Admin  Feasibility Studio\";\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    outlet?.setHeaderMeta({\r\n      title: \"Admin\",\r\n      subtitle: \"Create users, manage countries, and review scenarios.\",\r\n    });\r\n    return () => {\r\n      outlet?.clearHeaderMeta?.();\r\n    };\r\n  }, [outlet]);\r\n\r\n  // Keep latest queue filters without making loadQueue depend on queueFilters\r\n  const queueFiltersRef = useRef(queueFilters);\r\n  useEffect(() => {\r\n    queueFiltersRef.current = queueFilters;\r\n  }, [queueFilters]);\r\n\r\n  const selectedUser = useMemo(\r\n    () => users.find((u) => String(u.id) === String(assignUserId)) || null,\r\n    [users, assignUserId]\r\n  );\r\n\r\n  const selectedCountry = useMemo(\r\n    () => countries.find((c) => String(c.id) === String(assignCountryId)) || null,\r\n    [countries, assignCountryId]\r\n  );\r\n\r\n  const selectedSchoolsCountry = useMemo(\r\n    () => countries.find((c) => String(c.id) === String(schoolsCountryId)) || null,\r\n    [countries, schoolsCountryId]\r\n  );\r\n\r\n  // Load principal lists for each school when the country schools list changes\r\n  useEffect(() => {\r\n    // Only load when we are on the countries tab and have schools for the selected country\r\n    if (activeTab !== \"countries\") return;\r\n    if (!Array.isArray(countrySchools) || countrySchools.length === 0) return;\r\n    countrySchools.forEach((school) => {\r\n      const id = school.id;\r\n      // If we haven't loaded this school's principals yet, fetch them\r\n      if (principalLists[id] === undefined) {\r\n        (async () => {\r\n          try {\r\n            const list = await api.adminGetSchoolPrincipals(id);\r\n            setPrincipalLists((prev) => ({ ...prev, [id]: Array.isArray(list) ? list : [] }));\r\n            // Initialize draft selection with current principal IDs\r\n            const ids = Array.isArray(list) ? list.map((u) => u.id) : [];\r\n            setPrincipalDrafts((prev) => ({ ...prev, [id]: ids }));\r\n          } catch (e) {\r\n            console.error(e);\r\n            // Do not toast here to avoid spam; errors will be shown on save\r\n          }\r\n        })();\r\n      }\r\n    });\r\n  }, [activeTab, countrySchools, principalLists]);\r\n\r\n  // Load permissions catalog, user permissions, and schools list for the selected user\r\n  useEffect(() => {\r\n    // derive simple IDs from the selectedUser to avoid stale object dependencies\r\n    const userId = selectedUser?.id;\r\n    const countryId = selectedUser?.country_id;\r\n    // If no user selected, reset and exit early\r\n    if (!userId) {\r\n      setPermissionsCatalog(null);\r\n      setPermissionSelections({});\r\n      setPermissionScopes({});\r\n      setUserSchools([]);\r\n      return;\r\n    }\r\n    setPermissionsLoading(true);\r\n    Promise.all([\r\n      api.adminGetPermissionsCatalog(),\r\n      api.adminGetUserPermissions(userId),\r\n      countryId ? api.adminListCountrySchools(countryId) : Promise.resolve([]),\r\n    ])\r\n      .then(([catalogData, userPerms, schoolsData]) => {\r\n        setPermissionsCatalog(catalogData || null);\r\n        // Determine scope options: flatten schools list\r\n        let schoolsList = [];\r\n        if (Array.isArray(schoolsData)) {\r\n          schoolsList = schoolsData;\r\n        } else if (schoolsData && Array.isArray(schoolsData.items)) {\r\n          schoolsList = schoolsData.items;\r\n        }\r\n        setUserSchools(schoolsList);\r\n        // Initialize selection and scope state from existing user perms\r\n        const sel = {};\r\n        const scopeMap = {};\r\n        (userPerms || []).forEach((p) => {\r\n          const key = `${p.resource}|${p.action}`;\r\n          sel[key] = true;\r\n          if (p.scope_school_id != null) {\r\n            scopeMap[key] = `school:${p.scope_school_id}`;\r\n          } else {\r\n            scopeMap[key] = \"country\";\r\n          }\r\n        });\r\n        setPermissionSelections(sel);\r\n        setPermissionScopes(scopeMap);\r\n      })\r\n      .catch((e) => {\r\n        console.error(e);\r\n        toast.error(e?.message || \"Failed to load permissions\");\r\n      })\r\n      .finally(() => {\r\n        setPermissionsLoading(false);\r\n      });\r\n  }, [selectedUser]);\r\n\r\n  const progressCatalogInputs = useMemo(\r\n    () => ({\r\n      discounts: SAMPLE_DISCOUNTS.map((name) => ({ name, ratio: 0, value: 0 })),\r\n    }),\r\n    []\r\n  );\r\n\r\n  const progressCatalog = useMemo(\r\n    () => buildProgressCatalog({ inputs: progressCatalogInputs, norm: null }),\r\n    [progressCatalogInputs]\r\n  );\r\n\r\n  const progressConfigNormalized = useMemo(\r\n    () => normalizeProgressConfig(progressConfig),\r\n    [progressConfig]\r\n  );\r\n\r\n  const isSameCountry =\r\n    selectedUser &&\r\n    selectedCountry &&\r\n    selectedUser.country_id != null &&\r\n    String(selectedUser.country_id) === String(selectedCountry.id);\r\n\r\n  const currentAssignmentLabel = selectedUser\r\n    ? selectedUser.country_name\r\n      ? `${selectedUser.country_name} (${selectedUser.country_code})${selectedUser.region ? ` - ${selectedUser.region}` : \"\"\r\n      }`\r\n      : \"Unassigned\"\r\n    : \"Select a user\";\r\n\r\n  const newAssignmentLabel = selectedCountry\r\n    ? `${selectedCountry.name} (${selectedCountry.code})${selectedCountry.region ? ` - ${selectedCountry.region}` : \"\"\r\n    }`\r\n    : \"Select a country\";\r\n\r\n  const actionLabel = selectedUser?.country_id != null ? \"Update Country\" : \"Assign Country\";\r\n\r\n  const filteredUsers = useMemo(() => {\r\n    if (!showUnassigned) return users;\r\n    return users.filter((u) => u.country_id == null);\r\n  }, [users, showUnassigned]);\r\n\r\n  const regionOptions = useMemo(() => {\r\n    const set = new Set();\r\n    countries.forEach((c) => {\r\n      if (c.region) set.add(c.region);\r\n    });\r\n    return Array.from(set).sort();\r\n  }, [countries]);\r\n\r\n  // Group permissions by their catalog group for display\r\n  const permissionsGrouped = useMemo(() => {\r\n    // When no catalog loaded, return empty object\r\n    if (!permissionsCatalog) return {};\r\n    // Backend returns a grouped object (group -> array of permissions) via\r\n    // /admin/permissions/catalog. When it's already grouped, return it as is.\r\n    if (!Array.isArray(permissionsCatalog) && typeof permissionsCatalog === \"object\") {\r\n      return permissionsCatalog;\r\n    }\r\n    // Otherwise if an array is provided, group by the `group` property on each entry.\r\n    if (Array.isArray(permissionsCatalog)) {\r\n      return permissionsCatalog.reduce((acc, perm) => {\r\n        const grp = perm.group || \"Other\";\r\n        if (!acc[grp]) acc[grp] = [];\r\n        acc[grp].push(perm);\r\n        return acc;\r\n      }, {});\r\n    }\r\n    return {};\r\n  }, [permissionsCatalog]);\r\n\r\n  const queueCountryOptions = useMemo(() => {\r\n    if (!queueFilters.region) return countries;\r\n    return countries.filter((c) => c.region === queueFilters.region);\r\n  }, [countries, queueFilters.region]);\r\n\r\n  const toggleQueueSort = useCallback((key) => {\r\n    const cycles = {\r\n      academic_year: [\"desc\", \"asc\", null],\r\n      country_name: [\"asc\", \"desc\", null],\r\n      school_name: [\"asc\", \"desc\", null],\r\n      scenario_name: [\"asc\", \"desc\", null],\r\n      submitted_at: [\"desc\", \"asc\", null],\r\n      status: [\"asc\", \"desc\", null],\r\n    };\r\n\r\n    setQueueSort((prev) => {\r\n      const cycle = cycles[key] || [\"asc\", \"desc\", null];\r\n      if (prev.key !== key) return { key, dir: cycle[0] };\r\n\r\n      const i = cycle.indexOf(prev.dir);\r\n      const next = cycle[(i + 1) % cycle.length];\r\n      if (!next) return { key: null, dir: null };\r\n      return { key, dir: next };\r\n    });\r\n  }, [setQueueSort]);\r\n\r\n  const sortIndicator = useCallback(\r\n    (key) => {\r\n      if (queueSort.key !== key || !queueSort.dir) return \"\";\r\n      return queueSort.dir === \"asc\" ? \"\" : \"\";\r\n    },\r\n    [queueSort]\r\n  );\r\n\r\n  const ariaSort = useCallback(\r\n    (key) => {\r\n      if (queueSort.key !== key || !queueSort.dir) return \"none\";\r\n      return queueSort.dir === \"asc\" ? \"ascending\" : \"descending\";\r\n    },\r\n    [queueSort]\r\n  );\r\n\r\n  const sortedQueueRows = useMemo(() => {\r\n    const base = Array.isArray(queueRows) ? queueRows : [];\r\n    if (!queueSort?.key || !queueSort?.dir) return base;\r\n\r\n    const parseAcademicYear = (value) => {\r\n      const raw = String(value || \"\").trim();\r\n      const nums = raw.match(/\\d{4}/g) || [];\r\n      const a = nums[0] ? Number(nums[0]) : -1;\r\n      const b = nums[1] ? Number(nums[1]) : a;\r\n      return { a, b, raw: raw.toLowerCase() };\r\n    };\r\n\r\n    const getValue = (row) => {\r\n      switch (queueSort.key) {\r\n        case \"country_name\":\r\n          return String(row.country?.name || \"\");\r\n        case \"school_name\":\r\n          return String(row.school?.name || \"\");\r\n        case \"scenario_name\":\r\n          return String(row.scenario?.name || \"\");\r\n        case \"academic_year\":\r\n          return parseAcademicYear(row.scenario?.academic_year);\r\n        case \"submitted_at\":\r\n          return row.scenario?.submitted_at ? new Date(row.scenario.submitted_at).getTime() : -Infinity;\r\n        case \"status\":\r\n          return String(row.scenario?.status || \"\");\r\n        default:\r\n          return \"\";\r\n      }\r\n    };\r\n\r\n    const dirMul = queueSort.dir === \"desc\" ? -1 : 1;\r\n    const cmpStr = (a, b) =>\r\n      String(a || \"\").localeCompare(String(b || \"\"), undefined, { sensitivity: \"base\" });\r\n\r\n    const decorated = base.map((row, idx) => ({ row, idx, val: getValue(row) }));\r\n\r\n    decorated.sort((A, B) => {\r\n      let c = 0;\r\n      const av = A.val;\r\n      const bv = B.val;\r\n\r\n      if (queueSort.key === \"academic_year\") {\r\n        c = (av?.a ?? -1) - (bv?.a ?? -1);\r\n        if (c === 0) c = (av?.b ?? -1) - (bv?.b ?? -1);\r\n        if (c === 0) c = cmpStr(av?.raw, bv?.raw);\r\n      } else if (typeof av === \"number\" && typeof bv === \"number\") {\r\n        c = av - bv;\r\n      } else {\r\n        c = cmpStr(av, bv);\r\n      }\r\n\r\n      if (c === 0) return A.idx - B.idx; // back to server order\r\n      return c * dirMul;\r\n    });\r\n\r\n    return decorated.map((d) => d.row);\r\n  }, [queueRows, queueSort]);\r\n\r\n  const progressSearchValue = progressSearch.trim().toLowerCase();\r\n\r\n  const filteredCountriesForApply = useMemo(() => {\r\n    const q = progressCountryListSearch.trim().toLowerCase();\r\n    if (!q) return countries;\r\n    return countries.filter((c) => {\r\n      const name = String(c.name || \"\").toLowerCase();\r\n      const code = String(c.code || \"\").toLowerCase();\r\n      return name.includes(q) || code.includes(q);\r\n    });\r\n  }, [countries, progressCountryListSearch]);\r\n\r\n  const progressTargetCount = progressTargetIds.size;\r\n  const progressBulkDisabled =\r\n    !progressCountryId ||\r\n    progressTargetCount === 0 ||\r\n    progressSaving ||\r\n    progressLoading ||\r\n    progressBulkSaving;\r\n\r\n  const filteredCountrySchools = useMemo(() => {\r\n    const q = schoolsSearch.trim().toLowerCase();\r\n    if (!q) return countrySchools;\r\n    return countrySchools.filter((s) => String(s.name || \"\").toLowerCase().includes(q));\r\n  }, [countrySchools, schoolsSearch]);\r\n\r\n  const schoolCreateBusy = schoolCreateLoading || schoolBulkCreateLoading;\r\n  const bulkCreateCount = schoolCreateRows.reduce(\r\n    (count, name) => (String(name || \"\").trim() ? count + 1 : count),\r\n    0\r\n  );\r\n\r\n  const load = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const [countriesRows, userData] = await Promise.all([\r\n        api.listCountries(),\r\n        api.listUsers({ limit: 50, offset: 0, fields: \"brief\", order: \"id:desc\" }),\r\n      ]);\r\n      setCountries(countriesRows);\r\n      setUsers(Array.isArray(userData?.items) ? userData.items : []);\r\n    } catch (e) {\r\n      toast.error(e.message || \"Failed to load admin data\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const loadCountrySchools = useCallback(async (countryIdArg) => {\r\n    const countryId = Number(countryIdArg);\r\n    if (!Number.isFinite(countryId)) {\r\n      setCountrySchools([]);\r\n      return;\r\n    }\r\n    setCountrySchoolsLoading(true);\r\n    try {\r\n      const rows = await api.adminListCountrySchools(countryId, { includeClosed: 1 });\r\n      setCountrySchools(Array.isArray(rows) ? rows : []);\r\n    } catch (e) {\r\n      toast.error(e.message || \"Failed to load schools\");\r\n    } finally {\r\n      setCountrySchoolsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const loadProgressRequirements = useCallback(async (countryIdArg) => {\r\n    const countryId = Number(countryIdArg);\r\n    if (!Number.isFinite(countryId)) {\r\n      setProgressConfig(null);\r\n      return;\r\n    }\r\n    setProgressLoading(true);\r\n    try {\r\n      const data = await api.adminGetProgressRequirements(countryId);\r\n      setProgressConfig(normalizeProgressConfig(data?.config || data));\r\n    } catch (e) {\r\n      toast.error(e.message || \"Failed to load progress requirements\");\r\n      setProgressConfig(normalizeProgressConfig(null));\r\n    } finally {\r\n      setProgressLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const loadQueue = useCallback(async (filtersArg) => {\r\n    const f = filtersArg || queueFiltersRef.current || {};\r\n    setQueueLoading(true);\r\n    try {\r\n      const params = {\r\n        status: f.status,\r\n        academicYear: f.academicYear,\r\n        region: f.region,\r\n        countryId: f.countryId,\r\n      };\r\n      const rows = await api.adminGetScenarioQueue(params);\r\n      setQueueRows(Array.isArray(rows) ? rows : []);\r\n    } catch (e) {\r\n      toast.error(e.message || \"Failed to load approvals queue\");\r\n    } finally {\r\n      setQueueLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const loadRollup = useCallback(async (academicYearArg) => {\r\n    const academicYear = (academicYearArg ?? rollupYear).trim();\r\n    if (!academicYear) {\r\n      toast.error(\"Academic year is required\");\r\n      return;\r\n    }\r\n    setRollupLoading(true);\r\n    try {\r\n      const data = await api.adminGetRollup({ academicYear });\r\n      setRollupData(data);\r\n    } catch (e) {\r\n      toast.error(e.message || \"Failed to load rollup report\");\r\n    } finally {\r\n      setRollupLoading(false);\r\n    }\r\n  }, [rollupYear]);\r\n\r\n  useEffect(() => {\r\n    if (auth.user?.role === \"admin\") load();\r\n  }, [auth.user?.role, load]);\r\n\r\n  useEffect(() => {\r\n    if (activeTab === \"approvals\" && auth.user?.role === \"admin\") {\r\n      loadQueue(); // uses latest filters via ref\r\n    }\r\n  }, [activeTab, auth.user?.role, loadQueue]);\r\n\r\n  useEffect(() => {\r\n    if (activeTab !== \"countries\") return;\r\n    if (!schoolsCountryId) {\r\n      setCountrySchools([]);\r\n      return;\r\n    }\r\n    loadCountrySchools(schoolsCountryId);\r\n  }, [activeTab, loadCountrySchools, schoolsCountryId]);\r\n\r\n  useEffect(() => {\r\n    if (activeTab !== \"progress\") return;\r\n    if (!progressCountryId) {\r\n      setProgressConfig(null);\r\n      return;\r\n    }\r\n    loadProgressRequirements(progressCountryId);\r\n  }, [activeTab, loadProgressRequirements, progressCountryId]);\r\n\r\n  useEffect(() => {\r\n    setProgressSearch(\"\");\r\n    setExpandedProgressTabs(new Set());\r\n    setExpandedProgressSections(new Set());\r\n  }, [progressCountryId]);\r\n\r\n  useEffect(() => {\r\n    if (!rollupExportOpen) return;\r\n    const handleClick = (event) => {\r\n      const el = rollupExportRef.current;\r\n      if (!el || el.contains(event.target)) return;\r\n      setRollupExportOpen(false);\r\n    };\r\n    const handleKey = (event) => {\r\n      if (event.key === \"Escape\") setRollupExportOpen(false);\r\n    };\r\n    document.addEventListener(\"mousedown\", handleClick);\r\n    document.addEventListener(\"keydown\", handleKey);\r\n    return () => {\r\n      document.removeEventListener(\"mousedown\", handleClick);\r\n      document.removeEventListener(\"keydown\", handleKey);\r\n    };\r\n  }, [rollupExportOpen]);\r\n\r\n  useEffect(() => {\r\n    if (!rollupData?.regions) return;\r\n    const regionSet = new Set();\r\n    const countrySet = new Set();\r\n    rollupData.regions.forEach((region) => {\r\n      regionSet.add(region.region);\r\n      region.countries.forEach((country) => {\r\n        countrySet.add(`${region.region}::${country.id}`);\r\n      });\r\n    });\r\n    setExpandedRegions(regionSet);\r\n    setExpandedCountries(countrySet);\r\n  }, [rollupData]);\r\n\r\n  useEffect(() => {\r\n    if (!assignUserId) {\r\n      setAssignCountryId(\"\");\r\n      return;\r\n    }\r\n    const user = users.find((u) => String(u.id) === String(assignUserId));\r\n    if (!user) {\r\n      setAssignCountryId(\"\");\r\n      return;\r\n    }\r\n    if (user.country_id != null) setAssignCountryId(String(user.country_id));\r\n    else setAssignCountryId(\"\");\r\n  }, [assignUserId, users]);\r\n\r\n  useEffect(() => {\r\n    setSchoolNameDrafts({});\r\n    setSchoolsSearch(\"\");\r\n    setNewSchoolName(\"\");\r\n    setSchoolCreateRows([\"\"]);\r\n  }, [schoolsCountryId]);\r\n\r\n  async function createCountry() {\r\n    const payload = {\r\n      name: countryName.trim(),\r\n      code: countryCode.trim().toUpperCase(),\r\n      region: countryRegion.trim(),\r\n    };\r\n    if (!payload.name || !payload.code || !payload.region) {\r\n      toast.error(\"Name, code, and region are required\");\r\n      return;\r\n    }\r\n    try {\r\n      await api.createCountry(payload);\r\n      setCountryName(\"\");\r\n      setCountryCode(\"\");\r\n      setCountryRegion(\"\");\r\n      await load();\r\n      toast.success(\"Country created\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Create country failed\");\r\n    }\r\n  }\r\n\r\n  async function createCountrySchool() {\r\n    if (!schoolsCountryId) {\r\n      toast.error(\"Select a country\");\r\n      return;\r\n    }\r\n    const name = newSchoolName.trim();\r\n    if (!name) {\r\n      toast.error(\"School name is required\");\r\n      return;\r\n    }\r\n    setSchoolCreateLoading(true);\r\n    try {\r\n      await api.adminCreateCountrySchool(schoolsCountryId, { name });\r\n      setNewSchoolName(\"\");\r\n      await loadCountrySchools(schoolsCountryId);\r\n      toast.success(\"School created\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Create school failed\");\r\n    } finally {\r\n      setSchoolCreateLoading(false);\r\n    }\r\n  }\r\n\r\n  function updateSchoolCreateRow(index, value) {\r\n    setSchoolCreateRows((prev) => {\r\n      const next = [...prev];\r\n      next[index] = value;\r\n      return next;\r\n    });\r\n  }\r\n\r\n  function addSchoolCreateRow() {\r\n    setSchoolCreateRows((prev) => [...prev, \"\"]);\r\n  }\r\n\r\n  function removeSchoolCreateRow(index) {\r\n    setSchoolCreateRows((prev) => {\r\n      if (prev.length <= 1) return prev;\r\n      return prev.filter((_, i) => i !== index);\r\n    });\r\n  }\r\n\r\n  async function createCountrySchoolsBulk() {\r\n    if (!schoolsCountryId) {\r\n      toast.error(\"Select a country\");\r\n      return;\r\n    }\r\n    const rawNames = schoolCreateRows.map((name) => String(name || \"\").trim()).filter(Boolean);\r\n    const names = Array.from(new Set(rawNames));\r\n    if (!names.length) {\r\n      toast.error(\"At least one school name is required\");\r\n      return;\r\n    }\r\n    setSchoolBulkCreateLoading(true);\r\n    const errors = [];\r\n    let created = 0;\r\n    try {\r\n      for (const name of names) {\r\n        try {\r\n          await api.adminCreateCountrySchool(schoolsCountryId, { name });\r\n          created += 1;\r\n        } catch (e) {\r\n          errors.push({ name, message: e?.message || \"Create school failed\" });\r\n        }\r\n      }\r\n      if (created > 0) {\r\n        await loadCountrySchools(schoolsCountryId);\r\n      }\r\n      if (errors.length) {\r\n        toast.error(`${errors.length} of ${names.length} schools failed`);\r\n        setSchoolCreateRows(errors.map((err) => err.name));\r\n      } else {\r\n        toast.success(`${created} schools created`);\r\n        setSchoolCreateRows([\"\"]);\r\n      }\r\n    } finally {\r\n      setSchoolBulkCreateLoading(false);\r\n    }\r\n  }\r\n\r\n  async function createUser() {\r\n    const payload = {\r\n      fullName: newUserName.trim() || null,\r\n      email: newUserEmail.trim(),\r\n      password: newUserPassword,\r\n      role: newUserRole,\r\n    };\r\n    if (newUserCountryId) {\r\n      const nextId = Number(newUserCountryId);\r\n      if (!Number.isFinite(nextId)) {\r\n        toast.error(\"Invalid country selection\");\r\n        return;\r\n      }\r\n      payload.countryId = nextId;\r\n    }\r\n    if (!payload.email || !payload.password) {\r\n      toast.error(\"Email and password are required\");\r\n      return;\r\n    }\r\n    if (payload.password.length < 8) {\r\n      toast.error(\"Password must be at least 8 characters\");\r\n      return;\r\n    }\r\n    try {\r\n      await api.createUser(payload);\r\n      setNewUserName(\"\");\r\n      setNewUserEmail(\"\");\r\n      setNewUserPassword(\"\");\r\n      setNewUserRole(\"user\");\r\n      setNewUserCountryId(\"\");\r\n      await load();\r\n      toast.success(\"User created (password reset required on first login)\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Create user failed\");\r\n    }\r\n  }\r\n\r\n  async function assignCountry() {\r\n    if (!selectedUser) {\r\n      toast.error(\"Select a user\");\r\n      return;\r\n    }\r\n    if (!assignCountryId) {\r\n      toast.error(\"Select a country\");\r\n      return;\r\n    }\r\n    if (userUpdateLoading) return;\r\n    const nextId = Number(assignCountryId);\r\n    if (!Number.isFinite(nextId)) {\r\n      toast.error(\"Invalid country selection\");\r\n      return;\r\n    }\r\n    if (isSameCountry) {\r\n      toast.error(\"Selected country is already assigned to this user\");\r\n      return;\r\n    }\r\n    if (selectedUser.country_id != null) {\r\n      const currentLabel = selectedUser.country_name\r\n        ? `${selectedUser.country_name} (${selectedUser.country_code})`\r\n        : \"Unassigned\";\r\n      const nextLabel = selectedCountry ? `${selectedCountry.name} (${selectedCountry.code})` : `#${nextId}`;\r\n      setConfirmAssign({\r\n        userId: selectedUser.id,\r\n        nextId,\r\n        email: selectedUser.email,\r\n        currentLabel,\r\n        nextLabel,\r\n        hadCountry: true,\r\n      });\r\n      return;\r\n    }\r\n    setUserUpdateLoading(true);\r\n    try {\r\n      await api.assignUserCountry(assignUserId, { countryId: nextId });\r\n      await load();\r\n      toast.success(\"User assigned\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Assignment failed\");\r\n    } finally {\r\n      setUserUpdateLoading(false);\r\n    }\r\n  }\r\n\r\n  async function confirmAssignCountry(data) {\r\n    if (!data) return;\r\n    if (userUpdateLoading) return;\r\n    setUserUpdateLoading(true);\r\n    try {\r\n      await api.assignUserCountry(data.userId, { countryId: data.nextId });\r\n      await load();\r\n      toast.success(data.hadCountry ? \"User country updated\" : \"User assigned\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Assignment failed\");\r\n    } finally {\r\n      setUserUpdateLoading(false);\r\n    }\r\n  }\r\n\r\n  async function deleteUser(user) {\r\n    if (!user || !user.id) return;\r\n    const label = user.email || `User #${user.id}`;\r\n    setConfirmDelete({ id: user.id, label });\r\n  }\r\n\r\n  async function confirmDeleteUser(data) {\r\n    if (!data) return;\r\n    try {\r\n      await api.deleteUser(data.id);\r\n      await load();\r\n      toast.success(\"User deleted\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Delete failed\");\r\n    }\r\n  }\r\n\r\n  // --- Permission editor helpers ---\r\n  /**\r\n   * Toggle selection of a permission key (resource|action) in the UI.\r\n   * When enabling a permission for the first time without a scope, defaults to country scope.\r\n   */\r\n  function togglePermission(key) {\r\n    setPermissionSelections((prev) => {\r\n      const next = { ...prev };\r\n      next[key] = !prev[key];\r\n      return next;\r\n    });\r\n    setPermissionScopes((prev) => {\r\n      // When turning on a permission that doesnt have a scope yet, default to country\r\n      if (!permissionSelections[key] && !prev[key]) {\r\n        return { ...prev, [key]: \"country\" };\r\n      }\r\n      return prev;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Change the scope for a permission key.\r\n   * @param {string} key The permission key (resource|action)\r\n   * @param {string} value The selected scope: \"country\" or \"school:<id>\"\r\n   */\r\n  function changePermissionScope(key, value) {\r\n    setPermissionScopes((prev) => ({ ...prev, [key]: value }));\r\n  }\r\n\r\n  /**\r\n   * Persist the current permission selections for the selected user.\r\n   * Constructs the payload based on selected permissions and scopes and sends\r\n   * it to the backend. Afterwards reloads the users permissions from the\r\n   * server to ensure UI consistency.\r\n   */\r\n  async function saveUserPermissions() {\r\n    if (!selectedUser) {\r\n      toast.error(\"Select a user to edit permissions\");\r\n      return;\r\n    }\r\n    const perms = [];\r\n    const keys = Object.keys(permissionSelections || {});\r\n    keys.forEach((key) => {\r\n      if (!permissionSelections[key]) return;\r\n      const [resource, action] = key.split(\"|\");\r\n      let scopeVal = permissionScopes[key] || \"country\";\r\n      let scope_country_id = null;\r\n      let scope_school_id = null;\r\n      // Determine scope\r\n      if (scopeVal === \"country\") {\r\n        // assign scope_country_id based on user's country_id if available\r\n        if (selectedUser.country_id != null) {\r\n          scope_country_id = Number(selectedUser.country_id);\r\n        }\r\n      } else if (scopeVal.startsWith(\"school:\")) {\r\n        const idStr = scopeVal.split(\":\")[1];\r\n        const sid = Number(idStr);\r\n        if (Number.isFinite(sid)) {\r\n          scope_school_id = sid;\r\n        }\r\n        // set country_id if available\r\n        if (selectedUser.country_id != null) {\r\n          scope_country_id = Number(selectedUser.country_id);\r\n        }\r\n      }\r\n      perms.push({ resource, action, scope_country_id, scope_school_id });\r\n    });\r\n    setPermissionsSaving(true);\r\n    try {\r\n      await api.adminSetUserPermissions(selectedUser.id, { permissions: perms });\r\n      // Reload user permissions to reflect server state\r\n      const updated = await api.adminGetUserPermissions(selectedUser.id);\r\n      // Recompute selections and scopes based on the latest permissions returned\r\n      const sel = {};\r\n      const scopeMap = {};\r\n      (updated || []).forEach((p) => {\r\n        const k = `${p.resource}|${p.action}`;\r\n        sel[k] = true;\r\n        if (p.scope_school_id != null) {\r\n          scopeMap[k] = `school:${p.scope_school_id}`;\r\n        } else {\r\n          scopeMap[k] = \"country\";\r\n        }\r\n      });\r\n      setPermissionSelections(sel);\r\n      setPermissionScopes(scopeMap);\r\n      toast.success(\"Permissions saved\");\r\n    } catch (e) {\r\n      toast.error(e?.message || \"Save permissions failed\");\r\n    } finally {\r\n      setPermissionsSaving(false);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the role of the currently selected user.  This is triggered\r\n   * when an admin chooses a new role from the role selector.  The\r\n   * function calls the adminUpdateUserRole API and then refreshes\r\n   * the list of users to reflect the change.  Displays success or\r\n   * error messages via toast notifications.\r\n   *\r\n   * @param {string} role The new role to assign to the user\r\n   */\r\n  async function updateSelectedUserRole(role) {\r\n    // Ensure there is a selected user before updating\r\n    if (!selectedUser) return;\r\n    setRoleUpdating(true);\r\n    try {\r\n      await api.adminUpdateUserRole(selectedUser.id, { role });\r\n      // Reload data so the user list reflects the new role\r\n      await load();\r\n      // Maintain the current selection after reload\r\n      setAssignUserId(String(selectedUser.id));\r\n      toast.success(\"Role updated\");\r\n    } catch (e) {\r\n      toast.error(e?.message || \"Failed to update role\");\r\n    } finally {\r\n      setRoleUpdating(false);\r\n    }\r\n  }\r\n\r\n  // --- Principal assignment helpers ---\r\n  /**\r\n   * Handle selection of principal users for a school. Updates the draft state.\r\n   * @param {number} schoolId\r\n   * @param {string[]} valueIds Array of selected userId strings from a multiselect element\r\n   */\r\n  function handlePrincipalSelectionChange(schoolId, valueIds) {\r\n    const ids = valueIds.map((v) => Number(v)).filter((n) => Number.isFinite(n));\r\n    setPrincipalDrafts((prev) => ({ ...prev, [schoolId]: ids }));\r\n  }\r\n\r\n  /**\r\n   * Save principal assignments for a given school. Sends the current draft\r\n   * selection to the backend and updates the local principal list.\r\n   * @param {number} schoolId\r\n   */\r\n  async function savePrincipalAssignments(schoolId) {\r\n    const userIds = principalDrafts[schoolId] || [];\r\n    setPrincipalSaving((prev) => ({ ...prev, [schoolId]: true }));\r\n    try {\r\n      await api.adminSetSchoolPrincipals(schoolId, { userIds });\r\n      // Update local list with selected principal user objects\r\n      const newList = users.filter((u) => u.role === \"principal\" && userIds.includes(u.id));\r\n      setPrincipalLists((prev) => ({ ...prev, [schoolId]: newList }));\r\n      toast.success(\"Principals updated\");\r\n    } catch (e) {\r\n      toast.error(e?.message || \"Failed to update principals\");\r\n    } finally {\r\n      setPrincipalSaving((prev) => ({ ...prev, [schoolId]: false }));\r\n    }\r\n  }\r\n\r\n  function getAuthTokenFromStorage() {\r\n    try {\r\n      const keys = [\"token\", \"auth_token\", \"jwt\", \"access_token\"];\r\n      for (const k of keys) {\r\n        const v = window?.localStorage?.getItem(k);\r\n        if (v) return String(v);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  async function adminResetUserPassword(userId) {\r\n    const token = getAuthTokenFromStorage();\r\n    const res = await fetch(`/api/admin/users/${userId}/reset-password`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n      },\r\n      body: JSON.stringify({}),\r\n    });\r\n    let data = {};\r\n    try {\r\n      data = await res.json();\r\n    } catch {\r\n      data = {};\r\n    }\r\n    if (!res.ok) {\r\n      const msg = data?.error || data?.details || `Reset failed (${res.status})`;\r\n      throw new Error(msg);\r\n    }\r\n    return data;\r\n  }\r\n\r\n  async function resetPasswordForUser(user) {\r\n    if (!user?.id) return;\r\n    setConfirmReset({ id: user.id, email: user.email, full_name: user.full_name || null });\r\n  }\r\n\r\n  async function confirmResetPassword(data) {\r\n    if (!data?.id) return;\r\n    if (resetLoadingId) return;\r\n    setResetLoadingId(data.id);\r\n    try {\r\n      const out = await adminResetUserPassword(data.id);\r\n      setResetResult({\r\n        id: data.id,\r\n        email: data.email,\r\n        full_name: data.full_name || null,\r\n        temporary_password: out.temporary_password,\r\n      });\r\n      await load();\r\n      toast.success(\"Temporary password generated\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Reset failed\");\r\n    } finally {\r\n      setResetLoadingId(null);\r\n    }\r\n  }\r\n\r\n  async function copyText(text) {\r\n    const value = String(text || \"\");\r\n    if (!value) return;\r\n    try {\r\n      await navigator.clipboard.writeText(value);\r\n      toast.success(\"Copied\");\r\n      return;\r\n    } catch {\r\n      // fallback\r\n    }\r\n    try {\r\n      const ta = document.createElement(\"textarea\");\r\n      ta.value = value;\r\n      ta.style.position = \"fixed\";\r\n      ta.style.left = \"-9999px\";\r\n      document.body.appendChild(ta);\r\n      ta.select();\r\n      document.execCommand(\"copy\");\r\n      document.body.removeChild(ta);\r\n      toast.success(\"Copied\");\r\n    } catch {\r\n      toast.error(\"Copy failed\");\r\n    }\r\n  }\r\n\r\n  async function saveSchoolName(school) {\r\n    if (!school?.id) return;\r\n    const draft = schoolNameDrafts[school.id];\r\n    const nextName = String(draft != null ? draft : school.name || \"\").trim();\r\n    if (!nextName) {\r\n      toast.error(\"Name is required\");\r\n      return;\r\n    }\r\n    if (nextName === school.name) return;\r\n\r\n    setSchoolSavingId(school.id);\r\n    try {\r\n      await api.adminUpdateSchool(school.id, { name: nextName });\r\n      await loadCountrySchools(schoolsCountryId);\r\n      setSchoolNameDrafts((prev) => ({ ...prev, [school.id]: nextName }));\r\n      toast.success(\"School updated\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Update failed\");\r\n    } finally {\r\n      setSchoolSavingId(null);\r\n    }\r\n  }\r\n\r\n  async function toggleSchoolStatus(school) {\r\n    if (!school?.id) return;\r\n    const nextStatus = school.status === \"closed\" ? \"active\" : \"closed\";\r\n    setSchoolSavingId(school.id);\r\n    try {\r\n      await api.adminUpdateSchool(school.id, { status: nextStatus });\r\n      await loadCountrySchools(schoolsCountryId);\r\n      toast.success(nextStatus === \"closed\" ? \"School closed\" : \"School reopened\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Update failed\");\r\n    } finally {\r\n      setSchoolSavingId(null);\r\n    }\r\n  }\r\n\r\n  const toggleProgressTab = (tabKey) => {\r\n    setExpandedProgressTabs((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(tabKey)) next.delete(tabKey);\r\n      else next.add(tabKey);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const toggleProgressSection = (sectionId) => {\r\n    setExpandedProgressSections((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(sectionId)) next.delete(sectionId);\r\n      else next.add(sectionId);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const updateProgressSection = (sectionId, updater) => {\r\n    setProgressConfig((prev) => {\r\n      const base = normalizeProgressConfig(prev);\r\n      const next = structuredClone(base);\r\n      const section = next.sections?.[sectionId];\r\n      if (!section) return base;\r\n      updater(section);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const setProgressFieldSelected = (sectionId, fieldId, checked) => {\r\n    updateProgressSection(sectionId, (section) => {\r\n      if (!section.selectedFields) section.selectedFields = {};\r\n      if (checked) delete section.selectedFields[fieldId];\r\n      else section.selectedFields[fieldId] = false;\r\n    });\r\n  };\r\n\r\n  const setProgressSectionEnabled = (sectionId, enabled) => {\r\n    updateProgressSection(sectionId, (section) => {\r\n      section.enabled = !!enabled;\r\n    });\r\n  };\r\n\r\n  const setProgressSectionMode = (sectionId, mode) => {\r\n    updateProgressSection(sectionId, (section) => {\r\n      section.mode = mode;\r\n    });\r\n  };\r\n\r\n  const setProgressSectionMin = (sectionId, value) => {\r\n    const num = Number(value);\r\n    updateProgressSection(sectionId, (section) => {\r\n      section.min = Number.isFinite(num) ? Math.max(1, num) : 1;\r\n    });\r\n  };\r\n\r\n  const selectAllSectionFields = (sectionId, fieldIds) => {\r\n    updateProgressSection(sectionId, (section) => {\r\n      if (!section.selectedFields) section.selectedFields = {};\r\n      fieldIds.forEach((id) => {\r\n        if (section.selectedFields) delete section.selectedFields[id];\r\n      });\r\n    });\r\n  };\r\n\r\n  const unselectAllSectionFields = (sectionId, fieldIds) => {\r\n    updateProgressSection(sectionId, (section) => {\r\n      if (!section.selectedFields) section.selectedFields = {};\r\n      fieldIds.forEach((id) => {\r\n        if (section.selectedFields) section.selectedFields[id] = false;\r\n      });\r\n    });\r\n  };\r\n\r\n  const toggleTargetCountry = (countryId) => {\r\n    const id = Number(countryId);\r\n    if (!Number.isFinite(id)) return;\r\n    setProgressTargetIds((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(id)) next.delete(id);\r\n      else next.add(id);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const selectAllTargets = () => {\r\n    setProgressTargetIds((prev) => {\r\n      const next = new Set(prev);\r\n      filteredCountriesForApply.forEach((country) => {\r\n        const id = Number(country.id);\r\n        if (Number.isFinite(id)) next.add(id);\r\n      });\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const clearTargets = () => {\r\n    setProgressTargetIds(new Set());\r\n  };\r\n\r\n  const applyProgressConfigToSelectedCountries = async () => {\r\n    const ids = Array.from(progressTargetIds)\r\n      .map((id) => Number(id))\r\n      .filter((id) => Number.isFinite(id));\r\n    const uniqueIds = Array.from(new Set(ids));\r\n    if (!uniqueIds.length) {\r\n      toast.error(\"Select at least one country\");\r\n      return;\r\n    }\r\n    if (!progressCountryId) {\r\n      toast.error(\"Select a country to edit rules first\");\r\n      return;\r\n    }\r\n    const ok = window.confirm(\r\n      `Apply this configuration to ${uniqueIds.length} countries? This will overwrite their current rules.`\r\n    );\r\n    if (!ok) return;\r\n\r\n    setProgressBulkSaving(true);\r\n    try {\r\n      const result = await api.adminBulkSaveProgressRequirements(uniqueIds, progressConfigNormalized);\r\n      const updatedCount = Number.isFinite(Number(result?.updatedCount))\r\n        ? Number(result.updatedCount)\r\n        : uniqueIds.length;\r\n      toast.success(`Applied to ${updatedCount} countries`);\r\n      if (uniqueIds.some((id) => String(id) === String(progressCountryId))) {\r\n        await loadProgressRequirements(progressCountryId);\r\n      }\r\n    } catch (e) {\r\n      toast.error(e.message || \"Failed to apply progress requirements\");\r\n    } finally {\r\n      setProgressBulkSaving(false);\r\n    }\r\n  };\r\n\r\n  const saveProgressConfig = async () => {\r\n    if (!progressCountryId) {\r\n      toast.error(\"Select a country\");\r\n      return;\r\n    }\r\n    setProgressSaving(true);\r\n    try {\r\n      const saved = await api.adminSaveProgressRequirements(progressCountryId, progressConfigNormalized);\r\n      setProgressConfig(normalizeProgressConfig(saved?.config || saved));\r\n      toast.success(\"Progress requirements saved\");\r\n    } catch (e) {\r\n      toast.error(e.message || \"Failed to save progress requirements\");\r\n    } finally {\r\n      setProgressSaving(false);\r\n    }\r\n  };\r\n\r\n  const openReviewModal = (row, action) => {\r\n    setReviewModal({ row, action });\r\n    setReviewNote(\"\");\r\n    setReviewIncludedYears({ y1: true, y2: true, y3: true });\r\n    if (action === \"revise\") {\r\n      // Reset revision selection: all modules unchecked by default\r\n      const initial = {};\r\n      REQUIRED_WORK_IDS.forEach((id) => (initial[id] = false));\r\n      setReviewRevisionSelection(initial);\r\n    }\r\n  };\r\n\r\n  const closeReviewModal = () => {\r\n    setReviewModal(null);\r\n    setReviewNote(\"\");\r\n    setReviewIncludedYears({ y1: true, y2: true, y3: true });\r\n    // Reset revision selections on close\r\n    const reset = {};\r\n    REQUIRED_WORK_IDS.forEach((id) => (reset[id] = false));\r\n    setReviewRevisionSelection(reset);\r\n  };\r\n\r\n  const submitReview = async () => {\r\n    if (!reviewModal?.row?.scenario?.id) return;\r\n    const action = reviewModal.action;\r\n    const note = reviewNote.trim();\r\n    if (action === \"revise\" && !note) {\r\n      toast.error(\"Note is required for revision requests\");\r\n      return;\r\n    }\r\n    const payload = { action, note: note || null };\r\n    if (action === \"approve\") {\r\n      const includedYears = YEAR_KEYS.filter((key) => reviewIncludedYears[key]);\r\n      if (!includedYears.length) {\r\n        toast.error(\"Select at least one year\");\r\n        return;\r\n      }\r\n      payload.includedYears = includedYears;\r\n    } else if (action === \"revise\") {\r\n      // Collect selected revision work ids.  At least one must be selected.\r\n      const revisionWorkIds = REQUIRED_WORK_IDS.filter((id) => reviewRevisionSelection[id]);\r\n      if (!revisionWorkIds.length) {\r\n        toast.error(\"Select at least one module\");\r\n        return;\r\n      }\r\n      payload.revisionWorkIds = revisionWorkIds;\r\n    }\r\n    setReviewSaving(true);\r\n    try {\r\n      await api.adminReviewScenario(reviewModal.row.scenario.id, payload);\r\n      toast.success(action === \"approve\" ? \"Scenario approved\" : \"Revision requested\");\r\n      closeReviewModal();\r\n      await loadQueue(); // uses latest filters via ref\r\n    } catch (e) {\r\n      toast.error(e.message || \"Review failed\");\r\n    } finally {\r\n      setReviewSaving(false);\r\n    }\r\n  };\r\n\r\n  const toggleRegion = (regionKey) => {\r\n    setExpandedRegions((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(regionKey)) next.delete(regionKey);\r\n      else next.add(regionKey);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const toggleCountry = (regionKey, countryId) => {\r\n    const key = `${regionKey}::${countryId}`;\r\n    setExpandedCountries((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(key)) next.delete(key);\r\n      else next.add(key);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const renderQueueKpis = (kpi) => {\r\n    if (!kpi) {\r\n      return <div className=\"kpi-mini kpi-mini-missing\">Missing KPIs</div>;\r\n    }\r\n    const margin = kpi.net_ciro ? kpi.net_result / kpi.net_ciro : null;\r\n    return (\r\n      <div className=\"kpi-mini\">\r\n        <div className=\"kpi-mini-row\">\r\n          <span className=\"kpi-mini-label\">Net ciro</span>\r\n          <span className=\"kpi-mini-value\">{fmt(kpi.net_ciro)}</span>\r\n        </div>\r\n        <div className=\"kpi-mini-row\">\r\n          <span className=\"kpi-mini-label\">Net result</span>\r\n          <span className=\"kpi-mini-value\">{fmt(kpi.net_result)}</span>\r\n        </div>\r\n        <div className=\"kpi-mini-row\">\r\n          <span className=\"kpi-mini-label\">Margin</span>\r\n          <span className=\"kpi-mini-value\">{fmtPct(margin)}</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderYearCell = (year) => {\r\n    if (!year) return <div className=\"rollup-year-cell is-empty\">-</div>;\r\n    return (\r\n      <div className=\"rollup-year-cell\">\r\n        <div className=\"rollup-metric\">\r\n          <span className=\"rollup-label\">Net ciro</span>\r\n          <span className=\"rollup-value\">{fmt(year.net_ciro)}</span>\r\n        </div>\r\n        <div className=\"rollup-metric\">\r\n          <span className=\"rollup-label\">Net income</span>\r\n          <span className=\"rollup-value\">{fmt(year.net_income)}</span>\r\n        </div>\r\n        <div className=\"rollup-metric\">\r\n          <span className=\"rollup-label\">Expenses</span>\r\n          <span className=\"rollup-value\">{fmt(year.total_expenses)}</span>\r\n        </div>\r\n        <div className=\"rollup-metric\">\r\n          <span className=\"rollup-label\">Net result</span>\r\n          <span className=\"rollup-value\">{fmt(year.net_result)}</span>\r\n        </div>\r\n        <div className=\"rollup-metric\">\r\n          <span className=\"rollup-label\">Margin</span>\r\n          <span className=\"rollup-value\">{fmtPct(year.profitMargin)}</span>\r\n        </div>\r\n        <div className=\"rollup-metric\">\r\n          <span className=\"rollup-label\">Students</span>\r\n          <span className=\"rollup-value\">{fmt(year.students_total)}</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const handleRefresh = () => {\r\n    if (activeTab === \"approvals\") {\r\n      loadQueue(queueFilters);\r\n      return;\r\n    }\r\n    if (activeTab === \"progress\") {\r\n      if (progressCountryId) loadProgressRequirements(progressCountryId);\r\n      return;\r\n    }\r\n    if (activeTab === \"reports\") {\r\n      loadRollup(rollupYear);\r\n      return;\r\n    }\r\n    if (activeTab === \"countries\") {\r\n      load();\r\n      if (schoolsCountryId) loadCountrySchools(schoolsCountryId);\r\n      return;\r\n    }\r\n    load();\r\n  };\r\n\r\n  if (!auth.user) {\r\n    return (\r\n      <div className=\"container\">\r\n        <div className=\"card\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (auth.user.role !== \"admin\") {\r\n    return (\r\n      <div className=\"container\">\r\n        <div className=\"card\">\r\n          <div style={{ fontWeight: 700 }}>Admin only</div>\r\n          <div className=\"small\" style={{ marginTop: 6 }}>\r\n            You do not have permission to view this page.\r\n          </div>\r\n          <div style={{ marginTop: 10 }}>\r\n            <Link to=\"/schools\">Back to Schools</Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const rollupExportDisabled = rollupLoading || !rollupData;\r\n  const rollupXlsxReady = false;\r\n  const refreshDisabled = loading || queueLoading || rollupLoading || progressLoading;\r\n  const renderRefreshButton = () => (\r\n    <button className=\"btn\" onClick={handleRefresh} disabled={refreshDisabled}>\r\n      Refresh\r\n    </button>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {outlet?.headerPortalEl ? createPortal(renderRefreshButton(), outlet.headerPortalEl) : null}\r\n      <div className=\"container\">\r\n        {!outlet?.headerPortalEl && (\r\n          <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\r\n            <div>\r\n              <div style={{ fontWeight: 800, fontSize: 20 }}>Admin</div>\r\n              <div className=\"small\">Create users, manage countries, and review scenarios.</div>\r\n            </div>\r\n            {renderRefreshButton()}\r\n          </div>\r\n        )}\r\n\r\n        <ToastContainer position=\"top-right\" autoClose={3500} newestOnTop closeOnClick pauseOnFocusLoss pauseOnHover />\r\n\r\n      {userUpdateLoading ? (\r\n        <div className=\"modal-backdrop\" role=\"status\" aria-live=\"polite\" aria-busy=\"true\">\r\n          <style>{`@keyframes adminSpin{to{transform:rotate(360deg)}}`}</style>\r\n          <div\r\n            className=\"card\"\r\n            style={{\r\n              width: \"min(360px, 92vw)\",\r\n              padding: \"16px\",\r\n              textAlign: \"center\",\r\n            }}\r\n          >\r\n            <div\r\n              aria-hidden\r\n              style={{\r\n                width: 28,\r\n                height: 28,\r\n                margin: \"0 auto\",\r\n                borderRadius: \"50%\",\r\n                border: \"3px solid rgba(0,0,0,.15)\",\r\n                borderTopColor: \"rgba(0,0,0,.75)\",\r\n                animation: \"adminSpin .8s linear infinite\",\r\n              }}\r\n            />\r\n            <div style={{ fontWeight: 700, marginTop: 10 }}>Updating user...</div>\r\n            <div className=\"small muted\" style={{ marginTop: 6 }}>\r\n              Please wait.\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {confirmAssign ? (\r\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\r\n          <div className=\"modal\">\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Confirm Change</div>\r\n            <div className=\"small\" style={{ marginBottom: 12 }}>\r\n              {`Change ${confirmAssign.email} from ${confirmAssign.currentLabel} to ${confirmAssign.nextLabel}?`}\r\n            </div>\r\n            <div className=\"row\" style={{ justifyContent: \"flex-end\" }}>\r\n              <button className=\"btn\" onClick={() => setConfirmAssign(null)} disabled={userUpdateLoading}>\r\n                Cancel\r\n              </button>\r\n              <button\r\n                className=\"btn primary\"\r\n                onClick={() => {\r\n                  const data = confirmAssign;\r\n                  setConfirmAssign(null);\r\n                  confirmAssignCountry(data);\r\n                }}\r\n                disabled={userUpdateLoading}\r\n              >\r\n                {userUpdateLoading ? \"Updating...\" : \"Confirm\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {confirmDelete ? (\r\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\r\n          <div className=\"modal\">\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Confirm Delete</div>\r\n            <div className=\"small\" style={{ marginBottom: 12 }}>\r\n              {`Delete ${confirmDelete.label}? This only works if the user has no related records.`}\r\n            </div>\r\n            <div className=\"row\" style={{ justifyContent: \"flex-end\" }}>\r\n              <button className=\"btn\" onClick={() => setConfirmDelete(null)}>\r\n                Cancel\r\n              </button>\r\n              <button\r\n                className=\"btn danger\"\r\n                onClick={() => {\r\n                  const data = confirmDelete;\r\n                  setConfirmDelete(null);\r\n                  confirmDeleteUser(data);\r\n                }}\r\n              >\r\n                Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {resetLoadingId ? (\r\n        <div className=\"modal-backdrop\" role=\"status\" aria-live=\"polite\" aria-busy=\"true\">\r\n          <style>{`@keyframes adminSpin{to{transform:rotate(360deg)}}`}</style>\r\n          <div\r\n            className=\"card\"\r\n            style={{\r\n              width: \"min(360px, 92vw)\",\r\n              padding: \"16px\",\r\n              textAlign: \"center\",\r\n            }}\r\n          >\r\n            <div\r\n              aria-hidden\r\n              style={{\r\n                width: 28,\r\n                height: 28,\r\n                margin: \"0 auto\",\r\n                borderRadius: \"50%\",\r\n                border: \"3px solid rgba(0,0,0,.15)\",\r\n                borderTopColor: \"rgba(0,0,0,.75)\",\r\n                animation: \"adminSpin .8s linear infinite\",\r\n              }}\r\n            />\r\n            <div style={{ fontWeight: 700, marginTop: 10 }}>Resetting password...</div>\r\n            <div className=\"small muted\" style={{ marginTop: 6 }}>\r\n              Please wait.\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {confirmReset ? (\r\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\r\n          <div className=\"modal\">\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Reset Password</div>\r\n            <div className=\"small\" style={{ marginBottom: 12 }}>\r\n              {`Generate a new temporary password for ${confirmReset.email}? The user will be forced to change it on next login.`}\r\n            </div>\r\n            <div className=\"row\" style={{ justifyContent: \"flex-end\" }}>\r\n              <button className=\"btn\" onClick={() => setConfirmReset(null)} disabled={Boolean(resetLoadingId)}>\r\n                Cancel\r\n              </button>\r\n              <button\r\n                className=\"btn primary\"\r\n                onClick={() => {\r\n                  const data = confirmReset;\r\n                  setConfirmReset(null);\r\n                  confirmResetPassword(data);\r\n                }}\r\n                disabled={Boolean(resetLoadingId)}\r\n              >\r\n                Confirm\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {resetResult ? (\r\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\r\n          <div className=\"modal\" style={{ maxWidth: 560 }}>\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Temporary Password</div>\r\n            <div className=\"small\" style={{ marginBottom: 10 }}>\r\n              Share this password securely with the user. It will only be shown once here.\r\n            </div>\r\n            <div className=\"card\" style={{ padding: 12, background: \"rgba(0,0,0,.03)\" }}>\r\n              <div className=\"small\" style={{ marginBottom: 6 }}>\r\n                User: <strong>{resetResult.email}</strong>\r\n              </div>\r\n              <div className=\"row\" style={{ alignItems: \"center\", justifyContent: \"space-between\" }}>\r\n                <div style={{ fontFamily: \"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace\", fontSize: 18 }}>\r\n                  {resetResult.temporary_password}\r\n                </div>\r\n                <button className=\"btn\" onClick={() => copyText(resetResult.temporary_password)}>\r\n                  Copy\r\n                </button>\r\n              </div>\r\n            </div>\r\n            <div className=\"row\" style={{ justifyContent: \"flex-end\", marginTop: 12 }}>\r\n              <button className=\"btn primary\" onClick={() => setResetResult(null)}>\r\n                Done\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {reviewModal ? (\r\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\r\n          <div className=\"modal\">\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>\r\n              {reviewModal.action === \"approve\" ? \"Approve Scenario\" : \"Request Revision\"}\r\n            </div>\r\n            <div className=\"small\" style={{ marginBottom: 12 }}>\r\n              {reviewModal.row?.school?.name ? `${reviewModal.row.school.name} - ` : \"\"}\r\n              {reviewModal.row?.scenario?.name || \"Scenario\"}\r\n            </div>\r\n\r\n            {reviewModal.action === \"approve\" ? (\r\n              <div style={{ marginBottom: 10 }}>\r\n                <div className=\"small\" style={{ marginBottom: 6 }}>\r\n                  Included years\r\n                </div>\r\n                <div className=\"row\">\r\n                  {YEAR_KEYS.map((key) => (\r\n                    <label key={key} className=\"small\" style={{ display: \"inline-flex\", gap: 6 }}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={reviewIncludedYears[key]}\r\n                        onChange={(e) => setReviewIncludedYears((prev) => ({ ...prev, [key]: e.target.checked }))}\r\n                      />\r\n                      {key.toUpperCase()}\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n\r\n            {reviewModal.action === \"revise\" ? (\r\n              <div style={{ marginBottom: 10 }}>\r\n                <div className=\"small\" style={{ marginBottom: 6 }}>\r\n                  Sadece seilen modller revizeye alacak (editable).\r\n                </div>\r\n                <div className=\"row\" style={{ flexWrap: \"wrap\", gap: 8 }}>\r\n                  {REQUIRED_WORK_IDS.map((id) => (\r\n                    <label\r\n                      key={id}\r\n                      className=\"small\"\r\n                      style={{ display: \"inline-flex\", gap: 6, alignItems: \"center\" }}\r\n                    >\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={Boolean(reviewRevisionSelection[id])}\r\n                        onChange={(e) =>\r\n                          setReviewRevisionSelection((prev) => ({ ...prev, [id]: e.target.checked }))\r\n                        }\r\n                      />\r\n                      {WORK_ID_LABELS[id] || id}\r\n                    </label>\r\n                  ))}\r\n                  <button type=\"button\" className=\"btn sm\" onClick={selectAllRevisionWork}>\r\n                    Tmn se\r\n                  </button>\r\n                  <button type=\"button\" className=\"btn sm\" onClick={clearRevisionWork}>\r\n                    Temizle\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n\r\n            <div style={{ marginBottom: 12 }}>\r\n              <div className=\"small\" style={{ marginBottom: 6 }}>\r\n                Note {reviewModal.action === \"revise\" ? \"(required)\" : \"(optional)\"}\r\n              </div>\r\n              <textarea\r\n                className=\"input\"\r\n                style={{ width: \"100%\", minHeight: 90 }}\r\n                value={reviewNote}\r\n                onChange={(e) => setReviewNote(e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"row\" style={{ justifyContent: \"flex-end\" }}>\r\n              <button className=\"btn\" onClick={closeReviewModal}>\r\n                Cancel\r\n              </button>\r\n              <button className=\"btn primary\" onClick={submitReview} disabled={reviewSaving}>\r\n                {reviewSaving ? \"Saving...\" : reviewModal.action === \"approve\" ? \"Approve\" : \"Request Revision\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {activeTab === \"users\" && (\r\n        <>\r\n          <div\r\n            style={{\r\n              marginTop: 12,\r\n              display: \"grid\",\r\n              gridTemplateColumns: \"repeat(auto-fit, minmax(320px, 1fr))\",\r\n              gap: 12,\r\n            }}\r\n          >\r\n            <div className=\"card\">\r\n              <div style={{ fontWeight: 700, marginBottom: 8 }}>Create User</div>\r\n              <div className=\"row\">\r\n                <input\r\n                  className=\"input\"\r\n                  placeholder=\"Full name\"\r\n                  value={newUserName}\r\n                  onChange={(e) => setNewUserName(e.target.value)}\r\n                />\r\n                <input\r\n                  className=\"input\"\r\n                  placeholder=\"Email\"\r\n                  value={newUserEmail}\r\n                  onChange={(e) => setNewUserEmail(e.target.value)}\r\n                />\r\n                <input\r\n                  className=\"input\"\r\n                  placeholder=\"Temporary password\"\r\n                  type=\"password\"\r\n                  value={newUserPassword}\r\n                  onChange={(e) => setNewUserPassword(e.target.value)}\r\n                />\r\n                <select className=\"input sm\" value={newUserRole} onChange={(e) => setNewUserRole(e.target.value)}>\r\n                  <option value=\"user\">User</option>\r\n                  <option value=\"admin\">Admin</option>\r\n                  <option value=\"principal\">Principal</option>\r\n                  <option value=\"hr\">HR</option>\r\n                  <option value=\"manager\">Manager</option>\r\n                  <option value=\"accountant\">Accountant</option>\r\n                </select>\r\n                <select\r\n                  className=\"input\"\r\n                  value={newUserCountryId}\r\n                  onChange={(e) => setNewUserCountryId(e.target.value)}\r\n                >\r\n                  <option value=\"\">Assign country (optional)</option>\r\n                  {countries.map((c) => (\r\n                    <option key={c.id} value={c.id}>\r\n                      {c.name} ({c.code}){c.region ? ` - ${c.region}` : \"\"}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                <button className=\"btn primary\" onClick={createUser} disabled={loading}>\r\n                  <span className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                    <FaUserPlus aria-hidden=\"true\" />\r\n                    <span>Create</span>\r\n                  </span>\r\n                </button>\r\n              </div>\r\n              <div className=\"small\" style={{ marginTop: 8 }}>\r\n                New users must reset their password on first login.\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"card\">\r\n              <div style={{ fontWeight: 700, marginBottom: 8 }}>Assign / Edit User Country</div>\r\n              <div className=\"small\" style={{ marginBottom: 6 }}>\r\n                {selectedUser\r\n                  ? `Editing: ${selectedUser.email}${selectedUser.full_name ? ` (${selectedUser.full_name})` : \"\"\r\n                  } #${selectedUser.id}`\r\n                  : \"Select a user to assign or edit.\"}\r\n              </div>\r\n              <div className=\"row\">\r\n                <select className=\"input\" value={assignUserId} onChange={(e) => setAssignUserId(e.target.value)}>\r\n                  <option value=\"\">Select user</option>\r\n                  {users.map((u) => (\r\n                    <option key={u.id} value={u.id}>\r\n                      {u.email} {u.full_name ? `(${u.full_name})` : \"\"} #{u.id}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                <select className=\"input\" value={assignCountryId} onChange={(e) => setAssignCountryId(e.target.value)}>\r\n                  <option value=\"\">Select country</option>\r\n                  {countries.map((c) => (\r\n                    <option key={c.id} value={c.id}>\r\n                      {c.name} ({c.code}) - {c.region}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                <button\r\n                  className=\"btn primary\"\r\n                  onClick={assignCountry}\r\n                  disabled={loading || userUpdateLoading || !assignUserId || !assignCountryId || isSameCountry}\r\n                >\r\n                  {userUpdateLoading ? \"Updating...\" : actionLabel}\r\n                </button>\r\n              </div>\r\n              <div className=\"small\" style={{ marginTop: 8 }}>\r\n                <div>Current: {currentAssignmentLabel}</div>\r\n                <div>New: {newAssignmentLabel}</div>\r\n                {selectedUser && selectedCountry && selectedUser.country_id != null && !isSameCountry ? (\r\n                  <div style={{ color: \"#b45309\" }}>You are changing this user's assignment.</div>\r\n                ) : null}\r\n                {isSameCountry ? <div style={{ color: \"#6b7280\" }}>Selected country matches current assignment.</div> : null}\r\n                Users must re-login after assignment to refresh their token.\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n            {/* Permissions editor for the selected user */}\r\n            <div className=\"card\">\r\n              <div style={{ fontWeight: 700, marginBottom: 8 }}>Permissions</div>\r\n              {/* Only render the editor when a user is selected */}\r\n              {!selectedUser ? (\r\n                <div className=\"small\">Select a user above to edit permissions.</div>\r\n              ) : permissionsLoading ? (\r\n                <div className=\"small\">Loading permissions...</div>\r\n              ) : (\r\n                <>\r\n                  {/* Role selector for admin to change the user's role */}\r\n                  <div style={{ marginBottom: 8 }}>\r\n                    <label className=\"small\" style={{ marginRight: 8 }}>Role:</label>\r\n                    <select\r\n                      className=\"input sm\"\r\n                      value={selectedUser?.role || \"user\"}\r\n                      onChange={(e) => updateSelectedUserRole(e.target.value)}\r\n                      disabled={roleUpdating}\r\n                    >\r\n                      {roleOptions.map((opt) => (\r\n                        <option key={opt.value} value={opt.value}>{opt.label}</option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  {Object.keys(permissionsGrouped).length === 0 ? (\r\n                    <div className=\"small\">No permissions defined.</div>\r\n                  ) : (\r\n                    Object.entries(permissionsGrouped).map(([groupName, perms]) => (\r\n                      <div key={groupName} style={{ marginBottom: 12 }}>\r\n                        <div style={{ fontWeight: 600, marginBottom: 4 }}>{groupName}</div>\r\n                        {perms.map((perm) => {\r\n                          const key = `${perm.resource}|${perm.action}`;\r\n                          const isSelected = Boolean(permissionSelections[key]);\r\n                          const scopeValue = permissionScopes[key] || \"country\";\r\n                          return (\r\n                            <div key={key} className=\"row\" style={{ alignItems: \"center\", marginBottom: 4 }}>\r\n                              <label className=\"small\" style={{ flexGrow: 1, display: \"flex\", alignItems: \"center\", gap: 6 }}>\r\n                                <input\r\n                                  type=\"checkbox\"\r\n                                  checked={isSelected}\r\n                                  onChange={() => togglePermission(key)}\r\n                                />\r\n                                {perm.label}\r\n                              </label>\r\n                              {/* Scope selector */}\r\n                              <select\r\n                                className=\"input sm\"\r\n                                disabled={!isSelected}\r\n                                value={scopeValue}\r\n                                onChange={(e) => changePermissionScope(key, e.target.value)}\r\n                              >\r\n                                <option value=\"country\">Country</option>\r\n                                {userSchools && userSchools.map((s) => (\r\n                                  <option key={s.id} value={`school:${s.id}`}>\r\n                                    {s.name}\r\n                                  </option>\r\n                                ))}\r\n                              </select>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                    ))\r\n                  )}\r\n                  <div className=\"row\" style={{ marginTop: 8 }}>\r\n                    <button className=\"btn primary\" onClick={saveUserPermissions} disabled={permissionsSaving}>\r\n                      {permissionsSaving ? \"Saving...\" : \"Save Permissions\"}\r\n                    </button>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n\r\n          <div className=\"card\" style={{ marginTop: 12 }}>\r\n            <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\r\n              <div style={{ fontWeight: 700 }}>Users</div>\r\n              <label className=\"small\">\r\n                <input type=\"checkbox\" checked={showUnassigned} onChange={(e) => setShowUnassigned(e.target.checked)} />{\" \"}\r\n                Unassigned only\r\n              </label>\r\n            </div>\r\n            <table className=\"table\" style={{ marginTop: 8 }}>\r\n              <thead>\r\n                <tr>\r\n                  <th>ID</th>\r\n                  <th>Name</th>\r\n                  <th>Email</th>\r\n                  <th>Role</th>\r\n                  <th>Reset</th>\r\n                  <th>Country</th>\r\n                  <th>Region</th>\r\n                  <th>Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filteredUsers.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan=\"8\" className=\"small\">\r\n                      No users found.\r\n                    </td>\r\n                  </tr>\r\n                ) : (\r\n                  filteredUsers.map((u) => (\r\n                    <tr key={u.id}>\r\n                      <td className=\"small\">{u.id}</td>\r\n                      <td>{u.full_name || \"-\"}</td>\r\n                      <td>{u.email}</td>\r\n                      <td className=\"small\">{u.role}</td>\r\n                      <td>{u.must_reset_password ? <span className=\"badge\">Yes</span> : <span className=\"small\">No</span>}</td>\r\n                      <td>\r\n                        {u.country_name ? <span>{u.country_name} ({u.country_code})</span> : <span className=\"badge\">Unassigned</span>}\r\n                      </td>\r\n                      <td>{u.region || \"-\"}</td>\r\n                      <td>\r\n                        <div className=\"row\">\r\n                          <button className=\"btn\" onClick={() => setAssignUserId(String(u.id))}>\r\n                            Edit\r\n                          </button>\r\n                          <button\r\n                            className=\"btn\"\r\n                            onClick={() => resetPasswordForUser(u)}\r\n                            disabled={Boolean(resetLoadingId)}\r\n                          >\r\n                            Reset password\r\n                          </button>\r\n                          <button className=\"btn\" onClick={() => deleteUser(u)}>\r\n                            Delete\r\n                          </button>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n            <div className=\"small\" style={{ marginTop: 8 }}>\r\n              Delete is blocked if the user has created or updated records.\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {activeTab === \"countries\" && (\r\n        <>\r\n          <div className=\"card\" style={{ marginTop: 12 }}>\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Create Country</div>\r\n            <div className=\"row\">\r\n              <input\r\n                className=\"input\"\r\n                placeholder=\"Country name\"\r\n                value={countryName}\r\n                onChange={(e) => setCountryName(e.target.value)}\r\n              />\r\n              <input\r\n                className=\"input sm\"\r\n                placeholder=\"Code\"\r\n                value={countryCode}\r\n                onChange={(e) => setCountryCode(e.target.value.toUpperCase())}\r\n              />\r\n              <input\r\n                className=\"input\"\r\n                placeholder=\"Region\"\r\n                value={countryRegion}\r\n                onChange={(e) => setCountryRegion(e.target.value)}\r\n              />\r\n              <button className=\"btn primary\" onClick={createCountry} disabled={loading}>\r\n                Create\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"card\" style={{ marginTop: 12 }}>\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Countries</div>\r\n            <table className=\"table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>ID</th>\r\n                  <th>Name</th>\r\n                  <th>Code</th>\r\n                  <th>Region</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {countries.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan=\"4\" className=\"small\">\r\n                      No countries yet.\r\n                    </td>\r\n                  </tr>\r\n                ) : (\r\n                  countries.map((c) => (\r\n                    <tr key={c.id}>\r\n                      <td className=\"small\">{c.id}</td>\r\n                      <td>{c.name}</td>\r\n                      <td className=\"small\">{c.code}</td>\r\n                      <td>{c.region}</td>\r\n                    </tr>\r\n                  ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n\r\n          <div className=\"card\" style={{ marginTop: 12 }}>\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Country Schools</div>\r\n            <div className=\"row\" style={{ marginBottom: 10 }}>\r\n              <select\r\n                className=\"input\"\r\n                value={schoolsCountryId}\r\n                onChange={(e) => setSchoolsCountryId(e.target.value)}\r\n              >\r\n                <option value=\"\">Select a country</option>\r\n                {countries.map((c) => (\r\n                  <option key={c.id} value={c.id}>\r\n                    {c.name}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n              <input\r\n                className=\"input\"\r\n                placeholder=\"Search schools\"\r\n                value={schoolsSearch}\r\n                onChange={(e) => setSchoolsSearch(e.target.value)}\r\n                disabled={!schoolsCountryId}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"row\" style={{ marginBottom: 10 }}>\r\n              <input\r\n                className=\"input\"\r\n                placeholder=\"New school name\"\r\n                value={newSchoolName}\r\n                onChange={(e) => setNewSchoolName(e.target.value)}\r\n                disabled={!schoolsCountryId || schoolCreateBusy}\r\n              />\r\n              <button\r\n                className=\"btn primary\"\r\n                onClick={createCountrySchool}\r\n                disabled={!schoolsCountryId || schoolCreateBusy}\r\n              >\r\n                <span className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                  <FaSchool aria-hidden=\"true\" />\r\n                  <span>{schoolCreateLoading ? \"Creating...\" : \"Create\"}</span>\r\n                </span>\r\n              </button>\r\n            </div>\r\n\r\n            <div style={{ marginBottom: 12, paddingTop: 8, borderTop: \"1px solid #eef2f7\" }}>\r\n              <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>\r\n                Bulk add schools\r\n              </div>\r\n              <div style={{ display: \"grid\", gap: 6 }}>\r\n                {schoolCreateRows.map((row, idx) => (\r\n                  <div key={`school-create-row-${idx}`} className=\"row\">\r\n                    <input\r\n                      className=\"input\"\r\n                      placeholder={`School name #${idx + 1}`}\r\n                      value={row}\r\n                      onChange={(e) => updateSchoolCreateRow(idx, e.target.value)}\r\n                      disabled={!schoolsCountryId || schoolCreateBusy}\r\n                    />\r\n                    <button\r\n                      className=\"btn\"\r\n                      type=\"button\"\r\n                      onClick={() => removeSchoolCreateRow(idx)}\r\n                      disabled={!schoolsCountryId || schoolCreateBusy || schoolCreateRows.length <= 1}\r\n                    >\r\n                      Remove\r\n                    </button>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              <div className=\"row\" style={{ marginTop: 8 }}>\r\n                <button\r\n                  className=\"btn\"\r\n                  type=\"button\"\r\n                  onClick={addSchoolCreateRow}\r\n                  disabled={!schoolsCountryId || schoolCreateBusy}\r\n                >\r\n                  Add row\r\n                </button>\r\n                <button\r\n                  className=\"btn primary\"\r\n                  type=\"button\"\r\n                  onClick={createCountrySchoolsBulk}\r\n                  disabled={!schoolsCountryId || schoolCreateBusy || bulkCreateCount === 0}\r\n                >\r\n                  <span className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                    <FaSchool aria-hidden=\"true\" />\r\n                    <span>\r\n                      {schoolBulkCreateLoading ? \"Creating...\" : `Create ${bulkCreateCount || \"\"}`.trim()}\r\n                    </span>\r\n                  </span>\r\n                </button>\r\n              </div>\r\n              <div className=\"small\" style={{ marginTop: 6, color: \"#6b7280\" }}>\r\n                Add one school per row, then create all at once.\r\n              </div>\r\n            </div>\r\n\r\n            {!selectedSchoolsCountry ? (\r\n              <div className=\"small\">Select a country to manage its schools.</div>\r\n            ) : (\r\n              <table className=\"table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Name</th>\r\n                    <th>Status</th>\r\n                    <th>Created At</th>\r\n                    <th>Closed At</th>\r\n                    <th>Principals</th>\r\n                    <th>Actions</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {countrySchoolsLoading ? (\r\n                    <tr>\r\n                      <td colSpan=\"6\" className=\"small\">\r\n                        Loading...\r\n                      </td>\r\n                    </tr>\r\n                  ) : filteredCountrySchools.length === 0 ? (\r\n                    <tr>\r\n                      <td colSpan=\"6\" className=\"small\">\r\n                        No schools found.\r\n                      </td>\r\n                    </tr>\r\n                  ) : (\r\n                    filteredCountrySchools.map((school) => {\r\n                      const statusMeta = getSchoolStatusMeta(school.status);\r\n                      const draftName = schoolNameDrafts[school.id] ?? school.name ?? \"\";\r\n                      const isSaving = schoolSavingId === school.id;\r\n\r\n                      return (\r\n                        <tr key={school.id}>\r\n                          <td>{school.name}</td>\r\n                          <td>\r\n                            <span className={`status-badge ${statusMeta.className}`}>\r\n                              {statusMeta.label}\r\n                            </span>\r\n                          </td>\r\n                          <td className=\"small\">{formatDateTime(school.created_at)}</td>\r\n                          <td className=\"small\">{formatDateTime(school.closed_at)}</td>\r\n                          {/* Principals column: show assigned principal names */}\r\n                          <td>\r\n                            {Array.isArray(principalLists[school.id]) && principalLists[school.id].length > 0 ? (\r\n                              <span>{principalLists[school.id].map((u) => u.full_name || u.email).join(\", \")}</span>\r\n                            ) : (\r\n                              <span className=\"small muted\">-</span>\r\n                            )}\r\n                          </td>\r\n                          <td>\r\n                            {/* School name edit and status toggle */}\r\n                            <div className=\"row\">\r\n                              <input\r\n                                className=\"input sm\"\r\n                                value={draftName}\r\n                                onChange={(e) =>\r\n                                  setSchoolNameDrafts((prev) => ({\r\n                                    ...prev,\r\n                                    [school.id]: e.target.value,\r\n                                  }))\r\n                                }\r\n                                disabled={isSaving}\r\n                              />\r\n                              <button\r\n                                className=\"btn primary\"\r\n                                onClick={() => saveSchoolName(school)}\r\n                                disabled={isSaving}\r\n                              >\r\n                                Save\r\n                              </button>\r\n                              <button\r\n                                className=\"btn\"\r\n                                onClick={() => toggleSchoolStatus(school)}\r\n                                disabled={isSaving}\r\n                              >\r\n                                {school.status === \"closed\" ? \"Reopen\" : \"Close\"}\r\n                              </button>\r\n                            </div>\r\n                            {/* Principal assignment editor */}\r\n                            <div className=\"row\" style={{ marginTop: 4 }}>\r\n                              <select\r\n                                multiple\r\n                                className=\"input sm\"\r\n                                value={(principalDrafts[school.id] || []).map(String)}\r\n                                onChange={(e) => {\r\n                                  const opts = Array.from(e.target.selectedOptions || []);\r\n                                  const values = opts.map((o) => o.value);\r\n                                  handlePrincipalSelectionChange(school.id, values);\r\n                                }}\r\n                              >\r\n                                {users\r\n                                  .filter((u) => u.role === \"principal\")\r\n                                  .map((u) => (\r\n                                    <option key={u.id} value={u.id}>\r\n                                      {u.email} {u.full_name ? `(${u.full_name})` : \"\"} #{u.id}\r\n                                    </option>\r\n                                  ))}\r\n                              </select>\r\n                              <button\r\n                                className=\"btn\"\r\n                                onClick={() => savePrincipalAssignments(school.id)}\r\n                                disabled={Boolean(principalSaving[school.id])}\r\n                              >\r\n                                {principalSaving[school.id] ? \"Saving...\" : \"Save\"}\r\n                              </button>\r\n                            </div>\r\n                          </td>\r\n                        </tr>\r\n                      );\r\n                    })\r\n                  )}\r\n                </tbody>\r\n              </table>\r\n            )}\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {activeTab === \"progress\" && (\r\n        <div style={{ marginTop: 12 }}>\r\n          <div className=\"card\">\r\n            <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n              <div>\r\n                <div style={{ fontWeight: 700 }}>Progress Tracking</div>\r\n                <div className=\"small\">Configure per-field requirements by country.</div>\r\n              </div>\r\n              <div className=\"row\">\r\n                <select\r\n                  className=\"input sm\"\r\n                  value={progressCountryId}\r\n                  onChange={(e) => setProgressCountryId(e.target.value)}\r\n                >\r\n                  <option value=\"\">Select country</option>\r\n                  {countries.map((c) => (\r\n                    <option key={c.id} value={c.id}>\r\n                      {c.name}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                <input\r\n                  className=\"input sm\"\r\n                  placeholder=\"Search fields\"\r\n                  value={progressSearch}\r\n                  onChange={(e) => setProgressSearch(e.target.value)}\r\n                />\r\n                <button\r\n                  className=\"btn primary\"\r\n                  onClick={saveProgressConfig}\r\n                  disabled={!progressCountryId || progressSaving || progressLoading}\r\n                >\r\n                  {progressSaving ? \"Saving...\" : \"Save\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"card\" style={{ marginTop: 12 }}>\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Apply to multiple countries</div>\r\n            <div className=\"row\" style={{ alignItems: \"center\", flexWrap: \"wrap\", marginBottom: 10 }}>\r\n              <input\r\n                className=\"input sm\"\r\n                placeholder=\"Search countries\"\r\n                value={progressCountryListSearch}\r\n                onChange={(e) => setProgressCountryListSearch(e.target.value)}\r\n              />\r\n              <button\r\n                className=\"btn\"\r\n                onClick={selectAllTargets}\r\n                disabled={filteredCountriesForApply.length === 0 || progressBulkSaving}\r\n              >\r\n                Select all\r\n              </button>\r\n              <button\r\n                className=\"btn\"\r\n                onClick={clearTargets}\r\n                disabled={progressTargetCount === 0 || progressBulkSaving}\r\n              >\r\n                Clear\r\n              </button>\r\n              <button\r\n                className=\"btn primary\"\r\n                onClick={applyProgressConfigToSelectedCountries}\r\n                disabled={progressBulkDisabled}\r\n              >\r\n                {progressBulkSaving ? \"Applying...\" : `Apply to Selected (${progressTargetCount})`}\r\n              </button>\r\n            </div>\r\n\r\n            <div\r\n              style={{\r\n                border: \"1px solid #e5e7eb\",\r\n                borderRadius: 10,\r\n                padding: 10,\r\n                background: \"#fff\",\r\n                maxHeight: 240,\r\n                overflowY: \"auto\",\r\n              }}\r\n            >\r\n              {filteredCountriesForApply.length === 0 ? (\r\n                <div className=\"small\">No countries found.</div>\r\n              ) : (\r\n                filteredCountriesForApply.map((country) => {\r\n                  const id = Number(country.id);\r\n                  const checked = progressTargetIds.has(id);\r\n                  return (\r\n                    <label\r\n                      key={country.id}\r\n                      style={{ display: \"flex\", gap: 8, alignItems: \"center\", padding: \"6px 0\" }}\r\n                    >\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={checked}\r\n                        onChange={() => toggleTargetCountry(id)}\r\n                      />\r\n                      <span>{country.name || \"-\"}</span>\r\n                    </label>\r\n                  );\r\n                })\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {!progressCountryId ? (\r\n            <div className=\"card\" style={{ marginTop: 12 }}>\r\n              <div className=\"small\">Select a country to edit progress rules.</div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"card\" style={{ marginTop: 12 }}>\r\n              {progressLoading ? (\r\n                <div className=\"small\">Loading...</div>\r\n              ) : (\r\n                <div style={{ display: \"grid\", gap: 12 }}>\r\n                  {progressCatalog.tabs.map((tab) => {\r\n                    const tabSections = progressCatalog.sections.filter((s) => s.tabKey === tab.key);\r\n                    const visibleSections = tabSections.filter((section) => {\r\n                      if (!progressSearchValue) return true;\r\n                      const sectionMatch = String(section.label || \"\").toLowerCase().includes(progressSearchValue);\r\n                      const fields = (section.fields || [])\r\n                        .map((id) => progressCatalog.fieldsById[id])\r\n                        .filter(Boolean);\r\n                      const fieldMatch = fields.some((f) => {\r\n                        const label = String(f.label || \"\").toLowerCase();\r\n                        const id = String(f.id || \"\").toLowerCase();\r\n                        return label.includes(progressSearchValue) || id.includes(progressSearchValue);\r\n                      });\r\n                      return sectionMatch || fieldMatch;\r\n                    });\r\n\r\n                    if (!visibleSections.length) return null;\r\n                    const tabExpanded = expandedProgressTabs.has(tab.key) || Boolean(progressSearchValue);\r\n\r\n                    return (\r\n                      <div key={tab.key} style={{ border: \"1px solid #e5e7eb\", borderRadius: 10, padding: 10 }}>\r\n                        <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\r\n                          <div className=\"row\">\r\n                            <button\r\n                              type=\"button\"\r\n                              className=\"btn\"\r\n                              onClick={() => toggleProgressTab(tab.key)}\r\n                            >\r\n                              {tabExpanded ? \"-\" : \"+\"}\r\n                            </button>\r\n                            <div style={{ fontWeight: 700 }}>{tab.label}</div>\r\n                          </div>\r\n                          <div className=\"small\">{tabSections.length} sections</div>\r\n                        </div>\r\n\r\n                        {tabExpanded ? (\r\n                          <div style={{ display: \"grid\", gap: 10, marginTop: 10 }}>\r\n                            {visibleSections.map((section) => {\r\n                              const sectionConfig = progressConfigNormalized.sections?.[section.id] || {};\r\n                              const sectionEnabled = sectionConfig.enabled !== false;\r\n                              const sectionMode = String(sectionConfig.mode || section.modeDefault || \"ALL\").toUpperCase();\r\n                              const sectionMin =\r\n                                Number.isFinite(Number(sectionConfig.min)) && Number(sectionConfig.min) > 0\r\n                                  ? Number(sectionConfig.min)\r\n                                  : section.minDefault || 1;\r\n\r\n                              const allFields = (section.fields || [])\r\n                                .map((id) => progressCatalog.fieldsById[id])\r\n                                .filter(Boolean);\r\n                              const filteredFields = progressSearchValue\r\n                                ? allFields.filter((field) => {\r\n                                  const label = String(field.label || \"\").toLowerCase();\r\n                                  const id = String(field.id || \"\").toLowerCase();\r\n                                  return label.includes(progressSearchValue) || id.includes(progressSearchValue);\r\n                                })\r\n                                : allFields;\r\n\r\n                              if (!filteredFields.length && progressSearchValue) return null;\r\n\r\n                              const sectionExpanded = expandedProgressSections.has(section.id) || Boolean(progressSearchValue);\r\n                              const fieldIdsForBulk = (progressSearchValue ? filteredFields : allFields).map((f) => f.id);\r\n                              const selectedCount = allFields.filter(\r\n                                (field) => sectionConfig.selectedFields?.[field.id] !== false\r\n                              ).length;\r\n                              const totalCount = allFields.length;\r\n                              const showOnlySelected = Boolean(showOnlySelectedBySection[section.id]);\r\n                              const visibleFields = showOnlySelected\r\n                                ? filteredFields.filter((field) => sectionConfig.selectedFields?.[field.id] !== false)\r\n                                : filteredFields;\r\n                              const minValue = sectionMode === \"MIN\" ? sectionMin : null;\r\n                              const minTooHigh = sectionMode === \"MIN\" && minValue > selectedCount;\r\n                              const ruleSummary =\r\n                                sectionMode === \"ALL\"\r\n                                  ? ` Rule: Must complete ALL selected fields (${selectedCount} selected)`\r\n                                  : minTooHigh\r\n                                    ? ` MIN (${minValue}) is greater than selected (${selectedCount}). It will behave like ALL.`\r\n                                    : ` Rule: Must complete AT LEAST ${minValue} of ${selectedCount} selected fields`;\r\n                              const requiredCount = sectionMode === \"MIN\" ? minValue : selectedCount;\r\n\r\n                              return (\r\n                                <div key={section.id} style={{ borderTop: \"1px solid #eef2f7\", paddingTop: 10 }}>\r\n                                  <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n                                    <div className=\"row\">\r\n                                      <button\r\n                                        type=\"button\"\r\n                                        className=\"btn\"\r\n                                        onClick={() => toggleProgressSection(section.id)}\r\n                                      >\r\n                                        {sectionExpanded ? \"-\" : \"+\"}\r\n                                      </button>\r\n                                      <div style={{ fontWeight: 700 }}>{section.label}</div>\r\n                                      <span className={`status-badge ${sectionEnabled ? \"is-ok\" : \"is-muted\"}`}>\r\n                                        {sectionEnabled ? \"Enabled\" : \"Disabled\"}\r\n                                      </span>\r\n                                      <span className=\"small\">\r\n                                        {selectedCount}/{allFields.length || 0} selected\r\n                                      </span>\r\n                                    </div>\r\n\r\n                                    <div className=\"row\">\r\n                                      <label className=\"small\">\r\n                                        <input\r\n                                          type=\"checkbox\"\r\n                                          checked={showOnlySelected}\r\n                                          onChange={() =>\r\n                                            setShowOnlySelectedBySection((prev) => ({\r\n                                              ...prev,\r\n                                              [section.id]: !prev?.[section.id],\r\n                                            }))\r\n                                          }\r\n                                        />{\" \"}\r\n                                        Show only selected\r\n                                      </label>\r\n                                      <label className=\"small\">\r\n                                        <input\r\n                                          type=\"checkbox\"\r\n                                          checked={sectionEnabled}\r\n                                          onChange={(e) => setProgressSectionEnabled(section.id, e.target.checked)}\r\n                                        />{\" \"}\r\n                                        Enabled\r\n                                      </label>\r\n                                      <select\r\n                                        className=\"input xs\"\r\n                                        value={sectionMode}\r\n                                        onChange={(e) => setProgressSectionMode(section.id, e.target.value)}\r\n                                      >\r\n                                        <option value=\"ALL\">ALL</option>\r\n                                        <option value=\"MIN\">MIN</option>\r\n                                      </select>\r\n                                      {sectionMode === \"MIN\" ? (\r\n                                        <input\r\n                                          className=\"input xs\"\r\n                                          type=\"number\"\r\n                                          min=\"1\"\r\n                                          value={sectionMin}\r\n                                          onChange={(e) => setProgressSectionMin(section.id, e.target.value)}\r\n                                        />\r\n                                      ) : null}\r\n                                      <button\r\n                                        className=\"btn\"\r\n                                        onClick={() => selectAllSectionFields(section.id, fieldIdsForBulk)}\r\n                                        disabled={!fieldIdsForBulk.length}\r\n                                      >\r\n                                        Select all\r\n                                      </button>\r\n                                      <button\r\n                                        className=\"btn\"\r\n                                        onClick={() => unselectAllSectionFields(section.id, fieldIdsForBulk)}\r\n                                        disabled={!fieldIdsForBulk.length}\r\n                                      >\r\n                                        Unselect all\r\n                                      </button>\r\n                                    </div>\r\n                                  </div>\r\n                                  <div className=\"small\" style={{ marginTop: 6 }}>\r\n                                    {ruleSummary}\r\n                                  </div>\r\n                                  <div className=\"small\" style={{ marginTop: 4, color: \"#6b7280\" }}>\r\n                                    Selected: {selectedCount}/{totalCount}  Mode: {sectionMode}  Required: {requiredCount}\r\n                                  </div>\r\n\r\n                                  {sectionExpanded ? (\r\n                                    <div style={{ marginTop: 8 }}>\r\n                                      {!visibleFields.length ? (\r\n                                        <div className=\"small\">No fields available for this section.</div>\r\n                                      ) : (\r\n                                        <div className=\"grid2\" style={{ gap: 8 }}>\r\n                                          {visibleFields.map((field) => {\r\n                                            const checked = sectionConfig.selectedFields?.[field.id] !== false;\r\n                                            const dynamicHint = getDynamicHint(section.id, field);\r\n                                            return (\r\n                                              <label\r\n                                                key={field.id}\r\n                                                className=\"small\"\r\n                                                style={{\r\n                                                  display: \"flex\",\r\n                                                  gap: 8,\r\n                                                  alignItems: \"center\",\r\n                                                  justifyContent: \"space-between\",\r\n                                                  width: \"100%\",\r\n                                                }}\r\n                                              >\r\n                                                <span style={{ display: \"inline-flex\", gap: 8, alignItems: \"center\" }}>\r\n                                                  <input\r\n                                                    type=\"checkbox\"\r\n                                                    checked={checked}\r\n                                                    onChange={(e) =>\r\n                                                      setProgressFieldSelected(section.id, field.id, e.target.checked)\r\n                                                    }\r\n                                                    disabled={!sectionEnabled}\r\n                                                  />\r\n                                                  <span>{field.label || field.id}</span>\r\n                                                </span>\r\n                                                {dynamicHint ? (\r\n                                                  <span\r\n                                                    style={{\r\n                                                      padding: \"2px 8px\",\r\n                                                      borderRadius: 999,\r\n                                                      background: \"#eef2f7\",\r\n                                                      color: \"#374151\",\r\n                                                      fontSize: 11,\r\n                                                      lineHeight: 1.4,\r\n                                                      whiteSpace: \"nowrap\",\r\n                                                    }}\r\n                                                  >\r\n                                                    Dynamic: {dynamicHint}\r\n                                                  </span>\r\n                                                ) : null}\r\n                                              </label>\r\n                                            );\r\n                                          })}\r\n                                        </div>\r\n                                      )}\r\n                                    </div>\r\n                                  ) : null}\r\n                                </div>\r\n                              );\r\n                            })}\r\n                          </div>\r\n                        ) : null}\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {activeTab === \"approvals\" && (\r\n        <div className=\"card\" style={{ marginTop: 12 }}>\r\n          <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"flex-end\" }}>\r\n            <div>\r\n              <div style={{ fontWeight: 700 }}>alma Listeleri</div>\r\n              <div className=\"small\">Review submitted scenarios and approve for rollups.</div>\r\n            </div>\r\n            <div className=\"row admin-filter-row\">\r\n              <select\r\n                className=\"input sm\"\r\n                value={queueFilters.status}\r\n                onChange={(e) => setQueueFilters((prev) => ({ ...prev, status: e.target.value }))}\r\n              >\r\n                <option value=\"\">All</option>\r\n                <option value=\"sent_for_approval\">Sent for approval</option>\r\n                <option value=\"approved\">Approved</option>\r\n                <option value=\"revision_requested\">Revision requested</option>\r\n                <option value=\"draft\">Draft</option>\r\n              </select>\r\n              <input\r\n                className=\"input sm\"\r\n                placeholder=\"Academic year\"\r\n                value={queueFilters.academicYear}\r\n                onChange={(e) => setQueueFilters((prev) => ({ ...prev, academicYear: e.target.value }))}\r\n              />\r\n              <select\r\n                className=\"input sm\"\r\n                value={queueFilters.region}\r\n                onChange={(e) => setQueueFilters((prev) => ({ ...prev, region: e.target.value, countryId: \"\" }))}\r\n              >\r\n                <option value=\"\">All regions</option>\r\n                {regionOptions.map((r) => (\r\n                  <option key={r} value={r}>\r\n                    {r}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n              <select\r\n                className=\"input sm\"\r\n                value={queueFilters.countryId}\r\n                onChange={(e) => setQueueFilters((prev) => ({ ...prev, countryId: e.target.value }))}\r\n              >\r\n                <option value=\"\">All countries</option>\r\n                {queueCountryOptions.map((c) => (\r\n                  <option key={c.id} value={c.id}>\r\n                    {c.name}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n\r\n              {/*  don't pass click event */}\r\n              <button className=\"btn\" onClick={() => loadQueue(queueFilters)} disabled={queueLoading}>\r\n                Apply\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <table className=\"table admin-approvals-table\" style={{ marginTop: 12 }}>\r\n            <thead>\r\n              <tr>\r\n                <th aria-sort={ariaSort(\"country_name\")}>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => toggleQueueSort(\"country_name\")}\r\n                    style={{\r\n                      display: \"inline-flex\",\r\n                      alignItems: \"center\",\r\n                      gap: 6,\r\n                      background: \"none\",\r\n                      border: \"none\",\r\n                      padding: 0,\r\n                      cursor: \"pointer\",\r\n                      font: \"inherit\",\r\n                    }}\r\n                    title=\"Sort\"\r\n                  >\r\n                    lke <span aria-hidden>{sortIndicator(\"country_name\")}</span>\r\n                  </button>\r\n                </th>\r\n                <th aria-sort={ariaSort(\"school_name\")}>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => toggleQueueSort(\"school_name\")}\r\n                    style={{\r\n                      display: \"inline-flex\",\r\n                      alignItems: \"center\",\r\n                      gap: 6,\r\n                      background: \"none\",\r\n                      border: \"none\",\r\n                      padding: 0,\r\n                      cursor: \"pointer\",\r\n                      font: \"inherit\",\r\n                    }}\r\n                    title=\"Sort\"\r\n                  >\r\n                    School <span aria-hidden>{sortIndicator(\"school_name\")}</span>\r\n                  </button>\r\n                </th>\r\n                <th aria-sort={ariaSort(\"scenario_name\")}>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => toggleQueueSort(\"scenario_name\")}\r\n                    style={{\r\n                      display: \"inline-flex\",\r\n                      alignItems: \"center\",\r\n                      gap: 6,\r\n                      background: \"none\",\r\n                      border: \"none\",\r\n                      padding: 0,\r\n                      cursor: \"pointer\",\r\n                      font: \"inherit\",\r\n                    }}\r\n                    title=\"Sort\"\r\n                  >\r\n                    Scenario <span aria-hidden>{sortIndicator(\"scenario_name\")}</span>\r\n                  </button>\r\n                </th>\r\n                <th aria-sort={ariaSort(\"academic_year\")}>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => toggleQueueSort(\"academic_year\")}\r\n                    style={{\r\n                      display: \"inline-flex\",\r\n                      alignItems: \"center\",\r\n                      gap: 6,\r\n                      background: \"none\",\r\n                      border: \"none\",\r\n                      padding: 0,\r\n                      cursor: \"pointer\",\r\n                      font: \"inherit\",\r\n                    }}\r\n                    title=\"Sort\"\r\n                  >\r\n                    Academic Year <span aria-hidden>{sortIndicator(\"academic_year\")}</span>\r\n                  </button>\r\n                </th>\r\n                <th aria-sort={ariaSort(\"submitted_at\")}>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => toggleQueueSort(\"submitted_at\")}\r\n                    style={{\r\n                      display: \"inline-flex\",\r\n                      alignItems: \"center\",\r\n                      gap: 6,\r\n                      background: \"none\",\r\n                      border: \"none\",\r\n                      padding: 0,\r\n                      cursor: \"pointer\",\r\n                      font: \"inherit\",\r\n                    }}\r\n                    title=\"Sort\"\r\n                  >\r\n                    Submitted <span aria-hidden>{sortIndicator(\"submitted_at\")}</span>\r\n                  </button>\r\n                </th>\r\n                <th aria-sort={ariaSort(\"status\")}>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => toggleQueueSort(\"status\")}\r\n                    style={{\r\n                      display: \"inline-flex\",\r\n                      alignItems: \"center\",\r\n                      gap: 6,\r\n                      background: \"none\",\r\n                      border: \"none\",\r\n                      padding: 0,\r\n                      cursor: \"pointer\",\r\n                      font: \"inherit\",\r\n                    }}\r\n                    title=\"Sort\"\r\n                  >\r\n                    Status <span aria-hidden>{sortIndicator(\"status\")}</span>\r\n                  </button>\r\n                </th>\r\n                <th>Progress</th>\r\n                <th>Y1 KPIs</th>\r\n                <th>Y2 KPIs</th>\r\n                <th>Y3 KPIs</th>\r\n                <th>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {queueLoading ? (\r\n                <tr>\r\n                  <td colSpan=\"11\" className=\"small\">\r\n                    Loading...\r\n                  </td>\r\n                </tr>\r\n              ) : sortedQueueRows.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan=\"11\" className=\"small\">\r\n                    No scenarios found.\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                sortedQueueRows.map((row) => {\r\n                  const statusMeta = getStatusMeta(row.scenario);\r\n                  const canApprove =\r\n                    row.scenario?.status === 'sent_for_approval' || row.scenario?.status === 'submitted';\r\n                  const canRevise = ['sent_for_approval', 'approved', 'submitted'].includes(row.scenario?.status);\r\n                  const missing = row.missingKpis?.y1 || row.missingKpis?.y2 || row.missingKpis?.y3;\r\n                  const progressPct = Number.isFinite(Number(row.scenario?.progress_pct))\r\n                    ? Math.round(Number(row.scenario.progress_pct))\r\n                    : null;\r\n                  const progressMissingCount = Number(row.scenario?.progress_missing_count || 0);\r\n                  const progressMissingPreview = row.scenario?.progress_missing_preview;\r\n                  const progressTooltipLines =\r\n                    progressPct == null\r\n                      ? []\r\n                      : progressMissingCount > 0\r\n                        ? [\"Eksik:\", progressMissingPreview || \"Eksik alanlar\"]\r\n                        : [\"Tum tablar tamamlandi\"];\r\n\r\n                  return (\r\n                    <tr key={row.scenario?.id || `${row.school?.id}-${row.scenario?.name}`}>\r\n                      <td>\r\n                        <div style={{ fontWeight: 700 }}>{row.country?.name || \"-\"}</div>\r\n                        {row.country?.region ? <div className=\"small\">{row.country.region}</div> : null}\r\n                      </td>\r\n                      <td>\r\n                        <div style={{ fontWeight: 700 }}>{row.school?.name || \"-\"}</div>\r\n                      </td>\r\n                      <td>\r\n                        <div>{row.scenario?.name || \"-\"}</div>\r\n                        {missing ? <span className=\"status-badge is-bad\">Missing KPIs</span> : null}\r\n                      </td>\r\n                      <td className=\"small\">{row.scenario?.academic_year || \"-\"}</td>\r\n                      <td className=\"small\">{formatDateTime(row.scenario?.submitted_at)}</td>\r\n                      <td>\r\n                        <span className={`status-badge ${statusMeta.className}`}>{statusMeta.label}</span>\r\n                      </td>\r\n                      <td>\r\n                        {progressPct == null ? (\r\n                          <span className=\"small\">-</span>\r\n                        ) : (\r\n                          <Tooltip lines={progressTooltipLines}>\r\n                            <span className=\"badge\">{progressPct}%</span>\r\n                          </Tooltip>\r\n                        )}\r\n                      </td>\r\n                      <td>{renderQueueKpis(row.kpis?.y1)}</td>\r\n                      <td>{renderQueueKpis(row.kpis?.y2)}</td>\r\n                      <td>{renderQueueKpis(row.kpis?.y3)}</td>\r\n                      <td>\r\n                        <div className=\"row\">\r\n                          <button\r\n                            className=\"btn primary\"\r\n                            onClick={() => openReviewModal(row, \"approve\")}\r\n                            disabled={!canApprove || reviewSaving}\r\n                          >\r\n                            Onayla\r\n                          </button>\r\n                          <button\r\n                            className=\"btn\"\r\n                            onClick={() => openReviewModal(row, \"revise\")}\r\n                            disabled={!canRevise || reviewSaving}\r\n                          >\r\n                            Revizyon ste\r\n                          </button>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  );\r\n                })\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n\r\n      {activeTab === \"reports\" && (\r\n        <div style={{ marginTop: 12 }}>\r\n          <div className=\"card\">\r\n            <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\r\n              <div>\r\n                <div style={{ fontWeight: 700 }}>Rollup Reports</div>\r\n                <div className=\"small\">Approved scenarios only. Select an academic year.</div>\r\n              </div>\r\n              <div className=\"row\">\r\n                <input\r\n                  className=\"input sm\"\r\n                  placeholder=\"Academic year\"\r\n                  value={rollupYear}\r\n                  onChange={(e) => setRollupYear(e.target.value)}\r\n                />\r\n                <button className=\"btn\" onClick={() => loadRollup(rollupYear)} disabled={rollupLoading}>\r\n                  {rollupLoading ? \"Loading...\" : \"Load\"}\r\n                </button>\r\n\r\n                <div className=\"action-menu\" ref={rollupExportRef}>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn\"\r\n                    onClick={() => {\r\n                      if (rollupExportDisabled) return;\r\n                      setRollupExportOpen((prev) => !prev);\r\n                    }}\r\n                    disabled={rollupExportDisabled}\r\n                    aria-haspopup=\"menu\"\r\n                    aria-expanded={rollupExportOpen}\r\n                  >\r\n                    Export\r\n                  </button>\r\n                  {rollupExportOpen ? (\r\n                    <div className=\"action-menu-panel\" role=\"menu\">\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"action-menu-item\"\r\n                        onClick={() => {\r\n                          setRollupExportOpen(false);\r\n                          if (!rollupXlsxReady) return;\r\n                          const url = api.adminExportRollupXlsxUrl(rollupYear.trim());\r\n                          window.location.assign(url);\r\n                        }}\r\n                        disabled={!rollupXlsxReady}\r\n                        title={rollupXlsxReady ? \"Download Excel\" : \"Excel export coming soon\"}\r\n                        role=\"menuitem\"\r\n                      >\r\n                        Excel (.xlsx){rollupXlsxReady ? \"\" : \" (coming soon)\"}\r\n                      </button>\r\n                      <button type=\"button\" className=\"action-menu-item\" disabled role=\"menuitem\">\r\n                        PDF (coming soon)\r\n                      </button>\r\n                    </div>\r\n                  ) : null}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {rollupData ? (\r\n            <>\r\n              <div className=\"card\" style={{ marginTop: 12 }}>\r\n                <div style={{ fontWeight: 700 }}>Consolidated KPIs</div>\r\n                <div className=\"admin-kpi-strip\" style={{ marginTop: 10 }}>\r\n                  {YEAR_KEYS.map((key) => (\r\n                    <div key={key} className=\"admin-kpi-year\">\r\n                      <div className=\"admin-kpi-year-title\">{key.toUpperCase()}</div>\r\n                      <div className=\"admin-kpi-grid\">\r\n                        <div className=\"admin-kpi\">\r\n                          <div className=\"admin-kpi-label\">Net ciro</div>\r\n                          <div className=\"admin-kpi-value\">{fmt(rollupData.totals?.[key]?.net_ciro)}</div>\r\n                        </div>\r\n                        <div className=\"admin-kpi\">\r\n                          <div className=\"admin-kpi-label\">Net income</div>\r\n                          <div className=\"admin-kpi-value\">{fmt(rollupData.totals?.[key]?.net_income)}</div>\r\n                        </div>\r\n                        <div className=\"admin-kpi\">\r\n                          <div className=\"admin-kpi-label\">Expenses</div>\r\n                          <div className=\"admin-kpi-value\">{fmt(rollupData.totals?.[key]?.total_expenses)}</div>\r\n                        </div>\r\n                        <div className=\"admin-kpi\">\r\n                          <div className=\"admin-kpi-label\">Net result</div>\r\n                          <div className=\"admin-kpi-value\">{fmt(rollupData.totals?.[key]?.net_result)}</div>\r\n                        </div>\r\n                        <div className=\"admin-kpi\">\r\n                          <div className=\"admin-kpi-label\">Margin</div>\r\n                          <div className=\"admin-kpi-value\">{fmtPct(rollupData.totals?.[key]?.profitMargin)}</div>\r\n                        </div>\r\n                        <div className=\"admin-kpi\">\r\n                          <div className=\"admin-kpi-label\">Students</div>\r\n                          <div className=\"admin-kpi-value\">{fmt(rollupData.totals?.[key]?.students_total)}</div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card\" style={{ marginTop: 12 }}>\r\n                <div style={{ fontWeight: 700 }}>Rollup Tree</div>\r\n                <div className=\"small\" style={{ marginTop: 4 }}>\r\n                  Only approved scenarios are consolidated. Excluded years show as blank.\r\n                </div>\r\n\r\n                <div className=\"rollup-table-wrap\" style={{ marginTop: 10 }}>\r\n                  <table className=\"table rollup-table\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th style={{ minWidth: 220 }}>Unit</th>\r\n                        <th style={{ minWidth: 220 }}>Y1</th>\r\n                        <th style={{ minWidth: 220 }}>Y2</th>\r\n                        <th style={{ minWidth: 220 }}>Y3</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      <tr className=\"rollup-row rollup-total\">\r\n                        <td className=\"rollup-name\">Totals</td>\r\n                        <td>{renderYearCell(rollupData.totals?.y1)}</td>\r\n                        <td>{renderYearCell(rollupData.totals?.y2)}</td>\r\n                        <td>{renderYearCell(rollupData.totals?.y3)}</td>\r\n                      </tr>\r\n\r\n                      {rollupData.regions?.map((region) => {\r\n                        const regionKey = region.region || \"Unknown\";\r\n                        const regionExpanded = expandedRegions.has(regionKey);\r\n                        return (\r\n                          <React.Fragment key={`region-${regionKey}`}>\r\n                            <tr className=\"rollup-row rollup-region\">\r\n                              <td className=\"rollup-name\">\r\n                                <button\r\n                                  type=\"button\"\r\n                                  className=\"tree-toggle\"\r\n                                  onClick={() => toggleRegion(regionKey)}\r\n                                  aria-label=\"Toggle region\"\r\n                                >\r\n                                  {regionExpanded ? \"-\" : \"+\"}\r\n                                </button>\r\n                                <span className=\"rollup-title\">{region.region || \"Unknown region\"}</span>\r\n                              </td>\r\n                              <td>{renderYearCell(region.years?.y1)}</td>\r\n                              <td>{renderYearCell(region.years?.y2)}</td>\r\n                              <td>{renderYearCell(region.years?.y3)}</td>\r\n                            </tr>\r\n\r\n                            {regionExpanded\r\n                              ? region.countries?.map((country) => {\r\n                                const countryKey = `${regionKey}::${country.id}`;\r\n                                const countryExpanded = expandedCountries.has(countryKey);\r\n                                return (\r\n                                  <React.Fragment key={countryKey}>\r\n                                    <tr className=\"rollup-row rollup-country\">\r\n                                      <td className=\"rollup-name level-1\">\r\n                                        <button\r\n                                          type=\"button\"\r\n                                          className=\"tree-toggle\"\r\n                                          onClick={() => toggleCountry(regionKey, country.id)}\r\n                                          aria-label=\"Toggle country\"\r\n                                        >\r\n                                          {countryExpanded ? \"-\" : \"+\"}\r\n                                        </button>\r\n                                        <span className=\"rollup-title\">{country.name}</span>\r\n                                      </td>\r\n                                      <td>{renderYearCell(country.years?.y1)}</td>\r\n                                      <td>{renderYearCell(country.years?.y2)}</td>\r\n                                      <td>{renderYearCell(country.years?.y3)}</td>\r\n                                    </tr>\r\n\r\n                                    {countryExpanded\r\n                                      ? country.schools?.map((school) => (\r\n                                        <tr key={`school-${school.id}`} className=\"rollup-row rollup-school\">\r\n                                          <td className=\"rollup-name level-2\">\r\n                                            {school.name}\r\n                                            {school.included_years?.length ? (\r\n                                              <span className=\"rollup-sub\">({school.included_years.join(\", \")})</span>\r\n                                            ) : null}\r\n                                          </td>\r\n                                          <td>{renderYearCell(school.years?.y1)}</td>\r\n                                          <td>{renderYearCell(school.years?.y2)}</td>\r\n                                          <td>{renderYearCell(school.years?.y3)}</td>\r\n                                        </tr>\r\n                                      ))\r\n                                      : null}\r\n                                  </React.Fragment>\r\n                                );\r\n                              })\r\n                              : null}\r\n                          </React.Fragment>\r\n                        );\r\n                      })}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n\r\n              {rollupData.missingNoApproved?.length ? (\r\n                <div className=\"card admin-alert\" style={{ marginTop: 12 }}>\r\n                  <div className=\"admin-alert-title\">Schools without an approved scenario</div>\r\n                  <ul>\r\n                    {rollupData.missingNoApproved.map((row) => (\r\n                      <li key={`missing-${row.id}`}>\r\n                        {row.name} ({row.country_name})\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              ) : null}\r\n\r\n              {rollupData.missingKpis?.length ? (\r\n                <div className=\"card admin-alert\" style={{ marginTop: 12 }}>\r\n                  <div className=\"admin-alert-title\">Approved scenarios missing KPI snapshots</div>\r\n                  <ul>\r\n                    {rollupData.missingKpis.map((row) => (\r\n                      <li key={`missing-kpi-${row.scenario_id}`}>\r\n                        Scenario #{row.scenario_id} (School #{row.school_id}) - missing {row.missingYears.join(\", \")}\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              ) : null}\r\n            </>\r\n          ) : (\r\n            <div className=\"card\" style={{ marginTop: 12 }}>\r\n              <div className=\"small\">Select an academic year to view the rollup report.</div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n    </>\r\n  );\r\n}\r\n"],"names":["YEAR_KEYS","REQUIRED_WORK_IDS","WORK_ID_LABELS","temel_bilgiler","kapasite","DEFAULT_ADMIN_TAB","_ADMIN_TABS$","ADMIN_TABS","key","isValidAdminTab","value","some","tab","getTabFromSearch","search","URLSearchParams","get","fmt","v","n","Number","isFinite","toLocaleString","undefined","maximumFractionDigits","fmtPct","formatDateTime","d","Date","getTime","SAMPLE_DISCOUNTS","normalizeProgressConfig","config","defaults","DEFAULT_PROGRESS_CONFIG","input","sectionsInput","sections","out","version","Object","keys","forEach","id","base","incoming","enabled","mode","min","selectedFields","AdminPage","_auth$user2","_auth$user4","_reviewModal$row2","_reviewModal$row2$sch","_reviewModal$row3","_reviewModal$row3$sce","_rollupData$totals7","_rollupData$totals8","_rollupData$totals9","_rollupData$regions","_rollupData$missingNo","_rollupData$missingKp","forcedTab","arguments","length","auth","useAuth","outlet","useOutletContext","location","useLocation","normalizedForcedTab","activeTab","setActiveTab","useState","fromSearch","stored","localStorage","getItem","_","useEffect","setItem","countries","setCountries","users","setUsers","loading","setLoading","userUpdateLoading","setUserUpdateLoading","confirmAssign","setConfirmAssign","confirmDelete","setConfirmDelete","confirmReset","setConfirmReset","resetResult","setResetResult","resetLoadingId","setResetLoadingId","countryName","setCountryName","countryCode","setCountryCode","countryRegion","setCountryRegion","newUserName","setNewUserName","newUserEmail","setNewUserEmail","newUserPassword","setNewUserPassword","newUserRole","setNewUserRole","newUserCountryId","setNewUserCountryId","assignUserId","setAssignUserId","assignCountryId","setAssignCountryId","showUnassigned","setShowUnassigned","schoolsCountryId","setSchoolsCountryId","countrySchools","setCountrySchools","countrySchoolsLoading","setCountrySchoolsLoading","schoolsSearch","setSchoolsSearch","newSchoolName","setNewSchoolName","schoolCreateLoading","setSchoolCreateLoading","schoolBulkCreateLoading","setSchoolBulkCreateLoading","schoolCreateRows","setSchoolCreateRows","schoolSavingId","setSchoolSavingId","schoolNameDrafts","setSchoolNameDrafts","progressCountryId","setProgressCountryId","progressConfig","setProgressConfig","progressLoading","setProgressLoading","progressSaving","setProgressSaving","progressSearch","setProgressSearch","progressTargetIds","setProgressTargetIds","Set","progressCountryListSearch","setProgressCountryListSearch","progressBulkSaving","setProgressBulkSaving","showOnlySelectedBySection","setShowOnlySelectedBySection","expandedProgressTabs","setExpandedProgressTabs","expandedProgressSections","setExpandedProgressSections","queueRows","setQueueRows","permissionsCatalog","setPermissionsCatalog","permissionSelections","setPermissionSelections","permissionScopes","setPermissionScopes","permissionsLoading","setPermissionsLoading","permissionsSaving","setPermissionsSaving","userSchools","setUserSchools","roleOptions","useMemo","label","roleUpdating","setRoleUpdating","principalLists","setPrincipalLists","principalDrafts","setPrincipalDrafts","principalSaving","setPrincipalSaving","queueLoading","setQueueLoading","queueFilters","setQueueFilters","status","academicYear","region","countryId","queueSort","setQueueSort","dir","reviewModal","setReviewModal","reviewNote","setReviewNote","reviewIncludedYears","setReviewIncludedYears","y1","y2","y3","reviewRevisionSelection","setReviewRevisionSelection","initial","selectAllRevisionWork","useCallback","next","clearRevisionWork","reviewSaving","setReviewSaving","rollupYear","setRollupYear","rollupData","setRollupData","rollupLoading","setRollupLoading","rollupExportOpen","setRollupExportOpen","rollupExportRef","useRef","expandedRegions","setExpandedRegions","expandedCountries","setExpandedCountries","document","title","setHeaderMeta","subtitle","_outlet$clearHeaderMe","clearHeaderMeta","call","queueFiltersRef","current","selectedUser","find","u","String","selectedCountry","c","selectedSchoolsCountry","Array","isArray","school","list","api","adminGetSchoolPrincipals","prev","_objectSpread","ids","map","e","console","error","userId","country_id","Promise","all","adminGetPermissionsCatalog","adminGetUserPermissions","adminListCountrySchools","resolve","then","_ref","catalogData","userPerms","schoolsData","schoolsList","items","sel","scopeMap","p","concat","resource","action","scope_school_id","catch","toast","message","finally","progressCatalogInputs","discounts","name","ratio","progressCatalog","buildProgressCatalog","inputs","norm","progressConfigNormalized","isSameCountry","currentAssignmentLabel","country_name","country_code","newAssignmentLabel","code","actionLabel","filteredUsers","filter","regionOptions","set","add","from","sort","permissionsGrouped","reduce","acc","perm","grp","group","push","queueCountryOptions","toggleQueueSort","cycles","academic_year","school_name","scenario_name","submitted_at","cycle","i","indexOf","sortIndicator","ariaSort","sortedQueueRows","getValue","row","_row$country","_row$school","_row$scenario","_row$scenario2","_row$scenario3","_row$scenario4","country","scenario","raw","trim","nums","match","a","b","toLowerCase","parseAcademicYear","Infinity","dirMul","cmpStr","localeCompare","sensitivity","decorated","idx","val","A","B","av","bv","_av$a","_bv$a","_av$b","_bv$b","progressSearchValue","filteredCountriesForApply","q","includes","progressTargetCount","size","progressBulkDisabled","filteredCountrySchools","s","schoolCreateBusy","bulkCreateCount","count","load","async","countriesRows","userData","listCountries","listUsers","limit","offset","fields","order","loadCountrySchools","countryIdArg","rows","includeClosed","loadProgressRequirements","data","adminGetProgressRequirements","loadQueue","f","filtersArg","params","adminGetScenarioQueue","loadRollup","academicYearArg","adminGetRollup","adminResetUserPassword","token","k","_window","_window$localStorage","window","_unused","getAuthTokenFromStorage","res","fetch","method","headers","Authorization","body","JSON","stringify","json","_unused2","ok","_data","_data2","msg","details","Error","_auth$user","user","role","_auth$user3","handleClick","event","el","contains","target","handleKey","addEventListener","removeEventListener","regions","regionSet","countrySet","updateProgressSection","sectionId","updater","_next$sections","structuredClone","section","openReviewModal","closeReviewModal","reset","renderQueueKpis","kpi","_jsx","className","children","margin","net_ciro","net_result","_jsxs","renderYearCell","year","net_income","total_expenses","profitMargin","students_total","handleRefresh","style","fontWeight","marginTop","Link","to","rollupExportDisabled","refreshDisabled","renderRefreshButton","onClick","disabled","_Fragment","headerPortalEl","createPortal","justifyContent","fontSize","ToastContainer","position","autoClose","newestOnTop","closeOnClick","pauseOnFocusLoss","pauseOnHover","width","padding","textAlign","height","borderRadius","border","borderTopColor","animation","marginBottom","email","currentLabel","nextLabel","assignUserCountry","nextId","success","hadCountry","confirmAssignCountry","deleteUser","confirmDeleteUser","Boolean","full_name","temporary_password","confirmResetPassword","maxWidth","background","alignItems","fontFamily","text","navigator","clipboard","writeText","_unused3","ta","createElement","left","appendChild","select","execCommand","removeChild","_unused4","copyText","display","gap","type","checked","onChange","toUpperCase","flexWrap","minHeight","_reviewModal$row","_reviewModal$row$scen","note","payload","includedYears","revisionWorkIds","adminReviewScenario","gridTemplateColumns","placeholder","fullName","password","createUser","FaUserPlus","color","marginRight","adminUpdateUserRole","updateSelectedUserRole","opt","entries","_ref2","groupName","perms","isSelected","scopeValue","flexGrow","togglePermission","changePermissionScope","split","scopeVal","scope_country_id","startsWith","idStr","sid","adminSetUserPermissions","permissions","updated","colSpan","must_reset_password","resetPasswordForUser","createCountry","adminCreateCountrySchool","FaSchool","paddingTop","borderTop","updateSchoolCreateRow","index","removeSchoolCreateRow","rawNames","names","errors","created","err","_ref3","_schoolNameDrafts$sch","statusMeta","draftName","isSaving","created_at","closed_at","join","draft","nextName","adminUpdateSchool","saveSchoolName","nextStatus","toggleSchoolStatus","multiple","values","selectedOptions","o","schoolId","valueIds","handlePrincipalSelectionChange","userIds","adminSetSchoolPrincipals","newList","savePrincipalAssignments","saved","adminSaveProgressRequirements","selectAllTargets","clearTargets","uniqueIds","confirm","result","adminBulkSaveProgressRequirements","updatedCount","maxHeight","overflowY","has","delete","toggleTargetCountry","tabs","tabSections","tabKey","visibleSections","sectionMatch","fieldMatch","fieldsById","tabExpanded","toggleProgressTab","_progressConfigNormal","sectionConfig","sectionEnabled","sectionMode","modeDefault","sectionMin","minDefault","allFields","filteredFields","field","sectionExpanded","fieldIdsForBulk","selectedCount","_sectionConfig$select","totalCount","showOnlySelected","visibleFields","_sectionConfig$select2","minValue","minTooHigh","ruleSummary","requiredCount","toggleProgressSection","setProgressSectionEnabled","setProgressSectionMode","setProgressSectionMin","num","Math","max","selectAllSectionFields","fieldIds","unselectAllSectionFields","_sectionConfig$select3","dynamicHint","getDynamicHint","setProgressFieldSelected","fieldId","lineHeight","whiteSpace","r","cursor","font","_row$scenario5","_row$scenario6","_row$scenario7","_row$missingKpis","_row$missingKpis2","_row$missingKpis3","_row$scenario8","_row$scenario9","_row$scenario0","_row$scenario1","_row$school2","_row$scenario10","_row$country2","_row$country3","_row$school3","_row$scenario11","_row$scenario12","_row$scenario13","_row$kpis","_row$kpis2","_row$kpis3","scenarioOrStatus","obj","sentAt","sent_at","getStatusMeta","canApprove","canRevise","missing","missingKpis","progressPct","progress_pct","round","progressMissingCount","progress_missing_count","progressMissingPreview","progress_missing_preview","progressTooltipLines","Tooltip","lines","kpis","ref","_rollupData$totals","_rollupData$totals$ke","_rollupData$totals2","_rollupData$totals2$k","_rollupData$totals3","_rollupData$totals3$k","_rollupData$totals4","_rollupData$totals4$k","_rollupData$totals5","_rollupData$totals5$k","_rollupData$totals6","_rollupData$totals6$k","totals","minWidth","_region$years","_region$years2","_region$years3","_region$countries","regionKey","regionExpanded","React","toggleRegion","years","_country$years","_country$years2","_country$years3","_country$schools","countryKey","countryExpanded","toggleCountry","schools","_school$included_year","_school$years","_school$years2","_school$years3","included_years","missingNoApproved","scenario_id","school_id","missingYears"],"ignoreList":[],"sourceRoot":""}