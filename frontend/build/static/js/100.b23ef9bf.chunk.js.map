{"version":3,"file":"static/js/100.b23ef9bf.chunk.js","mappings":"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","sources":["components/ui/Tooltip.jsx","utils/kademe.js","components/ui/ProgressBar.jsx","components/ExpenseSplitModal.jsx","pages/SelectPage.jsx","utils/programType.js"],"sourcesContent":["import React from \"react\";\n\nfunction normalizeLines(lines, text) {\n  if (Array.isArray(lines)) {\n    return lines.map((line) => String(line)).filter((line) => line.trim().length > 0);\n  }\n  if (typeof text === \"string\") {\n    return text\n      .split(\"\\n\")\n      .map((line) => line.trim())\n      .filter(Boolean);\n  }\n  return [];\n}\n\nexport default function Tooltip({ text, lines, children, className = \"\" }) {\n  const resolved = normalizeLines(lines, text);\n  if (!resolved.length) return children;\n\n  return (\n    <span className={`tooltip-wrap ${className}`.trim()}>\n      {children}\n      <span className=\"tooltip-bubble\" role=\"tooltip\">\n        {resolved.map((line, idx) => (\n          <div key={`${idx}-${line}`} className=\"tooltip-line\">\n            {line}\n          </div>\n        ))}\n      </span>\n    </span>\n  );\n}\n","const GRADES = [\"KG\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"];\n\nconst KADEME_DEFS = [\n  { key: \"okulOncesi\", label: \"Okul ncesi\", defaultFrom: \"KG\", defaultTo: \"KG\" },\n  { key: \"ilkokul\", label: \"lkokul\", defaultFrom: \"1\", defaultTo: \"5\" },\n  { key: \"ortaokul\", label: \"Ortaokul\", defaultFrom: \"6\", defaultTo: \"9\" },\n  { key: \"lise\", label: \"Lise\", defaultFrom: \"10\", defaultTo: \"12\" },\n];\n\nfunction normalizeGrade(value) {\n  const v = String(value || \"\").trim().toUpperCase();\n  if (v === \"KG\") return \"KG\";\n  if (!/^\\d{1,2}$/.test(v)) return null;\n  const n = Number(v);\n  if (!Number.isFinite(n) || n < 1 || n > 12) return null;\n  return String(n);\n}\n\nfunction gradeIndex(value) {\n  const g = normalizeGrade(value);\n  if (!g) return -1;\n  return GRADES.indexOf(g);\n}\n\nfunction normalizeRange(fromValue, toValue, def) {\n  const from = normalizeGrade(fromValue) ?? def.defaultFrom;\n  const to = normalizeGrade(toValue) ?? def.defaultTo;\n  const fromIdx = gradeIndex(from);\n  const toIdx = gradeIndex(to);\n  if (fromIdx < 0 || toIdx < 0) return { from: def.defaultFrom, to: def.defaultTo };\n  if (fromIdx <= toIdx) return { from, to };\n  return { from: to, to: from };\n}\n\nexport function getKademeDefinitions() {\n  return KADEME_DEFS.map((d) => ({ ...d }));\n}\n\nexport function getDefaultKademeConfig() {\n  const out = {};\n  KADEME_DEFS.forEach((d) => {\n    out[d.key] = { enabled: true, from: d.defaultFrom, to: d.defaultTo };\n  });\n  return out;\n}\n\nexport function normalizeKademeConfig(config) {\n  const cfg = config && typeof config === \"object\" ? config : {};\n  const out = {};\n  KADEME_DEFS.forEach((d) => {\n    const row = cfg[d.key] && typeof cfg[d.key] === \"object\" ? cfg[d.key] : {};\n    const enabled = row.enabled !== false;\n    const range = normalizeRange(row.from, row.to, d);\n    out[d.key] = { enabled, ...range };\n  });\n  return out;\n}\n\nexport function getKademeRangeLabel(config, key) {\n  const def = KADEME_DEFS.find((d) => d.key === key);\n  if (!def) return \"\";\n  const cfg = normalizeKademeConfig(config)[key];\n  if (!cfg?.enabled) return \"\";\n  return cfg.from === cfg.to ? cfg.from : `${cfg.from}-${cfg.to}`;\n}\n\nexport function formatKademeLabel(label, config, key) {\n  const range = getKademeRangeLabel(config, key);\n  if (!range) return label;\n  return `${label} (${range})`;\n}\n\nexport function getKademeForGrade(grade, config) {\n  const idx = gradeIndex(grade);\n  if (idx < 0) return null;\n  const cfg = normalizeKademeConfig(config);\n  for (const def of KADEME_DEFS) {\n    const row = cfg[def.key];\n    if (!row?.enabled) continue;\n    const fromIdx = gradeIndex(row.from);\n    const toIdx = gradeIndex(row.to);\n    if (fromIdx <= idx && idx <= toIdx) return def.key;\n  }\n  return null;\n}\n\nexport function summarizeGradesByKademe(grades, config) {\n  const rows = Array.isArray(grades) ? grades : [];\n  const out = { okulOncesi: 0, ilkokul: 0, ortaokul: 0, lise: 0, total: 0 };\n\n  for (const r of rows) {\n    // studentsPerBranch now represents TOTAL students for the grade (not per-branch).\n    const students = Number(r?.studentsPerBranch || 0);\n    if (!Number.isFinite(students)) continue;\n    out.total += students;\n    const key = getKademeForGrade(r?.grade, config);\n    if (key && Object.prototype.hasOwnProperty.call(out, key)) out[key] += students;\n  }\n\n  return out;\n}\n\nexport function getGradeOptions() {\n  return GRADES.map((g) => g);\n}\n","import React from \"react\";\nimport Tooltip from \"./Tooltip\";\n\nfunction normalizeLines(lines) {\n  if (!lines) return [];\n  if (Array.isArray(lines)) return lines.map((line) => String(line));\n  if (typeof lines === \"string\") return lines.split(\"\\n\");\n  return [];\n}\n\nexport default function ProgressBar({ value = 0, label = \"\", tooltipLines }) {\n  const numeric = Number(value);\n  const pct = Number.isFinite(numeric) ? Math.max(0, Math.min(100, numeric)) : 0;\n  const lines = normalizeLines(tooltipLines).filter((line) => String(line).trim().length > 0);\n\n  const track = (\n    <div className=\"progress-track\">\n      <div className=\"progress-bar\" role=\"progressbar\" aria-valuenow={pct} aria-valuemin={0} aria-valuemax={100}>\n        <div className=\"progress-bar-fill\" style={{ width: `${pct}%` }} />\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"progress-row\">\n      {label ? <div className=\"progress-label\">{label}</div> : null}\n      {lines.length ? (\n        <Tooltip lines={lines} className=\"progress-tooltip\">\n          {track}\n        </Tooltip>\n      ) : (\n        track\n      )}\n      <div className=\"progress-value\">{Math.round(pct)}%</div>\n    </div>\n  );\n}\n","// frontend/src/components/ExpenseSplitModal.jsx\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport { api } from \"../api\";\r\n\r\nconst OPERATING_ITEMS = [\r\n  { key: \"ulkeTemsilciligi\", label: \"lke Temsilciligi Giderleri\" },\r\n  { key: \"genelYonetim\", label: \"Genel Ynetim Giderleri\" },\r\n  { key: \"kira\", label: \"Isletme Giderleri (Kira)\" },\r\n  { key: \"emsalKira\", label: \"Isletme Giderleri (Emsal Kira)\" },\r\n  { key: \"enerjiKantin\", label: \"Isletme Giderleri (Elektrik, Su, vb.)\" },\r\n  { key: \"turkPersonelMaas\", label: \"Yurt disi TRK Personel Maas Giderleri\" },\r\n  { key: \"turkDestekPersonelMaas\", label: \"Yurt disi TRK DESTEK Personel Maas Giderleri\" },\r\n  { key: \"yerelPersonelMaas\", label: \"Yurt disi YEREL Personel Maas Giderleri\" },\r\n  { key: \"yerelDestekPersonelMaas\", label: \"Yurt disi YEREL DESTEK Personel Maas Giderleri\" },\r\n  { key: \"internationalPersonelMaas\", label: \"Yurt disi INTERNATIONAL Personel Maas Giderleri\" },\r\n  { key: \"disaridanHizmet\", label: \"Disaridan Saglanan Mal ve Hizmet Alimlari\" },\r\n  { key: \"egitimAracGerec\", label: \"Egitim Ara ve Gereleri\" },\r\n  { key: \"finansalGiderler\", label: \"Finansal Giderler\" },\r\n  { key: \"egitimAmacliHizmet\", label: \"Egitim Amali Hizmet Alimlari\" },\r\n  { key: \"temsilAgirlama\", label: \"Temsil ve Agirlama\" },\r\n  { key: \"ulkeIciUlasim\", label: \"lke Ii Ulasim ve Konaklama\" },\r\n  { key: \"ulkeDisiUlasim\", label: \"lke Disi Ulasim ve Konaklama\" },\r\n  { key: \"vergilerResmiIslemler\", label: \"Vergiler Resmi Islemler\" },\r\n  { key: \"vergiler\", label: \"Vergiler\" },\r\n  { key: \"demirbasYatirim\", label: \"Demirbas ve Yatirimlar\" },\r\n  { key: \"rutinBakim\", label: \"Rutin Bakim ve Onarim\" },\r\n  { key: \"pazarlamaOrganizasyon\", label: \"Pazarlama Organizasyon\" },\r\n  { key: \"reklamTanitim\", label: \"Reklam ve Tanitim\" },\r\n  { key: \"tahsilEdilemeyenGelirler\", label: \"Tahsil Edilemeyen Gelirler\" },\r\n];\r\n\r\nconst SERVICE_ITEMS = [\r\n  { key: \"yemek\", label: \"Yemek\" },\r\n  { key: \"uniforma\", label: \"niforma\" },\r\n  { key: \"kitapKirtasiye\", label: \"Kitap-Krtasiye\" },\r\n  { key: \"ulasimServis\", label: \"Servis / Ulam\" },\r\n];\r\n\r\nconst DORM_ITEMS = [\r\n  { key: \"yurtGiderleri\", label: \"Yurt Giderleri (Kampus giderleri iinde gsterilmeyecek)\" },\r\n  { key: \"digerYurt\", label: \"Dier (Yaz okulu giderleri vb.)\" },\r\n];\r\n\r\nconst DISCOUNT_ITEMS = [\r\n  { key: \"discountsTotal\", label: \"Burs ve ndirimler (Toplam)\" },\r\n];\r\n\r\nconst EXPENSE_ITEMS = [...OPERATING_ITEMS, ...SERVICE_ITEMS, ...DORM_ITEMS, ...DISCOUNT_ITEMS];\r\nconst EXPENSE_KEYS = EXPENSE_ITEMS.map((it) => it.key);\r\nconst EXPENSE_ITEM_MAP = new Map(EXPENSE_ITEMS.map((it) => [it.key, it]));\r\nconst EXPENSE_LABELS = new Map(EXPENSE_ITEMS.map((it) => [it.key, it.label]));\r\n\r\nconst EXPENSE_SECTIONS = [\r\n  {\r\n    id: \"isletme\",\r\n    label: \"letme Giderleri\",\r\n    groups: [\r\n      {\r\n        label: \"letme Giderleri\",\r\n        keys: [\r\n          \"ulkeTemsilciligi\",\r\n          \"genelYonetim\",\r\n          \"temsilAgirlama\",\r\n          \"ulkeIciUlasim\",\r\n          \"ulkeDisiUlasim\",\r\n          \"vergilerResmiIslemler\",\r\n          \"vergiler\",\r\n          \"demirbasYatirim\",\r\n          \"rutinBakim\",\r\n          \"pazarlamaOrganizasyon\",\r\n          \"reklamTanitim\",\r\n          \"tahsilEdilemeyenGelirler\",\r\n        ],\r\n      },\r\n      {\r\n        label: \"Eitim Maliyetleri\",\r\n        keys: [\r\n          \"kira\",\r\n          \"emsalKira\",\r\n          \"enerjiKantin\",\r\n          \"turkPersonelMaas\",\r\n          \"turkDestekPersonelMaas\",\r\n          \"yerelPersonelMaas\",\r\n          \"yerelDestekPersonelMaas\",\r\n          \"internationalPersonelMaas\",\r\n          \"disaridanHizmet\",\r\n          \"egitimAracGerec\",\r\n          \"finansalGiderler\",\r\n          \"egitimAmacliHizmet\",\r\n        ],\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"ogrenimDisi\",\r\n    label: \"renim D Hizmetler\",\r\n    keys: [\"yemek\", \"uniforma\", \"kitapKirtasiye\", \"ulasimServis\"],\r\n  },\r\n  {\r\n    id: \"yurtKonaklama\",\r\n    label: \"Yurt / Konaklama\",\r\n    keys: [\"yurtGiderleri\", \"digerYurt\"],\r\n  },\r\n  {\r\n    id: \"bursIndirim\",\r\n    label: \"Burs ve ndirimler\",\r\n    keys: [\"discountsTotal\"],\r\n  },\r\n].map((section) => {\r\n  if (Array.isArray(section.groups)) {\r\n    const groups = section.groups.filter((group) => group.keys.length);\r\n    const keys = groups.flatMap((group) => group.keys);\r\n    return { ...section, groups, keys };\r\n  }\r\n  return {\r\n    ...section,\r\n    keys: section.keys,\r\n  };\r\n}).filter((section) => section.keys.length);\r\n\r\nconst fmtNum = (v, fractionDigits = 2) =>\r\n  Number.isFinite(Number(v))\r\n    ? Number(v).toLocaleString(undefined, { maximumFractionDigits: fractionDigits })\r\n    : \"-\";\r\n\r\nconst fmtPct = (v) =>\r\n  Number.isFinite(Number(v)) ? `${(Number(v) * 100).toFixed(2)}%` : \"-\";\r\n\r\nexport default function ExpenseSplitModal({ open, onClose, sourceScenario, sourceSchoolId }) {\r\n  const [targets, setTargets] = useState([]);\r\n  const [loadingTargets, setLoadingTargets] = useState(false);\r\n  const [targetSearch, setTargetSearch] = useState(\"\");\r\n  const [selectedTargets, setSelectedTargets] = useState(new Set());\r\n  const [basis, setBasis] = useState(\"students\");\r\n  const [basisYearKey, setBasisYearKey] = useState(\"y1\");\r\n  const [selectedExpenseKeys, setSelectedExpenseKeys] = useState(new Set());\r\n  const [preview, setPreview] = useState(null);\r\n  const [previewLoading, setPreviewLoading] = useState(false);\r\n  const [applyLoading, setApplyLoading] = useState(false);\r\n  const compactControlStyle = {\r\n    fontSize: 12,\r\n    height: 30,\r\n    padding: \"4px 8px\",\r\n    lineHeight: \"20px\",\r\n    boxSizing: \"border-box\",\r\n  };\r\n\r\n  const selectedTargetsKey = useMemo(\r\n    () => Array.from(selectedTargets).sort().join(\",\"),\r\n    [selectedTargets]\r\n  );\r\n  const selectedExpenseKeyStr = useMemo(\r\n    () => Array.from(selectedExpenseKeys).sort().join(\",\"),\r\n    [selectedExpenseKeys]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!open) return;\r\n    setTargetSearch(\"\");\r\n    setSelectedTargets(new Set());\r\n    setSelectedExpenseKeys(new Set());\r\n    setBasis(\"students\");\r\n    setBasisYearKey(\"y1\");\r\n    setPreview(null);\r\n  }, [open, sourceScenario?.id]);\r\n\r\n  useEffect(() => {\r\n    setPreview(null);\r\n  }, [basis, basisYearKey, selectedTargetsKey, selectedExpenseKeyStr]);\r\n\r\n  useEffect(() => {\r\n    let active = true;\r\n    async function loadTargets() {\r\n      if (!open || !sourceScenario?.academic_year) return;\r\n      setLoadingTargets(true);\r\n      try {\r\n        const data = await api.expenseSplitTargets(sourceScenario.academic_year);\r\n        if (!active) return;\r\n        const list = Array.isArray(data) ? data : [];\r\n        const filtered = list.filter(\r\n          (row) => String(row.scenarioId) !== String(sourceScenario?.id)\r\n        );\r\n        setTargets(filtered);\r\n      } catch (e) {\r\n        if (active) {\r\n          toast.error(e.message || \"Hedef senaryolar alinamadi\");\r\n        }\r\n      } finally {\r\n        if (active) setLoadingTargets(false);\r\n      }\r\n    }\r\n    loadTargets();\r\n    return () => {\r\n      active = false;\r\n    };\r\n  }, [open, sourceScenario?.academic_year, sourceScenario?.id]);\r\n\r\n  const filteredTargets = useMemo(() => {\r\n    const term = targetSearch.trim().toLowerCase();\r\n    if (!term) return targets;\r\n    return targets.filter((row) => {\r\n      const schoolName = String(row?.schoolName || \"\").toLowerCase();\r\n      const scenarioName = String(row?.scenarioName || \"\").toLowerCase();\r\n      return schoolName.includes(term) || scenarioName.includes(term);\r\n    });\r\n  }, [targets, targetSearch]);\r\n\r\n  const toggleTarget = (id) => {\r\n    setSelectedTargets((prev) => {\r\n      const next = new Set(prev);\r\n      const key = String(id);\r\n      if (next.has(key)) next.delete(key);\r\n      else next.add(key);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const toggleExpenseKey = (key) => {\r\n    setSelectedExpenseKeys((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(key)) next.delete(key);\r\n      else next.add(key);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const setExpenseKeys = (keys, checked) => {\r\n    if (!Array.isArray(keys) || !keys.length) return;\r\n    setSelectedExpenseKeys((prev) => {\r\n      const next = new Set(prev);\r\n      keys.forEach((key) => {\r\n        if (checked) next.add(key);\r\n        else next.delete(key);\r\n      });\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const handlePreview = async () => {\r\n    if (!sourceScenario?.id || !sourceSchoolId) return;\r\n    const payload = {\r\n      targetScenarioIds: Array.from(selectedTargets).map((id) => Number(id)),\r\n      basis,\r\n      basisYearKey,\r\n      expenseKeys: Array.from(selectedExpenseKeys),\r\n    };\r\n    setPreviewLoading(true);\r\n    try {\r\n      const data = await api.previewExpenseSplit(sourceSchoolId, sourceScenario.id, payload);\r\n      setPreview(data || null);\r\n    } catch (e) {\r\n      toast.error(e.message || \"nizleme alinamadi\");\r\n    } finally {\r\n      setPreviewLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleApply = async () => {\r\n    if (!sourceScenario?.id || !sourceSchoolId) return;\r\n    const payload = {\r\n      targetScenarioIds: Array.from(selectedTargets).map((id) => Number(id)),\r\n      basis,\r\n      basisYearKey,\r\n      expenseKeys: Array.from(selectedExpenseKeys),\r\n    };\r\n    setApplyLoading(true);\r\n    try {\r\n      await api.applyExpenseSplit(sourceSchoolId, sourceScenario.id, payload);\r\n      toast.success(\"Gider dagitimi kaydedildi.\");\r\n      onClose?.();\r\n    } catch (e) {\r\n      toast.error(e.message || \"Dagitim uygulanamadi\");\r\n    } finally {\r\n      setApplyLoading(false);\r\n    }\r\n  };\r\n\r\n  const previewTargets = useMemo(\r\n    () => (Array.isArray(preview?.targets) ? preview.targets : []),\r\n    [preview]\r\n  );\r\n  const previewPools = useMemo(\r\n    () => (Array.isArray(preview?.pools) ? preview.pools : []),\r\n    [preview]\r\n  );\r\n  const previewAllocations = useMemo(\r\n    () => (Array.isArray(preview?.allocations) ? preview.allocations : []),\r\n    [preview]\r\n  );\r\n  const previewWarnings = useMemo(\r\n    () => (Array.isArray(preview?.warnings) ? preview.warnings : []),\r\n    [preview]\r\n  );\r\n\r\n  const targetById = useMemo(() => {\r\n    const m = new Map();\r\n    previewTargets.forEach((t) => m.set(String(t.targetScenarioId), t));\r\n    return m;\r\n  }, [previewTargets]);\r\n\r\n  const allocationRows = useMemo(() => {\r\n    return previewAllocations.map((row) => {\r\n      const target = targetById.get(String(row.targetScenarioId));\r\n      return {\r\n        targetLabel: target\r\n          ? `${target.schoolName || \"\"}  ${target.scenarioName || \"\"}`\r\n          : String(row.targetScenarioId),\r\n        expenseLabel: EXPENSE_LABELS.get(row.expenseKey) || row.expenseKey,\r\n        amount: row.allocatedAmount,\r\n      };\r\n    });\r\n  }, [previewAllocations, targetById]);\r\n\r\n  const totalExpenseCount = EXPENSE_KEYS.length;\r\n  const selectedExpenseCount = selectedExpenseKeys.size;\r\n  const allExpensesSelected = totalExpenseCount > 0 && selectedExpenseCount === totalExpenseCount;\r\n  const someExpensesSelected = selectedExpenseCount > 0 && !allExpensesSelected;\r\n\r\n  const previewDisabled =\r\n    !selectedTargets.size || !selectedExpenseKeys.size || previewLoading || applyLoading;\r\n\r\n  const isletmeSection = EXPENSE_SECTIONS.find((s) => s.id === \"isletme\") || null;\r\n  const otherSections = EXPENSE_SECTIONS.filter((s) => s.id !== \"isletme\");\r\n\r\n  const renderSectionCard = (section) => {\r\n    if (!section) return null;\r\n    const total = section.keys.length;\r\n    const selected = section.keys.reduce(\r\n      (sum, key) => sum + (selectedExpenseKeys.has(key) ? 1 : 0),\r\n      0\r\n    );\r\n    const allSelected = total > 0 && selected === total;\r\n    const someSelected = selected > 0 && !allSelected;\r\n\r\n    return (\r\n      <div\r\n        key={section.id}\r\n        className=\"card\"\r\n        style={{ padding: \"10px 12px\", background: \"#f8fafc\" }}\r\n      >\r\n        <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n          <label className=\"row small\" style={{ gap: 6, alignItems: \"center\", fontWeight: 700 }}>\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={allSelected}\r\n              ref={(el) => {\r\n                if (el) el.indeterminate = someSelected;\r\n              }}\r\n              onChange={(e) => setExpenseKeys(section.keys, e.target.checked)}\r\n            />\r\n            <span>{section.label}</span>\r\n          </label>\r\n          <div className=\"row\" style={{ gap: 6 }}>\r\n            <button\r\n              className=\"btn\"\r\n              type=\"button\"\r\n              style={{ padding: \"4px 10px\" }}\r\n              onClick={() => setExpenseKeys(section.keys, true)}\r\n              disabled={!total}\r\n            >\r\n              Sec\r\n            </button>\r\n            <button\r\n              className=\"btn\"\r\n              type=\"button\"\r\n              style={{ padding: \"4px 10px\" }}\r\n              onClick={() => setExpenseKeys(section.keys, false)}\r\n              disabled={!selected}\r\n            >\r\n              Temizle\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div className=\"small muted\" style={{ marginTop: 4 }}>\r\n          Secili: {selected}/{total}\r\n        </div>\r\n        {Array.isArray(section.groups) ? (\r\n          <div style={{ marginTop: 8 }}>\r\n            {section.groups.map((group) => (\r\n              <div key={group.label} style={{ marginTop: 8 }}>\r\n                <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>\r\n                  {group.label}\r\n                </div>\r\n                <div className=\"grid2\" style={{ gap: 8 }}>\r\n                  {group.keys.map((key) => {\r\n                    const item = EXPENSE_ITEM_MAP.get(key);\r\n                    const label = item?.label || key;\r\n                    return (\r\n                      <label key={key} className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedExpenseKeys.has(key)}\r\n                          onChange={() => toggleExpenseKey(key)}\r\n                        />\r\n                        <span className=\"small\">{label}</span>\r\n                      </label>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid2\" style={{ gap: 8, marginTop: 8 }}>\r\n            {section.keys.map((key) => {\r\n              const item = EXPENSE_ITEM_MAP.get(key);\r\n              const label = item?.label || key;\r\n              return (\r\n                <label key={key} className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={selectedExpenseKeys.has(key)}\r\n                    onChange={() => toggleExpenseKey(key)}\r\n                  />\r\n                  <span className=\"small\">{label}</span>\r\n                </label>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (!open) return null;\r\n\r\n  return (\r\n    <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\" onClick={onClose}>\r\n      <div\r\n        className=\"modal\"\r\n        style={{ width: \"min(980px, 96vw)\", maxHeight: \"86vh\", overflowY: \"auto\", position: \"relative\" }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n          <button\r\n            className=\"btn\"\r\n            onClick={onClose}\r\n            disabled={applyLoading || previewLoading}\r\n            style={{\r\n              position: \"absolute\",\r\n              top: 10,\r\n              right: 10,\r\n              background: \"#111827\",\r\n              borderColor: \"#111827\",\r\n              color: \"#fff\",\r\n            }}\r\n          >\r\n            Kapat\r\n          </button>\r\n        </div>\r\n\r\n        {!sourceScenario ? (\r\n          <div className=\"small\" style={{ marginTop: 10 }}>\r\n            Kaynak senaryo seilmedi.\r\n          </div>\r\n        ) : (\r\n          <>\r\n            <div style={{ marginTop: 2 }}>\r\n              <div className=\"row\" style={{ gap: 12, alignItems: \"flex-end\", flexWrap: \"wrap\" }}>\r\n                <div style={{ minWidth: 170 }}>\r\n                  <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Basis</div>\r\n                  <select className=\"input sm\" style={compactControlStyle} value={basis} onChange={(e) => setBasis(e.target.value)}>\r\n                    <option value=\"students\">Students</option>\r\n                    <option value=\"revenue\">Revenue</option>\r\n                  </select>\r\n                </div>\r\n                <div style={{ minWidth: 160 }}>\r\n                  <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Basis Yil</div>\r\n                  <select className=\"input sm\" style={compactControlStyle} value={basisYearKey} onChange={(e) => setBasisYearKey(e.target.value)}>\r\n                    <option value=\"y1\">Y1</option>\r\n                    <option value=\"y2\">Y2</option>\r\n                    <option value=\"y3\">Y3</option>\r\n                  </select>\r\n                </div>\r\n                <div style={{ flex: \"1 1 220px\" }}>\r\n                  <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Hedef Ara</div>\r\n                  <input\r\n                    className=\"input sm\"\r\n                    style={compactControlStyle}\r\n                    placeholder=\"Okul veya senaryo ara\"\r\n                    value={targetSearch}\r\n                    onChange={(e) => setTargetSearch(e.target.value)}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ marginTop: 5 }}>\r\n              <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Hedef Senaryolar</div>\r\n              {loadingTargets ? (\r\n                <div className=\"small\">Ykleniyor...</div>\r\n              ) : (\r\n                <div className=\"table-scroll\" style={{ maxHeight: 260 }}>\r\n                  <table className=\"table\" style={{ fontSize: 12 }}>\r\n                    <thead>\r\n                      <tr>\r\n                        <th style={{ width: 40 }}></th>\r\n                        <th style={{ fontSize: 12, padding: \"6px 8px\" }}>Okul</th>\r\n                        <th style={{ fontSize: 12, padding: \"6px 8px\" }}>Senaryo</th>\r\n                        <th style={{ fontSize: 12, padding: \"6px 8px\" }}>Yil</th>\r\n                        <th style={{ fontSize: 12, padding: \"6px 8px\" }}>Para Birimi</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {filteredTargets.length === 0 ? (\r\n                        <tr>\r\n                          <td colSpan=\"5\" className=\"small\" style={{ padding: \"6px 8px\" }}>Hedef bulunamadi.</td>\r\n                        </tr>\r\n                      ) : (\r\n                        filteredTargets.map((row) => {\r\n                          const id = String(row.scenarioId);\r\n                          const checked = selectedTargets.has(id);\r\n                          const currencyLabel =\r\n                            String(row.input_currency || \"USD\") === \"LOCAL\"\r\n                              ? `${row.input_currency}/${row.local_currency_code || \"LOCAL\"}`\r\n                              : row.input_currency || \"USD\";\r\n                          return (\r\n                            <tr key={row.scenarioId}>\r\n                              <td style={{ padding: \"6px 8px\" }}>\r\n                                <input\r\n                                  type=\"checkbox\"\r\n                                  checked={checked}\r\n                                  onChange={() => toggleTarget(id)}\r\n                                />\r\n                              </td>\r\n                              <td style={{ padding: \"6px 8px\" }}>{row.schoolName}</td>\r\n                              <td style={{ padding: \"6px 8px\" }}>{row.scenarioName}</td>\r\n                              <td style={{ padding: \"6px 8px\" }}>{row.academic_year}</td>\r\n                              <td style={{ padding: \"6px 8px\" }}>{currencyLabel}</td>\r\n                            </tr>\r\n                          );\r\n                        })\r\n                      )}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div style={{ marginTop: 16 }}>\r\n              <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n                <div className=\"small\" style={{ fontWeight: 700 }}>Gider Kalemleri</div>\r\n                <div className=\"row\" style={{ gap: 6 }}>\r\n                  <button\r\n                    className=\"btn\"\r\n                    type=\"button\"\r\n                    style={{ padding: \"4px 10px\" }}\r\n                    onClick={() => setExpenseKeys(EXPENSE_KEYS, true)}\r\n                    disabled={!totalExpenseCount}\r\n                  >\r\n                    Tumunu Sec\r\n                  </button>\r\n                  <button\r\n                    className=\"btn\"\r\n                    type=\"button\"\r\n                    style={{ padding: \"4px 10px\" }}\r\n                    onClick={() => setExpenseKeys(EXPENSE_KEYS, false)}\r\n                    disabled={!selectedExpenseCount}\r\n                  >\r\n                    Temizle\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div className=\"row\" style={{ gap: 10, alignItems: \"center\", marginTop: 8 }}>\r\n                <label className=\"row small\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={allExpensesSelected}\r\n                    ref={(el) => {\r\n                      if (el) el.indeterminate = someExpensesSelected;\r\n                    }}\r\n                    onChange={(e) => setExpenseKeys(EXPENSE_KEYS, e.target.checked)}\r\n                  />\r\n                  <span>Toplam Secili: {selectedExpenseCount}/{totalExpenseCount}</span>\r\n                </label>\r\n              </div>\r\n\r\n              <div className=\"row\" style={{ alignItems: \"flex-start\", gap: 12, marginTop: 10 }}>\r\n                <div style={{ flex: \"1 1 0\", minWidth: 320 }}>\r\n                  {renderSectionCard(isletmeSection)}\r\n                </div>\r\n                <div style={{ flex: \"1 1 0\", minWidth: 320, display: \"grid\", gap: 12 }}>\r\n                  {otherSections.map((section) => renderSectionCard(section))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"row\" style={{ justifyContent: \"flex-end\", marginTop: 16, gap: 8 }}>\r\n              <button className=\"btn\" onClick={handlePreview} disabled={previewDisabled}>\r\n                {previewLoading ? \"nizleme...\" : \"nizle\"}\r\n              </button>\r\n              <button\r\n                className=\"btn primary\"\r\n                onClick={handleApply}\r\n                disabled={\r\n                  applyLoading ||\r\n                  previewLoading ||\r\n                  !selectedTargets.size ||\r\n                  !selectedExpenseKeys.size\r\n                }\r\n              >\r\n                {applyLoading ? \"Uygulaniyor...\" : \"Uygula\"}\r\n              </button>\r\n            </div>\r\n\r\n            {previewWarnings.length > 0 ? (\r\n              <div className=\"card\" style={{ marginTop: 12, background: \"#fff7ed\", borderColor: \"#fed7aa\" }}>\r\n                <div style={{ fontWeight: 700, marginBottom: 6 }}>Uyarilar</div>\r\n                {previewWarnings.map((w, idx) => (\r\n                  <div key={idx} className=\"small\"> {w}</div>\r\n                ))}\r\n              </div>\r\n            ) : null}\r\n\r\n            {preview ? (\r\n              <div style={{ marginTop: 16 }}>\r\n                {previewPools.length > 0 ? (\r\n                  <>\r\n                    <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Havuz Tutarlari</div>\r\n                    <div className=\"table-scroll\">\r\n                      <table className=\"table\">\r\n                        <thead>\r\n                          <tr>\r\n                            <th>Gider</th>\r\n                            <th>Havuz Tutari</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          {previewPools.map((p) => (\r\n                            <tr key={p.expenseKey}>\r\n                              <td>{EXPENSE_LABELS.get(p.expenseKey) || p.expenseKey}</td>\r\n                              <td>{fmtNum(p.poolAmount)}</td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </>\r\n                ) : null}\r\n\r\n                {previewTargets.length > 0 ? (\r\n                  <>\r\n                    <div className=\"small\" style={{ fontWeight: 700, margin: \"12px 0 6px\" }}>Agirliklar</div>\r\n                    <div className=\"table-scroll\">\r\n                      <table className=\"table\">\r\n                        <thead>\r\n                          <tr>\r\n                            <th>Okul</th>\r\n                            <th>Senaryo</th>\r\n                            <th>Basis</th>\r\n                            <th>Agirlik</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          {previewTargets.map((t) => (\r\n                            <tr key={t.targetScenarioId}>\r\n                              <td>{t.schoolName}</td>\r\n                              <td>{t.scenarioName}</td>\r\n                              <td>{fmtNum(t.basisValue)}</td>\r\n                              <td>{fmtPct(t.weight)}</td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </>\r\n                ) : null}\r\n\r\n                {allocationRows.length > 0 ? (\r\n                  <>\r\n                    <div className=\"small\" style={{ fontWeight: 700, margin: \"12px 0 6px\" }}>Dagitimlar</div>\r\n                    <div className=\"table-scroll\">\r\n                      <table className=\"table\">\r\n                        <thead>\r\n                          <tr>\r\n                            <th>Hedef</th>\r\n                            <th>Gider</th>\r\n                            <th>Tutar</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          {allocationRows.map((row, idx) => (\r\n                            <tr key={`${row.targetLabel}-${row.expenseLabel}-${idx}`}>\r\n                              <td>{row.targetLabel}</td>\r\n                              <td>{row.expenseLabel}</td>\r\n                              <td>{fmtNum(row.amount)}</td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </>\r\n                ) : null}\r\n              </div>\r\n            ) : null}\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","\r\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { useNavigate, useOutletContext, useSearchParams } from \"react-router-dom\";\r\nimport { ToastContainer, toast } from \"react-toastify\";\r\n// Import additional icons for better visual cues on the action buttons.\r\n// FaCheckCircle represents approval actions and FaTrash represents deletion actions.\r\nimport { FaCheckCircle, FaPaperPlane, FaTrash, FaSort, FaSortDown, FaSortUp } from \"react-icons/fa\";\r\nimport { api } from \"../api\";\r\nimport { useAuth } from \"../auth/AuthContext\";\r\nimport ProgressBar from \"../components/ui/ProgressBar\";\r\nimport ExpenseSplitModal from \"../components/ExpenseSplitModal\";\r\nimport {\r\n  getDefaultKademeConfig,\r\n  getKademeDefinitions,\r\n  getGradeOptions,\r\n  normalizeKademeConfig,\r\n} from \"../utils/kademe\";\r\nimport { PROGRAM_TYPES, normalizeProgramType } from \"../utils/programType\";\r\nimport {\r\n  readSelectedScenarioId,\r\n  writeSelectedScenarioId,\r\n  readGlobalLastRouteSegment,\r\n  writeLastActiveSchoolId,\r\n} from \"../utils/schoolNavStorage\";\r\nimport { can } from \"../utils/permissions\";\r\n\r\nconst COPY_SELECT_TABS = [\r\n  {\r\n    key: \"temel\",\r\n    label: \"Temel Bilgiler\",\r\n    sections: [\r\n      { id: \"temel.core\", label: \"Kademeler + Program\" },\r\n      { id: \"temel.pricing\", label: \"Enflasyon + Ucret Artis Oranlari + Ucret Hesaplama Ayari\" },\r\n      { id: \"temel.schoolInfo\", label: \"Yetkililer + Okul/Egitim Bilgileri\" },\r\n      { id: \"temel.discountsMeta\", label: \"IK Mevcut + Burs/Indirim Ogrenci Sayilari\" },\r\n      { id: \"temel.competitors\", label: \"Rakip Analizi\" },\r\n      { id: \"temel.performance\", label: \"Performans + Degerlendirme\" },\r\n    ],\r\n  },\r\n  {\r\n    key: \"kapasite\",\r\n    label: \"Kapasite\",\r\n    sections: [{ id: \"kapasite.all\", label: \"Kapasite (tumu)\" }],\r\n  },\r\n  {\r\n    key: \"norm\",\r\n    label: \"Norm\",\r\n    sections: [\r\n      { id: \"norm.planned\", label: \"Planlanan donem bilgileri\" },\r\n      { id: \"norm.current\", label: \"Mevcut donem bilgileri\" },\r\n      { id: \"norm.lessonY1\", label: \"Ders dagilimi (yalnizca Y1)\" },\r\n    ],\r\n  },\r\n  {\r\n    key: \"hr\",\r\n    label: \"IK (HR)\",\r\n    sections: [{ id: \"hr.ik\", label: \"IK Plan (tumu)\" }],\r\n  },\r\n  {\r\n    key: \"gelirler\",\r\n    label: \"Gelirler\",\r\n    sections: [{ id: \"income.gelirler\", label: \"Gelirler (tumu)\" }],\r\n  },\r\n  {\r\n    key: \"giderler\",\r\n    label: \"Giderler\",\r\n    sections: [\r\n      { id: \"expenses.giderler\", label: \"Giderler (tumu)\" },\r\n      { id: \"expenses.discounts\", label: \"BURS VE INDIRIMLER / YIL\" },\r\n    ],\r\n  },\r\n];\r\n\r\n// Mapping from copy selection section IDs to permission resources.  When a\r\n// scenario is copied, we must specify which permission resources are\r\n// modified so the backend can authorize writes.  Each entry maps a\r\n// selection key to an array of resource strings.  Pagelevel resources\r\n// (e.g. 'page.temel_bilgiler') grant write access to the entire module,\r\n// while sectionlevel resources (e.g. 'section.temel_bilgiler.inflation')\r\n// grant write access only to that portion.  Adjust this mapping if new\r\n// copy sections are introduced.\r\nconst COPY_SECTION_RESOURCES = {\r\n  // Temel Bilgiler: core data (kademeler & program type) require pagelevel permission\r\n  'temel.core': ['page.temel_bilgiler'],\r\n  // Temel Bilgiler: pricing (inflation, fee increases, fee calculation)\r\n  'temel.pricing': ['section.temel_bilgiler.inflation'],\r\n  // Temel Bilgiler: school info and administrators\r\n  'temel.schoolInfo': ['page.temel_bilgiler'],\r\n  // Temel Bilgiler: IK mevcut + burs/indirim counts\r\n  'temel.discountsMeta': ['section.temel_bilgiler.ik_mevcut', 'section.temel_bilgiler.burs_ogr'],\r\n  // Temel Bilgiler: competitors\r\n  'temel.competitors': ['section.temel_bilgiler.rakip'],\r\n  // Temel Bilgiler: performance and evaluation\r\n  'temel.performance': ['section.temel_bilgiler.performans'],\r\n  // Kapasite: all capacity values\r\n  'kapasite.all': ['section.kapasite.caps'],\r\n  // Norm: planned semesters (y2,y3) rely on the norm page\r\n  'norm.planned': ['page.norm'],\r\n  // Norm: current semester values (gradesCurrent) rely on the norm page\r\n  'norm.current': ['page.norm'],\r\n  // Norm: lesson distribution (Y1) maps to the ders_dagilimi section\r\n  'norm.lessonY1': ['section.norm.ders_dagilimi'],\r\n  // HR (IK): all HR data.  Use pagelevel resource since there is only one section defined.\r\n  'hr.ik': ['section.ik.local_staff'],\r\n  // Gelirler: income.  Use pagelevel resource (covers all income categories)\r\n  // For the Gelirler module, use the unit_fee section instead of the page\r\n  // resource.  This allows users who only have sectionlevel write access\r\n  // (e.g. unit_fee) to copy incomes without requiring page.gelirler\r\n  // permission.  See SchoolPage.pathToResources for section mapping logic.\r\n  'income.gelirler': ['section.gelirler.unit_fee'],\r\n  // Giderler: expenses.  The isletme section covers operating expenses\r\n  'expenses.giderler': ['section.giderler.isletme'],\r\n  // Discounts: burs/indirim values (yearlevel discounts)\r\n  'expenses.discounts': ['section.discounts.discounts'],\r\n};\r\n\r\n/**\r\n * Build a list of modified permission resources based on the user's copy\r\n * selection.  For each selected section key whose value is truthy in\r\n * `selection`, this function looks up the corresponding resource(s) in\r\n * COPY_SECTION_RESOURCES and collects them into a unique list.  Unknown\r\n * section keys are ignored.\r\n *\r\n * @param {Object} selection Mapping of section keys to boolean (selected)\r\n * @returns {string[]} List of unique permission resource keys\r\n */\r\nfunction buildModifiedResourcesFromCopySelection(selection) {\r\n  const out = new Set();\r\n  if (!selection || typeof selection !== 'object') return [];\r\n  Object.entries(selection).forEach(([key, value]) => {\r\n    if (!value) return;\r\n    const resources = COPY_SECTION_RESOURCES[key];\r\n    if (Array.isArray(resources)) {\r\n      resources.forEach((r) => out.add(r));\r\n    }\r\n  });\r\n  return Array.from(out);\r\n}\r\n\r\nfunction isScenarioLocked(scenario) {\r\n  const status = String(scenario?.status || \"draft\");\r\n  const submittedAt = scenario?.submitted_at != null;\r\n  const sentAt = scenario?.sent_at != null;\r\n  return (\r\n    status === \"sent_for_approval\" ||\r\n    status === \"submitted\" ||\r\n    (status === \"approved\" && sentAt) ||\r\n    (status === \"in_review\" && submittedAt)\r\n  );\r\n}\r\n\r\nconst DEFAULT_START_YEAR = \"2026\";\r\nconst DEFAULT_END_YEAR = \"2027\";\r\nconst CURRENCY_CODE_REGEX = /^[A-Z0-9]{2,10}$/;\r\nconst LOCAL_CURRENCY_OPTIONS = [\"USD\", \"EUR\", \"TRY\", \"GBP\", \"JPY\", \"CNY\", \"INR\", \"RUB\", \"AED\", \"SAR\", \"AFN\"];\r\n\r\nfunction normalizeYearInput(value) {\r\n  const s = String(value || \"\").trim();\r\n  if (!/^\\d{4}$/.test(s)) return null;\r\n  return Number(s);\r\n}\r\n\r\nfunction formatAcademicYear(periodType, startYearValue, endYearValue) {\r\n  const start = normalizeYearInput(startYearValue);\r\n  if (!start) return \"\";\r\n  if (periodType === \"full\") return String(start);\r\n  const end = normalizeYearInput(endYearValue);\r\n  if (!end) return \"\";\r\n  return `${start}-${end}`;\r\n}\r\n\r\nfunction parseAcademicYear(academicYear) {\r\n  const s = String(academicYear || \"\").trim();\r\n  const range = s.match(/(\\d{4})\\s*-\\s*(\\d{4})/);\r\n  if (range) {\r\n    const startYear = Number(range[1]);\r\n    const endYear = Number(range[2]);\r\n    if (Number.isFinite(startYear) && Number.isFinite(endYear)) {\r\n      return { startYear, endYear };\r\n    }\r\n  }\r\n  const single = s.match(/^(\\d{4})$/);\r\n  if (single) {\r\n    const startYear = Number(single[1]);\r\n    if (Number.isFinite(startYear)) return { startYear, endYear: startYear };\r\n  }\r\n  return { startYear: null, endYear: null };\r\n}\r\n\r\nfunction incrementAcademicYearString(academicYear) {\r\n  const raw = String(academicYear || \"\").trim();\r\n  const single = raw.match(/^(\\d{4})$/);\r\n  if (single) {\r\n    const start = Number(single[1]);\r\n    return Number.isFinite(start) ? String(start + 1) : \"\";\r\n  }\r\n  const range = raw.match(/^(\\d{4})\\s*-\\s*(\\d{4})$/);\r\n  if (range) {\r\n    const start = Number(range[1]);\r\n    const end = Number(range[2]);\r\n    if (Number.isFinite(start) && Number.isFinite(end)) return `${start + 1}-${end + 1}`;\r\n  }\r\n  return \"\";\r\n}\r\n\r\nfunction getAllCopySectionIds() {\r\n  return COPY_SELECT_TABS.flatMap((tab) => tab.sections.map((section) => section.id));\r\n}\r\n\r\nfunction enforceIkGiderlerPair(selection) {\r\n  const next = { ...(selection || {}) };\r\n  const ikSelected = !!next[\"hr.ik\"];\r\n  const giderlerSelected = !!next[\"expenses.giderler\"];\r\n  if (ikSelected !== giderlerSelected) {\r\n    const nextValue = ikSelected || giderlerSelected;\r\n    next[\"hr.ik\"] = nextValue;\r\n    next[\"expenses.giderler\"] = nextValue;\r\n  }\r\n  return next;\r\n}\r\n\r\nfunction buildDefaultCopySelection(presetKey = \"all\") {\r\n  const sectionIds = getAllCopySectionIds();\r\n  const selection = Object.fromEntries(sectionIds.map((id) => [id, false]));\r\n  if (presetKey === \"all\") {\r\n    sectionIds.forEach((id) => {\r\n      selection[id] = true;\r\n    });\r\n  } else if (presetKey === \"structure\") {\r\n    [\"temel.core\", \"kapasite.all\", \"norm.planned\", \"norm.lessonY1\"].forEach((id) => {\r\n      selection[id] = true;\r\n    });\r\n  } else if (presetKey === \"financial\") {\r\n    [\"temel.core\", \"income.gelirler\", \"expenses.discounts\", \"hr.ik\", \"expenses.giderler\"].forEach((id) => {\r\n      selection[id] = true;\r\n    });\r\n  }\r\n  return enforceIkGiderlerPair(selection);\r\n}\r\n\r\nfunction filterInputsForCopyBySelection(srcInputs, selection) {\r\n  const sel = selection || {};\r\n  const keep = (id) => !!sel[id];\r\n  const next = structuredClone(srcInputs || {});\r\n  const buildDefaultGrades = () =>\r\n    getGradeOptions().map((g) => ({ grade: g, branchCount: 0, studentsPerBranch: 0 }));\r\n  const srcGradesYears =\r\n    srcInputs?.gradesYears && typeof srcInputs.gradesYears === \"object\" ? srcInputs.gradesYears : {};\r\n  const srcGrades = Array.isArray(srcInputs?.grades) ? srcInputs.grades : null;\r\n  const y1Source = Array.isArray(srcGradesYears?.y1)\r\n    ? srcGradesYears.y1\r\n    : Array.isArray(srcGrades)\r\n      ? srcGrades\r\n      : buildDefaultGrades();\r\n  const keepPlanned = keep(\"norm.planned\");\r\n  const keepLessonY1 = keep(\"norm.lessonY1\");\r\n  const y2Source = Array.isArray(srcGradesYears?.y2)\r\n    ? srcGradesYears.y2\r\n    : keepLessonY1\r\n      ? y1Source\r\n      : buildDefaultGrades();\r\n  const y3Source = Array.isArray(srcGradesYears?.y3)\r\n    ? srcGradesYears.y3\r\n    : keepLessonY1\r\n      ? y1Source\r\n      : buildDefaultGrades();\r\n  next.temelBilgiler = next.temelBilgiler || {};\r\n\r\n  if (!keep(\"temel.core\")) {\r\n    delete next.temelBilgiler.kademeler;\r\n    delete next.temelBilgiler.programType;\r\n  }\r\n\r\n  if (!keep(\"temel.pricing\")) {\r\n    delete next.temelBilgiler.inflation;\r\n    delete next.temelBilgiler.ucretArtisOranlari;\r\n    delete next.temelBilgiler.okulUcretleriHesaplama;\r\n  }\r\n\r\n  if (!keep(\"temel.schoolInfo\")) {\r\n    delete next.temelBilgiler.yetkililer;\r\n    delete next.temelBilgiler.okulEgitimBilgileri;\r\n  }\r\n\r\n  if (!keep(\"temel.discountsMeta\")) {\r\n    delete next.temelBilgiler.ikMevcut;\r\n    delete next.temelBilgiler.bursIndirimOgrenciSayilari;\r\n  }\r\n\r\n  if (!keep(\"temel.competitors\")) {\r\n    delete next.temelBilgiler.rakipAnalizi;\r\n  }\r\n\r\n  if (!keep(\"temel.performance\")) {\r\n    delete next.temelBilgiler.performans;\r\n    delete next.temelBilgiler.degerlendirme;\r\n  }\r\n  if (next.temelBilgiler?.performans && typeof next.temelBilgiler.performans === \"object\") {\r\n    delete next.temelBilgiler.performans.gerceklesen;\r\n  }\r\n\r\n  if (!keep(\"kapasite.all\")) {\r\n    delete next.kapasite;\r\n    delete next.schoolCapacity;\r\n  }\r\n\r\n  if (!keep(\"norm.current\")) {\r\n    delete next.gradesCurrent;\r\n  }\r\n\r\n  if (!keepPlanned && !keepLessonY1) {\r\n    delete next.gradesYears;\r\n    delete next.grades;\r\n  } else {\r\n    const y1 = keepLessonY1 ? structuredClone(y1Source) : structuredClone(buildDefaultGrades());\r\n    const y2 = keepPlanned ? structuredClone(y2Source) : structuredClone(buildDefaultGrades());\r\n    const y3 = keepPlanned ? structuredClone(y3Source) : structuredClone(buildDefaultGrades());\r\n    next.gradesYears = { y1, y2, y3 };\r\n    if (keepLessonY1) {\r\n      next.grades = structuredClone(y1);\r\n    } else {\r\n      delete next.grades;\r\n    }\r\n  }\r\n\r\n  if (!keep(\"hr.ik\")) {\r\n    delete next.ik;\r\n  }\r\n\r\n  if (!keep(\"income.gelirler\")) {\r\n    delete next.gelirler;\r\n  }\r\n\r\n  if (!keep(\"expenses.giderler\")) {\r\n    delete next.giderler;\r\n  }\r\n\r\n  if (!keep(\"expenses.discounts\")) {\r\n    delete next.discounts;\r\n  }\r\n\r\n  return next;\r\n}\r\n\r\nfunction buildEmptyNormCurriculum() {\r\n  const empty = {};\r\n  getGradeOptions().forEach((g) => {\r\n    empty[g] = {};\r\n  });\r\n  return empty;\r\n}\r\n\r\nfunction buildEmptyNormYear(maxHours) {\r\n  return {\r\n    teacherWeeklyMaxHours: Number.isFinite(maxHours) && maxHours > 0 ? maxHours : 24,\r\n    curriculumWeeklyHours: buildEmptyNormCurriculum(),\r\n  };\r\n}\r\n\r\nfunction convertInputsUsdToLocalForCopy(inputs, fx) {\r\n  const rate = Number(fx);\r\n  if (!Number.isFinite(rate) || rate <= 0) return inputs;\r\n\r\n  const mulMoney = (v) => {\r\n    const n = Number(v);\r\n    if (!Number.isFinite(n)) return v;\r\n    return Math.round(n * rate * 100) / 100;\r\n  };\r\n\r\n  if (inputs?.gelirler) {\r\n    const g = inputs.gelirler;\r\n\r\n    const convertRows = (rows) => {\r\n      if (!Array.isArray(rows)) return;\r\n      rows.forEach((r) => {\r\n        if (!r || typeof r !== \"object\") return;\r\n        if (\"unitFee\" in r) r.unitFee = mulMoney(r.unitFee);\r\n        if (\"amount\" in r) r.amount = mulMoney(r.amount);\r\n      });\r\n    };\r\n\r\n    convertRows(g?.tuition?.rows);\r\n    convertRows(g?.nonEducationFees?.rows);\r\n    convertRows(g?.dormitory?.rows);\r\n    convertRows(g?.otherInstitutionIncome?.rows);\r\n\r\n    if (g?.governmentIncentives != null) {\r\n      g.governmentIncentives = mulMoney(g.governmentIncentives);\r\n    }\r\n  }\r\n\r\n  if (inputs?.giderler && typeof inputs.giderler === \"object\") {\r\n    Object.values(inputs.giderler).forEach((grp) => {\r\n      if (!grp || typeof grp !== \"object\") return;\r\n      if (!grp.items || typeof grp.items !== \"object\") return;\r\n      Object.keys(grp.items).forEach((k) => {\r\n        grp.items[k] = mulMoney(grp.items[k]);\r\n      });\r\n    });\r\n  }\r\n\r\n  if (inputs?.ik?.years && typeof inputs.ik.years === \"object\") {\r\n    Object.values(inputs.ik.years).forEach((yearObj) => {\r\n      if (!yearObj || typeof yearObj !== \"object\") return;\r\n      if (!yearObj.unitCosts || typeof yearObj.unitCosts !== \"object\") return;\r\n      Object.keys(yearObj.unitCosts).forEach((k) => {\r\n        yearObj.unitCosts[k] = mulMoney(yearObj.unitCosts[k]);\r\n      });\r\n    });\r\n  }\r\n\r\n  if (Array.isArray(inputs?.discounts)) {\r\n    inputs.discounts.forEach((d) => {\r\n      if (!d || typeof d !== \"object\") return;\r\n      if (String(d.mode || \"\").toLowerCase() === \"amount\") {\r\n        d.value = mulMoney(d.value);\r\n      }\r\n    });\r\n  }\r\n\r\n  const tb = inputs?.temelBilgiler;\r\n  if (tb) {\r\n    if (tb?.inflation?.currentSeasonAvgFee != null) {\r\n      tb.inflation.currentSeasonAvgFee = mulMoney(tb.inflation.currentSeasonAvgFee);\r\n    }\r\n\r\n    if (tb?.rakipAnalizi && typeof tb.rakipAnalizi === \"object\") {\r\n      Object.values(tb.rakipAnalizi).forEach((obj) => {\r\n        if (!obj || typeof obj !== \"object\") return;\r\n        [\"a\", \"b\", \"c\"].forEach((k) => {\r\n          if (k in obj) obj[k] = mulMoney(obj[k]);\r\n        });\r\n      });\r\n    }\r\n\r\n    if (tb?.performans?.gerceklesen && typeof tb.performans.gerceklesen === \"object\") {\r\n      Object.keys(tb.performans.gerceklesen).forEach((k) => {\r\n        tb.performans.gerceklesen[k] = mulMoney(tb.performans.gerceklesen[k]);\r\n      });\r\n    }\r\n  }\r\n\r\n  return inputs;\r\n}\r\n\r\nfunction convertInputsLocalToUsdForCopy(inputs, fx) {\r\n  const rate = Number(fx);\r\n  if (!Number.isFinite(rate) || rate <= 0) return inputs;\r\n  return convertInputsUsdToLocalForCopy(inputs, 1 / rate);\r\n}\r\n\r\nfunction InlineSpinner({ size = 12 }) {\r\n  return (\r\n    <span\r\n      aria-hidden\r\n      style={{\r\n        width: size,\r\n        height: size,\r\n        borderRadius: \"50%\",\r\n        border: \"2px solid rgba(0,0,0,0.18)\",\r\n        borderTopColor: \"rgba(0,0,0,0.65)\",\r\n        display: \"inline-block\",\r\n        animation: \"schoolSpin .8s linear infinite\",\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\nfunction applyIkSalariesToGiderler(inInputs) {\r\n  const src = inInputs || {};\r\n  const ik = src.ik || {};\r\n  const yearIK = ik?.years?.y1 ? ik.years.y1 : ik;\r\n\r\n  const unitCosts = yearIK?.unitCosts || {};\r\n  const headcountsByLevel = yearIK?.headcountsByLevel || {};\r\n\r\n  const roles = [\r\n    \"turk_mudur\",\r\n    \"turk_mdyard\",\r\n    \"turk_egitimci\",\r\n    \"turk_temsil\",\r\n    \"yerel_yonetici_egitimci\",\r\n    \"yerel_destek\",\r\n    \"yerel_ulke_temsil_destek\",\r\n    \"int_yonetici_egitimci\",\r\n  ];\r\n\r\n  const levels = [\r\n    \"okulOncesi\",\r\n    \"ilkokulYerel\",\r\n    \"ilkokulInt\",\r\n    \"ortaokulYerel\",\r\n    \"ortaokulInt\",\r\n    \"liseYerel\",\r\n    \"liseInt\",\r\n  ];\r\n\r\n  const roleAnnual = {};\r\n  for (const r of roles) {\r\n    let count = 0;\r\n    for (const lvl of levels) count += Number(headcountsByLevel?.[lvl]?.[r] || 0);\r\n    roleAnnual[r] = Number(unitCosts?.[r] || 0) * count;\r\n  }\r\n\r\n  const patch = {\r\n    turkPersonelMaas:\r\n      (roleAnnual.turk_mudur || 0) +\r\n      (roleAnnual.turk_mdyard || 0) +\r\n      (roleAnnual.turk_egitimci || 0),\r\n    turkDestekPersonelMaas: roleAnnual.turk_temsil || 0,\r\n    yerelPersonelMaas: roleAnnual.yerel_yonetici_egitimci || 0,\r\n    yerelDestekPersonelMaas:\r\n      (roleAnnual.yerel_destek || 0) + (roleAnnual.yerel_ulke_temsil_destek || 0),\r\n    internationalPersonelMaas: roleAnnual.int_yonetici_egitimci || 0,\r\n  };\r\n\r\n  const prevItems = src?.giderler?.isletme?.items || {};\r\n  const keys = Object.keys(patch);\r\n\r\n  let changed = false;\r\n  for (const k of keys) {\r\n    const a = Number(prevItems?.[k] || 0);\r\n    const b = Number(patch?.[k] || 0);\r\n    if (Math.abs(a - b) > 1e-6) {\r\n      changed = true;\r\n      break;\r\n    }\r\n  }\r\n  if (!changed) return src;\r\n\r\n  const next = structuredClone(src);\r\n  next.giderler = next.giderler || {};\r\n  next.giderler.isletme = next.giderler.isletme || {};\r\n  next.giderler.isletme.items = next.giderler.isletme.items || {};\r\n  for (const k of keys) next.giderler.isletme.items[k] = Number(patch[k] || 0);\r\n  return next;\r\n}\r\n\r\nfunction normalizeCapacityInputs(src) {\r\n  const safeNum = (v) => {\r\n    const n = Number(v);\r\n    return Number.isFinite(n) ? n : 0;\r\n  };\r\n\r\n  const s = src || {};\r\n  const legacy = safeNum(s.schoolCapacity);\r\n\r\n  const cap = s.kapasite && typeof s.kapasite === \"object\" ? s.kapasite : {};\r\n  const years = cap.years && typeof cap.years === \"object\" ? cap.years : {};\r\n\r\n  const y1 = safeNum(years.y1 != null ? years.y1 : legacy);\r\n  const y2 = safeNum(years.y2 != null ? years.y2 : y1);\r\n  const y3 = safeNum(years.y3 != null ? years.y3 : y1);\r\n\r\n  const currentStudents = safeNum(cap.currentStudents);\r\n  const byKademe = cap.byKademe && typeof cap.byKademe === \"object\" ? cap.byKademe : {};\r\n\r\n  const needsPatch =\r\n    \"schoolCapacity\" in s ||\r\n    !s.kapasite ||\r\n    typeof s.kapasite !== \"object\" ||\r\n    !cap.years ||\r\n    typeof cap.years !== \"object\" ||\r\n    safeNum(cap?.years?.y1) !== y1 ||\r\n    safeNum(cap?.years?.y2) !== y2 ||\r\n    safeNum(cap?.years?.y3) !== y3 ||\r\n    safeNum(cap?.currentStudents) !== currentStudents ||\r\n    !cap.byKademe ||\r\n    typeof cap.byKademe !== \"object\";\r\n\r\n  if (!needsPatch) return s;\r\n\r\n  const next = structuredClone(s);\r\n  next.kapasite = {\r\n    ...(cap || {}),\r\n    currentStudents,\r\n    years: { y1, y2, y3 },\r\n    byKademe,\r\n  };\r\n  if (\"schoolCapacity\" in next) delete next.schoolCapacity;\r\n  return next;\r\n}\r\n\r\nfunction normalizeTemelBilgilerInputs(src) {\r\n  const s = src || {};\r\n  const t = s.temelBilgiler && typeof s.temelBilgiler === \"object\" ? s.temelBilgiler : {};\r\n  const next = structuredClone(s);\r\n\r\n  const inf = t.inflation && typeof t.inflation === \"object\" ? t.inflation : {};\r\n  const toFinite = (v) => (Number.isFinite(Number(v)) ? Number(v) : 0);\r\n  next.temelBilgiler = {\r\n    inflation: {\r\n      ...inf,\r\n      expenseDeviationPct: toFinite(inf.expenseDeviationPct),\r\n      y2023: toFinite(inf.y2023),\r\n      y2024: toFinite(inf.y2024),\r\n      y2025: toFinite(inf.y2025),\r\n      y1: toFinite(inf.y1),\r\n      y2: toFinite(inf.y2),\r\n      y3: toFinite(inf.y3),\r\n      currentSeasonAvgFee: toFinite(inf.currentSeasonAvgFee),\r\n    },\r\n    yetkililer: t.yetkililer || { mudur: \"\", ulkeTemsilcisi: \"\", raporuHazirlayan: \"\" },\r\n    okulEgitimBilgileri: t.okulEgitimBilgileri || {\r\n      egitimBaslamaTarihi: \"\",\r\n      zorunluEgitimDonemleri: \"\",\r\n      birDersSuresiDakika: 0,\r\n      gunlukDersSaati: 0,\r\n      haftalikDersSaatiToplam: 0,\r\n      sabahciOglenci: \"\",\r\n      ogretmenHaftalikDersOrt: 0,\r\n      gecisSinaviBilgisi: \"\",\r\n      uygulananProgram: \"\",\r\n    },\r\n    kademeler: normalizeKademeConfig(t.kademeler),\r\n    programType: normalizeProgramType(t.programType),\r\n    okulUcretleriHesaplama: typeof t.okulUcretleriHesaplama === \"boolean\" ? t.okulUcretleriHesaplama : true,\r\n    ucretArtisOranlari: t.ucretArtisOranlari || {\r\n      okulOncesi: 0,\r\n      ilkokulYerel: 0,\r\n      ilkokulInt: 0,\r\n      ortaokulYerel: 0,\r\n      ortaokulInt: 0,\r\n      liseYerel: 0,\r\n      liseInt: 0,\r\n    },\r\n    ikMevcut: t.ikMevcut || {\r\n      turkPersonelYoneticiEgitimci: 0,\r\n      turkPersonelTemsilcilik: 0,\r\n      yerelKadroluEgitimci: 0,\r\n      yerelUcretliVakaterEgitimci: 0,\r\n      yerelDestek: 0,\r\n      yerelTemsilcilik: 0,\r\n      international: 0,\r\n    },\r\n    bursIndirimOgrenciSayilari: t.bursIndirimOgrenciSayilari || {\r\n      magisBasariBursu: 0,\r\n      maarifYetenekBursu: 0,\r\n      ihtiyacBursu: 0,\r\n      okulBasariBursu: 0,\r\n      tamEgitimBursu: 0,\r\n      barinmaBursu: 0,\r\n      turkceBasariBursu: 0,\r\n      uluslararasiYukumlulukIndirimi: 0,\r\n      vakifCalisaniIndirimi: 0,\r\n      kardesIndirimi: 0,\r\n      erkenKayitIndirimi: 0,\r\n      pesinOdemeIndirimi: 0,\r\n      kademeGecisIndirimi: 0,\r\n      temsilIndirimi: 0,\r\n      kurumIndirimi: 0,\r\n      istisnaiIndirim: 0,\r\n      yerelMevzuatIndirimi: 0,\r\n    },\r\n    rakipAnalizi: t.rakipAnalizi || {\r\n      okulOncesi: { a: 0, b: 0, c: 0 },\r\n      ilkokul: { a: 0, b: 0, c: 0 },\r\n      ortaokul: { a: 0, b: 0, c: 0 },\r\n      lise: { a: 0, b: 0, c: 0 },\r\n    },\r\n    performans: t.performans || {\r\n      gerceklesen: { ogrenciSayisi: 0, gelirler: 0, giderler: 0, karZarar: 0, bursVeIndirimler: 0 },\r\n    },\r\n    degerlendirme: typeof t.degerlendirme === \"string\" ? t.degerlendirme : \"\",\r\n  };\r\n\r\n  return next;\r\n}\r\n\r\nfunction normalizeGradesInputs(src) {\r\n  const s = src || {};\r\n  const defaultGrades = getGradeOptions().map((g) => ({ grade: g, branchCount: 0, studentsPerBranch: 0 }));\r\n  const baseGrades = Array.isArray(s.grades) ? s.grades : defaultGrades;\r\n  const years = s.gradesYears && typeof s.gradesYears === \"object\" ? s.gradesYears : {};\r\n\r\n  const y1 = Array.isArray(years.y1) ? years.y1 : baseGrades;\r\n  const y2 = Array.isArray(years.y2) ? years.y2 : y1;\r\n  const y3 = Array.isArray(years.y3) ? years.y3 : y1;\r\n\r\n  const normalizeRow = (row) => ({\r\n    grade: String(row?.grade ?? \"\"),\r\n    branchCount: Number(row?.branchCount ?? 0),\r\n    studentsPerBranch: Number(row?.studentsPerBranch ?? 0),\r\n  });\r\n\r\n  const toMap = (list) => {\r\n    const m = new Map();\r\n    (Array.isArray(list) ? list : []).forEach((row) => {\r\n      const r = normalizeRow(row);\r\n      if (!r.grade) return;\r\n      m.set(r.grade, r);\r\n    });\r\n    return m;\r\n  };\r\n\r\n  const areGradesEqual = (a, b) => {\r\n    if (!Array.isArray(a) || !Array.isArray(b)) return false;\r\n    if (a.length !== b.length) return false;\r\n    const ma = toMap(a);\r\n    const mb = toMap(b);\r\n    if (ma.size !== mb.size) return false;\r\n    for (const [grade, ra] of ma.entries()) {\r\n      const rb = mb.get(grade);\r\n      if (!rb) return false;\r\n      if (Number(ra.branchCount) !== Number(rb.branchCount)) return false;\r\n      if (Number(ra.studentsPerBranch) !== Number(rb.studentsPerBranch)) return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const needsPatch =\r\n    !s.gradesYears ||\r\n    !Array.isArray(s.grades) ||\r\n    !Array.isArray(years.y1) ||\r\n    !Array.isArray(years.y2) ||\r\n    !Array.isArray(years.y3) ||\r\n    !areGradesEqual(s.grades, y1);\r\n\r\n  if (!needsPatch) return s;\r\n\r\n  const next = structuredClone(s);\r\n  next.gradesYears = {\r\n    y1: structuredClone(y1),\r\n    y2: structuredClone(y2),\r\n    y3: structuredClone(y3),\r\n  };\r\n  next.grades = structuredClone(next.gradesYears.y1);\r\n  return next;\r\n}\r\n\r\nfunction getScenarioStatusMeta(scenarioOrStatus) {\r\n  const obj = scenarioOrStatus && typeof scenarioOrStatus === 'object' ? scenarioOrStatus : { status: scenarioOrStatus };\r\n  const status = obj.status;\r\n  const sentAt = obj.sent_at;\r\n  switch (status) {\r\n    case 'revision_requested':\r\n      return { label: 'Revize istendi', cls: 'is-revision', help: 'Revize istendi: senaryoda dzeltme gerekiyor.' };\r\n    case 'sent_for_approval':\r\n      return { label: 'Merkeze iletildi', cls: 'is-submitted', help: 'Merkeze iletildi: admin onay bekleniyor.' };\r\n    case 'submitted':\r\n      // Legacy status; treat similarly to sent_for_approval\r\n      return { label: 'Merkeze iletildi', cls: 'is-submitted', help: 'Merkeze iletildi: admin onay bekleniyor.' };\r\n    case 'approved':\r\n      if (sentAt) {\r\n        return { label: 'Onayland', cls: 'is-approved', help: 'Onayland: admin tarafndan onayland.' };\r\n      }\r\n      return { label: 'Kontrol edildi', cls: 'is-approved', help: 'Kontrol edildi: ynetici tarafndan kontrol edildi.' };\r\n    case 'in_review':\r\n      return { label: 'ncelemede', cls: 'is-submitted', help: 'ncelemede: ynetici incelemesinde.' };\r\n    case 'draft':\r\n      return { label: 'Taslak', cls: 'is-draft', help: 'Taslak: senaryo zerinde allyor.' };\r\n    default:\r\n      return { label: status || '-', cls: 'is-unknown', help: '' };\r\n  }\r\n}\r\n\r\nexport default function SelectPage() {\r\n  const navigate = useNavigate();\r\n  const outlet = useOutletContext();\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const auth = useAuth();\r\n\r\n  const [schools, setSchools] = useState([]);\r\n  const [scenarios, setScenarios] = useState([]);\r\n  const [scenariosSchoolId, setScenariosSchoolId] = useState(null);\r\n  const [selectedSchoolId, setSelectedSchoolId] = useState(null);\r\n  const [selectedScenarioIdLocal, setSelectedScenarioIdLocal] = useState(null);\r\n  const [selectedScenario, setSelectedScenario] = useState(null);\r\n  const [inputs, setInputs] = useState(null);\r\n  const [, setReport] = useState(null);\r\n  const [err, setErr] = useState(\"\");\r\n  const [loadingSchools, setLoadingSchools] = useState(false);\r\n  const [loadingScenarios, setLoadingScenarios] = useState(false);\r\n  const [schoolProgress, setSchoolProgress] = useState({});\r\n  const [schoolProgressLoading, setSchoolProgressLoading] = useState(false);\r\n  const [scenarioProgressMap, setScenarioProgressMap] = useState({});\r\n  const [scenarioProgressLoading, setScenarioProgressLoading] = useState(false);\r\n\r\n  const [newScenarioName, setNewScenarioName] = useState(\"\");\r\n  const [newScenarioPeriod, setNewScenarioPeriod] = useState(\"split\");\r\n  const [newScenarioStartYear, setNewScenarioStartYear] = useState(DEFAULT_START_YEAR);\r\n  const [newScenarioEndYear, setNewScenarioEndYear] = useState(DEFAULT_END_YEAR);\r\n  const [newScenarioKademeler, setNewScenarioKademeler] = useState(getDefaultKademeConfig());\r\n  const [newScenarioInputCurrency, setNewScenarioInputCurrency] = useState(\"USD\");\r\n  const [newScenarioLocalCurrencyCode, setNewScenarioLocalCurrencyCode] = useState(\"\");\r\n  const [newScenarioFxUsdToLocal, setNewScenarioFxUsdToLocal] = useState(\"\");\r\n  const [newScenarioProgramType, setNewScenarioProgramType] = useState(null);\r\n  const [newScenarioStep, setNewScenarioStep] = useState(0);\r\n  const [scenarioWizardOpen, setScenarioWizardOpen] = useState(false);\r\n  const [scenarioWizardMode, setScenarioWizardMode] = useState(\"create\");\r\n  const [scenarioWizardScenario, setScenarioWizardScenario] = useState(null);\r\n  const [scenarioWizardLoading, setScenarioWizardLoading] = useState(false);\r\n  const [scenarioWizardSaving, setScenarioWizardSaving] = useState(false);\r\n\r\n  const [scenarioSort, setScenarioSort] = useState({ key: null, dir: \"asc\" });\r\n  const [submittingScenarioId, setSubmittingScenarioId] = useState(null);\r\n  const [copyingScenarioId, setCopyingScenarioId] = useState(null);\r\n  const [deletingScenarioId, setDeletingScenarioId] = useState(null);\r\n  const [deleteConfirmScenarioId, setDeleteConfirmScenarioId] = useState(null);\r\n  const [copyModalOpen, setCopyModalOpen] = useState(false);\r\n  const [expenseSplitOpen, setExpenseSplitOpen] = useState(false);\r\n  const [copyModalError, setCopyModalError] = useState(\"\");\r\n  const [copySelection, setCopySelection] = useState(null);\r\n  const [copySelectionMsg, setCopySelectionMsg] = useState(\"\");\r\n  const [copyTargetCurrency, setCopyTargetCurrency] = useState(\"USD\");\r\n  const [copyLocalCurrencyCode, setCopyLocalCurrencyCode] = useState(\"\");\r\n  const [copyPlannedFxUsdToLocal, setCopyPlannedFxUsdToLocal] = useState(\"\");\r\n  const [copyFxUsdToLocal, setCopyFxUsdToLocal] = useState(\"\");\r\n  const [calculating, setCalculating] = useState(false);\r\n\r\n  const copySelectionMsgTimerRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (!outlet?.setHeaderMeta) return;\r\n    outlet.setHeaderMeta({\r\n      title: \"Okul & Senaryo Sec\",\r\n      subtitle: \"Okul ve senaryoyu secip Uygula'ya basin.\",\r\n      centered: true,\r\n    });\r\n    return () => {\r\n      outlet.clearHeaderMeta?.();\r\n    };\r\n  }, [outlet]);\r\n\r\n  const loadSchools = useCallback(async () => {\r\n    setErr(\"\");\r\n    setLoadingSchools(true);\r\n    try {\r\n      const data = await api.listSchools({\r\n        limit: 50,\r\n        offset: 0,\r\n        fields: \"brief\",\r\n        order: \"name:asc\",\r\n      });\r\n      setSchools(Array.isArray(data?.items) ? data.items : []);\r\n    } catch (e) {\r\n      setErr(e.message || \"Okullar yuklenemedi.\");\r\n    } finally {\r\n      setLoadingSchools(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadSchools();\r\n  }, [loadSchools]);\r\n\r\n  const loadSchoolProgress = useCallback(async (rows) => {\r\n    if (!Array.isArray(rows) || !rows.length) {\r\n      setSchoolProgress({});\r\n      return;\r\n    }\r\n    setSchoolProgressLoading(true);\r\n    try {\r\n      const ids = rows.map((s) => s.id);\r\n      const data = await api.getSchoolsProgressBulk(ids);\r\n      const map = data?.progressBySchoolId && typeof data.progressBySchoolId === \"object\"\r\n        ? data.progressBySchoolId\r\n        : {};\r\n      setSchoolProgress(map);\r\n    } catch (_) {\r\n      const fallback = {};\r\n      rows.forEach((s) => {\r\n        fallback[s.id] = { state: \"error\", label: \"lerleme hesaplanamad\" };\r\n      });\r\n      setSchoolProgress(fallback);\r\n    } finally {\r\n      setSchoolProgressLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!schools.length) {\r\n      setSchoolProgress({});\r\n      setSchoolProgressLoading(false);\r\n      return;\r\n    }\r\n    loadSchoolProgress(schools);\r\n  }, [schools, loadSchoolProgress]);\r\n\r\n  useEffect(() => {\r\n    const raw = searchParams.get(\"schoolId\");\r\n    const paramId = Number(raw || 0);\r\n    if (!raw || !Number.isFinite(paramId)) return;\r\n    if (!schools.length) return;\r\n    if (!schools.some((s) => String(s.id) === String(paramId))) return;\r\n    setSelectedSchoolId((prev) => {\r\n      if (String(prev) === String(paramId)) return prev;\r\n      setScenarios([]);\r\n      setScenariosSchoolId(null);\r\n      setScenarioProgressMap({});\r\n      setScenarioProgressLoading(false);\r\n      return paramId;\r\n    });\r\n  }, [searchParams, schools]);\r\n\r\n  const handleSelectSchool = useCallback(\r\n    (schoolId) => {\r\n      const isDifferent = String(selectedSchoolId) !== String(schoolId);\r\n      if (isDifferent) {\r\n        setSelectedScenarioIdLocal(null);\r\n        setSelectedScenario(null);\r\n        setInputs(null);\r\n        setReport(null);\r\n        setScenarios([]);\r\n        setScenariosSchoolId(null);\r\n        setScenarioProgressMap({});\r\n        setScenarioProgressLoading(false);\r\n      }\r\n      setSelectedSchoolId(schoolId);\r\n      if (isDifferent) {\r\n        setSearchParams((prev) => {\r\n          const next = new URLSearchParams(prev);\r\n          next.set(\"schoolId\", String(schoolId));\r\n          return next;\r\n        });\r\n      }\r\n    },\r\n    [selectedSchoolId, setSearchParams]\r\n  );\r\n\r\n  const clearSchoolSelection = useCallback(() => {\r\n    setSelectedSchoolId(null);\r\n    setSelectedScenarioIdLocal(null);\r\n    setSelectedScenario(null);\r\n    setInputs(null);\r\n    setReport(null);\r\n    setScenarios([]);\r\n    setScenariosSchoolId(null);\r\n    setScenarioProgressMap({});\r\n    setSearchParams((prev) => {\r\n      const next = new URLSearchParams(prev);\r\n      next.delete(\"schoolId\");\r\n      return next;\r\n    });\r\n  }, [setSearchParams]);\r\n\r\n  const clearScenarioSelection = useCallback(() => {\r\n    setSelectedScenarioIdLocal(null);\r\n    setSelectedScenario(null);\r\n    setInputs(null);\r\n    setReport(null);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!selectedSchoolId) {\r\n      setScenarios([]);\r\n      setScenariosSchoolId(null);\r\n      setSelectedScenarioIdLocal(null);\r\n      setSelectedScenario(null);\r\n      setInputs(null);\r\n      setReport(null);\r\n      setScenarioProgressMap({});\r\n      setScenarioProgressLoading(false);\r\n      setLoadingScenarios(false);\r\n      return;\r\n    }\r\n\r\n    setSelectedScenarioIdLocal(null);\r\n    setSelectedScenario(null);\r\n    setInputs(null);\r\n    setReport(null);\r\n    setScenarios([]);\r\n    setScenariosSchoolId(null);\r\n    setScenarioProgressMap({});\r\n    setScenarioProgressLoading(false);\r\n\r\n    let active = true;\r\n    setErr(\"\");\r\n    setLoadingScenarios(true);\r\n    async function loadScenarios() {\r\n      try {\r\n        const sc = await api.listScenarios(selectedSchoolId, {\r\n          limit: 50,\r\n          offset: 0,\r\n          fields: \"brief\",\r\n          order: \"created_at:desc\",\r\n        });\r\n        if (!active) return;\r\n        const rows = Array.isArray(sc?.items) ? sc.items : [];\r\n        setScenarios(rows);\r\n        setScenariosSchoolId(selectedSchoolId);\r\n        setSelectedScenarioIdLocal((prev) => {\r\n          const exists = rows.some((s) => String(s.id) === String(prev));\r\n          if (exists) return prev;\r\n          const stored = readSelectedScenarioId(selectedSchoolId);\r\n          if (stored != null && rows.some((s) => String(s.id) === String(stored))) return stored;\r\n          return null;\r\n        });\r\n      } catch (e) {\r\n        if (!active) return;\r\n        setErr(e.message || \"Senaryolar yuklenemedi.\");\r\n        setScenarios([]);\r\n      } finally {\r\n        if (active) setLoadingScenarios(false);\r\n      }\r\n    }\r\n\r\n    loadScenarios();\r\n    return () => {\r\n      active = false;\r\n    };\r\n  }, [selectedSchoolId]);\r\n\r\n  useEffect(() => {\r\n    if (!selectedSchoolId) {\r\n      setScenarioProgressMap({});\r\n      setScenarioProgressLoading(false);\r\n      return;\r\n    }\r\n    if (scenariosSchoolId != null && String(scenariosSchoolId) !== String(selectedSchoolId)) {\r\n      setScenarioProgressMap({});\r\n      setScenarioProgressLoading(false);\r\n      return;\r\n    }\r\n    if (!scenarios.length) {\r\n      setScenarioProgressMap({});\r\n      setScenarioProgressLoading(false);\r\n      return;\r\n    }\r\n    let active = true;\r\n    setScenarioProgressLoading(true);\r\n    async function loadScenarioProgress() {\r\n      try {\r\n        const results = await Promise.all(\r\n          scenarios.map(async (scenario) => {\r\n            try {\r\n              const data = await api.getScenarioProgress(selectedSchoolId, scenario.id);\r\n              const progress = data?.progress;\r\n              if (!progress) return { id: scenario.id, error: true };\r\n              const missingLines = Array.isArray(progress.missingDetailsLines)\r\n                ? progress.missingDetailsLines\r\n                : [];\r\n              const tooltipLines = missingLines.length\r\n                ? [\"Eksik:\", ...missingLines]\r\n                : [\"Tm tablolar tamamland\"];\r\n              return { id: scenario.id, pct: progress.pct ?? 0, tooltipLines };\r\n            } catch (_) {\r\n              return { id: scenario.id, error: true };\r\n            }\r\n          })\r\n        );\r\n        if (!active) return;\r\n        const map = {};\r\n        results.forEach((row) => {\r\n          map[row.id] = row;\r\n        });\r\n        setScenarioProgressMap(map);\r\n      } finally {\r\n        if (active) setScenarioProgressLoading(false);\r\n      }\r\n    }\r\n    loadScenarioProgress();\r\n    return () => {\r\n      active = false;\r\n    };\r\n  }, [selectedSchoolId, scenarios, scenariosSchoolId]);\r\n\r\n  useEffect(() => {\r\n    if (!selectedSchoolId || !selectedScenarioIdLocal) {\r\n      setSelectedScenario(null);\r\n      setInputs(null);\r\n      setReport(null);\r\n      return;\r\n    }\r\n\r\n    let active = true;\r\n    setErr(\"\");\r\n    async function loadScenario() {\r\n      try {\r\n        const data = await api.getScenarioInputs(selectedSchoolId, selectedScenarioIdLocal);\r\n        if (!active) return;\r\n        setSelectedScenario(data?.scenario || null);\r\n        const raw = data?.inputs;\r\n        const normalized =\r\n          raw && typeof raw === \"object\"\r\n            ? normalizeGradesInputs(normalizeTemelBilgilerInputs(normalizeCapacityInputs(raw)))\r\n            : raw;\r\n        setInputs(normalized);\r\n        setReport(null);\r\n      } catch (e) {\r\n        if (!active) return;\r\n        setErr(e.message || \"Senaryo yuklenemedi.\");\r\n      }\r\n    }\r\n\r\n    loadScenario();\r\n    return () => {\r\n      active = false;\r\n    };\r\n  }, [selectedSchoolId, selectedScenarioIdLocal]);\r\n\r\n  const refreshScenarios = useCallback(async () => {\r\n    if (!selectedSchoolId) return null;\r\n    try {\r\n      const sc = await api.listScenarios(selectedSchoolId, {\r\n        limit: 50,\r\n        offset: 0,\r\n        fields: \"brief\",\r\n        order: \"created_at:desc\",\r\n      });\r\n      const rows = Array.isArray(sc?.items) ? sc.items : [];\r\n      setScenarios(rows);\r\n      setScenariosSchoolId(selectedSchoolId);\r\n      return rows;\r\n    } catch (_) {\r\n      return null;\r\n    }\r\n  }, [selectedSchoolId]);\r\n\r\n  const kademeDefs = useMemo(() => getKademeDefinitions(), []);\r\n  const gradeOptions = useMemo(() => getGradeOptions(), []);\r\n\r\n  const draftStartYear = normalizeYearInput(newScenarioStartYear);\r\n  const draftEndYear = normalizeYearInput(newScenarioEndYear);\r\n  const draftAcademicYear = formatAcademicYear(newScenarioPeriod, newScenarioStartYear, newScenarioEndYear);\r\n  const draftRangeOk = newScenarioPeriod === \"full\" || (draftStartYear != null && draftEndYear === draftStartYear + 1);\r\n  const yearConflict = useMemo(() => {\r\n    if (!draftAcademicYear) return false;\r\n    const excludeId =\r\n      scenarioWizardMode === \"edit\"\r\n        ? Number(scenarioWizardScenario?.id || selectedScenarioIdLocal || 0)\r\n        : null;\r\n    return scenarios.some(\r\n      (s) =>\r\n        String(s?.academic_year || \"\").trim() === String(draftAcademicYear).trim() &&\r\n        (excludeId == null || Number(s?.id) !== excludeId)\r\n    );\r\n  }, [draftAcademicYear, scenarios, scenarioWizardMode, scenarioWizardScenario?.id, selectedScenarioIdLocal]);\r\n\r\n  const draftKademeConfig = useMemo(() => normalizeKademeConfig(newScenarioKademeler), [newScenarioKademeler]);\r\n  const hasEnabledKademe = useMemo(\r\n    () => Object.values(draftKademeConfig).some((row) => row && row.enabled),\r\n    [draftKademeConfig]\r\n  );\r\n  const normalizedLocalCode = String(newScenarioLocalCurrencyCode || \"\").trim().toUpperCase();\r\n  const localCodeOk = newScenarioInputCurrency !== \"LOCAL\" || CURRENCY_CODE_REGEX.test(normalizedLocalCode);\r\n  const fxValue = Number(newScenarioFxUsdToLocal);\r\n  const fxOk = newScenarioInputCurrency !== \"LOCAL\" || (Number.isFinite(fxValue) && fxValue > 0);\r\n  const currencyStepOk = newScenarioInputCurrency === \"USD\" || (localCodeOk && fxOk);\r\n  const draftReady =\r\n    Boolean(newScenarioName.trim()) &&\r\n    Boolean(draftAcademicYear) &&\r\n    draftRangeOk &&\r\n    !yearConflict &&\r\n    hasEnabledKademe &&\r\n    currencyStepOk;\r\n  const scenarioStepTotal = 6;\r\n  const scenarioStepLabels = [\r\n    \"Donem Turu\",\r\n    \"Para Birimi\",\r\n    \"Program Turu\",\r\n    \"Yil\",\r\n    \"Kademeler\",\r\n    \"Senaryo Adi\",\r\n  ];\r\n  const scenarioStepOk = [\r\n    true,\r\n    currencyStepOk,\r\n    Boolean(newScenarioProgramType),\r\n    Boolean(draftAcademicYear) && draftRangeOk && !yearConflict,\r\n    hasEnabledKademe,\r\n    draftReady,\r\n  ];\r\n\r\n  const scenarioOpsBusy = Boolean(\r\n    copyingScenarioId ||\r\n    submittingScenarioId ||\r\n    deletingScenarioId ||\r\n    scenarioWizardSaving ||\r\n    scenarioWizardLoading\r\n  );\r\n  const busyRowId = copyingScenarioId ?? submittingScenarioId ?? deletingScenarioId ?? null;\r\n  const selectedRowScenario = useMemo(\r\n    () => scenarios.find((s) => String(s.id) === String(selectedScenarioIdLocal)) || null,\r\n    [scenarios, selectedScenarioIdLocal]\r\n  );\r\n  const sortedScenarios = useMemo(() => {\r\n    if (!scenarioSort.key) return scenarios;\r\n    const indexed = scenarios.map((s, idx) => ({ s, idx }));\r\n    const dirMul = scenarioSort.dir === \"asc\" ? 1 : -1;\r\n\r\n    const getYearParts = (ay) => {\r\n      const m = String(ay || \"\").match(/(\\d{4})(?:\\s*-\\s*(\\d{4}))?/);\r\n      const a = m ? Number(m[1]) : 0;\r\n      const b = m && m[2] ? Number(m[2]) : a;\r\n      return [a || 0, b || 0];\r\n    };\r\n\r\n    const getCurrencyCode = (s) =>\r\n      String(s.input_currency || \"USD\").toUpperCase() === \"LOCAL\"\r\n        ? String(s.local_currency_code || \"LOCAL\").toUpperCase()\r\n        : \"USD\";\r\n\r\n    const getStatusLabel = (status) => {\r\n      switch (status) {\r\n        case 'in_review':\r\n          return 'ncelemede';\r\n        case 'sent_for_approval':\r\n          return 'Onaya Gonderildi';\r\n        case 'submitted':\r\n          return 'Gonderildi';\r\n        case \"revision_requested\":\r\n          return \"Revizyon Istendi\";\r\n        case \"approved\":\r\n          return \"Onaylandi\";\r\n        default:\r\n          return \"Taslak\";\r\n      }\r\n    };\r\n\r\n    indexed.sort((a, b) => {\r\n      const A = a.s;\r\n      const B = b.s;\r\n      let res = 0;\r\n\r\n      switch (scenarioSort.key) {\r\n        case \"name\":\r\n          res = String(A.name || \"\").localeCompare(String(B.name || \"\"), \"tr\", {\r\n            sensitivity: \"base\",\r\n            numeric: true,\r\n          });\r\n          break;\r\n        case \"year\": {\r\n          const [a1, a2] = getYearParts(A.academic_year);\r\n          const [b1, b2] = getYearParts(B.academic_year);\r\n          res = a1 - b1 || a2 - b2;\r\n          break;\r\n        }\r\n        case \"currency\":\r\n          res = getCurrencyCode(A).localeCompare(getCurrencyCode(B), \"tr\", {\r\n            sensitivity: \"base\",\r\n            numeric: true,\r\n          });\r\n          break;\r\n        case \"status\":\r\n          res = getStatusLabel(A.status).localeCompare(getStatusLabel(B.status), \"tr\", {\r\n            sensitivity: \"base\",\r\n            numeric: true,\r\n          });\r\n          break;\r\n        case \"date\":\r\n          res = new Date(A.created_at).getTime() - new Date(B.created_at).getTime();\r\n          break;\r\n        default:\r\n          res = 0;\r\n      }\r\n\r\n      if (res === 0) res = a.idx - b.idx;\r\n      return res * dirMul;\r\n    });\r\n\r\n    return indexed.map((item) => item.s);\r\n  }, [scenarios, scenarioSort]);\r\n  const toggleScenarioSort = (key) => {\r\n    setScenarioSort((prev) =>\r\n      prev.key === key ? { key, dir: prev.dir === \"asc\" ? \"desc\" : \"asc\" } : { key, dir: \"asc\" }\r\n    );\r\n  };\r\n  const getSortAria = (key) => {\r\n    if (scenarioSort.key !== key) return \"none\";\r\n    return scenarioSort.dir === \"asc\" ? \"ascending\" : \"descending\";\r\n  };\r\n  const sortIcon = (key) => {\r\n    if (scenarioSort.key !== key) {\r\n      return (\r\n        <span className=\"sort-icon is-idle\">\r\n          <FaSort aria-hidden=\"true\" />\r\n        </span>\r\n      );\r\n    }\r\n    return (\r\n      <span className=\"sort-icon\">\r\n        {scenarioSort.dir === \"asc\" ? <FaSortUp aria-hidden=\"true\" /> : <FaSortDown aria-hidden=\"true\" />}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const copySectionIds = useMemo(() => getAllCopySectionIds(), []);\r\n  const selectedCopyCount = copySelection\r\n    ? copySectionIds.reduce((sum, id) => sum + (copySelection[id] ? 1 : 0), 0)\r\n    : 0;\r\n  const selIk = !!copySelection?.[\"hr.ik\"];\r\n  const selGiderler = !!copySelection?.[\"expenses.giderler\"];\r\n  const isIkGiderlerValid = selIk === selGiderler;\r\n  const sourceCurrency = String(selectedScenario?.input_currency || \"USD\").toUpperCase();\r\n  const inputCurrencyCode =\r\n    selectedScenario?.input_currency === \"LOCAL\"\r\n      ? selectedScenario.local_currency_code || \"LOCAL\"\r\n      : \"USD\";\r\n  const isLocalScenario = selectedScenario?.input_currency === \"LOCAL\";\r\n  const prevRealFxValue = Number(inputs?.temelBilgiler?.performans?.prevYearRealizedFxUsdToLocal || 0);\r\n  const prevRealFxMissing = isLocalScenario && !(Number.isFinite(prevRealFxValue) && prevRealFxValue > 0);\r\n\r\n  const permissionScope = useMemo(\r\n    () => ({\r\n      countryId: auth.user?.country_id ?? null,\r\n      schoolId: selectedSchoolId != null ? Number(selectedSchoolId) : null,\r\n    }),\r\n    [auth.user?.country_id, selectedSchoolId]\r\n  );\r\n  const role = String(auth.user?.role || \"\");\r\n  const canCreateScenario = can(auth.user, \"scenario.create\", \"write\", permissionScope);\r\n  const canEditScenarioPlan = can(auth.user, \"scenario.plan_edit\", \"write\", permissionScope);\r\n  const canCopyScenario = can(auth.user, \"scenario.copy\", \"write\", permissionScope);\r\n  const canExpenseSplit = can(auth.user, \"scenario.expense_split\", \"write\", permissionScope);\r\n  const canSubmitScenario = can(auth.user, \"scenario.submit\", \"write\", permissionScope);\r\n  const canForwardScenario =\r\n    role === \"manager\" || role === \"accountant\" || can(auth.user, \"scenario.forward\", \"write\", permissionScope);\r\n  const canDeleteScenario = can(auth.user, \"scenario.delete\", \"write\", permissionScope);\r\n\r\n  // Lock editing when the scenario has been forwarded to admins (sent_for_approval)\r\n  // or when it has been adminapproved.  Managerapproved scenarios (status\r\n  // 'approved' with sent_at null) remain editable until they are sent\r\n  // onward via the manager workflow.\r\n  const toolbarLocked = Boolean(selectedRowScenario) && isScenarioLocked(selectedRowScenario);\r\n  const canEditToolbar = Boolean(selectedRowScenario) && !toolbarLocked && canEditScenarioPlan;\r\n  const canDeleteToolbar = Boolean(selectedRowScenario) && !toolbarLocked && canDeleteScenario;\r\n  const isSubmitStage =\r\n    Boolean(selectedRowScenario) &&\r\n    (selectedRowScenario.status === \"draft\" || selectedRowScenario.status === \"revision_requested\");\r\n  const isForwardStage =\r\n    Boolean(selectedRowScenario) && selectedRowScenario.status === \"approved\" && !selectedRowScenario.sent_at;\r\n  const canSubmitToolbar = isSubmitStage && canSubmitScenario;\r\n  const canForwardToolbar = isForwardStage && canForwardScenario;\r\n  const canCopyToolbar = Boolean(selectedRowScenario) && inputs && canCopyScenario;\r\n  const toolbarIsCopying =\r\n    selectedRowScenario && String(copyingScenarioId) === String(selectedRowScenario.id);\r\n  const toolbarIsSubmitting =\r\n    selectedRowScenario && String(submittingScenarioId) === String(selectedRowScenario.id);\r\n  const toolbarIsDeleting =\r\n    selectedRowScenario && String(deletingScenarioId) === String(selectedRowScenario.id);\r\n\r\n  const handleScenarioCurrencyChange = (next) => {\r\n    setNewScenarioInputCurrency(next);\r\n    if (next !== \"LOCAL\") {\r\n      setNewScenarioLocalCurrencyCode(\"\");\r\n      setNewScenarioFxUsdToLocal(\"\");\r\n    }\r\n  };\r\n\r\n  function getScenarioStepError(step) {\r\n    if (step === 1) {\r\n      if (newScenarioInputCurrency === \"LOCAL\") {\r\n        if (!localCodeOk) return \"Local currency code zorunludur.\";\r\n        if (!fxOk) return \"Kur degeri zorunlu ve 0'dan buyuk olmali.\";\r\n      }\r\n    }\r\n    if (step === 2) {\r\n      if (!newScenarioProgramType) return \"Program Turu secilmelidir.\";\r\n    }\r\n    if (step === 3) {\r\n      if (!draftAcademicYear) return \"Lutfen gecerli bir akademik yil girin.\";\r\n      if (!draftRangeOk) return \"Bitis yili, baslangic yilindan 1 fazla olmali.\";\r\n      if (yearConflict) return \"Bu yil turu icin zaten bir senaryo var. Lutfen baska bir yil secin.\";\r\n    }\r\n    if (step === 4 && !hasEnabledKademe) return \"En az bir kademe secmelisiniz.\";\r\n    if (step === 5 && !newScenarioName.trim()) return \"Senaryo adi zorunludur.\";\r\n    return \"\";\r\n  }\r\n\r\n  function goScenarioNext() {\r\n    setErr(\"\");\r\n    if (scenarioWizardSaving) return;\r\n    const msg = getScenarioStepError(newScenarioStep);\r\n    if (msg) {\r\n      setErr(msg);\r\n      return;\r\n    }\r\n    if (newScenarioStep < scenarioStepTotal - 1) {\r\n      setNewScenarioStep((prev) => Math.min(prev + 1, scenarioStepTotal - 1));\r\n      return;\r\n    }\r\n    submitScenarioWizard();\r\n  }\r\n\r\n  function goScenarioBack() {\r\n    setErr(\"\");\r\n    setNewScenarioStep((prev) => Math.max(0, prev - 1));\r\n  }\r\n\r\n  function resetScenarioWizard() {\r\n    setNewScenarioName(\"\");\r\n    setNewScenarioPeriod(\"split\");\r\n    setNewScenarioStartYear(DEFAULT_START_YEAR);\r\n    setNewScenarioEndYear(DEFAULT_END_YEAR);\r\n    setNewScenarioKademeler(getDefaultKademeConfig());\r\n    setNewScenarioInputCurrency(\"USD\");\r\n    setNewScenarioLocalCurrencyCode(\"\");\r\n    setNewScenarioFxUsdToLocal(\"\");\r\n    setNewScenarioProgramType(null);\r\n    setNewScenarioStep(0);\r\n  }\r\n\r\n  function closeScenarioWizard() {\r\n    setErr(\"\");\r\n    setScenarioWizardOpen(false);\r\n    setScenarioWizardLoading(false);\r\n    setScenarioWizardSaving(false);\r\n    setNewScenarioStep(0);\r\n  }\r\n\r\n  function openScenarioWizardCreate() {\r\n    if (!canCreateScenario) return;\r\n    if (!selectedSchoolId) {\r\n      setErr(\"Once okul secin.\");\r\n      return;\r\n    }\r\n    setErr(\"\");\r\n    resetScenarioWizard();\r\n    setScenarioWizardMode(\"create\");\r\n    setScenarioWizardScenario(null);\r\n    setScenarioWizardOpen(true);\r\n  }\r\n\r\n  async function openScenarioWizardEdit(scenarioId) {\r\n    if (!canEditScenarioPlan) return;\r\n    if (!selectedSchoolId) return;\r\n    setErr(\"\");\r\n    const targetScenario = scenarios.find((s) => String(s.id) === String(scenarioId));\r\n    if (targetScenario && isScenarioLocked(targetScenario)) {\r\n      setErr(\"Senaryo onayda veya onaylandi, duzenlenemez.\");\r\n      return;\r\n    }\r\n    setSelectedScenarioIdLocal(scenarioId);\r\n    setScenarioWizardMode(\"edit\");\r\n    setScenarioWizardScenario(null);\r\n    setScenarioWizardOpen(true);\r\n    setScenarioWizardLoading(true);\r\n    setNewScenarioStep(0);\r\n    try {\r\n      const data = await api.getScenarioInputs(selectedSchoolId, scenarioId);\r\n      const scenario = data?.scenario;\r\n      if (!scenario) throw new Error(\"Senaryo bulunamadi.\");\r\n      setScenarioWizardScenario(scenario);\r\n      setNewScenarioName(scenario.name || \"\");\r\n      const years = parseAcademicYear(scenario.academic_year);\r\n      if (years.startYear && years.endYear && years.endYear !== years.startYear) {\r\n        setNewScenarioPeriod(\"split\");\r\n        setNewScenarioStartYear(String(years.startYear));\r\n        setNewScenarioEndYear(String(years.endYear));\r\n      } else if (years.startYear) {\r\n        setNewScenarioPeriod(\"full\");\r\n        setNewScenarioStartYear(String(years.startYear));\r\n        setNewScenarioEndYear(String(years.startYear + 1));\r\n      } else {\r\n        setNewScenarioPeriod(\"split\");\r\n        setNewScenarioStartYear(DEFAULT_START_YEAR);\r\n        setNewScenarioEndYear(DEFAULT_END_YEAR);\r\n      }\r\n      const existingKademe = data?.inputs?.temelBilgiler?.kademeler;\r\n      setNewScenarioKademeler(\r\n        existingKademe ? normalizeKademeConfig(existingKademe) : getDefaultKademeConfig()\r\n      );\r\n      const scenarioCurrency = scenario.input_currency || \"USD\";\r\n      setNewScenarioInputCurrency(scenarioCurrency);\r\n      setNewScenarioLocalCurrencyCode(scenario.local_currency_code || \"\");\r\n      setNewScenarioFxUsdToLocal(\r\n        scenario.fx_usd_to_local != null ? String(scenario.fx_usd_to_local) : \"\"\r\n      );\r\n      setNewScenarioProgramType(scenario.program_type || PROGRAM_TYPES.LOCAL);\r\n    } catch (e) {\r\n      setErr(e.message || \"Senaryo yuklenemedi.\");\r\n      setScenarioWizardOpen(false);\r\n    } finally {\r\n      setScenarioWizardLoading(false);\r\n    }\r\n  }\r\n\r\n  async function submitScenarioWizard() {\r\n    if (scenarioWizardMode === \"edit\") {\r\n      await updateScenario();\r\n      return;\r\n    }\r\n    await createScenario();\r\n  }\r\n\r\n  async function createScenario() {\r\n    if (!selectedSchoolId) return;\r\n    const name = newScenarioName.trim();\r\n    if (!name) return;\r\n    if (!draftAcademicYear) {\r\n      setErr(\"Lutfen gecerli bir akademik yil girin.\");\r\n      return;\r\n    }\r\n    if (!draftRangeOk) {\r\n      setErr(\"Bitis yili, baslangic yilindan 1 fazla olmali.\");\r\n      return;\r\n    }\r\n    if (yearConflict) {\r\n      setErr(\"Bu yil turu icin zaten bir senaryo var. Lutfen baska bir yil secin.\");\r\n      return;\r\n    }\r\n    if (!hasEnabledKademe) {\r\n      setErr(\"En az bir kademe secmelisiniz.\");\r\n      return;\r\n    }\r\n    if (newScenarioInputCurrency === \"LOCAL\") {\r\n      if (!localCodeOk) {\r\n        setErr(\"Local currency code zorunludur.\");\r\n        return;\r\n      }\r\n      if (!fxOk) {\r\n        setErr(\"Kur degeri zorunlu ve 0'dan buyuk olmali.\");\r\n        return;\r\n      }\r\n    }\r\n    setErr(\"\");\r\n    setScenarioWizardSaving(true);\r\n    try {\r\n      const scenarioProgramType = newScenarioProgramType || PROGRAM_TYPES.LOCAL;\r\n      const kademeConfig = normalizeKademeConfig(newScenarioKademeler);\r\n      const created = await api.createScenario(selectedSchoolId, {\r\n        name,\r\n        academicYear: draftAcademicYear,\r\n        kademeConfig,\r\n        inputCurrency: newScenarioInputCurrency,\r\n        localCurrencyCode: newScenarioInputCurrency === \"LOCAL\" ? normalizedLocalCode : null,\r\n        fxUsdToLocal: newScenarioInputCurrency === \"LOCAL\" ? newScenarioFxUsdToLocal : null,\r\n        programType: scenarioProgramType,\r\n      });\r\n      await refreshScenarios();\r\n      setSelectedScenarioIdLocal(created.id);\r\n      setScenarioWizardOpen(false);\r\n      setNewScenarioStep(0);\r\n    } catch (e) {\r\n      setErr(e.message || \"Senaryo olusturulamadi.\");\r\n    } finally {\r\n      setScenarioWizardSaving(false);\r\n    }\r\n  }\r\n\r\n  async function updateScenario() {\r\n    if (!selectedSchoolId || !scenarioWizardScenario?.id) return;\r\n    const name = newScenarioName.trim();\r\n    if (!name) return;\r\n    if (!draftAcademicYear) {\r\n      setErr(\"Lutfen gecerli bir akademik yil girin.\");\r\n      return;\r\n    }\r\n    if (!draftRangeOk) {\r\n      setErr(\"Bitis yili, baslangic yilindan 1 fazla olmali.\");\r\n      return;\r\n    }\r\n    if (yearConflict) {\r\n      setErr(\"Bu yil turu icin zaten bir senaryo var. Lutfen baska bir yil secin.\");\r\n      return;\r\n    }\r\n    if (!hasEnabledKademe) {\r\n      setErr(\"En az bir kademe secmelisiniz.\");\r\n      return;\r\n    }\r\n    if (scenarioWizardScenario?.input_currency === \"LOCAL\") {\r\n      if (!localCodeOk) {\r\n        setErr(\"Local currency code zorunludur.\");\r\n        return;\r\n      }\r\n      if (!fxOk) {\r\n        setErr(\"Kur degeri zorunlu ve 0'dan buyuk olmali.\");\r\n        return;\r\n      }\r\n    }\r\n    setErr(\"\");\r\n    setScenarioWizardSaving(true);\r\n    try {\r\n      const scenarioProgramType = newScenarioProgramType || PROGRAM_TYPES.LOCAL;\r\n      const kademeConfig = normalizeKademeConfig(newScenarioKademeler);\r\n      await api.updateScenario(selectedSchoolId, scenarioWizardScenario.id, {\r\n        name,\r\n        academicYear: draftAcademicYear,\r\n        kademeConfig,\r\n        programType: scenarioProgramType,\r\n        localCurrencyCode:\r\n          scenarioWizardScenario?.input_currency === \"LOCAL\" ? normalizedLocalCode : undefined,\r\n        fxUsdToLocal:\r\n          scenarioWizardScenario?.input_currency === \"LOCAL\" ? newScenarioFxUsdToLocal : undefined,\r\n      });\r\n      await refreshScenarios();\r\n      setSelectedScenarioIdLocal(scenarioWizardScenario.id);\r\n      setSelectedScenario((prev) =>\r\n        prev && prev.id === scenarioWizardScenario.id\r\n          ? {\r\n            ...prev,\r\n            name,\r\n            academic_year: draftAcademicYear,\r\n            program_type: scenarioProgramType,\r\n            ...(scenarioWizardScenario?.input_currency === \"LOCAL\"\r\n              ? { local_currency_code: normalizedLocalCode, fx_usd_to_local: fxValue }\r\n              : {}),\r\n          }\r\n          : prev\r\n      );\r\n      setInputs((prev) => {\r\n        if (!prev || typeof prev !== \"object\") return prev;\r\n        const next = structuredClone(prev);\r\n        next.temelBilgiler = next.temelBilgiler || {};\r\n        next.temelBilgiler.kademeler = kademeConfig;\r\n        next.temelBilgiler.programType = scenarioProgramType;\r\n        return next;\r\n      });\r\n      setScenarioWizardOpen(false);\r\n      setNewScenarioStep(0);\r\n    } catch (e) {\r\n      setErr(e.message || \"Senaryo guncellenemedi.\");\r\n    } finally {\r\n      setScenarioWizardSaving(false);\r\n    }\r\n  }\r\n\r\n  const updateNewKademe = (key, patch) => {\r\n    setNewScenarioKademeler((prev) => {\r\n      const base = normalizeKademeConfig(prev);\r\n      const next = { ...base, [key]: { ...base[key], ...patch } };\r\n      return normalizeKademeConfig(next);\r\n    });\r\n  };\r\n\r\n  const parseFxInput = (value) => {\r\n    const raw = String(value ?? \"\").trim();\r\n    if (!raw) return NaN;\r\n    const normalized = raw.replace(\",\", \".\");\r\n    const match = normalized.match(/-?\\d+(?:\\.\\d+)?/);\r\n    if (!match) return NaN;\r\n    const num = Number.parseFloat(match[0]);\r\n    return Number.isFinite(num) ? num : NaN;\r\n  };\r\n\r\n  const showCopySelectionMsg = (message) => {\r\n    if (copySelectionMsgTimerRef.current) {\r\n      clearTimeout(copySelectionMsgTimerRef.current);\r\n    }\r\n    setCopySelectionMsg(message);\r\n    copySelectionMsgTimerRef.current = setTimeout(() => {\r\n      setCopySelectionMsg(\"\");\r\n    }, 2000);\r\n  };\r\n\r\n  const applyPresetSelection = (presetKey) => {\r\n    setCopySelection(buildDefaultCopySelection(presetKey));\r\n    setCopySelectionMsg(\"\");\r\n  };\r\n\r\n  const toggleCopySelection = (id, value) => {\r\n    if (scenarioOpsBusy) return;\r\n    setCopySelection((prev) => {\r\n      const base = prev || buildDefaultCopySelection(\"all\");\r\n      const next = { ...base };\r\n      if (id === \"hr.ik\" || id === \"expenses.giderler\") {\r\n        next[\"hr.ik\"] = value;\r\n        next[\"expenses.giderler\"] = value;\r\n        showCopySelectionMsg(`IK ve Giderler birlikte ${value ? \"secildi\" : \"kaldirildi\"}.`);\r\n      } else {\r\n        next[id] = value;\r\n      }\r\n      return enforceIkGiderlerPair(next);\r\n    });\r\n  };\r\n\r\n  const setCopyTabSelectionAll = (tabKey, value) => {\r\n    if (scenarioOpsBusy) return;\r\n    const tab = COPY_SELECT_TABS.find((entry) => entry.key === tabKey);\r\n    if (!tab) return;\r\n    setCopySelection((prev) => {\r\n      const base = prev || buildDefaultCopySelection(\"all\");\r\n      const next = { ...base };\r\n      tab.sections.forEach((section) => {\r\n        next[section.id] = value;\r\n      });\r\n      return enforceIkGiderlerPair(next);\r\n    });\r\n  };\r\n\r\n  function openCopyScenarioModal() {\r\n    if (!canCopyScenario) return;\r\n    if (!selectedScenarioIdLocal || !selectedScenario || !inputs) return;\r\n    if (copyingScenarioId) return;\r\n    setErr(\"\");\r\n    setCopyModalError(\"\");\r\n    setCopySelection(buildDefaultCopySelection(\"all\"));\r\n    setCopySelectionMsg(\"\");\r\n    setCopyTargetCurrency(sourceCurrency === \"LOCAL\" ? \"LOCAL\" : \"USD\");\r\n    setCopyLocalCurrencyCode(\"\");\r\n    setCopyPlannedFxUsdToLocal(\"\");\r\n    setCopyFxUsdToLocal(\"\");\r\n    setCopyModalOpen(true);\r\n  }\r\n\r\n  function closeCopyScenarioModal() {\r\n    setCopyModalOpen(false);\r\n    setCopyModalError(\"\");\r\n  }\r\n\r\n  async function confirmCopyScenarioModal() {\r\n    if (!copySelection) return;\r\n    if (copyingScenarioId) return;\r\n    const selection = enforceIkGiderlerPair(copySelection);\r\n\r\n    const targetCurrency = String(copyTargetCurrency || sourceCurrency).toUpperCase();\r\n    let localCurrencyCodeValue = null;\r\n    let plannedFxUsdToLocalValue = null;\r\n    let copyFxUsdToLocalValue = null;\r\n\r\n    if (sourceCurrency === \"USD\" && targetCurrency === \"LOCAL\") {\r\n      const normalizedLocalCode = String(copyLocalCurrencyCode || \"\")\r\n        .toUpperCase()\r\n        .replace(/[^A-Z0-9]/g, \"\")\r\n        .slice(0, 10);\r\n      if (!CURRENCY_CODE_REGEX.test(normalizedLocalCode)) {\r\n        setCopyModalError(\"Local para birimi kodu gecersiz.\");\r\n        return;\r\n      }\r\n      const plannedFxNumber = parseFxInput(copyPlannedFxUsdToLocal);\r\n      if (!Number.isFinite(plannedFxNumber) || plannedFxNumber <= 0) {\r\n        setCopyModalError(\"Gecerli bir kur girilmelidir.\");\r\n        return;\r\n      }\r\n      const copyFxNumber = parseFxInput(copyFxUsdToLocal);\r\n      if (!Number.isFinite(copyFxNumber) || copyFxNumber <= 0) {\r\n        setCopyModalError(\"Gecerli bir kopyalama kuru girilmelidir.\");\r\n        return;\r\n      }\r\n      localCurrencyCodeValue = normalizedLocalCode;\r\n      plannedFxUsdToLocalValue = plannedFxNumber;\r\n      copyFxUsdToLocalValue = copyFxNumber;\r\n    }\r\n\r\n    if (sourceCurrency === \"LOCAL\" && targetCurrency === \"USD\") {\r\n      const copyFxNumber = parseFxInput(copyFxUsdToLocal);\r\n      if (!Number.isFinite(copyFxNumber) || copyFxNumber <= 0) {\r\n        setCopyModalError(\"Gecerli bir kopyalama kuru girilmelidir.\");\r\n        return;\r\n      }\r\n      copyFxUsdToLocalValue = copyFxNumber;\r\n    }\r\n\r\n    closeCopyScenarioModal();\r\n    await copySelectedScenario({\r\n      targetCurrency,\r\n      localCurrencyCode: localCurrencyCodeValue,\r\n      plannedFxUsdToLocal: plannedFxUsdToLocalValue,\r\n      copyFxUsdToLocal: copyFxUsdToLocalValue,\r\n      selection,\r\n    });\r\n  }\r\n\r\n  async function copySelectedScenario(copyOptions = {}) {\r\n    if (!canCopyScenario) return;\r\n    if (!selectedScenarioIdLocal || !selectedScenario || !inputs) return;\r\n    if (copyingScenarioId) return;\r\n    if (!selectedScenario.academic_year) {\r\n      setErr(\"Akademik yil bulunamadi.\");\r\n      return;\r\n    }\r\n\r\n    setErr(\"\");\r\n    const selection = enforceIkGiderlerPair(copyOptions?.selection || buildDefaultCopySelection(\"all\"));\r\n    if (!!selection[\"hr.ik\"] !== !!selection[\"expenses.giderler\"]) {\r\n      toast.warn(\"IK ve Giderler birlikte secilmelidir.\");\r\n      return;\r\n    }\r\n    const targetCurrency = String(copyOptions?.targetCurrency || sourceCurrency).toUpperCase();\r\n    let localCurrencyCode = copyOptions?.localCurrencyCode ?? null;\r\n    let plannedFxUsdToLocal = copyOptions?.plannedFxUsdToLocal ?? null;\r\n    let copyFxUsdToLocal = copyOptions?.copyFxUsdToLocal ?? null;\r\n    let plannedFxParsed = parseFxInput(plannedFxUsdToLocal);\r\n    let copyFxParsed = parseFxInput(copyFxUsdToLocal);\r\n\r\n    if (sourceCurrency === \"LOCAL\" && targetCurrency === \"LOCAL\") {\r\n      localCurrencyCode = localCurrencyCode ?? selectedScenario.local_currency_code ?? \"\";\r\n      plannedFxUsdToLocal = plannedFxUsdToLocal ?? selectedScenario.fx_usd_to_local;\r\n      plannedFxParsed = parseFxInput(plannedFxUsdToLocal);\r\n    }\r\n\r\n    if (sourceCurrency === \"LOCAL\" && targetCurrency === \"USD\") {\r\n      copyFxUsdToLocal = copyFxUsdToLocal ?? selectedScenario.fx_usd_to_local;\r\n      copyFxParsed = parseFxInput(copyFxUsdToLocal);\r\n      if (!Number.isFinite(copyFxParsed) || copyFxParsed <= 0) {\r\n        toast.warn(\"Gecerli bir kopyalama kuru girilmelidir.\");\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (sourceCurrency === \"USD\" && targetCurrency === \"LOCAL\") {\r\n      if (!localCurrencyCode || !CURRENCY_CODE_REGEX.test(localCurrencyCode)) {\r\n        toast.warn(\"Local para birimi kodu gecersiz.\");\r\n        return;\r\n      }\r\n      if (!Number.isFinite(plannedFxParsed) || plannedFxParsed <= 0) {\r\n        toast.warn(\"Gecerli bir kur girilmelidir.\");\r\n        return;\r\n      }\r\n      if (!Number.isFinite(copyFxParsed) || copyFxParsed <= 0) {\r\n        toast.warn(\"Gecerli bir kopyalama kuru girilmelidir.\");\r\n        return;\r\n      }\r\n    }\r\n\r\n    setCopyingScenarioId(selectedScenarioIdLocal);\r\n    try {\r\n      const baseName = selectedScenario.name || \"Senaryo\";\r\n      const copyName = `${baseName} (Kopya)`;\r\n      let candidateYear = incrementAcademicYearString(selectedScenario.academic_year);\r\n      if (!candidateYear) {\r\n        throw new Error(\"Akademik yil formati gecersiz.\");\r\n      }\r\n      let guard = 0;\r\n      const hasAcademicYear = (yearStr) =>\r\n        scenarios.some((s) => String(s?.academic_year || \"\").trim() === String(yearStr).trim());\r\n\r\n      while (hasAcademicYear(candidateYear)) {\r\n        candidateYear = incrementAcademicYearString(candidateYear);\r\n        guard += 1;\r\n        if (!candidateYear || guard > 20) {\r\n          throw new Error(\"Uygun yeni akademik yil bulunamadi.\");\r\n        }\r\n      }\r\n\r\n      const shouldCopyCore = !!selection[\"temel.core\"];\r\n      const kademeConfig = normalizeKademeConfig(\r\n        shouldCopyCore ? inputs?.temelBilgiler?.kademeler || getDefaultKademeConfig() : getDefaultKademeConfig()\r\n      );\r\n      const programType = shouldCopyCore\r\n        ? selectedScenario?.program_type || PROGRAM_TYPES.LOCAL\r\n        : PROGRAM_TYPES.LOCAL;\r\n      const fxForCreate =\r\n        targetCurrency === \"LOCAL\" && Number.isFinite(plannedFxParsed) && plannedFxParsed > 0\r\n          ? plannedFxParsed\r\n          : null;\r\n      const created = await api.createScenario(selectedSchoolId, {\r\n        name: copyName,\r\n        academicYear: candidateYear,\r\n        kademeConfig,\r\n        inputCurrency: targetCurrency,\r\n        localCurrencyCode: targetCurrency === \"LOCAL\" ? localCurrencyCode || \"\" : null,\r\n        fxUsdToLocal: fxForCreate,\r\n        programType,\r\n      });\r\n\r\n      let clonedInputs = filterInputsForCopyBySelection(inputs, selection);\r\n      if (selection[\"hr.ik\"] && selection[\"expenses.giderler\"]) {\r\n        clonedInputs = applyIkSalariesToGiderler(clonedInputs);\r\n      }\r\n      clonedInputs = normalizeTemelBilgilerInputs(clonedInputs);\r\n      clonedInputs = normalizeCapacityInputs(clonedInputs);\r\n      clonedInputs = normalizeGradesInputs(clonedInputs);\r\n\r\n      if (sourceCurrency === \"USD\" && targetCurrency === \"LOCAL\") {\r\n        clonedInputs = convertInputsUsdToLocalForCopy(clonedInputs, copyFxParsed);\r\n        clonedInputs.temelBilgiler = clonedInputs.temelBilgiler || {};\r\n        clonedInputs.temelBilgiler.performans = clonedInputs.temelBilgiler.performans || {};\r\n        clonedInputs.temelBilgiler.performans.prevYearRealizedFxUsdToLocal = Number(copyFxParsed);\r\n      }\r\n\r\n      if (sourceCurrency === \"LOCAL\" && targetCurrency === \"USD\") {\r\n        clonedInputs = convertInputsLocalToUsdForCopy(clonedInputs, copyFxParsed);\r\n        clonedInputs.temelBilgiler = clonedInputs.temelBilgiler || {};\r\n        clonedInputs.temelBilgiler.performans = clonedInputs.temelBilgiler.performans || {};\r\n        clonedInputs.temelBilgiler.performans.prevYearRealizedFxUsdToLocal = Number(copyFxParsed);\r\n      }\r\n\r\n      // Determine which permission resources are modified based on the user's selection.  The\r\n      // backend requires a list of modifiedResources for nonadmin users to enforce\r\n      // granular write permissions.  Without this list, principals and managers\r\n      // would be blocked from copying scenarios.  See COPY_SECTION_RESOURCES\r\n      // mapping above for how selection keys map to permission resources.\r\n      const modifiedResources = buildModifiedResourcesFromCopySelection(selection);\r\n      await api.saveScenarioInputs(selectedSchoolId, created.id, clonedInputs, modifiedResources);\r\n\r\n      if (selection[\"norm.lessonY1\"]) {\r\n        try {\r\n          const sourceNorm = await api.getNormConfig(selectedSchoolId, selectedScenarioIdLocal);\r\n          if (sourceNorm) {\r\n            const sourceYears = sourceNorm?.years && typeof sourceNorm.years === \"object\" ? sourceNorm.years : {};\r\n            const baseHours = Number(\r\n              sourceYears?.y1?.teacherWeeklyMaxHours ??\r\n                sourceNorm?.teacherWeeklyMaxHours ??\r\n                24\r\n            );\r\n            const y1 = sourceYears?.y1\r\n              ? structuredClone(sourceYears.y1)\r\n              : {\r\n                teacherWeeklyMaxHours: Number.isFinite(baseHours) && baseHours > 0 ? baseHours : 24,\r\n                curriculumWeeklyHours:\r\n                  sourceNorm?.curriculumWeeklyHours && typeof sourceNorm.curriculumWeeklyHours === \"object\"\r\n                    ? structuredClone(sourceNorm.curriculumWeeklyHours)\r\n                    : buildEmptyNormCurriculum(),\r\n              };\r\n            const payload = {\r\n              years: {\r\n                y1,\r\n                y2: buildEmptyNormYear(baseHours),\r\n                y3: buildEmptyNormYear(baseHours),\r\n              },\r\n            };\r\n            await api.saveNormConfig(selectedSchoolId, created.id, payload);\r\n          }\r\n        } catch (err) {\r\n          console.warn(\"[copyScenario] norm copy skipped\", err);\r\n        }\r\n      }\r\n\r\n      await refreshScenarios();\r\n      setSelectedScenarioIdLocal(created.id);\r\n      toast.success(\"Senaryo kopyalandi.\");\r\n    } catch (e) {\r\n      setErr(e.message || \"Scenario copy failed\");\r\n    } finally {\r\n      setCopyingScenarioId(null);\r\n    }\r\n  }\r\n\r\n  function openDeleteScenarioModal(scenarioId) {\r\n    if (!canDeleteScenario) return;\r\n    if (!scenarioId || scenarioOpsBusy) return;\r\n    setDeleteConfirmScenarioId(scenarioId);\r\n  }\r\n\r\n  async function confirmDeleteScenario() {\r\n    if (!deleteConfirmScenarioId) return;\r\n    const scenarioId = deleteConfirmScenarioId;\r\n    setDeleteConfirmScenarioId(null);\r\n    await deleteScenario(scenarioId);\r\n  }\r\n\r\n  async function deleteScenario(scenarioId) {\r\n    if (!canDeleteScenario) return;\r\n    if (!selectedSchoolId || !scenarioId) return;\r\n    if (scenarioOpsBusy) return;\r\n    const target = scenarios.find((s) => String(s.id) === String(scenarioId));\r\n    if (!target) return;\r\n    if (isScenarioLocked(target)) {\r\n      setErr(\"Senaryo onayda veya onaylandi, silinemez.\");\r\n      return;\r\n    }\r\n\r\n    setErr(\"\");\r\n    setDeletingScenarioId(scenarioId);\r\n    try {\r\n      await api.deleteScenario(selectedSchoolId, scenarioId);\r\n      const sc = await refreshScenarios();\r\n      if (Array.isArray(sc)) {\r\n        if (!sc.length) {\r\n          setSelectedScenarioIdLocal(null);\r\n          setInputs(null);\r\n          setReport(null);\r\n        } else if (!sc.some((s) => String(s.id) === String(selectedScenarioIdLocal))) {\r\n          setSelectedScenarioIdLocal(sc[0].id);\r\n        }\r\n      }\r\n      toast.success(\"Senaryo silindi.\");\r\n    } catch (e) {\r\n      setErr(e.message || \"Senaryo silinemedi.\");\r\n    } finally {\r\n      setDeletingScenarioId(null);\r\n    }\r\n  }\r\n\r\n  function sumPlannedStudents(grades) {\r\n    const list = Array.isArray(grades) ? grades : [];\r\n    let sum = 0;\r\n    for (const row of list) {\r\n      const n = Number(row?.studentsPerBranch ?? 0);\r\n      if (Number.isFinite(n)) sum += n;\r\n    }\r\n    return sum;\r\n  }\r\n\r\n  function getPlannedStudentTotalsByYear(srcInputs) {\r\n    const s = srcInputs && typeof srcInputs === \"object\" ? srcInputs : {};\r\n    const years = s.gradesYears && typeof s.gradesYears === \"object\" ? s.gradesYears : {};\r\n    return {\r\n      y1: sumPlannedStudents(Array.isArray(years.y1) ? years.y1 : s.grades),\r\n      y2: sumPlannedStudents(years.y2),\r\n      y3: sumPlannedStudents(years.y3),\r\n    };\r\n  }\r\n\r\n  function showBlockingToast(message, toastId = \"blocking-toast\") {\r\n    toast.warn(message, {\r\n      toastId,\r\n      position: \"bottom-right\",\r\n      autoClose: false,\r\n      closeOnClick: false,\r\n      draggable: true,\r\n      icon: \"!\",\r\n      style: {\r\n        background: \"rgba(15, 23, 42, 0.96)\",\r\n        color: \"#f8fafc\",\r\n        border: \"1px solid rgba(251, 191, 36, 0.35)\",\r\n        boxShadow: \"0 18px 40px rgba(0,0,0,.28)\",\r\n        borderRadius: 14,\r\n      },\r\n    });\r\n  }\r\n\r\n  function ensurePlanningStudentsForY2Y3(actionLabel = \"Islem\") {\r\n    if (!inputs) return true;\r\n\r\n    const totals = getPlannedStudentTotalsByYear(inputs);\r\n    const missing = [];\r\n    if (!(totals.y2 > 0)) missing.push(\"Y2\");\r\n    if (!(totals.y3 > 0)) missing.push(\"Y3\");\r\n    if (!missing.length) return true;\r\n\r\n    const msg =\r\n      `${actionLabel} yapilamaz: Norm > Planlanan Donem Bilgileri bolumunde ` +\r\n      `${missing.join(\" ve \")} toplam ogrenci 0 gorunuyor. Lutfen Y2/Y3 ogrenci sayilarini girin.`;\r\n\r\n    setErr(\"\");\r\n    showBlockingToast(msg, \"norm-y2y3-missing\");\r\n    return false;\r\n  }\r\n\r\n  function ensurePrevRealFxForLocal(actionLabel = \"Islem\") {\r\n    if (!inputs) return true;\r\n    if (!isLocalScenario) return true;\r\n    if (!prevRealFxMissing) return true;\r\n\r\n    const msg =\r\n      `${actionLabel} yapilamaz: Temel Bilgiler > Performans alanindaki ` +\r\n      `\"Onceki Donem Ortalama Kur (Gerceklesen)\" girilmelidir.`;\r\n\r\n    setErr(\"\");\r\n    showBlockingToast(msg, \"prev-realized-fx-missing\");\r\n    return false;\r\n  }\r\n\r\n  async function calculate(options = {}) {\r\n    if (!selectedSchoolId || !selectedScenarioIdLocal) return false;\r\n    if (!ensurePrevRealFxForLocal(\"Hesaplama\")) return false;\r\n    if (!options.skipPlanValidation && !ensurePlanningStudentsForY2Y3(\"Hesaplama\")) return false;\r\n    setCalculating(true);\r\n    setErr(\"\");\r\n    let ok = false;\r\n    try {\r\n      const data = await api.calculateScenario(selectedSchoolId, selectedScenarioIdLocal);\r\n      setReport(data.results);\r\n      ok = true;\r\n    } catch (e) {\r\n      setErr(e.message || \"Calculation failed\");\r\n    } finally {\r\n      setCalculating(false);\r\n    }\r\n    return ok;\r\n  }\r\n\r\n  async function submitScenarioForApproval(scenarioId) {\r\n    if (!canSubmitScenario) return;\r\n    if (!selectedSchoolId || !scenarioId || scenarioId !== selectedScenarioIdLocal) return;\r\n    const status = String(selectedScenario?.status || \"draft\");\r\n    if (![\"draft\", \"revision_requested\"].includes(status)) {\r\n      setErr(\"Senaryo onayda veya onaylandi, gonderilemez.\");\r\n      return;\r\n    }\r\n    if (!ensurePrevRealFxForLocal(\"Onaya gonderme\")) return;\r\n    if (!ensurePlanningStudentsForY2Y3(\"Onaya gonderme\")) return;\r\n    if (submittingScenarioId) return;\r\n\r\n    setErr(\"\");\r\n    setSubmittingScenarioId(scenarioId);\r\n    try {\r\n      const calcOk = await calculate({ keepTab: true });\r\n      if (!calcOk) return;\r\n      const data = await api.submitScenario(selectedSchoolId, scenarioId);\r\n      toast.success(\"Senaryo onaya gonderildi.\");\r\n      if (data?.scenario) {\r\n        setSelectedScenario((prev) => ({ ...(prev || {}), ...data.scenario }));\r\n      }\r\n      await refreshScenarios();\r\n    } catch (e) {\r\n      setErr(e.message || \"Submit failed\");\r\n    } finally {\r\n      setSubmittingScenarioId(null);\r\n    }\r\n  }\r\n\r\n  async function sendScenarioForApproval(scenarioId) {\r\n    if (!canForwardScenario) return;\r\n    if (!selectedSchoolId || !scenarioId || scenarioId !== selectedScenarioIdLocal) return;\r\n    const status = String(selectedScenario?.status || \"draft\");\r\n    if (status !== \"approved\" || selectedScenario?.sent_at) {\r\n      setErr(\"Senaryo merkeze iletilemez.\");\r\n      return;\r\n    }\r\n    if (!ensurePrevRealFxForLocal(\"Merkeze iletme\")) return;\r\n    if (!ensurePlanningStudentsForY2Y3(\"Merkeze iletme\")) return;\r\n    if (submittingScenarioId) return;\r\n\r\n    setErr(\"\");\r\n    setSubmittingScenarioId(scenarioId);\r\n    try {\r\n      const calcOk = await calculate({ keepTab: true });\r\n      if (!calcOk) return;\r\n      const data = await api.sendForApproval(selectedSchoolId, scenarioId);\r\n      toast.success(\"Merkeze iletildi\");\r\n      if (data?.scenario) {\r\n        setSelectedScenario((prev) => ({ ...(prev || {}), ...data.scenario }));\r\n      }\r\n      await refreshScenarios();\r\n    } catch (e) {\r\n      setErr(e.message || \"Gonderme basarisiz\");\r\n    } finally {\r\n      setSubmittingScenarioId(null);\r\n    }\r\n  }\r\n\r\n  const deleteConfirmScenario =\r\n    deleteConfirmScenarioId != null\r\n      ? scenarios.find((s) => String(s.id) === String(deleteConfirmScenarioId))\r\n      : null;\r\n  const deleteConfirmLabel = deleteConfirmScenario?.name\r\n    ? `\"${deleteConfirmScenario.name}\"`\r\n    : \"Senaryo\";\r\n  const deleteConfirmMessage =\r\n    deleteConfirmScenarioId != null &&\r\n      String(deleteConfirmScenarioId) === String(selectedScenarioIdLocal) &&\r\n      scenarios.length <= 1\r\n      ? `${deleteConfirmLabel} son senaryo. Silerseniz senaryo secimi temizlenir.`\r\n      : `${deleteConfirmLabel} silinecek. Devam edilsin mi?`;\r\n\r\n  const handleApply = () => {\r\n    if (!selectedSchoolId || !selectedScenarioIdLocal) return;\r\n    // Persist the selected scenario. Regardless of which scenario the user\r\n    // chooses, navigate to the globally last viewed sidebar page. This ensures\r\n    // that when switching schools or scenarios the user lands on the same\r\n    // section (e.g. Gelirler). If no global route has been recorded, default\r\n    // to the \"temel-bilgiler\" page.\r\n    // Persist the selected scenario for the chosen school.  Also write\r\n    // the last active school ID so that the sidebar can immediately\r\n    // render navigation items without requiring a page refresh.  Without\r\n    // this call, users have reported that the nav menu only appears\r\n    // after refreshing the page.  See issue reported by testers.\r\n    writeSelectedScenarioId(selectedSchoolId, selectedScenarioIdLocal);\r\n    writeLastActiveSchoolId(selectedSchoolId);\r\n    const seg = readGlobalLastRouteSegment() || \"temel-bilgiler\";\r\n    navigate(`/schools/${selectedSchoolId}/${seg}`, { replace: true });\r\n  };\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <ToastContainer position=\"bottom-right\" autoClose={3500} newestOnTop closeOnClick pauseOnFocusLoss pauseOnHover hideProgressBar theme=\"dark\" />\r\n      <style>{`@keyframes schoolSpin{to{transform:rotate(360deg)}}`}</style>\r\n\r\n      {err ? (\r\n        <div className=\"card\" style={{ marginTop: 10, background: \"#fff1f2\", borderColor: \"#fecaca\" }}>\r\n          {err}\r\n        </div>\r\n      ) : null}\r\n\r\n      {deleteConfirmScenarioId ? (\r\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\r\n          <div className=\"modal\">\r\n            <div style={{ fontWeight: 700, marginBottom: 8 }}>Senaryo Sil</div>\r\n            <div className=\"small\">{deleteConfirmMessage}</div>\r\n            <div className=\"row\" style={{ justifyContent: \"flex-end\", marginTop: 12 }}>\r\n              <button className=\"btn\" onClick={() => setDeleteConfirmScenarioId(null)} disabled={scenarioOpsBusy}>\r\n                Iptal\r\n              </button>\r\n              <button className=\"btn danger\" onClick={confirmDeleteScenario} disabled={scenarioOpsBusy}>\r\n                Sil\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {copyModalOpen ? (\r\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\r\n          <div\r\n            className=\"modal\"\r\n            style={{\r\n              width: \"min(980px, 96vw)\",\r\n              maxHeight: \"86vh\",\r\n              overflowY: \"auto\",\r\n            }}\r\n          >\r\n            <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\r\n              <div style={{ fontWeight: 700 }}>Senaryo Kopyalama</div>\r\n              <button className=\"btn\" onClick={closeCopyScenarioModal} disabled={scenarioOpsBusy}>\r\n                Kapat\r\n              </button>\r\n            </div>\r\n            <div className=\"small\" style={{ marginTop: 6 }}>\r\n              Yeni senaryo icin para birimini secin.\r\n            </div>\r\n\r\n            {copyModalError ? (\r\n              <div className=\"card\" style={{ marginTop: 10, background: \"#fff1f2\", borderColor: \"#fecaca\" }}>\r\n                {copyModalError}\r\n              </div>\r\n            ) : null}\r\n\r\n            <div style={{ marginTop: 12 }}>\r\n              <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Para Birimi</div>\r\n              <div className=\"row\" style={{ gap: 12, alignItems: \"center\" }}>\r\n                <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"copy-currency\"\r\n                    checked={copyTargetCurrency === \"USD\"}\r\n                    onChange={() => {\r\n                      setCopyTargetCurrency(\"USD\");\r\n                      setCopyModalError(\"\");\r\n                    }}\r\n                  />\r\n                  <span>USD</span>\r\n                </label>\r\n                <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"copy-currency\"\r\n                    checked={copyTargetCurrency === \"LOCAL\"}\r\n                    onChange={() => {\r\n                      setCopyTargetCurrency(\"LOCAL\");\r\n                      setCopyModalError(\"\");\r\n                    }}\r\n                  />\r\n                  <span>LOCAL</span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n            {sourceCurrency === \"USD\" && copyTargetCurrency === \"LOCAL\" ? (\r\n              <div style={{ marginTop: 12 }}>\r\n                <div className=\"row\" style={{ gap: 8, alignItems: \"center\" }}>\r\n                  <div className=\"small\" style={{ fontWeight: 700 }}>Local currency code</div>\r\n                  <input\r\n                    className=\"input sm\"\r\n                    list=\"local-currency-codes-copy\"\r\n                    placeholder=\"TRY\"\r\n                    value={copyLocalCurrencyCode}\r\n                    onChange={(e) =>\r\n                      setCopyLocalCurrencyCode(\r\n                        e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, \"\").slice(0, 10)\r\n                      )\r\n                    }\r\n                  />\r\n                  <datalist id=\"local-currency-codes-copy\">\r\n                    {LOCAL_CURRENCY_OPTIONS.map((code) => (\r\n                      <option key={code} value={code} />\r\n                    ))}\r\n                  </datalist>\r\n                </div>\r\n\r\n                <div className=\"row\" style={{ gap: 8, alignItems: \"center\", marginTop: 10 }}>\r\n                  <span>1 USD =</span>\r\n                  <input\r\n                    className=\"input sm\"\r\n                    type=\"number\"\r\n                    step=\"0.000001\"\r\n                    value={copyPlannedFxUsdToLocal}\r\n                    onChange={(e) => setCopyPlannedFxUsdToLocal(e.target.value)}\r\n                  />\r\n                  <span>{copyLocalCurrencyCode || \"LOCAL\"}</span>\r\n                </div>\r\n                <div className=\"small muted\" style={{ marginTop: 6 }}>\r\n                  Planlanan kur (senaryo ayarlari icin).\r\n                </div>\r\n\r\n                <div className=\"row\" style={{ gap: 8, alignItems: \"center\", marginTop: 10 }}>\r\n                  <span>Kopyalama kuru:</span>\r\n                  <input\r\n                    className=\"input sm\"\r\n                    type=\"number\"\r\n                    step=\"0.000001\"\r\n                    value={copyFxUsdToLocal}\r\n                    onChange={(e) => setCopyFxUsdToLocal(e.target.value)}\r\n                  />\r\n                  <span>{copyLocalCurrencyCode || \"LOCAL\"}</span>\r\n                </div>\r\n                <div className=\"small muted\" style={{ marginTop: 6 }}>\r\n                  Kopyalama kuruna gore tum rakamlar cevrilir.\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n\r\n            {sourceCurrency === \"LOCAL\" && copyTargetCurrency === \"USD\" ? (\r\n              <div style={{ marginTop: 12 }}>\r\n                <div className=\"row\" style={{ gap: 8, alignItems: \"center\" }}>\r\n                  <span>1 USD =</span>\r\n                  <input\r\n                    className=\"input sm\"\r\n                    type=\"number\"\r\n                    step=\"0.000001\"\r\n                    value={copyFxUsdToLocal}\r\n                    onChange={(e) => setCopyFxUsdToLocal(e.target.value)}\r\n                  />\r\n                  <span>{inputCurrencyCode}</span>\r\n                </div>\r\n                <div className=\"small muted\" style={{ marginTop: 6 }}>\r\n                  Kopyalama kuru (LOCAL -&gt; USD).\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n\r\n            {copySelectionMsg ? (\r\n              <div className=\"small\" style={{ marginTop: 10, color: \"#0369a1\" }}>\r\n                {copySelectionMsg}\r\n              </div>\r\n            ) : null}\r\n\r\n            <div style={{ marginTop: 16 }}>\r\n              <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n                <div style={{ fontWeight: 700 }}>Kopyalanacak Bolumler</div>\r\n                <div className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                  <div className=\"small muted\">Secili: {selectedCopyCount}</div>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn\"\r\n                    onClick={() => applyPresetSelection(\"all\")}\r\n                    disabled={scenarioOpsBusy}\r\n                  >\r\n                    Tumu\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn\"\r\n                    onClick={() => applyPresetSelection(\"structure\")}\r\n                    disabled={scenarioOpsBusy}\r\n                  >\r\n                    Yapisi\r\n                  </button>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn\"\r\n                    onClick={() => applyPresetSelection(\"financial\")}\r\n                    disabled={scenarioOpsBusy}\r\n                  >\r\n                    Finans\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div style={{ marginTop: 10, display: \"grid\", gap: 12, gridTemplateColumns: \"repeat(auto-fit, minmax(240px, 1fr))\" }}>\r\n                {COPY_SELECT_TABS.map((tab) => (\r\n                  <div key={tab.key} className=\"card\" style={{ padding: 12 }}>\r\n                    <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n                      <div style={{ fontWeight: 700 }}>{tab.label}</div>\r\n                      <div className=\"row\" style={{ gap: 4 }}>\r\n                        <button\r\n                          type=\"button\"\r\n                          className=\"btn\"\r\n                          style={{ padding: \"2px 6px\", fontSize: 12 }}\r\n                          onClick={() => setCopyTabSelectionAll(tab.key, true)}\r\n                          disabled={scenarioOpsBusy}\r\n                        >\r\n                          Tumu\r\n                        </button>\r\n                        <button\r\n                          type=\"button\"\r\n                          className=\"btn\"\r\n                          style={{ padding: \"2px 6px\", fontSize: 12 }}\r\n                          onClick={() => setCopyTabSelectionAll(tab.key, false)}\r\n                          disabled={scenarioOpsBusy}\r\n                        >\r\n                          Temizle\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                    <div style={{ marginTop: 8, display: \"flex\", flexDirection: \"column\", gap: 6 }}>\r\n                      {tab.sections.map((section) => (\r\n                        <label key={section.id} className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={!!copySelection?.[section.id]}\r\n                            onChange={(e) => toggleCopySelection(section.id, e.target.checked)}\r\n                            disabled={scenarioOpsBusy}\r\n                          />\r\n                          <span className=\"small\">{section.label}</span>\r\n                        </label>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"row\" style={{ justifyContent: \"flex-end\", marginTop: 14 }}>\r\n              <button className=\"btn\" onClick={closeCopyScenarioModal} disabled={scenarioOpsBusy}>\r\n                Iptal\r\n              </button>\r\n              <button\r\n                className=\"btn primary\"\r\n                onClick={confirmCopyScenarioModal}\r\n                disabled={scenarioOpsBusy || copyingScenarioId || !copySelection || !isIkGiderlerValid}\r\n              >\r\n                {copyingScenarioId ? (\r\n                  <span style={{ display: \"inline-flex\", gap: 6, alignItems: \"center\" }}>\r\n                    <InlineSpinner />\r\n                    <span>Kopyalaniyor...</span>\r\n                  </span>\r\n                ) : (\r\n                  \"Tamam\"\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {expenseSplitOpen ? (\r\n        <ExpenseSplitModal\r\n          open={expenseSplitOpen}\r\n          onClose={() => setExpenseSplitOpen(false)}\r\n          sourceScenario={selectedRowScenario}\r\n          sourceSchoolId={selectedSchoolId}\r\n        />\r\n      ) : null}\r\n\r\n      {scenarioWizardOpen ? (\r\n        <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\">\r\n          <div className=\"modal scenario-wizard-modal\">\r\n            <div className=\"scenario-wizard-header\">\r\n              <div className=\"row\" style={{ justifyContent: \"space-between\" }}>\r\n                <div style={{ fontWeight: 700 }}>\r\n                  {scenarioWizardMode === \"edit\" ? \"Senaryo Kurulumunu Duzenle\" : \"Yeni Senaryo Kurulumu\"}\r\n                </div>\r\n                <button\r\n                  className=\"btn\"\r\n                  onClick={closeScenarioWizard}\r\n                  disabled={scenarioWizardSaving || scenarioWizardLoading}\r\n                >\r\n                  Kapat\r\n                </button>\r\n              </div>\r\n              <div className=\"small\" style={{ marginTop: 6 }}>\r\n                {scenarioWizardMode === \"edit\"\r\n                  ? \"Senaryo ayarlarini guncelleyip kaydedebilirsiniz.\"\r\n                  : \"Adim adim kurulum tamamlayin.\"}\r\n              </div>\r\n            </div>\r\n            <div className=\"scenario-wizard-body\">\r\n              {err ? (\r\n                <div className=\"card\" style={{ marginTop: 10, background: \"#fff1f2\", borderColor: \"#fecaca\" }}>\r\n                  {err}\r\n                </div>\r\n              ) : null}\r\n\r\n              {scenarioWizardLoading ? (\r\n                <div className=\"card\" style={{ marginTop: 12 }}>Yukleniyor...</div>\r\n              ) : (\r\n                <div style={{ marginTop: 12 }}>\r\n                  <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n                    <div style={{ fontWeight: 700 }}>Kurulum Adimi</div>\r\n                    <div className=\"small\">{`Adim ${newScenarioStep + 1} / ${scenarioStepTotal}: ${scenarioStepLabels[newScenarioStep]}`}</div>\r\n                  </div>\r\n\r\n                  {newScenarioStep === 0 && (\r\n                    <div style={{ marginTop: 10 }}>\r\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Donem Turu</div>\r\n                      <div className=\"row\" style={{ gap: 12, alignItems: \"center\" }}>\r\n                        <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                          <input\r\n                            type=\"radio\"\r\n                            name=\"scenario-period\"\r\n                            checked={newScenarioPeriod === \"full\"}\r\n                            onChange={() => setNewScenarioPeriod(\"full\")}\r\n                          />\r\n                          <span>Tam Yil (tek yil)</span>\r\n                        </label>\r\n                        <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                          <input\r\n                            type=\"radio\"\r\n                            name=\"scenario-period\"\r\n                            checked={newScenarioPeriod === \"split\"}\r\n                            onChange={() => setNewScenarioPeriod(\"split\")}\r\n                          />\r\n                          <span>Yil ortasinda baslar, sonraki yil biter</span>\r\n                        </label>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {newScenarioStep === 1 && (\r\n                    <div style={{ marginTop: 10 }}>\r\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Para Birimi</div>\r\n                      <div className=\"row\" style={{ gap: 12, alignItems: \"center\" }}>\r\n                        <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                          <input\r\n                            type=\"radio\"\r\n                            name=\"scenario-currency\"\r\n                            checked={newScenarioInputCurrency === \"USD\"}\r\n                            onChange={() => handleScenarioCurrencyChange(\"USD\")}\r\n                            disabled={scenarioWizardMode === \"edit\"}\r\n                          />\r\n                          <span>USD</span>\r\n                        </label>\r\n                        <label className=\"row\" style={{ gap: 6, alignItems: \"center\" }}>\r\n                          <input\r\n                            type=\"radio\"\r\n                            name=\"scenario-currency\"\r\n                            checked={newScenarioInputCurrency === \"LOCAL\"}\r\n                            onChange={() => handleScenarioCurrencyChange(\"LOCAL\")}\r\n                            disabled={scenarioWizardMode === \"edit\"}\r\n                          />\r\n                          <span>Local currency</span>\r\n                        </label>\r\n                      </div>\r\n\r\n                      {newScenarioInputCurrency === \"LOCAL\" && (\r\n                        <div style={{ marginTop: 10 }}>\r\n                          <div className=\"row\" style={{ gap: 8, alignItems: \"center\" }}>\r\n                            <div className=\"small\" style={{ fontWeight: 700 }}>Local currency code</div>\r\n                            <input\r\n                              className=\"input sm\"\r\n                              list=\"local-currency-codes\"\r\n                              placeholder=\"TRY\"\r\n                              value={newScenarioLocalCurrencyCode}\r\n                              onChange={(e) =>\r\n                                setNewScenarioLocalCurrencyCode(\r\n                                  e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, \"\").slice(0, 10)\r\n                                )\r\n                              }\r\n                            />\r\n                            <datalist id=\"local-currency-codes\">\r\n                              {LOCAL_CURRENCY_OPTIONS.map((code) => (\r\n                                <option key={code} value={code} />\r\n                              ))}\r\n                            </datalist>\r\n                          </div>\r\n                          {!localCodeOk ? (\r\n                            <div className=\"small\" style={{ color: \"#b91c1c\", marginTop: 6 }}>\r\n                              Code 2-10 chars, A-Z0-9.\r\n                            </div>\r\n                          ) : null}\r\n\r\n                          <div className=\"row\" style={{ gap: 8, alignItems: \"center\", marginTop: 10 }}>\r\n                            <span>1 USD =</span>\r\n                            <input\r\n                              className=\"input sm\"\r\n                              type=\"number\"\r\n                              step=\"0.000001\"\r\n                              value={newScenarioFxUsdToLocal}\r\n                              onChange={(e) => setNewScenarioFxUsdToLocal(e.target.value)}\r\n                            />\r\n                            <span>{normalizedLocalCode || \"LOCAL\"}</span>\r\n                          </div>\r\n                          {!fxOk ? (\r\n                            <div className=\"small\" style={{ color: \"#b91c1c\", marginTop: 6 }}>\r\n                              FX rate must be &gt; 0.\r\n                            </div>\r\n                          ) : null}\r\n                          <div className=\"small muted\" style={{ marginTop: 6 }}>\r\n                            Kur formati: 1 USD = X LOCAL\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                  {newScenarioStep === 2 && (\r\n                    <div style={{ marginTop: 10 }}>\r\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Program Turu</div>\r\n                      <div className=\"row\" style={{ gap: 12 }}>\r\n                        {[\r\n                          {\r\n                            key: PROGRAM_TYPES.LOCAL,\r\n                            label: \"Yerel\",\r\n                            hint: \"Yerel kademeleri planlayin\",\r\n                          },\r\n                          {\r\n                            key: PROGRAM_TYPES.INTERNATIONAL,\r\n                            label: \"International\",\r\n                            hint: \"Uluslararasi kademeleri planlayin\",\r\n                          },\r\n                        ].map((option) => (\r\n                          <button\r\n                            key={option.key}\r\n                            type=\"button\"\r\n                            className={`btn ${newScenarioProgramType === option.key ? \"primary\" : \"ghost\"}`}\r\n                            aria-pressed={newScenarioProgramType === option.key}\r\n                            onClick={() => setNewScenarioProgramType(option.key)}\r\n                          >\r\n                            <div style={{ fontWeight: 700 }}>{option.label}</div>\r\n                            <div className=\"small\" style={{ opacity: 0.75 }}>{option.hint}</div>\r\n                          </button>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {newScenarioStep === 3 && (\r\n                    <div style={{ marginTop: 10 }}>\r\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Yil</div>\r\n                      {newScenarioPeriod === \"full\" ? (\r\n                        <input\r\n                          className=\"input sm\"\r\n                          placeholder={DEFAULT_START_YEAR}\r\n                          value={newScenarioStartYear}\r\n                          onChange={(e) => setNewScenarioStartYear(e.target.value)}\r\n                        />\r\n                      ) : (\r\n                        <div className=\"row\" style={{ gap: 8, alignItems: \"center\" }}>\r\n                          <input\r\n                            className=\"input sm\"\r\n                            placeholder={DEFAULT_START_YEAR}\r\n                            value={newScenarioStartYear}\r\n                            onChange={(e) => setNewScenarioStartYear(e.target.value)}\r\n                          />\r\n                          <span className=\"muted\">-</span>\r\n                          <input\r\n                            className=\"input sm\"\r\n                            placeholder={DEFAULT_END_YEAR}\r\n                            value={newScenarioEndYear}\r\n                            onChange={(e) => setNewScenarioEndYear(e.target.value)}\r\n                          />\r\n                        </div>\r\n                      )}\r\n                      <div className=\"small muted\" style={{ marginTop: 6 }}>\r\n                        Akademik yil: {draftAcademicYear || \"-\"}\r\n                        {newScenarioPeriod === \"split\" && draftAcademicYear && !draftRangeOk ? (\r\n                          <span style={{ color: \"#b91c1c\", marginLeft: 8 }}>\r\n                            Bitis yili, baslangic yilindan 1 fazla olmali.\r\n                          </span>\r\n                        ) : null}\r\n                        {draftAcademicYear && yearConflict ? (\r\n                          <span style={{ color: \"#b91c1c\", marginLeft: 8 }}>\r\n                            Bu yil turu icin zaten bir senaryo var.\r\n                          </span>\r\n                        ) : null}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {newScenarioStep === 4 && (\r\n                    <div style={{ marginTop: 10 }}>\r\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Kademeler</div>\r\n                      <table className=\"table\">\r\n                        <thead>\r\n                          <tr>\r\n                            <th>Kademe</th>\r\n                            <th style={{ width: 120 }}>Aktif</th>\r\n                            <th style={{ width: 160 }}>Baslangic</th>\r\n                            <th style={{ width: 160 }}>Bitis</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          {kademeDefs.map((def) => {\r\n                            const row = draftKademeConfig[def.key];\r\n                            return (\r\n                              <tr key={def.key}>\r\n                                <td style={{ fontWeight: 700 }}>{def.label}</td>\r\n                                <td>\r\n                                  <input\r\n                                    type=\"checkbox\"\r\n                                    checked={!!row?.enabled}\r\n                                    onChange={(e) => updateNewKademe(def.key, { enabled: e.target.checked })}\r\n                                  />\r\n                                </td>\r\n                                <td>\r\n                                  <select\r\n                                    className=\"input sm\"\r\n                                    value={row?.from || \"\"}\r\n                                    onChange={(e) => updateNewKademe(def.key, { from: e.target.value })}\r\n                                    disabled={!row?.enabled}\r\n                                  >\r\n                                    {gradeOptions.map((g) => (\r\n                                      <option key={g} value={g}>{g}</option>\r\n                                    ))}\r\n                                  </select>\r\n                                </td>\r\n                                <td>\r\n                                  <select\r\n                                    className=\"input sm\"\r\n                                    value={row?.to || \"\"}\r\n                                    onChange={(e) => updateNewKademe(def.key, { to: e.target.value })}\r\n                                    disabled={!row?.enabled}\r\n                                  >\r\n                                    {gradeOptions.map((g) => (\r\n                                      <option key={g} value={g}>{g}</option>\r\n                                    ))}\r\n                                  </select>\r\n                                </td>\r\n                              </tr>\r\n                            );\r\n                          })}\r\n                        </tbody>\r\n                      </table>\r\n                      {!hasEnabledKademe ? (\r\n                        <div className=\"small\" style={{ color: \"#b91c1c\" }}>En az bir kademe secmelisiniz.</div>\r\n                      ) : null}\r\n                    </div>\r\n                  )}\r\n\r\n                  {newScenarioStep === 5 && (\r\n                    <div style={{ marginTop: 10 }}>\r\n                      <div className=\"small\" style={{ fontWeight: 700, marginBottom: 6 }}>Senaryo Adi</div>\r\n                      <div className=\"row\">\r\n                        <input\r\n                          className=\"input\"\r\n                          placeholder=\"Senaryo adi\"\r\n                          value={newScenarioName}\r\n                          onChange={(e) => setNewScenarioName(e.target.value)}\r\n                        />\r\n                      </div>\r\n                      {!newScenarioName.trim() ? (\r\n                        <div className=\"small\" style={{ color: \"#b91c1c\", marginTop: 6 }}>Senaryo adi zorunludur.</div>\r\n                      ) : null}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n            {!scenarioWizardLoading ? (\r\n              <div className=\"scenario-wizard-footer\">\r\n                <button\r\n                  className=\"btn\"\r\n                  onClick={goScenarioBack}\r\n                  disabled={newScenarioStep === 0 || scenarioWizardSaving}\r\n                >\r\n                  Geri\r\n                </button>\r\n                <button\r\n                  className=\"btn primary\"\r\n                  onClick={goScenarioNext}\r\n                  disabled={scenarioWizardSaving || !scenarioStepOk[newScenarioStep]}\r\n                >\r\n                  {scenarioWizardSaving ? (\r\n                    <span style={{ display: \"inline-flex\", gap: 6, alignItems: \"center\" }}>\r\n                      <InlineSpinner />\r\n                      <span>{scenarioWizardMode === \"edit\" ? \"Kaydediliyor...\" : \"Olusturuluyor...\"}</span>\r\n                    </span>\r\n                  ) : (\r\n                    newScenarioStep < scenarioStepTotal - 1\r\n                      ? \"Ileri\"\r\n                      : scenarioWizardMode === \"edit\"\r\n                        ? \"Kaydet\"\r\n                        : \"Bitir\"\r\n                  )}\r\n                </button>\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      <div\r\n        className=\"row select-page-tables\"\r\n        style={{ gap: 12, alignItems: \"stretch\", marginTop: 12, flexWrap: \"wrap\" }}\r\n      >\r\n        <div className=\"card select-table-card\" style={{ flex: \"1 1 320px\", minWidth: 280 }}>\r\n          <div style={{ fontWeight: 700, marginBottom: 8 }}>Okullar</div>\r\n          {loadingSchools ? (\r\n            <div className=\"small\">Yukleniyor...</div>\r\n          ) : (\r\n            <div className=\"select-table-body\">\r\n              <table className=\"table select-school-table\">\r\n                <colgroup>\r\n                  <col style={{ width: 32 }} />\r\n                  <col />\r\n                  <col style={{ width: 180 }} />\r\n                </colgroup>\r\n              <thead>\r\n                <tr>\r\n                  <th></th>\r\n                  <th>Okul</th>\r\n                  <th>lerleme</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {schools.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan=\"3\" className=\"small\">Okul bulunamadi.</td>\r\n                  </tr>\r\n                ) : (\r\n                  schools.map((s) => {\r\n                    const isSelected = String(selectedSchoolId) === String(s.id);\r\n                    const progress = schoolProgress[s.id];\r\n                    return (\r\n                      <tr\r\n                        key={s.id}\r\n                        className={isSelected ? \"scenario-row is-selected\" : \"scenario-row\"}\r\n                        // Provide a pointer cursor for the whole row to indicate interactivity. Clicking the row or any\r\n                        // cell will select the school.\r\n                        style={{ cursor: isSelected ? \"default\" : \"pointer\" }}\r\n                        onClick={() => {\r\n                          if (isSelected) return;\r\n                          handleSelectSchool(s.id);\r\n                        }}\r\n                      >\r\n                        <td\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                          }}\r\n                        >\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            className=\"select-checkbox\"\r\n                            checked={isSelected}\r\n                            aria-label={`${s.name} okulunu se`}\r\n                            onChange={(e) => {\r\n                              e.stopPropagation();\r\n                              if (isSelected) {\r\n                                clearSchoolSelection();\r\n                                return;\r\n                              }\r\n                              handleSelectSchool(s.id);\r\n                            }}\r\n                          />\r\n                        </td>\r\n                        <td\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            if (isSelected) return;\r\n                            handleSelectSchool(s.id);\r\n                          }}\r\n                          style={{ cursor: \"pointer\" }}\r\n                        >\r\n                          <b>{s.name}</b>\r\n                        </td>\r\n                        <td style={{ minWidth: 180 }}>\r\n                          {progress ? (\r\n                            progress.state === \"active\" ? (\r\n                              <ProgressBar value={progress.pct} tooltipLines={progress.tooltipLines} />\r\n                            ) : (\r\n                              <div className=\"small\">{progress.label || \"-\"}</div>\r\n                            )\r\n                          ) : (\r\n                            <div className=\"small\">{schoolProgressLoading ? \"Hesaplanyor...\" : \"-\"}</div>\r\n                          )}\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })\r\n                )}\r\n              </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"card select-table-card\" style={{ flex: \"2 1 420px\", minWidth: 320 }}>\r\n          {/* Header for the scenarios list. The \"Yeni Senaryo\" button has been moved into the scenario toolbar\r\n              below so it appears alongside the other scenario actions. */}\r\n          <div className=\"row\" style={{ justifyContent: \"space-between\", alignItems: \"center\", gap: 12 }}>\r\n            <div style={{ fontWeight: 700 }}>Senaryolar</div>\r\n          </div>\r\n\r\n          {!selectedSchoolId ? (\r\n            <div className=\"small muted\" style={{ marginTop: 10 }}>Once okul secin.</div>\r\n          ) : (\r\n            <>\r\n              <div className=\"scenario-toolbar\" style={{ marginTop: 10 }}>\r\n                {/* Yeni Senaryo button moved here to be the first action in the toolbar. It remains disabled when\r\n                    no school is selected or an operation is in progress. */}\r\n                {canCreateScenario ? (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn primary\"\r\n                    onClick={openScenarioWizardCreate}\r\n                    disabled={!selectedSchoolId || scenarioOpsBusy}\r\n                    title=\"Yeni Senaryo\"\r\n                  >\r\n                    <span className=\"btn-inner\">\r\n                      <span>Yeni Senaryo</span>\r\n                    </span>\r\n                  </button>\r\n                ) : null}\r\n                {canEditScenarioPlan ? (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn\"\r\n                    onClick={() => {\r\n                      if (!selectedRowScenario) return;\r\n                      openScenarioWizardEdit(selectedRowScenario.id);\r\n                    }}\r\n                    disabled={!canEditToolbar || scenarioOpsBusy}\r\n                    title=\"Planlamayi Duzenle\"\r\n                  >\r\n                    <span className=\"btn-inner\">\r\n                      <span>Planlamayi Duzenle</span>\r\n                    </span>\r\n                  </button>\r\n                ) : null}\r\n                {canCopyScenario ? (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn\"\r\n                    onClick={openCopyScenarioModal}\r\n                    disabled={!canCopyToolbar || calculating || scenarioOpsBusy}\r\n                    title=\"Kopyala\"\r\n                  >\r\n                    <span className=\"btn-inner\">\r\n                      {toolbarIsCopying ? <InlineSpinner /> : null}\r\n                      <span>Kopyala</span>\r\n                    </span>\r\n                  </button>\r\n                ) : null}\r\n                {canExpenseSplit ? (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn\"\r\n                    onClick={() => setExpenseSplitOpen(true)}\r\n                    disabled={!selectedRowScenario || scenarioOpsBusy}\r\n                    title=\"Gider Paylatr\"\r\n                  >\r\n                    <span className=\"btn-inner\">\r\n                      <span>Gider Paylatr</span>\r\n                    </span>\r\n                  </button>\r\n                ) : null}\r\n                {canForwardScenario && isForwardStage ? (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn primary\"\r\n                    onClick={() => {\r\n                      if (!selectedRowScenario) return;\r\n                      sendScenarioForApproval(selectedRowScenario.id);\r\n                    }}\r\n                    disabled={!canForwardToolbar || calculating || scenarioOpsBusy}\r\n                    title=\"Merkeze ilet\"\r\n                  >\r\n                    <span className=\"btn-inner\">\r\n                      {toolbarIsSubmitting ? <InlineSpinner /> : <FaPaperPlane style={{ marginRight: 4 }} />}\r\n                      <span>Merkeze ilet</span>\r\n                    </span>\r\n                  </button>\r\n                ) : null}\r\n                {canSubmitScenario && isSubmitStage ? (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn primary\"\r\n                    onClick={() => {\r\n                      if (!selectedRowScenario) return;\r\n                      submitScenarioForApproval(selectedRowScenario.id);\r\n                    }}\r\n                    disabled={!canSubmitToolbar || calculating || scenarioOpsBusy}\r\n                    title=\"Onaya Gonder\"\r\n                  >\r\n                    <span className=\"btn-inner\">\r\n                      {/* Show a spinner while submitting; otherwise show an approval icon. */}\r\n                      {toolbarIsSubmitting ? <InlineSpinner /> : <FaCheckCircle style={{ marginRight: 4 }} />}\r\n                      <span>Onaya Gonder</span>\r\n                    </span>\r\n                  </button>\r\n                ) : null}\r\n                {canDeleteScenario ? (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn danger\"\r\n                    onClick={() => {\r\n                      if (!selectedRowScenario) return;\r\n                      openDeleteScenarioModal(selectedRowScenario.id);\r\n                    }}\r\n                    disabled={!canDeleteToolbar || calculating || scenarioOpsBusy}\r\n                    title=\"Sil\"\r\n                  >\r\n                    <span className=\"btn-inner\">\r\n                      {/* Show a spinner while deleting; otherwise show a trash icon. */}\r\n                      {toolbarIsDeleting ? <InlineSpinner /> : <FaTrash style={{ marginRight: 4 }} />}\r\n                      <span>Sil</span>\r\n                    </span>\r\n                  </button>\r\n                ) : null}\r\n              </div>\r\n              <div className=\"select-table-body select-table-body-gap\">\r\n                <table className=\"table scenario-table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th></th>\r\n                    <th aria-sort={getSortAria(\"name\")}>\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"sort-th\"\r\n                        onClick={() => toggleScenarioSort(\"name\")}\r\n                        aria-label=\"Sirala: Ad\"\r\n                      >\r\n                        <span>Ad</span>\r\n                        {sortIcon(\"name\")}\r\n                      </button>\r\n                    </th>\r\n                    <th aria-sort={getSortAria(\"year\")}>\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"sort-th\"\r\n                        onClick={() => toggleScenarioSort(\"year\")}\r\n                        aria-label=\"Sirala: Yil\"\r\n                      >\r\n                        <span>Yil</span>\r\n                        {sortIcon(\"year\")}\r\n                      </button>\r\n                    </th>\r\n                    <th aria-sort={getSortAria(\"currency\")}>\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"sort-th\"\r\n                        onClick={() => toggleScenarioSort(\"currency\")}\r\n                        aria-label=\"Sirala: Para Birimi\"\r\n                      >\r\n                        <span>Para Birimi</span>\r\n                        {sortIcon(\"currency\")}\r\n                      </button>\r\n                    </th>\r\n                    <th aria-sort={getSortAria(\"status\")}>\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"sort-th\"\r\n                        onClick={() => toggleScenarioSort(\"status\")}\r\n                        aria-label=\"Sirala: Durum\"\r\n                      >\r\n                        <span>Durum</span>\r\n                        {sortIcon(\"status\")}\r\n                      </button>\r\n                    </th>\r\n                    <th>lerleme</th>\r\n                    <th aria-sort={getSortAria(\"date\")}>\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"sort-th\"\r\n                        onClick={() => toggleScenarioSort(\"date\")}\r\n                        aria-label=\"Sirala: Tarih\"\r\n                      >\r\n                        <span>Tarih</span>\r\n                        {sortIcon(\"date\")}\r\n                      </button>\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {loadingScenarios ? (\r\n                    <tr>\r\n                      <td colSpan=\"7\" className=\"small\">Yukleniyor...</td>\r\n                    </tr>\r\n                  ) : sortedScenarios.length === 0 ? (\r\n                    <tr>\r\n                      <td colSpan=\"7\" className=\"small\">Gosterilecek senaryo yok.</td>\r\n                    </tr>\r\n                  ) : (\r\n                    sortedScenarios.map((s) => {\r\n                      const statusMeta = getScenarioStatusMeta(s);\r\n                      const isSelected = String(selectedScenarioIdLocal) === String(s.id);\r\n                      const isThisRowBusy = String(s.id) === String(busyRowId);\r\n                      const isOtherRowDisabled = scenarioOpsBusy && busyRowId && !isThisRowBusy;\r\n                      const disableThisRowActions = scenarioOpsBusy;\r\n                      const currencyLabel =\r\n                        s.input_currency === \"LOCAL\"\r\n                          ? `${s.local_currency_code || \"LOCAL\"} (LOCAL)`\r\n                          : \"USD\";\r\n                      return (\r\n                        <tr\r\n                          key={s.id}\r\n                          className={isSelected ? \"scenario-row is-selected\" : \"scenario-row\"}\r\n                          // Apply opacity and pointer-event rules as before. Also set cursor to pointer when\r\n                          // selection is possible. When another row is busy or this row is disabled/selected, the\r\n                          // cursor remains default and clicking does nothing.\r\n                          style={{\r\n                            opacity: isOtherRowDisabled ? 0.5 : 1,\r\n                            pointerEvents: isOtherRowDisabled ? \"none\" : \"auto\",\r\n                            cursor:\r\n                              isSelected || disableThisRowActions || isOtherRowDisabled ? \"default\" : \"pointer\",\r\n                          }}\r\n                          onClick={() => {\r\n                            if (isSelected || disableThisRowActions || isOtherRowDisabled) return;\r\n                            setSelectedScenarioIdLocal(s.id);\r\n                          }}\r\n                        >\r\n                          <td>\r\n                            <input\r\n                              type=\"checkbox\"\r\n                              className=\"select-checkbox\"\r\n                              checked={isSelected}\r\n                              disabled={disableThisRowActions || isOtherRowDisabled}\r\n                              aria-label={`${s.name} senaryosunu se`}\r\n                              onChange={(e) => {\r\n                                e.stopPropagation();\r\n                                if (disableThisRowActions || isOtherRowDisabled) return;\r\n                                if (isSelected) {\r\n                                  clearScenarioSelection();\r\n                                  return;\r\n                                }\r\n                                setSelectedScenarioIdLocal(s.id);\r\n                              }}\r\n                            />\r\n                          </td>\r\n                          <td>\r\n                            <b className=\"scenario-name\" title={s.name}>\r\n                              {s.name}\r\n                            </b>\r\n                          </td>\r\n                          <td>{s.academic_year}</td>\r\n                          <td>{currencyLabel}</td>\r\n                          <td>\r\n                            <span className={`status-badge ${statusMeta.cls}`} title={statusMeta.help}>\r\n                              {statusMeta.label}\r\n                            </span>\r\n                          </td>\r\n                          <td style={{ minWidth: 160 }}>\r\n                            {scenarioProgressMap[s.id] && !scenarioProgressMap[s.id].error ? (\r\n                              <ProgressBar\r\n                                value={scenarioProgressMap[s.id].pct}\r\n                                tooltipLines={scenarioProgressMap[s.id].tooltipLines}\r\n                              />\r\n                            ) : (\r\n                              <span className=\"small\">\r\n                                {scenarioProgressLoading ? \"Hesaplanyor...\" : \"-\"}\r\n                              </span>\r\n                            )}\r\n                          </td>\r\n                          <td className=\"small\">{new Date(s.created_at).toLocaleString()}</td>\r\n                        </tr>\r\n                      );\r\n                    })\r\n                  )}\r\n                </tbody>\r\n                </table>\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"row\" style={{ justifyContent: \"flex-end\", marginTop: 12 }}>\r\n        <button\r\n          className=\"btn primary\"\r\n          onClick={handleApply}\r\n          disabled={!selectedSchoolId || !selectedScenarioIdLocal}\r\n        >\r\n          Uygula\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","const PROGRAM_TYPES = {\n  LOCAL: \"local\",\n  INTERNATIONAL: \"international\",\n};\n\nconst ALLOWED_PROGRAM_TYPES = new Set(Object.values(PROGRAM_TYPES));\n\nfunction normalizeProgramType(value) {\n  const raw = String(value || \"\").trim().toLowerCase();\n  if (ALLOWED_PROGRAM_TYPES.has(raw)) return raw;\n  return PROGRAM_TYPES.LOCAL;\n}\n\nfunction getProgramType(inputs = {}, scenario = null) {\n  const programFromInputs =\n    inputs?.temelBilgiler?.programType ?? inputs?.programType ?? inputs?.program_type;\n  if (programFromInputs) {\n    return normalizeProgramType(programFromInputs);\n  }\n  const programFromScenario = scenario?.program_type || scenario?.programType;\n  if (programFromScenario) return normalizeProgramType(programFromScenario);\n  return PROGRAM_TYPES.LOCAL;\n}\n\nfunction isKademeKeyVisible(key, programType = PROGRAM_TYPES.LOCAL) {\n  const type = normalizeProgramType(programType);\n  if (!key) return true;\n  if (key === \"okulOncesi\") return true;\n  if (key.endsWith(\"Yerel\")) return type === PROGRAM_TYPES.LOCAL;\n  if (key.endsWith(\"Int\")) return type === PROGRAM_TYPES.INTERNATIONAL;\n  return true;\n}\n\nfunction mapBaseKademeToVariant(baseKademe, programType = PROGRAM_TYPES.LOCAL) {\n  const type = normalizeProgramType(programType);\n  if (baseKademe === \"okulOncesi\") return \"okulOncesi\";\n  const suffix = type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\";\n  return `${baseKademe}${suffix}`;\n}\n\nfunction getVariantKeysForProgramType(programType = PROGRAM_TYPES.LOCAL) {\n  const type = normalizeProgramType(programType);\n  return new Set([\n    \"okulOncesi\",\n    `ilkokul${type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\"}`,\n    `ortaokul${type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\"}`,\n    `lise${type === PROGRAM_TYPES.INTERNATIONAL ? \"Int\" : \"Yerel\"}`,\n  ]);\n}\n\nexport {\n  PROGRAM_TYPES,\n  ALLOWED_PROGRAM_TYPES,\n  getProgramType,\n  normalizeProgramType,\n  isKademeKeyVisible,\n  mapBaseKademeToVariant,\n  getVariantKeysForProgramType,\n};\n"],"names":["Tooltip","_ref","text","lines","children","className","resolved","Array","isArray","map","line","String","filter","trim","length","split","Boolean","normalizeLines","_jsxs","concat","_jsx","role","idx","GRADES","KADEME_DEFS","key","label","defaultFrom","defaultTo","normalizeGrade","value","v","toUpperCase","test","n","Number","isFinite","gradeIndex","g","indexOf","getKademeDefinitions","d","_objectSpread","getDefaultKademeConfig","out","forEach","enabled","from","to","normalizeKademeConfig","config","cfg","row","range","fromValue","toValue","def","_normalizeGrade","_normalizeGrade2","fromIdx","toIdx","normalizeRange","formatKademeLabel","find","getKademeRangeLabel","getKademeForGrade","grade","summarizeGradesByKademe","grades","rows","okulOncesi","ilkokul","ortaokul","lise","total","r","students","studentsPerBranch","Object","prototype","hasOwnProperty","call","getGradeOptions","ProgressBar","tooltipLines","numeric","pct","Math","max","min","track","style","width","round","EXPENSE_ITEMS","EXPENSE_KEYS","it","EXPENSE_ITEM_MAP","Map","EXPENSE_LABELS","EXPENSE_SECTIONS","id","groups","keys","section","group","flatMap","fmtNum","fractionDigits","arguments","undefined","toLocaleString","maximumFractionDigits","ExpenseSplitModal","open","onClose","sourceScenario","sourceSchoolId","targets","setTargets","useState","loadingTargets","setLoadingTargets","targetSearch","setTargetSearch","selectedTargets","setSelectedTargets","Set","basis","setBasis","basisYearKey","setBasisYearKey","selectedExpenseKeys","setSelectedExpenseKeys","preview","setPreview","previewLoading","setPreviewLoading","applyLoading","setApplyLoading","compactControlStyle","fontSize","height","padding","lineHeight","boxSizing","selectedTargetsKey","useMemo","sort","join","selectedExpenseKeyStr","useEffect","active","async","academic_year","data","api","expenseSplitTargets","filtered","scenarioId","e","toast","error","message","loadTargets","filteredTargets","term","toLowerCase","schoolName","scenarioName","includes","toggleExpenseKey","prev","next","has","delete","add","setExpenseKeys","checked","previewTargets","previewPools","pools","previewAllocations","allocations","previewWarnings","warnings","targetById","m","t","set","targetScenarioId","allocationRows","target","get","targetLabel","expenseLabel","expenseKey","amount","allocatedAmount","totalExpenseCount","selectedExpenseCount","size","allExpensesSelected","someExpensesSelected","previewDisabled","isletmeSection","s","otherSections","renderSectionCard","selected","reduce","sum","allSelected","someSelected","background","justifyContent","alignItems","gap","fontWeight","type","ref","el","indeterminate","onChange","onClick","disabled","marginTop","marginBottom","item","maxHeight","overflowY","position","stopPropagation","top","right","borderColor","color","_Fragment","flexWrap","minWidth","flex","placeholder","colSpan","currencyLabel","input_currency","local_currency_code","toggleTarget","display","payload","targetScenarioIds","expenseKeys","previewExpenseSplit","applyExpenseSplit","success","w","p","poolAmount","margin","basisValue","weight","toFixed","COPY_SELECT_TABS","sections","COPY_SECTION_RESOURCES","isScenarioLocked","scenario","status","submittedAt","submitted_at","sentAt","sent_at","DEFAULT_START_YEAR","DEFAULT_END_YEAR","CURRENCY_CODE_REGEX","LOCAL_CURRENCY_OPTIONS","normalizeYearInput","incrementAcademicYearString","academicYear","raw","single","match","start","end","getAllCopySectionIds","tab","enforceIkGiderlerPair","selection","ikSelected","giderlerSelected","nextValue","buildDefaultCopySelection","presetKey","sectionIds","fromEntries","buildEmptyNormCurriculum","empty","buildEmptyNormYear","maxHours","teacherWeeklyMaxHours","curriculumWeeklyHours","convertInputsUsdToLocalForCopy","inputs","fx","_inputs$ik","rate","mulMoney","gelirler","_g$tuition","_g$nonEducationFees","_g$dormitory","_g$otherInstitutionIn","convertRows","unitFee","tuition","nonEducationFees","dormitory","otherInstitutionIncome","governmentIncentives","giderler","values","grp","items","k","ik","years","yearObj","unitCosts","discounts","mode","tb","temelBilgiler","_tb$inflation","_tb$performans","inflation","currentSeasonAvgFee","rakipAnalizi","obj","performans","gerceklesen","InlineSpinner","_ref2","borderRadius","border","borderTopColor","animation","normalizeCapacityInputs","src","_cap$years","_cap$years2","_cap$years3","safeNum","legacy","schoolCapacity","cap","kapasite","y1","y2","y3","currentStudents","byKademe","structuredClone","normalizeTemelBilgilerInputs","inf","toFinite","expenseDeviationPct","y2023","y2024","y2025","yetkililer","mudur","ulkeTemsilcisi","raporuHazirlayan","okulEgitimBilgileri","egitimBaslamaTarihi","zorunluEgitimDonemleri","birDersSuresiDakika","gunlukDersSaati","haftalikDersSaatiToplam","sabahciOglenci","ogretmenHaftalikDersOrt","gecisSinaviBilgisi","uygulananProgram","kademeler","programType","normalizeProgramType","okulUcretleriHesaplama","ucretArtisOranlari","ilkokulYerel","ilkokulInt","ortaokulYerel","ortaokulInt","liseYerel","liseInt","ikMevcut","turkPersonelYoneticiEgitimci","turkPersonelTemsilcilik","yerelKadroluEgitimci","yerelUcretliVakaterEgitimci","yerelDestek","yerelTemsilcilik","international","bursIndirimOgrenciSayilari","magisBasariBursu","maarifYetenekBursu","ihtiyacBursu","okulBasariBursu","tamEgitimBursu","barinmaBursu","turkceBasariBursu","uluslararasiYukumlulukIndirimi","vakifCalisaniIndirimi","kardesIndirimi","erkenKayitIndirimi","pesinOdemeIndirimi","kademeGecisIndirimi","temsilIndirimi","kurumIndirimi","istisnaiIndirim","yerelMevzuatIndirimi","a","b","c","ogrenciSayisi","karZarar","bursVeIndirimler","degerlendirme","normalizeGradesInputs","defaultGrades","branchCount","baseGrades","gradesYears","toMap","list","_row$grade","_row$branchCount","_row$studentsPerBranc","normalizeRow","areGradesEqual","ma","mb","ra","entries","rb","SelectPage","_ref3","_ref4","_inputs$temelBilgiler","_inputs$temelBilgiler2","_auth$user2","_auth$user3","navigate","useNavigate","outlet","useOutletContext","searchParams","setSearchParams","useSearchParams","auth","useAuth","schools","setSchools","scenarios","setScenarios","scenariosSchoolId","setScenariosSchoolId","selectedSchoolId","setSelectedSchoolId","selectedScenarioIdLocal","setSelectedScenarioIdLocal","selectedScenario","setSelectedScenario","setInputs","setReport","err","setErr","loadingSchools","setLoadingSchools","loadingScenarios","setLoadingScenarios","schoolProgress","setSchoolProgress","schoolProgressLoading","setSchoolProgressLoading","scenarioProgressMap","setScenarioProgressMap","scenarioProgressLoading","setScenarioProgressLoading","newScenarioName","setNewScenarioName","newScenarioPeriod","setNewScenarioPeriod","newScenarioStartYear","setNewScenarioStartYear","newScenarioEndYear","setNewScenarioEndYear","newScenarioKademeler","setNewScenarioKademeler","newScenarioInputCurrency","setNewScenarioInputCurrency","newScenarioLocalCurrencyCode","setNewScenarioLocalCurrencyCode","newScenarioFxUsdToLocal","setNewScenarioFxUsdToLocal","newScenarioProgramType","setNewScenarioProgramType","newScenarioStep","setNewScenarioStep","scenarioWizardOpen","setScenarioWizardOpen","scenarioWizardMode","setScenarioWizardMode","scenarioWizardScenario","setScenarioWizardScenario","scenarioWizardLoading","setScenarioWizardLoading","scenarioWizardSaving","setScenarioWizardSaving","scenarioSort","setScenarioSort","dir","submittingScenarioId","setSubmittingScenarioId","copyingScenarioId","setCopyingScenarioId","deletingScenarioId","setDeletingScenarioId","deleteConfirmScenarioId","setDeleteConfirmScenarioId","copyModalOpen","setCopyModalOpen","expenseSplitOpen","setExpenseSplitOpen","copyModalError","setCopyModalError","copySelection","setCopySelection","copySelectionMsg","setCopySelectionMsg","copyTargetCurrency","setCopyTargetCurrency","copyLocalCurrencyCode","setCopyLocalCurrencyCode","copyPlannedFxUsdToLocal","setCopyPlannedFxUsdToLocal","copyFxUsdToLocal","setCopyFxUsdToLocal","calculating","setCalculating","copySelectionMsgTimerRef","useRef","setHeaderMeta","title","subtitle","centered","_outlet$clearHeaderMe","clearHeaderMeta","loadSchools","useCallback","listSchools","limit","offset","fields","order","loadSchoolProgress","ids","getSchoolsProgressBulk","progressBySchoolId","_","fallback","state","paramId","some","handleSelectSchool","schoolId","isDifferent","URLSearchParams","clearSchoolSelection","clearScenarioSelection","sc","listScenarios","stored","readSelectedScenarioId","loadScenarios","results","Promise","all","_progress$pct","getScenarioProgress","progress","missingLines","missingDetailsLines","loadScenarioProgress","getScenarioInputs","normalized","loadScenario","refreshScenarios","kademeDefs","gradeOptions","draftStartYear","draftEndYear","draftAcademicYear","periodType","startYearValue","endYearValue","formatAcademicYear","draftRangeOk","yearConflict","excludeId","draftKademeConfig","hasEnabledKademe","normalizedLocalCode","localCodeOk","fxValue","fxOk","currencyStepOk","draftReady","scenarioStepOk","scenarioOpsBusy","busyRowId","selectedRowScenario","sortedScenarios","indexed","dirMul","getYearParts","ay","getCurrencyCode","getStatusLabel","A","B","res","name","localeCompare","sensitivity","a1","a2","b1","b2","Date","created_at","getTime","toggleScenarioSort","getSortAria","sortIcon","FaSort","FaSortUp","FaSortDown","copySectionIds","selectedCopyCount","isIkGiderlerValid","sourceCurrency","inputCurrencyCode","isLocalScenario","prevRealFxValue","prevYearRealizedFxUsdToLocal","prevRealFxMissing","permissionScope","_auth$user$country_id","_auth$user","countryId","user","country_id","canCreateScenario","can","canEditScenarioPlan","canCopyScenario","canExpenseSplit","canSubmitScenario","canForwardScenario","canDeleteScenario","toolbarLocked","canEditToolbar","canDeleteToolbar","isSubmitStage","isForwardStage","canSubmitToolbar","canForwardToolbar","canCopyToolbar","toolbarIsCopying","toolbarIsSubmitting","toolbarIsDeleting","handleScenarioCurrencyChange","openScenarioWizardEdit","targetScenario","_data$inputs","_data$inputs$temelBil","Error","startYear","endYear","parseAcademicYear","existingKademe","scenarioCurrency","fx_usd_to_local","program_type","PROGRAM_TYPES","LOCAL","updateNewKademe","patch","base","parseFxInput","NaN","replace","num","parseFloat","applyPresetSelection","toggleCopySelection","current","clearTimeout","setTimeout","setCopyTabSelectionAll","tabKey","entry","closeCopyScenarioModal","sumPlannedStudents","_row$studentsPerBranc2","showBlockingToast","toastId","warn","autoClose","closeOnClick","draggable","icon","boxShadow","ensurePlanningStudentsForY2Y3","actionLabel","totals","srcInputs","getPlannedStudentTotalsByYear","missing","push","msg","ensurePrevRealFxForLocal","calculate","options","skipPlanValidation","ok","calculateScenario","deleteConfirmScenario","deleteConfirmLabel","deleteConfirmMessage","ToastContainer","newestOnTop","pauseOnFocusLoss","pauseOnHover","hideProgressBar","theme","deleteScenario","slice","code","step","gridTemplateColumns","flexDirection","targetCurrency","localCurrencyCodeValue","plannedFxUsdToLocalValue","copyFxUsdToLocalValue","plannedFxNumber","copyFxNumber","_copyOptions$localCur","_copyOptions$plannedF","_copyOptions$copyFxUs","copyOptions","localCurrencyCode","plannedFxUsdToLocal","plannedFxParsed","copyFxParsed","_ref5","_localCurrencyCode","_plannedFxUsdToLocal","_copyFxUsdToLocal","_inputs$temelBilgiler3","baseName","copyName","candidateYear","guard","hasAcademicYear","yearStr","shouldCopyCore","kademeConfig","fxForCreate","created","createScenario","inputCurrency","fxUsdToLocal","clonedInputs","_next$temelBilgiler","sel","keep","buildDefaultGrades","srcGradesYears","srcGrades","y1Source","keepPlanned","keepLessonY1","y2Source","y3Source","gradesCurrent","filterInputsForCopyBySelection","inInputs","_ik$years","_src$giderler","_src$giderler$isletme","yearIK","headcountsByLevel","roles","levels","roleAnnual","count","lvl","_headcountsByLevel$lv","turkPersonelMaas","turk_mudur","turk_mdyard","turk_egitimci","turkDestekPersonelMaas","turk_temsil","yerelPersonelMaas","yerel_yonetici_egitimci","yerelDestekPersonelMaas","yerel_destek","yerel_ulke_temsil_destek","internationalPersonelMaas","int_yonetici_egitimci","prevItems","isletme","changed","abs","applyIkSalariesToGiderler","convertInputsLocalToUsdForCopy","modifiedResources","resources","buildModifiedResourcesFromCopySelection","saveScenarioInputs","sourceNorm","getNormConfig","_ref6","_sourceYears$y1$teach","_sourceYears$y","sourceYears","baseHours","saveNormConfig","console","copySelectedScenario","hint","INTERNATIONAL","option","opacity","marginLeft","getScenarioStepError","scenarioStepTotal","scenarioProgramType","updateScenario","submitScenarioWizard","isSelected","cursor","keepTab","sendForApproval","sendScenarioForApproval","FaPaperPlane","marginRight","submitScenario","submitScenarioForApproval","FaCheckCircle","FaTrash","statusMeta","scenarioOrStatus","cls","help","getScenarioStatusMeta","isThisRowBusy","isOtherRowDisabled","disableThisRowActions","pointerEvents","handleApply","writeSelectedScenarioId","writeLastActiveSchoolId","seg","readGlobalLastRouteSegment","ALLOWED_PROGRAM_TYPES","getProgramType","programFromInputs","programFromScenario","isKademeKeyVisible","endsWith","mapBaseKademeToVariant","baseKademe","suffix"],"ignoreList":[],"sourceRoot":""}